2025-10-31 18:44:30,956 - poker_game - INFO - PokerGame initialized with SB=10, BB=20, initial_chips=2000
2025-10-31 18:44:30,957 - poker_game - INFO - === STARTING NEW HAND #1 ===
2025-10-31 18:44:30,957 - poker_game - INFO - Active players for new hand: 5
2025-10-31 18:44:30,957 - poker_game - INFO - Moving dealer button
2025-10-31 18:44:30,958 - poker_game - INFO - Posting blinds
2025-10-31 18:44:30,958 - poker_game - INFO - Dealing hole cards
2025-10-31 18:44:30,958 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:44:30,972 - poker_game - INFO - Started new hand in database: hand_id=1
2025-10-31 18:44:30,972 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:44:30,973 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:30,973 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:44:30,973 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:44:30,974 - poker_game - INFO - Last raiser: 4
2025-10-31 18:44:30,974 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:30,974 - poker_game - INFO - Active players: 5, All-in: 0, Folded: 0
2025-10-31 18:44:30,974 - poker_game - INFO - Community cards: []
2025-10-31 18:44:30,974 - poker_game - INFO -   P0(Agent0): chips=2000, bet=0, status=active
2025-10-31 18:44:30,974 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=active
2025-10-31 18:44:30,974 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:30,974 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:30,975 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:30,975 - poker_game - INFO - ==================================================
2025-10-31 18:44:30,975 - poker_game - DEBUG - LLM Prompt for Agent0: {
  "your_id": 0,
  "phase": "preflop",
  "your_cards": [
    "J♥",
    "K♥"
  ],
  "community": [],
  "your_chips": 2000,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 2,
  "current_turn": 0,
  "players": [
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 2,
      "chips": 2000,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 1980,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (2000)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:44:30,989 - poker_game - DEBUG - Create Session: {'id': '883aec5e-ddfd-4383-b364-831b2b5677d6', 'appName': 'beginner_agent', 'userId': 'player_0', 'state': {}, 'events': [], 'lastUpdateTime': 1761903870.9868126}
2025-10-31 18:44:33,664 - poker_game - INFO - LLM raw Response for Agent0: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "プリフロップで、J♥K♥は非常に強いハンドです（=\\"エクイティ\\"が高い）。ポットは30で、コールには20必要です。相手のレイズ（4番プレイヤーの20）は、ポットオッズ（=ポットサイズに対するコール金額の比率）を非常に有利にしています。10の追加ベットで、相手にプレッシャーをかけ、ポットを大きくします。これは \\"3ベット\\" (3 Bet = プリフロップでのレイズ) と呼ばれる戦略です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 144, 'promptTokenCount': 652, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 652}], 'totalTokenCount': 796}, 'invocationId': 'e-c160291f-5dd1-4dc8-8d01-3c0f48fb9f2f', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'VLhzYl8Q', 'timestamp': 1761903871.408115}]
2025-10-31 18:44:33,664 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent0:
2025-10-31 18:44:33,665 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 60,
  "reasoning": "プリフロップで、J♥K♥は非常に強いハンドです（=\"エクイティ\"が高い）。ポットは30で、コールには20必要です。相手のレイズ（4番プレイヤーの20）は、ポットオッズ（=ポットサイズに対するコール金額の比率）を非常に有利にしています。10の追加ベットで、相手にプレッシャーをかけ、ポットを大きくします。これは \"3ベット\" (3 Bet = プリフロップでのレイズ) と呼ばれる戦略です。"
}
```
2025-10-31 18:44:33,665 - poker_game - DEBUG - [Agent0] Starting LLM API response parsing
2025-10-31 18:44:33,666 - poker_game - DEBUG - [Agent0] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "プリフロップで、J♥K♥は非常に強いハンドです（=\\"エクイティ\\"が高い）。ポットは30で、コールには20必要です。相手のレイズ（4番プレイヤーの20）は、ポットオッズ（=ポットサイズに対するコール金額の比率）を非常に有利にしています。10の追加ベットで、相手にプレッシャーをかけ、ポットを大きくします。これは \\"3ベット\\" (3 Bet = プリフロップでのレイズ) と呼ばれる戦略です。"\n}\n```'
2025-10-31 18:44:33,666 - poker_game - DEBUG - [Agent0] Markdown code block detected
2025-10-31 18:44:33,666 - poker_game - DEBUG - [Agent0] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "プリフロップで、J♥K♥は非常に強いハンドです（=\\"エクイティ\\"が高い）。ポットは30で、コールには20必要です。相手のレイズ（4番プレイヤーの20）は、ポットオッズ（=ポットサイズに対するコール金額の比率）を非常に有利にしています。10の追加ベットで、相手にプレッシャーをかけ、ポットを大きくします。これは \\"3ベット\\" (3 Bet = プリフロップでのレイズ) と呼ばれる戦略です。"\n}'
2025-10-31 18:44:33,667 - poker_game - DEBUG - [Agent0] JSON pattern found: {
  "action": "raise",
  "amount": 60,
  "reasoning": "プリフロップで、J♥K♥は非常に強いハンドです（=\"エクイティ\"が高い）。ポットは30で、コールには20必要です。相手のレイズ（4番プレイヤーの20）は、ポットオッズ（=ポットサイズに対するコール金額の比率）を非常に有利にしています。10の追加ベットで、相手にプレッシャーをかけ、ポットを大きくします。これは \"3ベット\" (3 Bet = プリフロップでのレイズ) と呼ばれる戦略です。"
}
2025-10-31 18:44:33,668 - poker_game - DEBUG - [Agent0] JSON parsing successful: {'action': 'raise', 'amount': 60, 'reasoning': 'プリフロップで、J♥K♥は非常に強いハンドです（="エクイティ"が高い）。ポットは30で、コールには20必要です。相手のレイズ（4番プレイヤーの20）は、ポットオッズ（=ポットサイズに対するコール金額の比率）を非常に有利にしています。10の追加ベットで、相手にプレッシャーをかけ、ポットを大きくします。これは "3ベット" (3 Bet = プリフロップでのレイズ) と呼ばれる戦略です。'}
2025-10-31 18:44:33,668 - poker_game - DEBUG - [Agent0] Extracted values - action: 'raise', amount: 60
2025-10-31 18:44:33,668 - poker_game - DEBUG - [Agent0] Processing raise action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (2000)']
2025-10-31 18:44:33,670 - poker_game - DEBUG - [Agent0] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 18:44:33,670 - poker_game - DEBUG - [Agent0] Raise amount 60 is valid (min: 40)
2025-10-31 18:44:33,670 - poker_game - DEBUG - [Agent0] Final parsed decision: {'action': 'raise', 'amount': 60}
2025-10-31 18:44:33,670 - poker_game - INFO - [Agent0] Successfully parsed decision: raise, 60, プリフロップで、J♥K♥は非常に強いハンドです（="エクイティ"が高い）。ポットは30で、コールには20必要です。相手のレイズ（4番プレイヤーの20）は、ポットオッズ（=ポットサイズに対するコール金額の比率）を非常に有利にしています。10の追加ベットで、相手にプレッシャーをかけ、ポットを大きくします。これは "3ベット" (3 Bet = プリフロップでのレイズ) と呼ばれる戦略です。
2025-10-31 18:44:33,674 - poker_game - INFO - >>> PROCESS_ACTION: Player 0 attempts 'raise' with amount 60
2025-10-31 18:44:33,674 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:44:33,675 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:33,676 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:44:33,676 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:44:33,677 - poker_game - INFO - Last raiser: 4
2025-10-31 18:44:33,677 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:33,677 - poker_game - INFO - Active players: 5, All-in: 0, Folded: 0
2025-10-31 18:44:33,678 - poker_game - INFO - Community cards: []
2025-10-31 18:44:33,678 - poker_game - INFO -   P0(Agent0): chips=2000, bet=0, status=active
2025-10-31 18:44:33,679 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=active
2025-10-31 18:44:33,679 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:33,680 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:33,680 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:33,680 - poker_game - INFO - ==================================================
2025-10-31 18:44:33,681 - poker_game - INFO - ACTION_EXECUTED: Player 0 raised to 80
2025-10-31 18:44:33,693 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:44:33,694 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:33,694 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:44:33,695 - poker_game - INFO - Pot: 110, Current bet: 80
2025-10-31 18:44:33,696 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:33,696 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:33,698 - poker_game - INFO - Active players: 5, All-in: 0, Folded: 0
2025-10-31 18:44:33,698 - poker_game - INFO - Community cards: []
2025-10-31 18:44:33,698 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:33,699 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=active
2025-10-31 18:44:33,699 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:33,700 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:33,700 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:33,701 - poker_game - INFO - Extra: Action: Player 0 raised to 80
2025-10-31 18:44:33,701 - poker_game - INFO - ==================================================
2025-10-31 18:44:33,701 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:44:33,702 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:44:33,702 - poker_game - DEBUG - Active players: [0, 1, 2, 3, 4]
2025-10-31 18:44:33,703 - poker_game - INFO - Advanced from player 0 to player 1 (seat order)
2025-10-31 18:44:33,703 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:44:33,703 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:44:33,704 - poker_game - DEBUG - Active: 5, All-in: 0
2025-10-31 18:44:33,704 - poker_game - DEBUG - Player bets: [80, 0, 0, 10, 20], Current bet: 80, All same: False
2025-10-31 18:44:33,704 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:44:33,704 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:44:33,705 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:33,705 - poker_game - INFO - Current player: 1, Dealer: 2
2025-10-31 18:44:33,706 - poker_game - INFO - Pot: 110, Current bet: 80
2025-10-31 18:44:33,706 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:33,707 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:33,707 - poker_game - INFO - Active players: 5, All-in: 0, Folded: 0
2025-10-31 18:44:33,707 - poker_game - INFO - Community cards: []
2025-10-31 18:44:33,708 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:33,708 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=active
2025-10-31 18:44:33,709 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:33,710 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:33,711 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:33,711 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:44:33,712 - poker_game - INFO - ==================================================
2025-10-31 18:44:33,814 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "Q♣",
    "7♠"
  ],
  "community": [],
  "your_chips": 2000,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 110,
  "to_call": 80,
  "dealer_button": 2,
  "current_turn": 1,
  "players": [
    {
      "id": 0,
      "chips": 1920,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 2,
      "chips": 2000,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 1980,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (80)",
    "raise (min 100)",
    "all-in (2000)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80"
  ]
}
2025-10-31 18:44:33,846 - poker_game - DEBUG - Create Session: {'id': '736825e8-53c1-4f0f-979a-255eca853120', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761903873.8419363}
2025-10-31 18:44:35,918 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Q7オフスート（異なるマークのスート）は、プリフロップ（カードが配られた直後）では弱いハンドです。ポットにはすでに80のコールが必要で、さらにレイズされる可能性も考慮すると、このハンドでコールまたはレイズするのはリスクが高すぎます。フォールド（降りる）のが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 105, 'promptTokenCount': 667, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 667}], 'totalTokenCount': 772}, 'invocationId': 'e-0fc2721e-0f09-4fe0-abf3-2c203d8c0d74', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 't79fQKJt', 'timestamp': 1761903873.861892}]
2025-10-31 18:44:35,918 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:44:35,919 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "Q7オフスート（異なるマークのスート）は、プリフロップ（カードが配られた直後）では弱いハンドです。ポットにはすでに80のコールが必要で、さらにレイズされる可能性も考慮すると、このハンドでコールまたはレイズするのはリスクが高すぎます。フォールド（降りる）のが最善の選択です。"
}
```
2025-10-31 18:44:35,919 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:44:35,920 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Q7オフスート（異なるマークのスート）は、プリフロップ（カードが配られた直後）では弱いハンドです。ポットにはすでに80のコールが必要で、さらにレイズされる可能性も考慮すると、このハンドでコールまたはレイズするのはリスクが高すぎます。フォールド（降りる）のが最善の選択です。"\n}\n```'
2025-10-31 18:44:35,920 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:44:35,920 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Q7オフスート（異なるマークのスート）は、プリフロップ（カードが配られた直後）では弱いハンドです。ポットにはすでに80のコールが必要で、さらにレイズされる可能性も考慮すると、このハンドでコールまたはレイズするのはリスクが高すぎます。フォールド（降りる）のが最善の選択です。"\n}'
2025-10-31 18:44:35,921 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "Q7オフスート（異なるマークのスート）は、プリフロップ（カードが配られた直後）では弱いハンドです。ポットにはすでに80のコールが必要で、さらにレイズされる可能性も考慮すると、このハンドでコールまたはレイズするのはリスクが高すぎます。フォールド（降りる）のが最善の選択です。"
}
2025-10-31 18:44:35,921 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'Q7オフスート（異なるマークのスート）は、プリフロップ（カードが配られた直後）では弱いハンドです。ポットにはすでに80のコールが必要で、さらにレイズされる可能性も考慮すると、このハンドでコールまたはレイズするのはリスクが高すぎます。フォールド（降りる）のが最善の選択です。'}
2025-10-31 18:44:35,921 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:44:35,921 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:44:35,921 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:44:35,922 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, Q7オフスート（異なるマークのスート）は、プリフロップ（カードが配られた直後）では弱いハンドです。ポットにはすでに80のコールが必要で、さらにレイズされる可能性も考慮すると、このハンドでコールまたはレイズするのはリスクが高すぎます。フォールド（降りる）のが最善の選択です。
2025-10-31 18:44:35,923 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:44:35,923 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:44:35,924 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:35,924 - poker_game - INFO - Current player: 1, Dealer: 2
2025-10-31 18:44:35,924 - poker_game - INFO - Pot: 110, Current bet: 80
2025-10-31 18:44:35,926 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:35,926 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:35,928 - poker_game - INFO - Active players: 5, All-in: 0, Folded: 0
2025-10-31 18:44:35,929 - poker_game - INFO - Community cards: []
2025-10-31 18:44:35,930 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:35,931 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=active
2025-10-31 18:44:35,932 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:35,933 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:35,933 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:35,933 - poker_game - INFO - ==================================================
2025-10-31 18:44:35,934 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:44:35,949 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:44:35,949 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:35,950 - poker_game - INFO - Current player: 1, Dealer: 2
2025-10-31 18:44:35,950 - poker_game - INFO - Pot: 110, Current bet: 80
2025-10-31 18:44:35,951 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:35,951 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:35,951 - poker_game - INFO - Active players: 4, All-in: 0, Folded: 1
2025-10-31 18:44:35,952 - poker_game - INFO - Community cards: []
2025-10-31 18:44:35,952 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:35,952 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:35,953 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:35,953 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:35,953 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:35,954 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:44:35,954 - poker_game - INFO - ==================================================
2025-10-31 18:44:35,955 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:44:35,955 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:44:35,955 - poker_game - DEBUG - Active players: [0, 2, 3, 4]
2025-10-31 18:44:35,955 - poker_game - INFO - Advanced from player 1 to player 2 (seat order)
2025-10-31 18:44:35,956 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:44:35,956 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:44:35,957 - poker_game - DEBUG - Active: 4, All-in: 0
2025-10-31 18:44:35,957 - poker_game - DEBUG - Player bets: [80, 0, 10, 20], Current bet: 80, All same: False
2025-10-31 18:44:35,957 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:44:35,957 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:44:35,957 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:35,958 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:44:35,958 - poker_game - INFO - Pot: 110, Current bet: 80
2025-10-31 18:44:35,958 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:35,959 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:35,959 - poker_game - INFO - Active players: 4, All-in: 0, Folded: 1
2025-10-31 18:44:35,960 - poker_game - INFO - Community cards: []
2025-10-31 18:44:35,960 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:35,960 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:35,960 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:35,961 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:35,961 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:35,961 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:44:35,962 - poker_game - INFO - ==================================================
2025-10-31 18:44:36,064 - poker_game - DEBUG - LLM Prompt for Agent2: {
  "your_id": 2,
  "phase": "preflop",
  "your_cards": [
    "5♥",
    "8♦"
  ],
  "community": [],
  "your_chips": 2000,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 110,
  "to_call": 80,
  "dealer_button": 2,
  "current_turn": 2,
  "players": [
    {
      "id": 0,
      "chips": 1920,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 1980,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (80)",
    "raise (min 100)",
    "all-in (2000)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded"
  ]
}
2025-10-31 18:44:36,074 - poker_game - DEBUG - Create Session: {'id': '6c651280-3324-4cdc-94b7-f58ef9e1b12b', 'appName': 'beginner_agent', 'userId': 'player_2', 'state': {}, 'events': [], 'lastUpdateTime': 1761903876.0720365}
2025-10-31 18:44:44,099 - poker_game - INFO - LLM raw Response for Agent2: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 80,\n  "reasoning": "Preflop（プリフロップ）で、まだフロップ（コミュニティカードが開かれる前の段階）です。私の手札は5♥8♦で、これはコネクター（連続した数字）ですが、スート（マーク）は揃っていません。前のプレイヤー（Player 0）が80にレイズ（ベット額を上げる行為）しており、コール（相手のベット額と同じ額をベットしてプレイを続ける行為）するには80必要です。ポットにはすでに110あり、コールすることでフロップを見ることができます。私の手札はそれほど強くありませんが、ポットオッズ（コールに必要な金額に対してポットにある金額の割合）を考慮すると、フロップを見て改善の可能性を探る価値はあります。フォールド（プレイを降りる行為）するには、すでにポットにベットしたチップが無駄になります。レイズするには、手札が弱すぎるため、リスクが高いです。したがって、コールが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 230, 'promptTokenCount': 675, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 675}], 'totalTokenCount': 905}, 'invocationId': 'e-fdbb3f62-0843-4e47-90c3-257e9eb5bb40', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 's9EpPKQe', 'timestamp': 1761903876.084328}]
2025-10-31 18:44:44,100 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent2:
2025-10-31 18:44:44,100 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 80,
  "reasoning": "Preflop（プリフロップ）で、まだフロップ（コミュニティカードが開かれる前の段階）です。私の手札は5♥8♦で、これはコネクター（連続した数字）ですが、スート（マーク）は揃っていません。前のプレイヤー（Player 0）が80にレイズ（ベット額を上げる行為）しており、コール（相手のベット額と同じ額をベットしてプレイを続ける行為）するには80必要です。ポットにはすでに110あり、コールすることでフロップを見ることができます。私の手札はそれほど強くありませんが、ポットオッズ（コールに必要な金額に対してポットにある金額の割合）を考慮すると、フロップを見て改善の可能性を探る価値はあります。フォールド（プレイを降りる行為）するには、すでにポットにベットしたチップが無駄になります。レイズするには、手札が弱すぎるため、リスクが高いです。したがって、コールが最善の選択です。"
}
```
2025-10-31 18:44:44,100 - poker_game - DEBUG - [Agent2] Starting LLM API response parsing
2025-10-31 18:44:44,100 - poker_game - DEBUG - [Agent2] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 80,\n  "reasoning": "Preflop（プリフロップ）で、まだフロップ（コミュニティカードが開かれる前の段階）です。私の手札は5♥8♦で、これはコネクター（連続した数字）ですが、スート（マーク）は揃っていません。前のプレイヤー（Player 0）が80にレイズ（ベット額を上げる行為）しており、コール（相手のベット額と同じ額をベットしてプレイを続ける行為）するには80必要です。ポットにはすでに110あり、コールすることでフロップを見ることができます。私の手札はそれほど強くありませんが、ポットオッズ（コールに必要な金額に対してポットにある金額の割合）を考慮すると、フロップを見て改善の可能性を探る価値はあります。フォールド（プレイを降りる行為）するには、すでにポットにベットしたチップが無駄になります。レイズするには、手札が弱すぎるため、リスクが高いです。したがって、コールが最善の選択です。"\n}\n```'
2025-10-31 18:44:44,100 - poker_game - DEBUG - [Agent2] Markdown code block detected
2025-10-31 18:44:44,100 - poker_game - DEBUG - [Agent2] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 80,\n  "reasoning": "Preflop（プリフロップ）で、まだフロップ（コミュニティカードが開かれる前の段階）です。私の手札は5♥8♦で、これはコネクター（連続した数字）ですが、スート（マーク）は揃っていません。前のプレイヤー（Player 0）が80にレイズ（ベット額を上げる行為）しており、コール（相手のベット額と同じ額をベットしてプレイを続ける行為）するには80必要です。ポットにはすでに110あり、コールすることでフロップを見ることができます。私の手札はそれほど強くありませんが、ポットオッズ（コールに必要な金額に対してポットにある金額の割合）を考慮すると、フロップを見て改善の可能性を探る価値はあります。フォールド（プレイを降りる行為）するには、すでにポットにベットしたチップが無駄になります。レイズするには、手札が弱すぎるため、リスクが高いです。したがって、コールが最善の選択です。"\n}'
2025-10-31 18:44:44,100 - poker_game - DEBUG - [Agent2] JSON pattern found: {
  "action": "call",
  "amount": 80,
  "reasoning": "Preflop（プリフロップ）で、まだフロップ（コミュニティカードが開かれる前の段階）です。私の手札は5♥8♦で、これはコネクター（連続した数字）ですが、スート（マーク）は揃っていません。前のプレイヤー（Player 0）が80にレイズ（ベット額を上げる行為）しており、コール（相手のベット額と同じ額をベットしてプレイを続ける行為）するには80必要です。ポットにはすでに110あり、コールすることでフロップを見ることができます。私の手札はそれほど強くありませんが、ポットオッズ（コールに必要な金額に対してポットにある金額の割合）を考慮すると、フロップを見て改善の可能性を探る価値はあります。フォールド（プレイを降りる行為）するには、すでにポットにベットしたチップが無駄になります。レイズするには、手札が弱すぎるため、リスクが高いです。したがって、コールが最善の選択です。"
}
2025-10-31 18:44:44,100 - poker_game - DEBUG - [Agent2] JSON parsing successful: {'action': 'call', 'amount': 80, 'reasoning': 'Preflop（プリフロップ）で、まだフロップ（コミュニティカードが開かれる前の段階）です。私の手札は5♥8♦で、これはコネクター（連続した数字）ですが、スート（マーク）は揃っていません。前のプレイヤー（Player 0）が80にレイズ（ベット額を上げる行為）しており、コール（相手のベット額と同じ額をベットしてプレイを続ける行為）するには80必要です。ポットにはすでに110あり、コールすることでフロップを見ることができます。私の手札はそれほど強くありませんが、ポットオッズ（コールに必要な金額に対してポットにある金額の割合）を考慮すると、フロップを見て改善の可能性を探る価値はあります。フォールド（プレイを降りる行為）するには、すでにポットにベットしたチップが無駄になります。レイズするには、手札が弱すぎるため、リスクが高いです。したがって、コールが最善の選択です。'}
2025-10-31 18:44:44,100 - poker_game - DEBUG - [Agent2] Extracted values - action: 'call', amount: 80
2025-10-31 18:44:44,101 - poker_game - DEBUG - [Agent2] Processing call action - available actions: ['fold', 'call (80)', 'raise (min 100)', 'all-in (2000)']
2025-10-31 18:44:44,101 - poker_game - DEBUG - [Agent2] Call amount extracted from 'call (80)': 80
2025-10-31 18:44:44,101 - poker_game - DEBUG - [Agent2] Final parsed decision: {'action': 'call', 'amount': 80}
2025-10-31 18:44:44,101 - poker_game - INFO - [Agent2] Successfully parsed decision: call, 80, Preflop（プリフロップ）で、まだフロップ（コミュニティカードが開かれる前の段階）です。私の手札は5♥8♦で、これはコネクター（連続した数字）ですが、スート（マーク）は揃っていません。前のプレイヤー（Player 0）が80にレイズ（ベット額を上げる行為）しており、コール（相手のベット額と同じ額をベットしてプレイを続ける行為）するには80必要です。ポットにはすでに110あり、コールすることでフロップを見ることができます。私の手札はそれほど強くありませんが、ポットオッズ（コールに必要な金額に対してポットにある金額の割合）を考慮すると、フロップを見て改善の可能性を探る価値はあります。フォールド（プレイを降りる行為）するには、すでにポットにベットしたチップが無駄になります。レイズするには、手札が弱すぎるため、リスクが高いです。したがって、コールが最善の選択です。
2025-10-31 18:44:44,102 - poker_game - INFO - >>> PROCESS_ACTION: Player 2 attempts 'call' with amount 80
2025-10-31 18:44:44,102 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:44:44,102 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:44,102 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:44:44,102 - poker_game - INFO - Pot: 110, Current bet: 80
2025-10-31 18:44:44,103 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:44,103 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:44,103 - poker_game - INFO - Active players: 4, All-in: 0, Folded: 1
2025-10-31 18:44:44,103 - poker_game - INFO - Community cards: []
2025-10-31 18:44:44,103 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:44,103 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:44,103 - poker_game - INFO -   P2(Agent2): chips=2000, bet=0, status=active
2025-10-31 18:44:44,103 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:44,104 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:44,104 - poker_game - INFO - ==================================================
2025-10-31 18:44:44,104 - poker_game - INFO - ACTION_EXECUTED: Player 2 called 80
2025-10-31 18:44:44,131 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:44:44,132 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:44,132 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:44:44,132 - poker_game - INFO - Pot: 190, Current bet: 80
2025-10-31 18:44:44,132 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:44,132 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:44,133 - poker_game - INFO - Active players: 4, All-in: 0, Folded: 1
2025-10-31 18:44:44,133 - poker_game - INFO - Community cards: []
2025-10-31 18:44:44,133 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:44,133 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:44,133 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:44,133 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:44,134 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:44,134 - poker_game - INFO - Extra: Action: Player 2 called 80
2025-10-31 18:44:44,134 - poker_game - INFO - ==================================================
2025-10-31 18:44:44,134 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:44:44,134 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:44:44,134 - poker_game - DEBUG - Active players: [0, 2, 3, 4]
2025-10-31 18:44:44,135 - poker_game - INFO - Advanced from player 2 to player 3 (seat order)
2025-10-31 18:44:44,135 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:44:44,135 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:44:44,135 - poker_game - DEBUG - Active: 4, All-in: 0
2025-10-31 18:44:44,135 - poker_game - DEBUG - Player bets: [80, 80, 10, 20], Current bet: 80, All same: False
2025-10-31 18:44:44,135 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:44:44,135 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:44:44,136 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:44,136 - poker_game - INFO - Current player: 3, Dealer: 2
2025-10-31 18:44:44,136 - poker_game - INFO - Pot: 190, Current bet: 80
2025-10-31 18:44:44,136 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:44,136 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:44,136 - poker_game - INFO - Active players: 4, All-in: 0, Folded: 1
2025-10-31 18:44:44,137 - poker_game - INFO - Community cards: []
2025-10-31 18:44:44,137 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:44,137 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:44,137 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:44,137 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:44,138 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:44,138 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:44:44,139 - poker_game - INFO - ==================================================
2025-10-31 18:44:44,242 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "A♣",
    "2♦"
  ],
  "community": [],
  "your_chips": 1990,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 190,
  "to_call": 70,
  "dealer_button": 2,
  "current_turn": 3,
  "players": [
    {
      "id": 0,
      "chips": 1920,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 2,
      "chips": 1920,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 1980,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (70)",
    "raise (min 100)",
    "all-in (1990)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80"
  ]
}
2025-10-31 18:44:44,261 - poker_game - DEBUG - Create Session: {'id': 'a0a87c6e-6028-45a3-981c-15e0c93f4856', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761903884.2585967}
2025-10-31 18:44:45,991 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "A♣2♦は非常に弱いハンド（カードの組み合わせ）です。特にプリフロップ（最初のカードが配られた後の最初のラウンド）では、ほとんどの場合フォールド（降りる）のが最善です。ポットがそれほど大きくなく、コール（相手と同じ金額を支払って続ける）するにはリスクが高すぎます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 98, 'promptTokenCount': 688, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 688}], 'totalTokenCount': 786}, 'invocationId': 'e-fdd0e0da-562a-4dff-9926-58762aeb4c80', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'bEELCJUj', 'timestamp': 1761903884.275887}]
2025-10-31 18:44:45,992 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:44:45,992 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "A♣2♦は非常に弱いハンド（カードの組み合わせ）です。特にプリフロップ（最初のカードが配られた後の最初のラウンド）では、ほとんどの場合フォールド（降りる）のが最善です。ポットがそれほど大きくなく、コール（相手と同じ金額を支払って続ける）するにはリスクが高すぎます。"
}
```
2025-10-31 18:44:45,992 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:44:45,992 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "A♣2♦は非常に弱いハンド（カードの組み合わせ）です。特にプリフロップ（最初のカードが配られた後の最初のラウンド）では、ほとんどの場合フォールド（降りる）のが最善です。ポットがそれほど大きくなく、コール（相手と同じ金額を支払って続ける）するにはリスクが高すぎます。"\n}\n```'
2025-10-31 18:44:45,993 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:44:45,993 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "A♣2♦は非常に弱いハンド（カードの組み合わせ）です。特にプリフロップ（最初のカードが配られた後の最初のラウンド）では、ほとんどの場合フォールド（降りる）のが最善です。ポットがそれほど大きくなく、コール（相手と同じ金額を支払って続ける）するにはリスクが高すぎます。"\n}'
2025-10-31 18:44:45,993 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "A♣2♦は非常に弱いハンド（カードの組み合わせ）です。特にプリフロップ（最初のカードが配られた後の最初のラウンド）では、ほとんどの場合フォールド（降りる）のが最善です。ポットがそれほど大きくなく、コール（相手と同じ金額を支払って続ける）するにはリスクが高すぎます。"
}
2025-10-31 18:44:45,993 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'A♣2♦は非常に弱いハンド（カードの組み合わせ）です。特にプリフロップ（最初のカードが配られた後の最初のラウンド）では、ほとんどの場合フォールド（降りる）のが最善です。ポットがそれほど大きくなく、コール（相手と同じ金額を支払って続ける）するにはリスクが高すぎます。'}
2025-10-31 18:44:45,993 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:44:45,993 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:44:45,993 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:44:45,993 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, A♣2♦は非常に弱いハンド（カードの組み合わせ）です。特にプリフロップ（最初のカードが配られた後の最初のラウンド）では、ほとんどの場合フォールド（降りる）のが最善です。ポットがそれほど大きくなく、コール（相手と同じ金額を支払って続ける）するにはリスクが高すぎます。
2025-10-31 18:44:45,994 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:44:45,994 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:44:45,995 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:45,995 - poker_game - INFO - Current player: 3, Dealer: 2
2025-10-31 18:44:45,995 - poker_game - INFO - Pot: 190, Current bet: 80
2025-10-31 18:44:45,995 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:45,995 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:45,995 - poker_game - INFO - Active players: 4, All-in: 0, Folded: 1
2025-10-31 18:44:45,995 - poker_game - INFO - Community cards: []
2025-10-31 18:44:45,996 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:45,996 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:45,996 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:45,996 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=active
2025-10-31 18:44:45,996 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:45,996 - poker_game - INFO - ==================================================
2025-10-31 18:44:45,997 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:44:46,008 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:44:46,008 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:46,009 - poker_game - INFO - Current player: 3, Dealer: 2
2025-10-31 18:44:46,009 - poker_game - INFO - Pot: 190, Current bet: 80
2025-10-31 18:44:46,009 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:46,010 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:46,010 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:44:46,010 - poker_game - INFO - Community cards: []
2025-10-31 18:44:46,011 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:46,011 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:46,012 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:46,012 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=folded
2025-10-31 18:44:46,012 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:46,012 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:44:46,013 - poker_game - INFO - ==================================================
2025-10-31 18:44:46,013 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:44:46,013 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:44:46,014 - poker_game - DEBUG - Active players: [0, 2, 4]
2025-10-31 18:44:46,014 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:44:46,014 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:44:46,014 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:44:46,015 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:44:46,015 - poker_game - DEBUG - Player bets: [80, 80, 20], Current bet: 80, All same: False
2025-10-31 18:44:46,015 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:44:46,015 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:44:46,015 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:46,016 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:44:46,016 - poker_game - INFO - Pot: 190, Current bet: 80
2025-10-31 18:44:46,016 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:46,017 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:46,017 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:44:46,017 - poker_game - INFO - Community cards: []
2025-10-31 18:44:46,018 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:46,018 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:46,018 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:46,019 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=folded
2025-10-31 18:44:46,019 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:46,019 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:44:46,020 - poker_game - INFO - ==================================================
2025-10-31 18:44:46,122 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "3♠",
    "8♥"
  ],
  "community": [],
  "your_chips": 1980,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 190,
  "to_call": 60,
  "dealer_button": 2,
  "current_turn": 4,
  "players": [
    {
      "id": 0,
      "chips": 1920,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 2,
      "chips": 1920,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 10,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (60)",
    "raise (min 100)",
    "all-in (1980)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded"
  ]
}
2025-10-31 18:44:46,145 - poker_game - DEBUG - Create Session: {'id': 'c91958a5-8625-474c-822e-50b2bd2271cc', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903886.140638}
2025-10-31 18:44:51,418 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_FeGC9abf3RL4VwOqtzg0fxQ6', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1016, 'totalTokenCount': 1033}, 'invocationId': 'e-32fd130e-8847-4dd3-9e58-c8898476d7f8', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'dYmUH8Bq', 'timestamp': 1761903886.159304}, {'content': {'parts': [{'functionResponse': {'id': 'call_FeGC9abf3RL4VwOqtzg0fxQ6', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-32fd130e-8847-4dd3-9e58-c8898476d7f8', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'F9MrwmP5', 'timestamp': 1761903887.204361}, {'content': {'parts': [{'functionCall': {'id': 'call_FKo8oWTvpxFXxAvxuLT4wN98', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['3♠', '8♥'], 'community': [], 'your_chips': 1980, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 190, 'to_call': 60, 'dealer_button': 2, 'current_turn': 4, 'players': [{'id': 0, 'chips': 1920, 'bet': 80, 'status': 'active'}, {'id': 1, 'chips': 2000, 'bet': 0, 'status': 'folded'}, {'id': 2, 'chips': 1920, 'bet': 80, 'status': 'active'}, {'id': 3, 'chips': 1990, 'bet': 10, 'status': 'folded'}], 'actions': ['fold', 'call (60)', 'raise (min 100)', 'all-in (1980)'], 'history': ['Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 0 raised to 80', 'Player 1 folded', 'Player 2 called 80', 'Player 3 folded']}, 'call_amount': 60, 'pot_after_call': 250, 'equity': 0.3}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 260, 'promptTokenCount': 1540, 'totalTokenCount': 1800}, 'invocationId': 'e-32fd130e-8847-4dd3-9e58-c8898476d7f8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '6RyxlLGZ', 'timestamp': 1761903887.206212}, {'content': {'parts': [{'functionResponse': {'id': 'call_FKo8oWTvpxFXxAvxuLT4wN98', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 60, 'reasoning': 'ポットオッズを満たしており（33.00(ポットに対して17.37%）、コールが妥当と判断。コール額: 60'}}}], 'role': 'user'}, 'invocationId': 'e-32fd130e-8847-4dd3-9e58-c8898476d7f8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'kSnDoJuN', 'timestamp': 1761903889.629669}, {'content': {'parts': [{'text': '{"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（33.00(ポットに対して17.37%）、コールが妥当と判断。コール額: 60"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 1851, 'totalTokenCount': 1905}, 'invocationId': 'e-32fd130e-8847-4dd3-9e58-c8898476d7f8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '4Qxuse1z', 'timestamp': 1761903889.632279}]
2025-10-31 18:44:51,419 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:44:51,420 - poker_game - DEBUG - {"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（33.00(ポットに対して17.37%）、コールが妥当と判断。コール額: 60"}
2025-10-31 18:44:51,420 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:44:51,420 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（33.00(ポットに対して17.37%）、コールが妥当と判断。コール額: 60"}'
2025-10-31 18:44:51,421 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:44:51,421 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（33.00(ポットに対して17.37%）、コールが妥当と判断。コール額: 60"}
2025-10-31 18:44:51,421 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 60, 'reasoning': 'ポットオッズを満たしており（33.00(ポットに対して17.37%）、コールが妥当と判断。コール額: 60'}
2025-10-31 18:44:51,422 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 60
2025-10-31 18:44:51,423 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (60)', 'raise (min 100)', 'all-in (1980)']
2025-10-31 18:44:51,423 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (60)': 60
2025-10-31 18:44:51,423 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 60}
2025-10-31 18:44:51,424 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 60, ポットオッズを満たしており（33.00(ポットに対して17.37%）、コールが妥当と判断。コール額: 60
2025-10-31 18:44:51,425 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 60
2025-10-31 18:44:51,426 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:44:51,426 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:51,427 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:44:51,429 - poker_game - INFO - Pot: 190, Current bet: 80
2025-10-31 18:44:51,429 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:51,430 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:51,430 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:44:51,430 - poker_game - INFO - Community cards: []
2025-10-31 18:44:51,431 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:51,431 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:51,431 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:51,431 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=folded
2025-10-31 18:44:51,432 - poker_game - INFO -   P4(Agent4): chips=1980, bet=20, status=active
2025-10-31 18:44:51,432 - poker_game - INFO - ==================================================
2025-10-31 18:44:51,432 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 60
2025-10-31 18:44:51,449 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:44:51,450 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:51,450 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:44:51,451 - poker_game - INFO - Pot: 250, Current bet: 80
2025-10-31 18:44:51,451 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:51,451 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:51,452 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:44:51,452 - poker_game - INFO - Community cards: []
2025-10-31 18:44:51,452 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:51,452 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:51,452 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:51,453 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=folded
2025-10-31 18:44:51,453 - poker_game - INFO -   P4(Agent4): chips=1920, bet=80, status=active
2025-10-31 18:44:51,453 - poker_game - INFO - Extra: Action: Player 4 called 60
2025-10-31 18:44:51,454 - poker_game - INFO - ==================================================
2025-10-31 18:44:51,454 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:44:51,455 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:44:51,455 - poker_game - DEBUG - Active players: [0, 2, 4]
2025-10-31 18:44:51,455 - poker_game - INFO - Advanced from player 4 to player 0 (seat order)
2025-10-31 18:44:51,455 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:44:51,455 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:44:51,455 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:44:51,455 - poker_game - DEBUG - Player bets: [80, 80, 80], Current bet: 80, All same: True
2025-10-31 18:44:51,456 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:44:51,456 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:44:51,456 - poker_game - INFO - Hand #1, Phase: preflop
2025-10-31 18:44:51,456 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:44:51,457 - poker_game - INFO - Pot: 250, Current bet: 80
2025-10-31 18:44:51,457 - poker_game - INFO - Last raiser: 0
2025-10-31 18:44:51,457 - poker_game - INFO - Betting round complete: True
2025-10-31 18:44:51,458 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:44:51,458 - poker_game - INFO - Community cards: []
2025-10-31 18:44:51,459 - poker_game - INFO -   P0(Agent0): chips=1920, bet=80, status=active
2025-10-31 18:44:51,459 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:51,460 - poker_game - INFO -   P2(Agent2): chips=1920, bet=80, status=active
2025-10-31 18:44:51,461 - poker_game - INFO -   P3(Agent3): chips=1990, bet=10, status=folded
2025-10-31 18:44:51,461 - poker_game - INFO -   P4(Agent4): chips=1920, bet=80, status=active
2025-10-31 18:44:51,462 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:44:51,463 - poker_game - INFO - ==================================================
2025-10-31 18:44:51,564 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:44:51,564 - poker_game - INFO - Betting round complete: True
2025-10-31 18:44:51,565 - poker_game - INFO - Remaining players: 3
2025-10-31 18:44:51,565 - poker_game - DEBUG -   Remaining P0: Agent0, status: active
2025-10-31 18:44:51,566 - poker_game - DEBUG -   Remaining P2: Agent2, status: active
2025-10-31 18:44:51,566 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:44:51,566 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:44:51,577 - poker_game - INFO - Starting new betting round
2025-10-31 18:44:51,578 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:44:51,579 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:44:51,579 - poker_game - DEBUG - Active players for new betting round: [0, 2, 4]
2025-10-31 18:44:51,579 - poker_game - DEBUG - Dealer button: 2
2025-10-31 18:44:51,580 - poker_game - INFO - First actor: Player 4 (by phase rule), was 0
2025-10-31 18:44:51,580 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:44:51,580 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:44:51,581 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:44:51,581 - poker_game - INFO - Pot: 250, Current bet: 0
2025-10-31 18:44:51,582 - poker_game - INFO - Last raiser: None
2025-10-31 18:44:51,582 - poker_game - INFO - Betting round complete: False
2025-10-31 18:44:51,582 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:44:51,583 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:44:51,583 - poker_game - INFO -   P0(Agent0): chips=1920, bet=0, status=active
2025-10-31 18:44:51,584 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:44:51,584 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:44:51,584 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:44:51,585 - poker_game - INFO -   P4(Agent4): chips=1920, bet=0, status=active
2025-10-31 18:44:51,585 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:44:51,586 - poker_game - INFO - ==================================================
2025-10-31 18:44:51,587 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "3♠",
    "8♥"
  ],
  "community": [
    "3♣",
    "10♠",
    "4♣"
  ],
  "your_chips": 1920,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 250,
  "to_call": 0,
  "dealer_button": 2,
  "current_turn": 4,
  "players": [
    {
      "id": 0,
      "chips": 1920,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 2,
      "chips": 1920,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1920)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣"
  ]
}
2025-10-31 18:44:51,710 - poker_game - DEBUG - Create Session: {'id': 'cf9ddee6-e138-4138-8df5-7cfc4d386f2d', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903891.7056892}
2025-10-31 18:45:01,825 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:45:01,969 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_FrIsilRNDXMO9n7hAXX5JbTn', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1063, 'totalTokenCount': 1080}, 'invocationId': 'e-b9291d5a-b242-4ae1-bc2a-50434cb61b7c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'CYfrAvDo', 'timestamp': 1761903891.724894}, {'content': {'parts': [{'functionResponse': {'id': 'call_FrIsilRNDXMO9n7hAXX5JbTn', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-b9291d5a-b242-4ae1-bc2a-50434cb61b7c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'OmjXUCF5', 'timestamp': 1761903892.675762}, {'content': {'parts': [{'functionCall': {'id': 'call_OKbKAQGaMSLkU8qioI0xfqZq', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_9cLeIa74271NUzNqNZRQ6Yh5', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['3♠', '8♥'], 'community': ['3♣', '10♠', '4♣'], 'your_chips': 1920, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 80, 'pot': 250, 'to_call': 0, 'dealer_button': 2, 'current_turn': 4, 'players': [{'id': 0, 'chips': 1920, 'bet': 0, 'status': 'active'}, {'id': 1, 'chips': 2000, 'bet': 0, 'status': 'folded'}, {'id': 2, 'chips': 1920, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1990, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (1920)'], 'history': ['Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 0 raised to 80', 'Player 1 folded', 'Player 2 called 80', 'Player 3 folded', 'Player 4 called 60', 'Flop dealt: 3♣, 10♠, 4♣']}, 'call_amount': 0, 'pot_after_call': 250, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 314, 'promptTokenCount': 1587, 'totalTokenCount': 1901}, 'invocationId': 'e-b9291d5a-b242-4ae1-bc2a-50434cb61b7c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'xrtkcdAs', 'timestamp': 1761903892.677944}, {'content': {'parts': [{'functionResponse': {'id': 'call_OKbKAQGaMSLkU8qioI0xfqZq', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_9cLeIa74271NUzNqNZRQ6Yh5', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 125, 'reasoning': '期待値が見込める（125.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 125'}}}], 'role': 'user'}, 'invocationId': '1AkVfJIs', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '8Sk0pTF4', 'timestamp': 1761903900.528548}, {'content': {'parts': [{'text': '{"action":"raise","amount":125,"reasoning":"期待値が見積もれる（125.00（ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 125"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2070, 'totalTokenCount': 2126}, 'invocationId': 'e-b9291d5a-b242-4ae1-bc2a-50434cb61b7c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QgJM1Wjc', 'timestamp': 1761903900.532708}]
2025-10-31 18:45:01,970 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:45:01,970 - poker_game - DEBUG - {"action":"raise","amount":125,"reasoning":"期待値が見積もれる（125.00（ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 125"}
2025-10-31 18:45:01,971 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:45:01,971 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":125,"reasoning":"期待値が見積もれる（125.00（ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 125"}'
2025-10-31 18:45:01,971 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:45:01,972 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":125,"reasoning":"期待値が見積もれる（125.00（ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 125"}
2025-10-31 18:45:01,972 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 125, 'reasoning': '期待値が見積もれる（125.00（ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 125'}
2025-10-31 18:45:01,972 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 125
2025-10-31 18:45:01,972 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1920)']
2025-10-31 18:45:01,972 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:45:01,972 - poker_game - DEBUG - [Agent4] Raise amount 125 is valid (min: 20)
2025-10-31 18:45:01,973 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 125}
2025-10-31 18:45:01,973 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 125, 期待値が見積もれる（125.00（ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 125
2025-10-31 18:45:01,974 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 125
2025-10-31 18:45:01,974 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:01,974 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:01,975 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:01,975 - poker_game - INFO - Pot: 250, Current bet: 0
2025-10-31 18:45:01,976 - poker_game - INFO - Last raiser: None
2025-10-31 18:45:01,976 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:01,976 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:01,976 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:01,977 - poker_game - INFO -   P0(Agent0): chips=1920, bet=0, status=active
2025-10-31 18:45:01,977 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:01,978 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:45:01,978 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:01,978 - poker_game - INFO -   P4(Agent4): chips=1920, bet=0, status=active
2025-10-31 18:45:01,979 - poker_game - INFO - ==================================================
2025-10-31 18:45:01,979 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 125
2025-10-31 18:45:01,995 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:01,996 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:01,996 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:01,996 - poker_game - INFO - Pot: 375, Current bet: 125
2025-10-31 18:45:01,997 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:01,997 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:01,997 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:01,998 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:01,998 - poker_game - INFO -   P0(Agent0): chips=1920, bet=0, status=active
2025-10-31 18:45:01,998 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:01,999 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:45:01,999 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:02,000 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:02,001 - poker_game - INFO - Extra: Action: Player 4 raised to 125
2025-10-31 18:45:02,001 - poker_game - INFO - ==================================================
2025-10-31 18:45:02,001 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:02,002 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:02,002 - poker_game - DEBUG - Active players: [0, 2, 4]
2025-10-31 18:45:02,002 - poker_game - INFO - Advanced from player 4 to player 0 (seat order)
2025-10-31 18:45:02,003 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:02,003 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:02,003 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:45:02,003 - poker_game - DEBUG - Player bets: [0, 0, 125], Current bet: 125, All same: False
2025-10-31 18:45:02,003 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:45:02,004 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:02,004 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:02,004 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:45:02,005 - poker_game - INFO - Pot: 375, Current bet: 125
2025-10-31 18:45:02,005 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:02,005 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:02,006 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:02,007 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:02,007 - poker_game - INFO -   P0(Agent0): chips=1920, bet=0, status=active
2025-10-31 18:45:02,008 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:02,009 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:45:02,011 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:02,012 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:02,013 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:02,013 - poker_game - INFO - ==================================================
2025-10-31 18:45:02,115 - poker_game - DEBUG - LLM Prompt for Agent0: {
  "your_id": 0,
  "phase": "flop",
  "your_cards": [
    "J♥",
    "K♥"
  ],
  "community": [
    "3♣",
    "10♠",
    "4♣"
  ],
  "your_chips": 1920,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 375,
  "to_call": 125,
  "dealer_button": 2,
  "current_turn": 0,
  "players": [
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 2,
      "chips": 1920,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 1795,
      "bet": 125,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (125)",
    "raise (min 145)",
    "all-in (1920)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125"
  ]
}
2025-10-31 18:45:02,124 - poker_game - DEBUG - Create Session: {'id': 'f89c711f-d5f3-43de-8303-07dbd864abda', 'appName': 'beginner_agent', 'userId': 'player_0', 'state': {}, 'events': [], 'lastUpdateTime': 1761903902.1223683}
2025-10-31 18:45:04,385 - poker_game - INFO - LLM raw Response for Agent0: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 350,\n  "reasoning": "フロップで強いハンド（Jハイストレートドローとフラッシュドロー）を持っており、相手はアグレッシブなベットをしている。ポットを大きくするためにレイズする。レイズ額は、相手のベット額（125）に、ポット（375）の約2倍の額（750）を足した額にする。相手のベット額（125）をコールし、さらに125（相手のベット額）+100（ベット差）=225をレイズする。合計で250+125=375のベットにする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 221, 'promptTokenCount': 761, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 761}], 'totalTokenCount': 982}, 'invocationId': 'e-804fbc70-c4df-4dce-8f15-d6db24d4f015', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'zfwHLT4g', 'timestamp': 1761903902.135819}]
2025-10-31 18:45:04,386 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent0:
2025-10-31 18:45:04,387 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 350,
  "reasoning": "フロップで強いハンド（Jハイストレートドローとフラッシュドロー）を持っており、相手はアグレッシブなベットをしている。ポットを大きくするためにレイズする。レイズ額は、相手のベット額（125）に、ポット（375）の約2倍の額（750）を足した額にする。相手のベット額（125）をコールし、さらに125（相手のベット額）+100（ベット差）=225をレイズする。合計で250+125=375のベットにする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。"
}
```
2025-10-31 18:45:04,387 - poker_game - DEBUG - [Agent0] Starting LLM API response parsing
2025-10-31 18:45:04,387 - poker_game - DEBUG - [Agent0] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 350,\n  "reasoning": "フロップで強いハンド（Jハイストレートドローとフラッシュドロー）を持っており、相手はアグレッシブなベットをしている。ポットを大きくするためにレイズする。レイズ額は、相手のベット額（125）に、ポット（375）の約2倍の額（750）を足した額にする。相手のベット額（125）をコールし、さらに125（相手のベット額）+100（ベット差）=225をレイズする。合計で250+125=375のベットにする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。"\n}\n```'
2025-10-31 18:45:04,387 - poker_game - DEBUG - [Agent0] Markdown code block detected
2025-10-31 18:45:04,388 - poker_game - DEBUG - [Agent0] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 350,\n  "reasoning": "フロップで強いハンド（Jハイストレートドローとフラッシュドロー）を持っており、相手はアグレッシブなベットをしている。ポットを大きくするためにレイズする。レイズ額は、相手のベット額（125）に、ポット（375）の約2倍の額（750）を足した額にする。相手のベット額（125）をコールし、さらに125（相手のベット額）+100（ベット差）=225をレイズする。合計で250+125=375のベットにする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。"\n}'
2025-10-31 18:45:04,388 - poker_game - DEBUG - [Agent0] JSON pattern found: {
  "action": "raise",
  "amount": 350,
  "reasoning": "フロップで強いハンド（Jハイストレートドローとフラッシュドロー）を持っており、相手はアグレッシブなベットをしている。ポットを大きくするためにレイズする。レイズ額は、相手のベット額（125）に、ポット（375）の約2倍の額（750）を足した額にする。相手のベット額（125）をコールし、さらに125（相手のベット額）+100（ベット差）=225をレイズする。合計で250+125=375のベットにする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。"
}
2025-10-31 18:45:04,388 - poker_game - DEBUG - [Agent0] JSON parsing successful: {'action': 'raise', 'amount': 350, 'reasoning': 'フロップで強いハンド（Jハイストレートドローとフラッシュドロー）を持っており、相手はアグレッシブなベットをしている。ポットを大きくするためにレイズする。レイズ額は、相手のベット額（125）に、ポット（375）の約2倍の額（750）を足した額にする。相手のベット額（125）をコールし、さらに125（相手のベット額）+100（ベット差）=225をレイズする。合計で250+125=375のベットにする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。'}
2025-10-31 18:45:04,389 - poker_game - DEBUG - [Agent0] Extracted values - action: 'raise', amount: 350
2025-10-31 18:45:04,389 - poker_game - DEBUG - [Agent0] Processing raise action - available actions: ['fold', 'call (125)', 'raise (min 145)', 'all-in (1920)']
2025-10-31 18:45:04,389 - poker_game - DEBUG - [Agent0] Minimum raise amount extracted from 'raise (min 145)': 145
2025-10-31 18:45:04,389 - poker_game - DEBUG - [Agent0] Raise amount 350 is valid (min: 145)
2025-10-31 18:45:04,390 - poker_game - DEBUG - [Agent0] Final parsed decision: {'action': 'raise', 'amount': 350}
2025-10-31 18:45:04,390 - poker_game - INFO - [Agent0] Successfully parsed decision: raise, 350, フロップで強いハンド（Jハイストレートドローとフラッシュドロー）を持っており、相手はアグレッシブなベットをしている。ポットを大きくするためにレイズする。レイズ額は、相手のベット額（125）に、ポット（375）の約2倍の額（750）を足した額にする。相手のベット額（125）をコールし、さらに125（相手のベット額）+100（ベット差）=225をレイズする。合計で250+125=375のベットにする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。相手のベット額125をコールし、さらに225をレイズして、合計350にする。
2025-10-31 18:45:04,391 - poker_game - INFO - >>> PROCESS_ACTION: Player 0 attempts 'raise' with amount 350
2025-10-31 18:45:04,392 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:04,392 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:04,393 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:45:04,394 - poker_game - INFO - Pot: 375, Current bet: 125
2025-10-31 18:45:04,395 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:04,395 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:04,396 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:04,397 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:04,398 - poker_game - INFO -   P0(Agent0): chips=1920, bet=0, status=active
2025-10-31 18:45:04,398 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:04,399 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:45:04,399 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:04,400 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:04,401 - poker_game - INFO - ==================================================
2025-10-31 18:45:04,401 - poker_game - INFO - ACTION_EXECUTED: Player 0 raised to 475
2025-10-31 18:45:04,412 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:04,413 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:04,413 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:45:04,414 - poker_game - INFO - Pot: 850, Current bet: 475
2025-10-31 18:45:04,414 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:04,415 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:04,415 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:04,415 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:04,416 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:04,416 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:04,417 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:45:04,417 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:04,418 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:04,418 - poker_game - INFO - Extra: Action: Player 0 raised to 475
2025-10-31 18:45:04,418 - poker_game - INFO - ==================================================
2025-10-31 18:45:04,419 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:04,419 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:04,420 - poker_game - DEBUG - Active players: [0, 2, 4]
2025-10-31 18:45:04,420 - poker_game - INFO - Advanced from player 0 to player 2 (seat order)
2025-10-31 18:45:04,420 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:04,421 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:04,421 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:45:04,421 - poker_game - DEBUG - Player bets: [475, 0, 125], Current bet: 475, All same: False
2025-10-31 18:45:04,421 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:45:04,422 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:04,422 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:04,423 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:04,423 - poker_game - INFO - Pot: 850, Current bet: 475
2025-10-31 18:45:04,425 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:04,425 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:04,426 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:04,428 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:04,429 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:04,430 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:04,430 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:45:04,431 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:04,432 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:04,432 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:04,433 - poker_game - INFO - ==================================================
2025-10-31 18:45:04,534 - poker_game - DEBUG - LLM Prompt for Agent2: {
  "your_id": 2,
  "phase": "flop",
  "your_cards": [
    "5♥",
    "8♦"
  ],
  "community": [
    "3♣",
    "10♠",
    "4♣"
  ],
  "your_chips": 1920,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 850,
  "to_call": 475,
  "dealer_button": 2,
  "current_turn": 2,
  "players": [
    {
      "id": 0,
      "chips": 1445,
      "bet": 475,
      "status": "active"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 1795,
      "bet": 125,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (475)",
    "raise (min 495)",
    "all-in (1920)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125",
    "Player 0 raised to 475"
  ]
}
2025-10-31 18:45:04,548 - poker_game - DEBUG - Create Session: {'id': '4ca29442-a512-4e77-98a9-b530e1609fd1', 'appName': 'beginner_agent', 'userId': 'player_2', 'state': {}, 'events': [], 'lastUpdateTime': 1761903904.5448565}
2025-10-31 18:45:06,483 - poker_game - INFO - LLM raw Response for Agent2: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 475,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）は 3♣ 10♠ 4♣ です。私の手札は 5♥ 8♦ なので、現時点では強い役はできていません。しかし、ポットには850あり、コールに必要なのは475です。これは、ポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いことを意味します。つまり、このコールによって将来的にポットを獲得できる可能性が十分にあるということです。相手のレイズ額（475）は、彼らが強い手札を持っている可能性を示唆しますが、私の手札はドロー（役ができる途中）の可能性も秘めているため、コールして次のカード（ターン）を見る価値があると判断しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 188, 'promptTokenCount': 776, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 776}], 'totalTokenCount': 964}, 'invocationId': 'e-e0ab6ab4-b009-407a-8a05-aedad0d2800c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '2o7ROtJf', 'timestamp': 1761903904.560453}]
2025-10-31 18:45:06,484 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent2:
2025-10-31 18:45:06,484 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 475,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）は 3♣ 10♠ 4♣ です。私の手札は 5♥ 8♦ なので、現時点では強い役はできていません。しかし、ポットには850あり、コールに必要なのは475です。これは、ポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いことを意味します。つまり、このコールによって将来的にポットを獲得できる可能性が十分にあるということです。相手のレイズ額（475）は、彼らが強い手札を持っている可能性を示唆しますが、私の手札はドロー（役ができる途中）の可能性も秘めているため、コールして次のカード（ターン）を見る価値があると判断しました。"
}
```
2025-10-31 18:45:06,484 - poker_game - DEBUG - [Agent2] Starting LLM API response parsing
2025-10-31 18:45:06,485 - poker_game - DEBUG - [Agent2] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 475,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）は 3♣ 10♠ 4♣ です。私の手札は 5♥ 8♦ なので、現時点では強い役はできていません。しかし、ポットには850あり、コールに必要なのは475です。これは、ポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いことを意味します。つまり、このコールによって将来的にポットを獲得できる可能性が十分にあるということです。相手のレイズ額（475）は、彼らが強い手札を持っている可能性を示唆しますが、私の手札はドロー（役ができる途中）の可能性も秘めているため、コールして次のカード（ターン）を見る価値があると判断しました。"\n}\n```'
2025-10-31 18:45:06,485 - poker_game - DEBUG - [Agent2] Markdown code block detected
2025-10-31 18:45:06,485 - poker_game - DEBUG - [Agent2] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 475,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）は 3♣ 10♠ 4♣ です。私の手札は 5♥ 8♦ なので、現時点では強い役はできていません。しかし、ポットには850あり、コールに必要なのは475です。これは、ポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いことを意味します。つまり、このコールによって将来的にポットを獲得できる可能性が十分にあるということです。相手のレイズ額（475）は、彼らが強い手札を持っている可能性を示唆しますが、私の手札はドロー（役ができる途中）の可能性も秘めているため、コールして次のカード（ターン）を見る価値があると判断しました。"\n}'
2025-10-31 18:45:06,485 - poker_game - DEBUG - [Agent2] JSON pattern found: {
  "action": "call",
  "amount": 475,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）は 3♣ 10♠ 4♣ です。私の手札は 5♥ 8♦ なので、現時点では強い役はできていません。しかし、ポットには850あり、コールに必要なのは475です。これは、ポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いことを意味します。つまり、このコールによって将来的にポットを獲得できる可能性が十分にあるということです。相手のレイズ額（475）は、彼らが強い手札を持っている可能性を示唆しますが、私の手札はドロー（役ができる途中）の可能性も秘めているため、コールして次のカード（ターン）を見る価値があると判断しました。"
}
2025-10-31 18:45:06,486 - poker_game - DEBUG - [Agent2] JSON parsing successful: {'action': 'call', 'amount': 475, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）は 3♣ 10♠ 4♣ です。私の手札は 5♥ 8♦ なので、現時点では強い役はできていません。しかし、ポットには850あり、コールに必要なのは475です。これは、ポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いことを意味します。つまり、このコールによって将来的にポットを獲得できる可能性が十分にあるということです。相手のレイズ額（475）は、彼らが強い手札を持っている可能性を示唆しますが、私の手札はドロー（役ができる途中）の可能性も秘めているため、コールして次のカード（ターン）を見る価値があると判断しました。'}
2025-10-31 18:45:06,486 - poker_game - DEBUG - [Agent2] Extracted values - action: 'call', amount: 475
2025-10-31 18:45:06,486 - poker_game - DEBUG - [Agent2] Processing call action - available actions: ['fold', 'call (475)', 'raise (min 495)', 'all-in (1920)']
2025-10-31 18:45:06,486 - poker_game - DEBUG - [Agent2] Call amount extracted from 'call (475)': 475
2025-10-31 18:45:06,487 - poker_game - DEBUG - [Agent2] Final parsed decision: {'action': 'call', 'amount': 475}
2025-10-31 18:45:06,487 - poker_game - INFO - [Agent2] Successfully parsed decision: call, 475, フロップ（最初の3枚のコミュニティカード）は 3♣ 10♠ 4♣ です。私の手札は 5♥ 8♦ なので、現時点では強い役はできていません。しかし、ポットには850あり、コールに必要なのは475です。これは、ポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いことを意味します。つまり、このコールによって将来的にポットを獲得できる可能性が十分にあるということです。相手のレイズ額（475）は、彼らが強い手札を持っている可能性を示唆しますが、私の手札はドロー（役ができる途中）の可能性も秘めているため、コールして次のカード（ターン）を見る価値があると判断しました。
2025-10-31 18:45:06,488 - poker_game - INFO - >>> PROCESS_ACTION: Player 2 attempts 'call' with amount 475
2025-10-31 18:45:06,489 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:06,489 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:06,489 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:06,490 - poker_game - INFO - Pot: 850, Current bet: 475
2025-10-31 18:45:06,490 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:06,491 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:06,492 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:06,492 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:06,493 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:06,494 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:06,494 - poker_game - INFO -   P2(Agent2): chips=1920, bet=0, status=active
2025-10-31 18:45:06,495 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:06,495 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:06,496 - poker_game - INFO - ==================================================
2025-10-31 18:45:06,496 - poker_game - INFO - ACTION_EXECUTED: Player 2 called 475
2025-10-31 18:45:06,510 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:06,510 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:06,511 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:06,512 - poker_game - INFO - Pot: 1325, Current bet: 475
2025-10-31 18:45:06,512 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:06,513 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:06,513 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:06,514 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:06,514 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:06,515 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:06,515 - poker_game - INFO -   P2(Agent2): chips=1445, bet=475, status=active
2025-10-31 18:45:06,516 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:06,516 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:06,516 - poker_game - INFO - Extra: Action: Player 2 called 475
2025-10-31 18:45:06,517 - poker_game - INFO - ==================================================
2025-10-31 18:45:06,518 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:06,518 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:06,518 - poker_game - DEBUG - Active players: [0, 2, 4]
2025-10-31 18:45:06,519 - poker_game - INFO - Advanced from player 2 to player 4 (seat order)
2025-10-31 18:45:06,519 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:06,519 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:06,520 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:45:06,520 - poker_game - DEBUG - Player bets: [475, 475, 125], Current bet: 475, All same: False
2025-10-31 18:45:06,520 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:45:06,520 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:06,521 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:06,522 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:06,522 - poker_game - INFO - Pot: 1325, Current bet: 475
2025-10-31 18:45:06,523 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:06,524 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:06,524 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:06,525 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:06,526 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:06,526 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:06,527 - poker_game - INFO -   P2(Agent2): chips=1445, bet=475, status=active
2025-10-31 18:45:06,527 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:06,528 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:06,529 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:06,529 - poker_game - INFO - ==================================================
2025-10-31 18:45:06,630 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "3♠",
    "8♥"
  ],
  "community": [
    "3♣",
    "10♠",
    "4♣"
  ],
  "your_chips": 1795,
  "your_bet_this_round": 125,
  "your_total_bet_this_hand": 205,
  "pot": 1325,
  "to_call": 350,
  "dealer_button": 2,
  "current_turn": 4,
  "players": [
    {
      "id": 0,
      "chips": 1445,
      "bet": 475,
      "status": "active"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 2,
      "chips": 1445,
      "bet": 475,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (350)",
    "raise (min 495)",
    "all-in (1795)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125",
    "Player 0 raised to 475",
    "Player 2 called 475"
  ]
}
2025-10-31 18:45:06,643 - poker_game - DEBUG - Create Session: {'id': '88246e39-86b6-4dda-ba45-8901ef4f5365', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903906.6407175}
2025-10-31 18:45:16,690 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:45:18,221 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_Wgip6IIHcYIod8aOzuV7Ls05', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1095, 'totalTokenCount': 1112}, 'invocationId': 'e-13329a39-aafd-4cc5-98d0-e442b79e2823', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'PwDT9xGK', 'timestamp': 1761903906.655674}, {'content': {'parts': [{'functionResponse': {'id': 'call_Wgip6IIHcYIod8aOzuV7Ls05', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-13329a39-aafd-4cc5-98d0-e442b79e2823', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'IZ0YYkh3', 'timestamp': 1761903907.572631}, {'content': {'parts': [{'functionCall': {'id': 'call_zRvMESrQq9fegfOIZcKzUUtu', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1619, 'totalTokenCount': 1636}, 'invocationId': 'e-13329a39-aafd-4cc5-98d0-e442b79e2823', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ZTpFlL1V', 'timestamp': 1761903907.579272}, {'content': {'parts': [{'functionResponse': {'id': 'call_zRvMESrQq9fegfOIZcKzUUtu', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-13329a39-aafd-4cc5-98d0-e442b79e2823', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'hhMn69lI', 'timestamp': 1761903908.467368}, {'content': {'parts': [{'functionCall': {'id': 'call_WZV3HBIfzJc5LdMwRVgbKt97', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['3♠', '8♥'], 'community': ['3♣', '10♠', '4♣'], 'your_chips': 1795, 'your_bet_this_round': 125, 'your_total_bet_this_hand': 205, 'pot': 1325, 'to_call': 350, 'dealer_button': 2, 'current_turn': 4, 'players': [{'id': 0, 'chips': 1445, 'bet': 475, 'status': 'active'}, {'id': 1, 'chips': 2000, 'bet': 0, 'status': 'folded'}, {'id': 2, 'chips': 1445, 'bet': 475, 'status': 'active'}, {'id': 3, 'chips': 1990, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (350)', 'raise (min 495)', 'all-in (1795)'], 'history': ['Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 0 raised to 80', 'Player 1 folded', 'Player 2 called 80', 'Player 3 folded', 'Player 4 called 60', 'Flop dealt: 3♣, 10♠, 4♣', 'Player 4 raised to 125', 'Player 0 raised to 475', 'Player 2 called 475']}, 'call_amount': 350, 'pot_after_call': 1675, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 306, 'promptTokenCount': 1650, 'totalTokenCount': 1956}, 'invocationId': 'e-13329a39-aafd-4cc5-98d0-e442b79e2823', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Zue8ux5X', 'timestamp': 1761903908.472885}, {'content': {'parts': [{'functionResponse': {'id': 'call_WZV3HBIfzJc5LdMwRVgbKt97', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 350, 'reasoning': 'ポットオッズを満たしており（460.00(ポットに対して34.72%）、コールが妥当と判断。コール額: 350'}}}], 'role': 'user'}, 'invocationId': 'e-13329a39-aafd-4cc5-98d0-e442b79e2823', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'WdwBEasS', 'timestamp': 1761903916.197084}, {'content': {'parts': [{'text': '{"action":"call","amount":350,"reasoning":"ポットオッズを満たしており（460.00(ポットに対して34.72%）、コールが妥当と判断。コール額: 350"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2023, 'totalTokenCount': 2077}, 'invocationId': 'e-13329a39-aafd-4cc5-98d0-e442b79e2823', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'uhTL0FFF', 'timestamp': 1761903916.199584}]
2025-10-31 18:45:18,221 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:45:18,222 - poker_game - DEBUG - {"action":"call","amount":350,"reasoning":"ポットオッズを満たしており（460.00(ポットに対して34.72%）、コールが妥当と判断。コール額: 350"}
2025-10-31 18:45:18,222 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:45:18,222 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":350,"reasoning":"ポットオッズを満たしており（460.00(ポットに対して34.72%）、コールが妥当と判断。コール額: 350"}'
2025-10-31 18:45:18,222 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:45:18,223 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":350,"reasoning":"ポットオッズを満たしており（460.00(ポットに対して34.72%）、コールが妥当と判断。コール額: 350"}
2025-10-31 18:45:18,223 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 350, 'reasoning': 'ポットオッズを満たしており（460.00(ポットに対して34.72%）、コールが妥当と判断。コール額: 350'}
2025-10-31 18:45:18,223 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 350
2025-10-31 18:45:18,223 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (350)', 'raise (min 495)', 'all-in (1795)']
2025-10-31 18:45:18,223 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (350)': 350
2025-10-31 18:45:18,223 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 350}
2025-10-31 18:45:18,223 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 350, ポットオッズを満たしており（460.00(ポットに対して34.72%）、コールが妥当と判断。コール額: 350
2025-10-31 18:45:18,224 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 350
2025-10-31 18:45:18,224 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:18,224 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:18,225 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:18,225 - poker_game - INFO - Pot: 1325, Current bet: 475
2025-10-31 18:45:18,225 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:18,225 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:18,225 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:18,226 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:18,226 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:18,226 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:18,226 - poker_game - INFO -   P2(Agent2): chips=1445, bet=475, status=active
2025-10-31 18:45:18,227 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:18,227 - poker_game - INFO -   P4(Agent4): chips=1795, bet=125, status=active
2025-10-31 18:45:18,227 - poker_game - INFO - ==================================================
2025-10-31 18:45:18,227 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 350
2025-10-31 18:45:18,237 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:18,238 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:18,238 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:18,238 - poker_game - INFO - Pot: 1675, Current bet: 475
2025-10-31 18:45:18,238 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:18,238 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:18,239 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:18,239 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:18,239 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:18,239 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:18,240 - poker_game - INFO -   P2(Agent2): chips=1445, bet=475, status=active
2025-10-31 18:45:18,240 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:18,241 - poker_game - INFO -   P4(Agent4): chips=1445, bet=475, status=active
2025-10-31 18:45:18,241 - poker_game - INFO - Extra: Action: Player 4 called 350
2025-10-31 18:45:18,242 - poker_game - INFO - ==================================================
2025-10-31 18:45:18,242 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:18,242 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:18,243 - poker_game - DEBUG - Active players: [0, 2, 4]
2025-10-31 18:45:18,243 - poker_game - INFO - Advanced from player 4 to player 0 (seat order)
2025-10-31 18:45:18,243 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:18,243 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:18,243 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:45:18,243 - poker_game - DEBUG - Player bets: [475, 475, 475], Current bet: 475, All same: True
2025-10-31 18:45:18,244 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:45:18,244 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:18,244 - poker_game - INFO - Hand #1, Phase: flop
2025-10-31 18:45:18,244 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:45:18,244 - poker_game - INFO - Pot: 1675, Current bet: 475
2025-10-31 18:45:18,245 - poker_game - INFO - Last raiser: 0
2025-10-31 18:45:18,245 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:18,245 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:18,246 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣']
2025-10-31 18:45:18,246 - poker_game - INFO -   P0(Agent0): chips=1445, bet=475, status=active
2025-10-31 18:45:18,246 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:18,246 - poker_game - INFO -   P2(Agent2): chips=1445, bet=475, status=active
2025-10-31 18:45:18,247 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:18,247 - poker_game - INFO -   P4(Agent4): chips=1445, bet=475, status=active
2025-10-31 18:45:18,247 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:45:18,247 - poker_game - INFO - ==================================================
2025-10-31 18:45:18,349 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:45:18,349 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:18,350 - poker_game - INFO - Remaining players: 3
2025-10-31 18:45:18,351 - poker_game - DEBUG -   Remaining P0: Agent0, status: active
2025-10-31 18:45:18,351 - poker_game - DEBUG -   Remaining P2: Agent2, status: active
2025-10-31 18:45:18,351 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:45:18,352 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:45:18,362 - poker_game - INFO - Starting new betting round
2025-10-31 18:45:18,363 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:45:18,363 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:45:18,365 - poker_game - DEBUG - Active players for new betting round: [0, 2, 4]
2025-10-31 18:45:18,365 - poker_game - DEBUG - Dealer button: 2
2025-10-31 18:45:18,366 - poker_game - INFO - First actor: Player 4 (by phase rule), was 0
2025-10-31 18:45:18,366 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:45:18,367 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:18,368 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:18,368 - poker_game - INFO - Pot: 1675, Current bet: 0
2025-10-31 18:45:18,369 - poker_game - INFO - Last raiser: None
2025-10-31 18:45:18,369 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:18,370 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:18,370 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:18,371 - poker_game - INFO -   P0(Agent0): chips=1445, bet=0, status=active
2025-10-31 18:45:18,371 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:18,371 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:18,372 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:18,372 - poker_game - INFO -   P4(Agent4): chips=1445, bet=0, status=active
2025-10-31 18:45:18,372 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:45:18,373 - poker_game - INFO - ==================================================
2025-10-31 18:45:18,374 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "3♠",
    "8♥"
  ],
  "community": [
    "3♣",
    "10♠",
    "4♣",
    "3♥"
  ],
  "your_chips": 1445,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 555,
  "pot": 1675,
  "to_call": 0,
  "dealer_button": 2,
  "current_turn": 4,
  "players": [
    {
      "id": 0,
      "chips": 1445,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 2,
      "chips": 1445,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1445)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125",
    "Player 0 raised to 475",
    "Player 2 called 475",
    "Player 4 called 350",
    "Turn dealt: 3♥"
  ]
}
2025-10-31 18:45:18,386 - poker_game - DEBUG - Create Session: {'id': '5de0774d-ae08-4c5f-a71d-19513534f95d', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903918.3805685}
2025-10-31 18:45:20,224 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_1ATkP65ZOSVOmnpxiWk3bxN8', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1115, 'totalTokenCount': 1132}, 'invocationId': 'e-2ae5e1c0-3035-4d0a-9e7f-c79718be10f3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'JCLQfay1', 'timestamp': 1761903918.401581}, {'content': {'parts': [{'functionResponse': {'id': 'call_1ATkP65ZOSVOmnpxiWk3bxN8', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-2ae5e1c0-3035-4d0a-9e7f-c79718be10f3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'nqAKoeun', 'timestamp': 1761903916.905025}, {'content': {'parts': [{'functionCall': {'id': 'call_85l3Fuw53qx3kTliJ0EBjuOG', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1639, 'totalTokenCount': 1659}, 'invocationId': 'e-2ae5e1c0-3035-4d0a-9e7f-c79718be10f3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'SzODUSS8', 'timestamp': 1761903916.906894}, {'content': {'parts': [{'functionResponse': {'id': 'call_85l3Fuw53qx3kTliJ0EBjuOG', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-2ae5e1c0-3035-4d0a-9e7f-c79718be10f3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'vD6bBAxj', 'timestamp': 1761903918.043247}, {'content': {'parts': [{'text': '{\n  "action": "raise",\n  "amount": 1445,\n  "reasoning": "私は現在3枚のスリーオブアカインドを持っており、強力なハンドです。全てのチップを賭けて、ポットを獲得する可能性を最大化します。"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 76, 'promptTokenCount': 1201, 'totalTokenCount': 1277}, 'invocationId': 'e-2ae5e1c0-3035-4d0a-9e7f-c79718be10f3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Yp22Jw3K', 'timestamp': 1761903918.044626}]
2025-10-31 18:45:20,225 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:45:20,226 - poker_game - DEBUG - {
  "action": "raise",
  "amount": 1445,
  "reasoning": "私は現在3枚のスリーオブアカインドを持っており、強力なハンドです。全てのチップを賭けて、ポットを獲得する可能性を最大化します。"
}
2025-10-31 18:45:20,226 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:45:20,227 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "raise",\n  "amount": 1445,\n  "reasoning": "私は現在3枚のスリーオブアカインドを持っており、強力なハンドです。全てのチップを賭けて、ポットを獲得する可能性を最大化します。"\n}'
2025-10-31 18:45:20,227 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:45:20,227 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "raise",
  "amount": 1445,
  "reasoning": "私は現在3枚のスリーオブアカインドを持っており、強力なハンドです。全てのチップを賭けて、ポットを獲得する可能性を最大化します。"
}
2025-10-31 18:45:20,227 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 1445, 'reasoning': '私は現在3枚のスリーオブアカインドを持っており、強力なハンドです。全てのチップを賭けて、ポットを獲得する可能性を最大化します。'}
2025-10-31 18:45:20,227 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 1445
2025-10-31 18:45:20,227 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1445)']
2025-10-31 18:45:20,228 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:45:20,228 - poker_game - DEBUG - [Agent4] Raise amount 1445 is valid (min: 20)
2025-10-31 18:45:20,228 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 1445}
2025-10-31 18:45:20,228 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 1445, 私は現在3枚のスリーオブアカインドを持っており、強力なハンドです。全てのチップを賭けて、ポットを獲得する可能性を最大化します。
2025-10-31 18:45:20,229 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 1445
2025-10-31 18:45:20,230 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:20,230 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:20,230 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:20,231 - poker_game - INFO - Pot: 1675, Current bet: 0
2025-10-31 18:45:20,232 - poker_game - INFO - Last raiser: None
2025-10-31 18:45:20,232 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:20,233 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 2
2025-10-31 18:45:20,234 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:20,235 - poker_game - INFO -   P0(Agent0): chips=1445, bet=0, status=active
2025-10-31 18:45:20,236 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:20,237 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:20,238 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:20,238 - poker_game - INFO -   P4(Agent4): chips=1445, bet=0, status=active
2025-10-31 18:45:20,238 - poker_game - INFO - ==================================================
2025-10-31 18:45:20,239 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 1445
2025-10-31 18:45:20,252 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:20,253 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:20,253 - poker_game - INFO - Current player: 4, Dealer: 2
2025-10-31 18:45:20,254 - poker_game - INFO - Pot: 3120, Current bet: 1445
2025-10-31 18:45:20,254 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:20,255 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:20,255 - poker_game - INFO - Active players: 2, All-in: 1, Folded: 2
2025-10-31 18:45:20,255 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:20,256 - poker_game - INFO -   P0(Agent0): chips=1445, bet=0, status=active
2025-10-31 18:45:20,256 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:20,256 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:20,257 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:20,257 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:20,257 - poker_game - INFO - Extra: Action: Player 4 raised to 1445
2025-10-31 18:45:20,258 - poker_game - INFO - ==================================================
2025-10-31 18:45:20,258 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:20,259 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:20,259 - poker_game - DEBUG - Active players: [0, 2]
2025-10-31 18:45:20,259 - poker_game - INFO - Advanced from player 4 to player 0 (seat order)
2025-10-31 18:45:20,259 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:20,259 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:20,260 - poker_game - DEBUG - Active: 2, All-in: 1
2025-10-31 18:45:20,260 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 1445, All same: False
2025-10-31 18:45:20,260 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:45:20,260 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:20,261 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:20,261 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:45:20,262 - poker_game - INFO - Pot: 3120, Current bet: 1445
2025-10-31 18:45:20,262 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:20,262 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:20,263 - poker_game - INFO - Active players: 2, All-in: 1, Folded: 2
2025-10-31 18:45:20,263 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:20,263 - poker_game - INFO -   P0(Agent0): chips=1445, bet=0, status=active
2025-10-31 18:45:20,264 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:20,265 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:20,266 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:20,266 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:20,267 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:20,268 - poker_game - INFO - ==================================================
2025-10-31 18:45:20,369 - poker_game - DEBUG - LLM Prompt for Agent0: {
  "your_id": 0,
  "phase": "turn",
  "your_cards": [
    "J♥",
    "K♥"
  ],
  "community": [
    "3♣",
    "10♠",
    "4♣",
    "3♥"
  ],
  "your_chips": 1445,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 555,
  "pot": 3120,
  "to_call": 1445,
  "dealer_button": 2,
  "current_turn": 0,
  "players": [
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 2,
      "chips": 1445,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 0,
      "bet": 1445,
      "status": "all_in"
    }
  ],
  "actions": [
    "fold",
    "call (1445)",
    "all-in (1445)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125",
    "Player 0 raised to 475",
    "Player 2 called 475",
    "Player 4 called 350",
    "Turn dealt: 3♥",
    "Player 4 raised to 1445"
  ]
}
2025-10-31 18:45:20,381 - poker_game - DEBUG - Create Session: {'id': 'a9cbddeb-8614-4ffe-b8f1-1f17920ae63a', 'appName': 'beginner_agent', 'userId': 'player_0', 'state': {}, 'events': [], 'lastUpdateTime': 1761903920.3786576}
2025-10-31 18:45:22,541 - poker_game - INFO - LLM raw Response for Agent0: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 1445,\n  "reasoning": "あなたの手札（ホールカード）はJ♥K♥で、コミュニティカードは3♣10♠4♣3♥です。これにより、あなたの手札はフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、特にJ♥K♥とコミュニティカードの3♥、そして他のハートのカードがあれば、強力なフラッシュが完成する可能性があります。現在の状況では、プレイヤー4がオールインしており、コールするには1445チップが必要です。コミュニティカードに3が2枚あるため、ツーペア（同じ数字のカードが2組揃うこと）の可能性も考慮する必要があります。しかし、あなたのJ♥K♥は、相手がより強いツーペアやフルハウス（同じ数字のカードが3枚と2枚揃うこと）を持っていない限り、フラッシュが完成すれば勝てる可能性があります。ポットサイズ（ポット）が3120チップであり、コールに必要な1445チップは、将来の利益を考えると十分投資する価値があります。よって、コールを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 254, 'promptTokenCount': 821, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 821}], 'totalTokenCount': 1075}, 'invocationId': 'e-bbd7a897-2753-487c-8702-6bcbfa992980', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'knujqY9l', 'timestamp': 1761903920.395595}]
2025-10-31 18:45:22,542 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent0:
2025-10-31 18:45:22,542 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 1445,
  "reasoning": "あなたの手札（ホールカード）はJ♥K♥で、コミュニティカードは3♣10♠4♣3♥です。これにより、あなたの手札はフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、特にJ♥K♥とコミュニティカードの3♥、そして他のハートのカードがあれば、強力なフラッシュが完成する可能性があります。現在の状況では、プレイヤー4がオールインしており、コールするには1445チップが必要です。コミュニティカードに3が2枚あるため、ツーペア（同じ数字のカードが2組揃うこと）の可能性も考慮する必要があります。しかし、あなたのJ♥K♥は、相手がより強いツーペアやフルハウス（同じ数字のカードが3枚と2枚揃うこと）を持っていない限り、フラッシュが完成すれば勝てる可能性があります。ポットサイズ（ポット）が3120チップであり、コールに必要な1445チップは、将来の利益を考えると十分投資する価値があります。よって、コールを選択します。"
}
```
2025-10-31 18:45:22,542 - poker_game - DEBUG - [Agent0] Starting LLM API response parsing
2025-10-31 18:45:22,542 - poker_game - DEBUG - [Agent0] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 1445,\n  "reasoning": "あなたの手札（ホールカード）はJ♥K♥で、コミュニティカードは3♣10♠4♣3♥です。これにより、あなたの手札はフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、特にJ♥K♥とコミュニティカードの3♥、そして他のハートのカードがあれば、強力なフラッシュが完成する可能性があります。現在の状況では、プレイヤー4がオールインしており、コールするには1445チップが必要です。コミュニティカードに3が2枚あるため、ツーペア（同じ数字のカードが2組揃うこと）の可能性も考慮する必要があります。しかし、あなたのJ♥K♥は、相手がより強いツーペアやフルハウス（同じ数字のカードが3枚と2枚揃うこと）を持っていない限り、フラッシュが完成すれば勝てる可能性があります。ポットサイズ（ポット）が3120チップであり、コールに必要な1445チップは、将来の利益を考えると十分投資する価値があります。よって、コールを選択します。"\n}\n```'
2025-10-31 18:45:22,542 - poker_game - DEBUG - [Agent0] Markdown code block detected
2025-10-31 18:45:22,543 - poker_game - DEBUG - [Agent0] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 1445,\n  "reasoning": "あなたの手札（ホールカード）はJ♥K♥で、コミュニティカードは3♣10♠4♣3♥です。これにより、あなたの手札はフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、特にJ♥K♥とコミュニティカードの3♥、そして他のハートのカードがあれば、強力なフラッシュが完成する可能性があります。現在の状況では、プレイヤー4がオールインしており、コールするには1445チップが必要です。コミュニティカードに3が2枚あるため、ツーペア（同じ数字のカードが2組揃うこと）の可能性も考慮する必要があります。しかし、あなたのJ♥K♥は、相手がより強いツーペアやフルハウス（同じ数字のカードが3枚と2枚揃うこと）を持っていない限り、フラッシュが完成すれば勝てる可能性があります。ポットサイズ（ポット）が3120チップであり、コールに必要な1445チップは、将来の利益を考えると十分投資する価値があります。よって、コールを選択します。"\n}'
2025-10-31 18:45:22,543 - poker_game - DEBUG - [Agent0] JSON pattern found: {
  "action": "call",
  "amount": 1445,
  "reasoning": "あなたの手札（ホールカード）はJ♥K♥で、コミュニティカードは3♣10♠4♣3♥です。これにより、あなたの手札はフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、特にJ♥K♥とコミュニティカードの3♥、そして他のハートのカードがあれば、強力なフラッシュが完成する可能性があります。現在の状況では、プレイヤー4がオールインしており、コールするには1445チップが必要です。コミュニティカードに3が2枚あるため、ツーペア（同じ数字のカードが2組揃うこと）の可能性も考慮する必要があります。しかし、あなたのJ♥K♥は、相手がより強いツーペアやフルハウス（同じ数字のカードが3枚と2枚揃うこと）を持っていない限り、フラッシュが完成すれば勝てる可能性があります。ポットサイズ（ポット）が3120チップであり、コールに必要な1445チップは、将来の利益を考えると十分投資する価値があります。よって、コールを選択します。"
}
2025-10-31 18:45:22,543 - poker_game - DEBUG - [Agent0] JSON parsing successful: {'action': 'call', 'amount': 1445, 'reasoning': 'あなたの手札（ホールカード）はJ♥K♥で、コミュニティカードは3♣10♠4♣3♥です。これにより、あなたの手札はフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、特にJ♥K♥とコミュニティカードの3♥、そして他のハートのカードがあれば、強力なフラッシュが完成する可能性があります。現在の状況では、プレイヤー4がオールインしており、コールするには1445チップが必要です。コミュニティカードに3が2枚あるため、ツーペア（同じ数字のカードが2組揃うこと）の可能性も考慮する必要があります。しかし、あなたのJ♥K♥は、相手がより強いツーペアやフルハウス（同じ数字のカードが3枚と2枚揃うこと）を持っていない限り、フラッシュが完成すれば勝てる可能性があります。ポットサイズ（ポット）が3120チップであり、コールに必要な1445チップは、将来の利益を考えると十分投資する価値があります。よって、コールを選択します。'}
2025-10-31 18:45:22,543 - poker_game - DEBUG - [Agent0] Extracted values - action: 'call', amount: 1445
2025-10-31 18:45:22,543 - poker_game - DEBUG - [Agent0] Processing call action - available actions: ['fold', 'call (1445)', 'all-in (1445)']
2025-10-31 18:45:22,543 - poker_game - DEBUG - [Agent0] Call amount extracted from 'call (1445)': 1445
2025-10-31 18:45:22,543 - poker_game - DEBUG - [Agent0] Final parsed decision: {'action': 'call', 'amount': 1445}
2025-10-31 18:45:22,543 - poker_game - INFO - [Agent0] Successfully parsed decision: call, 1445, あなたの手札（ホールカード）はJ♥K♥で、コミュニティカードは3♣10♠4♣3♥です。これにより、あなたの手札はフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、特にJ♥K♥とコミュニティカードの3♥、そして他のハートのカードがあれば、強力なフラッシュが完成する可能性があります。現在の状況では、プレイヤー4がオールインしており、コールするには1445チップが必要です。コミュニティカードに3が2枚あるため、ツーペア（同じ数字のカードが2組揃うこと）の可能性も考慮する必要があります。しかし、あなたのJ♥K♥は、相手がより強いツーペアやフルハウス（同じ数字のカードが3枚と2枚揃うこと）を持っていない限り、フラッシュが完成すれば勝てる可能性があります。ポットサイズ（ポット）が3120チップであり、コールに必要な1445チップは、将来の利益を考えると十分投資する価値があります。よって、コールを選択します。
2025-10-31 18:45:22,544 - poker_game - INFO - >>> PROCESS_ACTION: Player 0 attempts 'call' with amount 1445
2025-10-31 18:45:22,544 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:22,544 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:22,545 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:45:22,545 - poker_game - INFO - Pot: 3120, Current bet: 1445
2025-10-31 18:45:22,545 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:22,545 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:22,545 - poker_game - INFO - Active players: 2, All-in: 1, Folded: 2
2025-10-31 18:45:22,546 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:22,546 - poker_game - INFO -   P0(Agent0): chips=1445, bet=0, status=active
2025-10-31 18:45:22,546 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:22,546 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:22,546 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:22,547 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:22,547 - poker_game - INFO - ==================================================
2025-10-31 18:45:22,547 - poker_game - INFO - ACTION_EXECUTED: Player 0 called 1445
2025-10-31 18:45:22,556 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:22,557 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:22,557 - poker_game - INFO - Current player: 0, Dealer: 2
2025-10-31 18:45:22,557 - poker_game - INFO - Pot: 4565, Current bet: 1445
2025-10-31 18:45:22,557 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:22,558 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:22,558 - poker_game - INFO - Active players: 1, All-in: 2, Folded: 2
2025-10-31 18:45:22,558 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:22,558 - poker_game - INFO -   P0(Agent0): chips=0, bet=1445, status=all_in
2025-10-31 18:45:22,558 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:22,558 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:22,558 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:22,558 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:22,559 - poker_game - INFO - Extra: Action: Player 0 called 1445
2025-10-31 18:45:22,559 - poker_game - INFO - ==================================================
2025-10-31 18:45:22,559 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:22,559 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:22,559 - poker_game - DEBUG - Active players: [2]
2025-10-31 18:45:22,559 - poker_game - INFO - Advanced from player 0 to player 2 (seat order)
2025-10-31 18:45:22,559 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:22,559 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:22,559 - poker_game - DEBUG - Active: 1, All-in: 2
2025-10-31 18:45:22,560 - poker_game - DEBUG - Single active player Agent2 needs to match bet: 0 < 1445
2025-10-31 18:45:22,560 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:22,560 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:22,560 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:22,560 - poker_game - INFO - Pot: 4565, Current bet: 1445
2025-10-31 18:45:22,560 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:22,561 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:22,561 - poker_game - INFO - Active players: 1, All-in: 2, Folded: 2
2025-10-31 18:45:22,561 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:22,561 - poker_game - INFO -   P0(Agent0): chips=0, bet=1445, status=all_in
2025-10-31 18:45:22,561 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:22,562 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:22,562 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:22,562 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:22,562 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:22,562 - poker_game - INFO - ==================================================
2025-10-31 18:45:22,664 - poker_game - DEBUG - LLM Prompt for Agent2: {
  "your_id": 2,
  "phase": "turn",
  "your_cards": [
    "5♥",
    "8♦"
  ],
  "community": [
    "3♣",
    "10♠",
    "4♣",
    "3♥"
  ],
  "your_chips": 1445,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 555,
  "pot": 4565,
  "to_call": 1445,
  "dealer_button": 2,
  "current_turn": 2,
  "players": [
    {
      "id": 0,
      "chips": 0,
      "bet": 1445,
      "status": "all_in"
    },
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1990,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 0,
      "bet": 1445,
      "status": "all_in"
    }
  ],
  "actions": [
    "fold",
    "call (1445)",
    "all-in (1445)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 0 raised to 80",
    "Player 1 folded",
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125",
    "Player 0 raised to 475",
    "Player 2 called 475",
    "Player 4 called 350",
    "Turn dealt: 3♥",
    "Player 4 raised to 1445",
    "Player 0 called 1445"
  ]
}
2025-10-31 18:45:22,672 - poker_game - DEBUG - Create Session: {'id': 'fc12d965-a2a6-408e-ab04-d5faf3ceb5ff', 'appName': 'beginner_agent', 'userId': 'player_2', 'state': {}, 'events': [], 'lastUpdateTime': 1761903922.6704345}
2025-10-31 18:45:24,285 - poker_game - INFO - LLM raw Response for Agent2: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 1445,\n  "reasoning": "コミュニティカードにペア（3♣、3♥）ができたため、ツーペアの可能性があり、コールする価値があります。相手はすでにオールインしており、これ以上チップを失うリスクはありません。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 77, 'promptTokenCount': 836, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 836}], 'totalTokenCount': 913}, 'invocationId': 'e-3f03a3ca-f0ca-4cdf-97db-b3380286ed03', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'dQ44JjLw', 'timestamp': 1761903922.682137}]
2025-10-31 18:45:24,286 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent2:
2025-10-31 18:45:24,286 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 1445,
  "reasoning": "コミュニティカードにペア（3♣、3♥）ができたため、ツーペアの可能性があり、コールする価値があります。相手はすでにオールインしており、これ以上チップを失うリスクはありません。"
}
```
2025-10-31 18:45:24,286 - poker_game - DEBUG - [Agent2] Starting LLM API response parsing
2025-10-31 18:45:24,286 - poker_game - DEBUG - [Agent2] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 1445,\n  "reasoning": "コミュニティカードにペア（3♣、3♥）ができたため、ツーペアの可能性があり、コールする価値があります。相手はすでにオールインしており、これ以上チップを失うリスクはありません。"\n}\n```'
2025-10-31 18:45:24,287 - poker_game - DEBUG - [Agent2] Markdown code block detected
2025-10-31 18:45:24,287 - poker_game - DEBUG - [Agent2] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 1445,\n  "reasoning": "コミュニティカードにペア（3♣、3♥）ができたため、ツーペアの可能性があり、コールする価値があります。相手はすでにオールインしており、これ以上チップを失うリスクはありません。"\n}'
2025-10-31 18:45:24,287 - poker_game - DEBUG - [Agent2] JSON pattern found: {
  "action": "call",
  "amount": 1445,
  "reasoning": "コミュニティカードにペア（3♣、3♥）ができたため、ツーペアの可能性があり、コールする価値があります。相手はすでにオールインしており、これ以上チップを失うリスクはありません。"
}
2025-10-31 18:45:24,287 - poker_game - DEBUG - [Agent2] JSON parsing successful: {'action': 'call', 'amount': 1445, 'reasoning': 'コミュニティカードにペア（3♣、3♥）ができたため、ツーペアの可能性があり、コールする価値があります。相手はすでにオールインしており、これ以上チップを失うリスクはありません。'}
2025-10-31 18:45:24,288 - poker_game - DEBUG - [Agent2] Extracted values - action: 'call', amount: 1445
2025-10-31 18:45:24,288 - poker_game - DEBUG - [Agent2] Processing call action - available actions: ['fold', 'call (1445)', 'all-in (1445)']
2025-10-31 18:45:24,288 - poker_game - DEBUG - [Agent2] Call amount extracted from 'call (1445)': 1445
2025-10-31 18:45:24,288 - poker_game - DEBUG - [Agent2] Final parsed decision: {'action': 'call', 'amount': 1445}
2025-10-31 18:45:24,289 - poker_game - INFO - [Agent2] Successfully parsed decision: call, 1445, コミュニティカードにペア（3♣、3♥）ができたため、ツーペアの可能性があり、コールする価値があります。相手はすでにオールインしており、これ以上チップを失うリスクはありません。
2025-10-31 18:45:24,293 - poker_game - INFO - >>> PROCESS_ACTION: Player 2 attempts 'call' with amount 1445
2025-10-31 18:45:24,293 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:24,294 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:24,294 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:24,294 - poker_game - INFO - Pot: 4565, Current bet: 1445
2025-10-31 18:45:24,295 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:24,295 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:24,295 - poker_game - INFO - Active players: 1, All-in: 2, Folded: 2
2025-10-31 18:45:24,296 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:24,296 - poker_game - INFO -   P0(Agent0): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,297 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:24,297 - poker_game - INFO -   P2(Agent2): chips=1445, bet=0, status=active
2025-10-31 18:45:24,297 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:24,298 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,298 - poker_game - INFO - ==================================================
2025-10-31 18:45:24,299 - poker_game - INFO - ACTION_EXECUTED: Player 2 called 1445
2025-10-31 18:45:24,313 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:24,314 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:24,315 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:24,315 - poker_game - INFO - Pot: 6010, Current bet: 1445
2025-10-31 18:45:24,316 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:24,317 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:24,317 - poker_game - INFO - Active players: 0, All-in: 3, Folded: 2
2025-10-31 18:45:24,318 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:24,318 - poker_game - INFO -   P0(Agent0): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,318 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:24,318 - poker_game - INFO -   P2(Agent2): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,319 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:24,319 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,320 - poker_game - INFO - Extra: Action: Player 2 called 1445
2025-10-31 18:45:24,320 - poker_game - INFO - ==================================================
2025-10-31 18:45:24,320 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:24,321 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:24,321 - poker_game - DEBUG - Active players: []
2025-10-31 18:45:24,321 - poker_game - WARNING - No active player found in seat order - marking betting round complete
2025-10-31 18:45:24,322 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:24,322 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:24,323 - poker_game - DEBUG - Active: 0, All-in: 3
2025-10-31 18:45:24,323 - poker_game - INFO - Betting complete: No active players
2025-10-31 18:45:24,323 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:24,324 - poker_game - INFO - Hand #1, Phase: turn
2025-10-31 18:45:24,324 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:24,324 - poker_game - INFO - Pot: 6010, Current bet: 1445
2025-10-31 18:45:24,325 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:24,325 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:24,325 - poker_game - INFO - Active players: 0, All-in: 3, Folded: 2
2025-10-31 18:45:24,326 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥']
2025-10-31 18:45:24,326 - poker_game - INFO -   P0(Agent0): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,327 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:24,327 - poker_game - INFO -   P2(Agent2): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,328 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:24,329 - poker_game - INFO -   P4(Agent4): chips=0, bet=1445, status=all_in
2025-10-31 18:45:24,329 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:45:24,330 - poker_game - INFO - ==================================================
2025-10-31 18:45:24,431 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:45:24,432 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:24,433 - poker_game - INFO - Remaining players: 3
2025-10-31 18:45:24,433 - poker_game - DEBUG -   Remaining P0: Agent0, status: all_in
2025-10-31 18:45:24,433 - poker_game - DEBUG -   Remaining P2: Agent2, status: all_in
2025-10-31 18:45:24,434 - poker_game - DEBUG -   Remaining P4: Agent4, status: all_in
2025-10-31 18:45:24,434 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:45:24,447 - poker_game - INFO - Starting new betting round
2025-10-31 18:45:24,448 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:45:24,448 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:45:24,449 - poker_game - DEBUG - Active players for new betting round: []
2025-10-31 18:45:24,449 - poker_game - DEBUG - Dealer button: 2
2025-10-31 18:45:24,450 - poker_game - WARNING - No active players - marking betting complete
2025-10-31 18:45:24,450 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:45:24,451 - poker_game - INFO - Hand #1, Phase: river
2025-10-31 18:45:24,451 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:24,452 - poker_game - INFO - Pot: 6010, Current bet: 0
2025-10-31 18:45:24,452 - poker_game - INFO - Last raiser: None
2025-10-31 18:45:24,453 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:24,453 - poker_game - INFO - Active players: 0, All-in: 3, Folded: 2
2025-10-31 18:45:24,454 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥', '4♠']
2025-10-31 18:45:24,454 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=all_in
2025-10-31 18:45:24,454 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:24,455 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=all_in
2025-10-31 18:45:24,456 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:24,456 - poker_game - INFO -   P4(Agent4): chips=0, bet=0, status=all_in
2025-10-31 18:45:24,457 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:45:24,457 - poker_game - INFO - ==================================================
2025-10-31 18:45:24,457 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:45:24,458 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:24,458 - poker_game - INFO - Remaining players: 3
2025-10-31 18:45:24,459 - poker_game - DEBUG -   Remaining P0: Agent0, status: all_in
2025-10-31 18:45:24,459 - poker_game - DEBUG -   Remaining P2: Agent2, status: all_in
2025-10-31 18:45:24,459 - poker_game - DEBUG -   Remaining P4: Agent4, status: all_in
2025-10-31 18:45:24,459 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:45:24,460 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:45:24,461 - poker_game - INFO - Hand #1, Phase: showdown
2025-10-31 18:45:24,461 - poker_game - INFO - Current player: 2, Dealer: 2
2025-10-31 18:45:24,461 - poker_game - INFO - Pot: 6010, Current bet: 0
2025-10-31 18:45:24,462 - poker_game - INFO - Last raiser: None
2025-10-31 18:45:24,463 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:24,463 - poker_game - INFO - Active players: 0, All-in: 3, Folded: 2
2025-10-31 18:45:24,464 - poker_game - INFO - Community cards: ['3♣', '10♠', '4♣', '3♥', '4♠']
2025-10-31 18:45:24,464 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=all_in
2025-10-31 18:45:24,465 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:24,466 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=all_in
2025-10-31 18:45:24,467 - poker_game - INFO -   P3(Agent3): chips=1990, bet=0, status=folded
2025-10-31 18:45:24,468 - poker_game - INFO -   P4(Agent4): chips=0, bet=0, status=all_in
2025-10-31 18:45:24,469 - poker_game - INFO - ==================================================
2025-10-31 18:45:24,470 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:45:24,470 - poker_game - INFO - Pot: 6010, Community cards: ['3♣', '10♠', '4♣', '3♥', '4♠']
2025-10-31 18:45:24,471 - poker_game - INFO -   Player 0 status=all_in cards=['J♥', 'K♥']
2025-10-31 18:45:24,471 - poker_game - INFO -   Player 2 status=all_in cards=['5♥', '8♦']
2025-10-31 18:45:24,472 - poker_game - INFO -   Player 4 status=all_in cards=['3♠', '8♥']
2025-10-31 18:45:24,476 - poker_game - INFO -   Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=['J♥', 'K♥']
2025-10-31 18:45:24,477 - poker_game - INFO -   Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=['5♥', '8♦']
2025-10-31 18:45:24,477 - poker_game - INFO -   Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=['3♠', '8♥']
2025-10-31 18:45:24,478 - poker_game - INFO - Pot layer 0: amount=40, contributors=[0, 2, 3, 4]
2025-10-31 18:45:24,478 - poker_game - INFO - Pot layer 1: amount=5970, contributors=[0, 2, 4]
2025-10-31 18:45:24,479 - poker_game - INFO - Showdown total awarded: 6010 (game.pot=6010)
2025-10-31 18:45:24,480 - poker_game - INFO - Showdown winners (aggregated): [4]
2025-10-31 18:45:24,480 - poker_game - INFO -   Awarded 6010 to Player 4 (hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥)
2025-10-31 18:45:24,481 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:45:24,527 - poker_game - INFO - === STARTING NEW HAND #2 ===
2025-10-31 18:45:24,528 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:45:24,528 - poker_game - INFO - Moving dealer button
2025-10-31 18:45:24,529 - poker_game - INFO - Posting blinds
2025-10-31 18:45:24,560 - poker_game - INFO - Dealing hole cards
2025-10-31 18:45:24,561 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:45:24,573 - poker_game - INFO - Started new hand in database: hand_id=2
2025-10-31 18:45:24,574 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:45:24,575 - poker_game - INFO - Hand #2, Phase: preflop
2025-10-31 18:45:24,575 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:45:24,575 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:24,577 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:24,577 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:24,578 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:24,578 - poker_game - INFO - Community cards: []
2025-10-31 18:45:24,579 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:24,579 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=active
2025-10-31 18:45:24,580 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:24,580 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=active
2025-10-31 18:45:24,581 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:24,582 - poker_game - INFO - ==================================================
2025-10-31 18:45:24,584 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "J♠",
    "3♠"
  ],
  "community": [],
  "your_chips": 2000,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1980,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5990,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (2000)"
  ],
  "history": [
    "Player 2 called 80",
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125",
    "Player 0 raised to 475",
    "Player 2 called 475",
    "Player 4 called 350",
    "Turn dealt: 3♥",
    "Player 4 raised to 1445",
    "Player 0 called 1445",
    "Player 2 called 1445",
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:45:24,603 - poker_game - DEBUG - Create Session: {'id': 'd84aad9c-1a3a-4480-9a05-6d68baa5b627', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761903924.599738}
2025-10-31 18:45:26,249 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップでJ♠ 3♠というハンドは、特に後続のアクションでレイズがあった場合、非常に弱いハンドです。ポットオッズ（コールに必要な金額に対するポットの大きさ）が良くても、このハンドでコールしてフロップ以降で戦うのはリスクが高すぎます。過去の履歴を見ると、このテーブルはアグレッシブなプレイヤーがいる可能性があり、不用意にポットに参加するのは避けるべきです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 123, 'promptTokenCount': 985, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 985}], 'totalTokenCount': 1108}, 'invocationId': 'e-d5549bde-2ec2-4848-ad02-14f959539352', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'MfTJv1iw', 'timestamp': 1761903924.617173}]
2025-10-31 18:45:26,251 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:45:26,251 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップでJ♠ 3♠というハンドは、特に後続のアクションでレイズがあった場合、非常に弱いハンドです。ポットオッズ（コールに必要な金額に対するポットの大きさ）が良くても、このハンドでコールしてフロップ以降で戦うのはリスクが高すぎます。過去の履歴を見ると、このテーブルはアグレッシブなプレイヤーがいる可能性があり、不用意にポットに参加するのは避けるべきです。"
}
```
2025-10-31 18:45:26,252 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:45:26,252 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップでJ♠ 3♠というハンドは、特に後続のアクションでレイズがあった場合、非常に弱いハンドです。ポットオッズ（コールに必要な金額に対するポットの大きさ）が良くても、このハンドでコールしてフロップ以降で戦うのはリスクが高すぎます。過去の履歴を見ると、このテーブルはアグレッシブなプレイヤーがいる可能性があり、不用意にポットに参加するのは避けるべきです。"\n}\n```'
2025-10-31 18:45:26,253 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:45:26,253 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップでJ♠ 3♠というハンドは、特に後続のアクションでレイズがあった場合、非常に弱いハンドです。ポットオッズ（コールに必要な金額に対するポットの大きさ）が良くても、このハンドでコールしてフロップ以降で戦うのはリスクが高すぎます。過去の履歴を見ると、このテーブルはアグレッシブなプレイヤーがいる可能性があり、不用意にポットに参加するのは避けるべきです。"\n}'
2025-10-31 18:45:26,253 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップでJ♠ 3♠というハンドは、特に後続のアクションでレイズがあった場合、非常に弱いハンドです。ポットオッズ（コールに必要な金額に対するポットの大きさ）が良くても、このハンドでコールしてフロップ以降で戦うのはリスクが高すぎます。過去の履歴を見ると、このテーブルはアグレッシブなプレイヤーがいる可能性があり、不用意にポットに参加するのは避けるべきです。"
}
2025-10-31 18:45:26,253 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップでJ♠ 3♠というハンドは、特に後続のアクションでレイズがあった場合、非常に弱いハンドです。ポットオッズ（コールに必要な金額に対するポットの大きさ）が良くても、このハンドでコールしてフロップ以降で戦うのはリスクが高すぎます。過去の履歴を見ると、このテーブルはアグレッシブなプレイヤーがいる可能性があり、不用意にポットに参加するのは避けるべきです。'}
2025-10-31 18:45:26,254 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:45:26,254 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:45:26,254 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:45:26,254 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップでJ♠ 3♠というハンドは、特に後続のアクションでレイズがあった場合、非常に弱いハンドです。ポットオッズ（コールに必要な金額に対するポットの大きさ）が良くても、このハンドでコールしてフロップ以降で戦うのはリスクが高すぎます。過去の履歴を見ると、このテーブルはアグレッシブなプレイヤーがいる可能性があり、不用意にポットに参加するのは避けるべきです。
2025-10-31 18:45:26,256 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:45:26,257 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:26,257 - poker_game - INFO - Hand #2, Phase: preflop
2025-10-31 18:45:26,257 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:45:26,258 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:26,258 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:26,258 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:26,259 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:26,259 - poker_game - INFO - Community cards: []
2025-10-31 18:45:26,259 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:26,260 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=active
2025-10-31 18:45:26,260 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:26,261 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=active
2025-10-31 18:45:26,261 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:26,262 - poker_game - INFO - ==================================================
2025-10-31 18:45:26,262 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:45:26,277 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:26,278 - poker_game - INFO - Hand #2, Phase: preflop
2025-10-31 18:45:26,278 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:45:26,279 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:26,279 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:26,280 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:26,280 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:26,280 - poker_game - INFO - Community cards: []
2025-10-31 18:45:26,281 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:26,281 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:26,282 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:26,282 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=active
2025-10-31 18:45:26,283 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:26,283 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:45:26,284 - poker_game - INFO - ==================================================
2025-10-31 18:45:26,284 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:26,285 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:26,285 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:45:26,286 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:45:26,287 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:26,287 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:26,288 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:45:26,288 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 18:45:26,288 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:45:26,289 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:26,289 - poker_game - INFO - Hand #2, Phase: preflop
2025-10-31 18:45:26,290 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:45:26,291 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:26,291 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:26,292 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:26,293 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:26,293 - poker_game - INFO - Community cards: []
2025-10-31 18:45:26,294 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:26,294 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:26,295 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:26,295 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=active
2025-10-31 18:45:26,296 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:26,296 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:26,296 - poker_game - INFO - ==================================================
2025-10-31 18:45:26,398 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "4♥",
    "7♦"
  ],
  "community": [],
  "your_chips": 1980,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2000,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5990,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1980)"
  ],
  "history": [
    "Player 3 folded",
    "Player 4 called 60",
    "Flop dealt: 3♣, 10♠, 4♣",
    "Player 4 raised to 125",
    "Player 0 raised to 475",
    "Player 2 called 475",
    "Player 4 called 350",
    "Turn dealt: 3♥",
    "Player 4 raised to 1445",
    "Player 0 called 1445",
    "Player 2 called 1445",
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded"
  ]
}
2025-10-31 18:45:26,411 - poker_game - DEBUG - Create Session: {'id': 'dc03e0bc-45e9-46af-b23d-42f4b66642ae', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761903926.4074361}
2025-10-31 18:45:28,447 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（カードが配られた直後）の状況です。私の手札は4♥7♦で、これは弱いハンド（カードの組み合わせ）です。ポット（賭け金の総額）は30で、コールするには10必要ですが、このハンドで勝てる可能性は低いです。さらに、過去の履歴を見ると、すでに多くのベットが行われており、相手（Player 4）が強いハンドを持っている可能性が高いです。そのため、これ以上ベットせずにフォールド（降りる）するのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 141, 'promptTokenCount': 983, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 983}], 'totalTokenCount': 1124}, 'invocationId': 'e-f1b48a99-0aa3-4d06-b496-de58a1761357', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'fhfZbcbV', 'timestamp': 1761903926.423063}]
2025-10-31 18:45:28,448 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:45:28,448 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（カードが配られた直後）の状況です。私の手札は4♥7♦で、これは弱いハンド（カードの組み合わせ）です。ポット（賭け金の総額）は30で、コールするには10必要ですが、このハンドで勝てる可能性は低いです。さらに、過去の履歴を見ると、すでに多くのベットが行われており、相手（Player 4）が強いハンドを持っている可能性が高いです。そのため、これ以上ベットせずにフォールド（降りる）するのが最善です。"
}
```
2025-10-31 18:45:28,449 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:45:28,450 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（カードが配られた直後）の状況です。私の手札は4♥7♦で、これは弱いハンド（カードの組み合わせ）です。ポット（賭け金の総額）は30で、コールするには10必要ですが、このハンドで勝てる可能性は低いです。さらに、過去の履歴を見ると、すでに多くのベットが行われており、相手（Player 4）が強いハンドを持っている可能性が高いです。そのため、これ以上ベットせずにフォールド（降りる）するのが最善です。"\n}\n```'
2025-10-31 18:45:28,450 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:45:28,450 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（カードが配られた直後）の状況です。私の手札は4♥7♦で、これは弱いハンド（カードの組み合わせ）です。ポット（賭け金の総額）は30で、コールするには10必要ですが、このハンドで勝てる可能性は低いです。さらに、過去の履歴を見ると、すでに多くのベットが行われており、相手（Player 4）が強いハンドを持っている可能性が高いです。そのため、これ以上ベットせずにフォールド（降りる）するのが最善です。"\n}'
2025-10-31 18:45:28,450 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（カードが配られた直後）の状況です。私の手札は4♥7♦で、これは弱いハンド（カードの組み合わせ）です。ポット（賭け金の総額）は30で、コールするには10必要ですが、このハンドで勝てる可能性は低いです。さらに、過去の履歴を見ると、すでに多くのベットが行われており、相手（Player 4）が強いハンドを持っている可能性が高いです。そのため、これ以上ベットせずにフォールド（降りる）するのが最善です。"
}
2025-10-31 18:45:28,451 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（カードが配られた直後）の状況です。私の手札は4♥7♦で、これは弱いハンド（カードの組み合わせ）です。ポット（賭け金の総額）は30で、コールするには10必要ですが、このハンドで勝てる可能性は低いです。さらに、過去の履歴を見ると、すでに多くのベットが行われており、相手（Player 4）が強いハンドを持っている可能性が高いです。そのため、これ以上ベットせずにフォールド（降りる）するのが最善です。'}
2025-10-31 18:45:28,451 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:45:28,451 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:45:28,451 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:45:28,452 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップ（カードが配られた直後）の状況です。私の手札は4♥7♦で、これは弱いハンド（カードの組み合わせ）です。ポット（賭け金の総額）は30で、コールするには10必要ですが、このハンドで勝てる可能性は低いです。さらに、過去の履歴を見ると、すでに多くのベットが行われており、相手（Player 4）が強いハンドを持っている可能性が高いです。そのため、これ以上ベットせずにフォールド（降りる）するのが最善です。
2025-10-31 18:45:28,453 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:45:28,454 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:28,454 - poker_game - INFO - Hand #2, Phase: preflop
2025-10-31 18:45:28,454 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:45:28,455 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:28,456 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:28,456 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:28,457 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:28,457 - poker_game - INFO - Community cards: []
2025-10-31 18:45:28,458 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:28,458 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:28,459 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:28,460 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=active
2025-10-31 18:45:28,460 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:28,461 - poker_game - INFO - ==================================================
2025-10-31 18:45:28,462 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:45:28,474 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:28,475 - poker_game - INFO - Hand #2, Phase: preflop
2025-10-31 18:45:28,475 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:45:28,475 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:28,476 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:28,476 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:28,477 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:45:28,477 - poker_game - INFO - Community cards: []
2025-10-31 18:45:28,478 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:28,478 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:28,478 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:28,479 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=folded
2025-10-31 18:45:28,479 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:28,479 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:45:28,480 - poker_game - INFO - ==================================================
2025-10-31 18:45:28,480 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:28,481 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:28,481 - poker_game - DEBUG - Active players: [4]
2025-10-31 18:45:28,481 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:45:28,482 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:28,482 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:28,482 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:45:28,482 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:45:28,483 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:28,483 - poker_game - INFO - Hand #2, Phase: preflop
2025-10-31 18:45:28,483 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:45:28,484 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:28,484 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:28,485 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:28,485 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:45:28,485 - poker_game - INFO - Community cards: []
2025-10-31 18:45:28,486 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:28,487 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:28,487 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:28,487 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=folded
2025-10-31 18:45:28,488 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:28,488 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:45:28,489 - poker_game - INFO - ==================================================
2025-10-31 18:45:28,592 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:45:28,593 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:28,593 - poker_game - INFO - Remaining players: 1
2025-10-31 18:45:28,594 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:45:28,594 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:45:28,594 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:45:28,595 - poker_game - INFO - Hand #2, Phase: showdown
2025-10-31 18:45:28,595 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:45:28,596 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:28,596 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:28,597 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:28,597 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:45:28,597 - poker_game - INFO - Community cards: []
2025-10-31 18:45:28,598 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:28,598 - poker_game - INFO -   P1(Agent1): chips=2000, bet=0, status=folded
2025-10-31 18:45:28,598 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:28,599 - poker_game - INFO -   P3(Agent3): chips=1980, bet=10, status=folded
2025-10-31 18:45:28,599 - poker_game - INFO -   P4(Agent4): chips=5990, bet=20, status=active
2025-10-31 18:45:28,599 - poker_game - INFO - ==================================================
2025-10-31 18:45:28,600 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:45:28,600 - poker_game - INFO - Pot: 30, Community cards: []
2025-10-31 18:45:28,601 - poker_game - INFO -   Player 4 status=active cards=['5♠', '3♥']
2025-10-31 18:45:28,601 - poker_game - INFO - Showdown winner by default: Player 4 awarded 30
2025-10-31 18:45:28,602 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:45:28,602 - poker_game - INFO - === STARTING NEW HAND #3 ===
2025-10-31 18:45:28,603 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:45:28,603 - poker_game - INFO - Moving dealer button
2025-10-31 18:45:28,604 - poker_game - INFO - Posting blinds
2025-10-31 18:45:28,621 - poker_game - INFO - Dealing hole cards
2025-10-31 18:45:28,622 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:45:28,631 - poker_game - INFO - Started new hand in database: hand_id=3
2025-10-31 18:45:28,632 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:45:28,632 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:28,633 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:45:28,633 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:28,634 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:28,634 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:28,635 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:28,635 - poker_game - INFO - Community cards: []
2025-10-31 18:45:28,635 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:28,636 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:28,636 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:28,637 - poker_game - INFO -   P3(Agent3): chips=1980, bet=0, status=active
2025-10-31 18:45:28,637 - poker_game - INFO -   P4(Agent4): chips=6010, bet=10, status=active
2025-10-31 18:45:28,638 - poker_game - INFO - ==================================================
2025-10-31 18:45:28,639 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "3♣",
    "Q♦"
  ],
  "community": [],
  "your_chips": 1980,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1980,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6010,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1980)"
  ],
  "history": [
    "Player 0 raised to 475",
    "Player 2 called 475",
    "Player 4 called 350",
    "Turn dealt: 3♥",
    "Player 4 raised to 1445",
    "Player 0 called 1445",
    "Player 2 called 1445",
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 18:45:28,653 - poker_game - DEBUG - Create Session: {'id': '419c811d-6fe2-43e3-afa0-c4ca582ab951', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761903928.6504745}
2025-10-31 18:45:30,636 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップ（フロップが開かれる前）で、手札はQ3オフスート（異なるスーツのクイーンと3）です。これはあまり強い手札ではありません。ポットには30、コールするには20必要です。プレイヤー1がすでに20をベットしており、プレイヤー4はビッグブラインドとして20にいます。この状況では、コールしてフロップを見て、その後の展開で判断するのが最も賢明な選択です。レイズするには手札が弱すぎ、フォールドするにはポットオッズ（投資するチップに対して得られるポットの大きさが有利であること）が良いからです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 160, 'promptTokenCount': 978, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 978}], 'totalTokenCount': 1138}, 'invocationId': 'e-b66d4255-9cf4-42d0-9508-53e72cc8492a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'K7QMF9O0', 'timestamp': 1761903928.661258}]
2025-10-31 18:45:30,636 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:45:30,637 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップ（フロップが開かれる前）で、手札はQ3オフスート（異なるスーツのクイーンと3）です。これはあまり強い手札ではありません。ポットには30、コールするには20必要です。プレイヤー1がすでに20をベットしており、プレイヤー4はビッグブラインドとして20にいます。この状況では、コールしてフロップを見て、その後の展開で判断するのが最も賢明な選択です。レイズするには手札が弱すぎ、フォールドするにはポットオッズ（投資するチップに対して得られるポットの大きさが有利であること）が良いからです。"
}
```
2025-10-31 18:45:30,637 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:45:30,637 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップ（フロップが開かれる前）で、手札はQ3オフスート（異なるスーツのクイーンと3）です。これはあまり強い手札ではありません。ポットには30、コールするには20必要です。プレイヤー1がすでに20をベットしており、プレイヤー4はビッグブラインドとして20にいます。この状況では、コールしてフロップを見て、その後の展開で判断するのが最も賢明な選択です。レイズするには手札が弱すぎ、フォールドするにはポットオッズ（投資するチップに対して得られるポットの大きさが有利であること）が良いからです。"\n}\n```'
2025-10-31 18:45:30,637 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:45:30,638 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップ（フロップが開かれる前）で、手札はQ3オフスート（異なるスーツのクイーンと3）です。これはあまり強い手札ではありません。ポットには30、コールするには20必要です。プレイヤー1がすでに20をベットしており、プレイヤー4はビッグブラインドとして20にいます。この状況では、コールしてフロップを見て、その後の展開で判断するのが最も賢明な選択です。レイズするには手札が弱すぎ、フォールドするにはポットオッズ（投資するチップに対して得られるポットの大きさが有利であること）が良いからです。"\n}'
2025-10-31 18:45:30,638 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップ（フロップが開かれる前）で、手札はQ3オフスート（異なるスーツのクイーンと3）です。これはあまり強い手札ではありません。ポットには30、コールするには20必要です。プレイヤー1がすでに20をベットしており、プレイヤー4はビッグブラインドとして20にいます。この状況では、コールしてフロップを見て、その後の展開で判断するのが最も賢明な選択です。レイズするには手札が弱すぎ、フォールドするにはポットオッズ（投資するチップに対して得られるポットの大きさが有利であること）が良いからです。"
}
2025-10-31 18:45:30,638 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップ（フロップが開かれる前）で、手札はQ3オフスート（異なるスーツのクイーンと3）です。これはあまり強い手札ではありません。ポットには30、コールするには20必要です。プレイヤー1がすでに20をベットしており、プレイヤー4はビッグブラインドとして20にいます。この状況では、コールしてフロップを見て、その後の展開で判断するのが最も賢明な選択です。レイズするには手札が弱すぎ、フォールドするにはポットオッズ（投資するチップに対して得られるポットの大きさが有利であること）が良いからです。'}
2025-10-31 18:45:30,638 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 20
2025-10-31 18:45:30,639 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (1980)']
2025-10-31 18:45:30,639 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (20)': 20
2025-10-31 18:45:30,639 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:45:30,639 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 20, プリフロップ（フロップが開かれる前）で、手札はQ3オフスート（異なるスーツのクイーンと3）です。これはあまり強い手札ではありません。ポットには30、コールするには20必要です。プレイヤー1がすでに20をベットしており、プレイヤー4はビッグブラインドとして20にいます。この状況では、コールしてフロップを見て、その後の展開で判断するのが最も賢明な選択です。レイズするには手札が弱すぎ、フォールドするにはポットオッズ（投資するチップに対して得られるポットの大きさが有利であること）が良いからです。
2025-10-31 18:45:30,640 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 20
2025-10-31 18:45:30,641 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:30,641 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:30,641 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:45:30,642 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:45:30,642 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:30,644 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:30,645 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:30,645 - poker_game - INFO - Community cards: []
2025-10-31 18:45:30,646 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:30,647 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:30,647 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:30,648 - poker_game - INFO -   P3(Agent3): chips=1980, bet=0, status=active
2025-10-31 18:45:30,648 - poker_game - INFO -   P4(Agent4): chips=6010, bet=10, status=active
2025-10-31 18:45:30,649 - poker_game - INFO - ==================================================
2025-10-31 18:45:30,649 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 20
2025-10-31 18:45:30,661 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:30,662 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:30,662 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:45:30,663 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:45:30,663 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:30,663 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:30,664 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:30,664 - poker_game - INFO - Community cards: []
2025-10-31 18:45:30,664 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:30,665 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:30,665 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:30,665 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:30,666 - poker_game - INFO -   P4(Agent4): chips=6010, bet=10, status=active
2025-10-31 18:45:30,666 - poker_game - INFO - Extra: Action: Player 3 called 20
2025-10-31 18:45:30,666 - poker_game - INFO - ==================================================
2025-10-31 18:45:30,667 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:30,667 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:30,667 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:45:30,667 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:45:30,668 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:30,668 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:30,668 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:45:30,669 - poker_game - DEBUG - Player bets: [20, 20, 10], Current bet: 20, All same: False
2025-10-31 18:45:30,669 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:45:30,670 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:30,670 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:30,670 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:45:30,670 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:45:30,671 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:30,671 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:30,671 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:30,671 - poker_game - INFO - Community cards: []
2025-10-31 18:45:30,672 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:30,674 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:30,675 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:30,675 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:30,676 - poker_game - INFO -   P4(Agent4): chips=6010, bet=10, status=active
2025-10-31 18:45:30,677 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:30,677 - poker_game - INFO - ==================================================
2025-10-31 18:45:30,779 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "J♣",
    "A♥"
  ],
  "community": [],
  "your_chips": 6010,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1980,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1960,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (6010)"
  ],
  "history": [
    "Player 2 called 475",
    "Player 4 called 350",
    "Turn dealt: 3♥",
    "Player 4 raised to 1445",
    "Player 0 called 1445",
    "Player 2 called 1445",
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20"
  ]
}
2025-10-31 18:45:30,795 - poker_game - DEBUG - Create Session: {'id': '45203c5d-e947-429d-bdeb-1ac8f75429fe', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903930.7933552}
2025-10-31 18:45:40,960 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:45:44,329 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_kyKau6eECMwyaK6BqLH7lty7', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1304, 'totalTokenCount': 1321}, 'invocationId': 'e-b8b9397b-50b4-47cf-9b48-2e9ce04ab273', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Sfl7Husa', 'timestamp': 1761903930.809202}, {'content': {'parts': [{'functionResponse': {'id': 'call_kyKau6eECMwyaK6BqLH7lty7', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-b8b9397b-50b4-47cf-9b48-2e9ce04ab273', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'kDbiNLxP', 'timestamp': 1761903932.000436}, {'content': {'parts': [{'functionCall': {'id': 'call_EPg97JzJAhNgmSuYzSBsB9Eg', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♣', 'A♥'], 'community': [], 'your_chips': 6010, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 50, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1980, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1960, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (6010)'], 'history': ['Player 2 called 475', 'Player 4 called 350', 'Turn dealt: 3♥', 'Player 4 raised to 1445', 'Player 0 called 1445', 'Player 2 called 1445', 'River dealt: 4♠', 'Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥', 'Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦', 'Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥', 'Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥', 'Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20']}, 'call_amount': 10, 'pot_after_call': 60, 'equity': 0.65}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 536, 'promptTokenCount': 1828, 'totalTokenCount': 2364}, 'invocationId': 'e-b8b9397b-50b4-47cf-9b48-2e9ce04ab273', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ueqbTCE9', 'timestamp': 1761903932.002757}, {'content': {'parts': [{'functionResponse': {'id': 'call_EPg97JzJAhNgmSuYzSBsB9Eg', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（35.50(ポットに対して71.00%）、コールが妥当と判断。コール額: 10'}}}], 'role': 'user'}, 'invocationId': 'e-b8b9397b-50b4-47cf-9b48-2e9ce04ab273', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'qACZ44AY', 'timestamp': 1761903942.559013}, {'content': {'parts': [{'text': '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（35.50(ポットに対して71.00%）、コールが妥当と判断。コール額: 10"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2431, 'totalTokenCount': 2485}, 'invocationId': 'e-b8b9397b-50b4-47cf-9b48-2e9ce04ab273', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '5i4LnWq7', 'timestamp': 1761903942.5626}]
2025-10-31 18:45:44,330 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:45:44,331 - poker_game - DEBUG - {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（35.50(ポットに対して71.00%）、コールが妥当と判断。コール額: 10"}
2025-10-31 18:45:44,332 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:45:44,332 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（35.50(ポットに対して71.00%）、コールが妥当と判断。コール額: 10"}'
2025-10-31 18:45:44,332 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:45:44,332 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（35.50(ポットに対して71.00%）、コールが妥当と判断。コール額: 10"}
2025-10-31 18:45:44,333 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（35.50(ポットに対して71.00%）、コールが妥当と判断。コール額: 10'}
2025-10-31 18:45:44,333 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 10
2025-10-31 18:45:44,333 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (6010)']
2025-10-31 18:45:44,333 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (10)': 10
2025-10-31 18:45:44,334 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:45:44,334 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 10, ポットオッズを満たしており（35.50(ポットに対して71.00%）、コールが妥当と判断。コール額: 10
2025-10-31 18:45:44,336 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 10
2025-10-31 18:45:44,337 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:44,337 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:44,338 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:45:44,339 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:45:44,339 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:44,340 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:44,341 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:44,341 - poker_game - INFO - Community cards: []
2025-10-31 18:45:44,342 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:44,342 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:44,343 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:44,343 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:44,343 - poker_game - INFO -   P4(Agent4): chips=6010, bet=10, status=active
2025-10-31 18:45:44,343 - poker_game - INFO - ==================================================
2025-10-31 18:45:44,344 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 10
2025-10-31 18:45:44,355 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:44,356 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:44,357 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:45:44,357 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:45:44,358 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:44,358 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:44,359 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:44,359 - poker_game - INFO - Community cards: []
2025-10-31 18:45:44,359 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:44,360 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:44,360 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:44,360 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:44,361 - poker_game - INFO -   P4(Agent4): chips=6000, bet=20, status=active
2025-10-31 18:45:44,361 - poker_game - INFO - Extra: Action: Player 4 called 10
2025-10-31 18:45:44,361 - poker_game - INFO - ==================================================
2025-10-31 18:45:44,362 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:44,362 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:44,363 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:45:44,363 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:45:44,363 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:44,364 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:44,364 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:45:44,364 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:45:44,364 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:45:44,364 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:45:44,365 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:45:44,365 - poker_game - DEBUG - Next after last raiser 1: 3
2025-10-31 18:45:44,365 - poker_game - DEBUG - Betting continues: Current player 1 != next after raiser 3
2025-10-31 18:45:44,365 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:44,366 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:44,366 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:45:44,367 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:45:44,367 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:44,368 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:44,368 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:44,369 - poker_game - INFO - Community cards: []
2025-10-31 18:45:44,369 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:44,369 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:44,370 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:44,371 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:44,371 - poker_game - INFO -   P4(Agent4): chips=6000, bet=20, status=active
2025-10-31 18:45:44,372 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:44,372 - poker_game - INFO - ==================================================
2025-10-31 18:45:44,474 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "3♥",
    "8♦"
  ],
  "community": [],
  "your_chips": 1980,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1960,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6000,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (1980)"
  ],
  "history": [
    "Player 4 called 350",
    "Turn dealt: 3♥",
    "Player 4 raised to 1445",
    "Player 0 called 1445",
    "Player 2 called 1445",
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10"
  ]
}
2025-10-31 18:45:44,485 - poker_game - DEBUG - Create Session: {'id': 'd91c78ff-6443-42e6-b7f6-e4711b65a8f3', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761903944.4832067}
2025-10-31 18:45:48,638 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで3と8のオフスート（異なる絵柄）は非常に弱いハンドです。レイズするには十分な強さがなく、コールするにもポットオッズ（コールに必要な金額に対するポットの大きさの比率）が有利ではありません。相手のベット額も不明ですが、このハンドで参加するのはリスクが高すぎます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 102, 'promptTokenCount': 973, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 973}], 'totalTokenCount': 1075}, 'invocationId': 'e-d7be13c0-0aad-4d70-984a-a35a9d6a8f1d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'KzYNXYT1', 'timestamp': 1761903944.495052}]
2025-10-31 18:45:48,639 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:45:48,639 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで3と8のオフスート（異なる絵柄）は非常に弱いハンドです。レイズするには十分な強さがなく、コールするにもポットオッズ（コールに必要な金額に対するポットの大きさの比率）が有利ではありません。相手のベット額も不明ですが、このハンドで参加するのはリスクが高すぎます。"
}
```
2025-10-31 18:45:48,639 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:45:48,639 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで3と8のオフスート（異なる絵柄）は非常に弱いハンドです。レイズするには十分な強さがなく、コールするにもポットオッズ（コールに必要な金額に対するポットの大きさの比率）が有利ではありません。相手のベット額も不明ですが、このハンドで参加するのはリスクが高すぎます。"\n}\n```'
2025-10-31 18:45:48,640 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:45:48,640 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで3と8のオフスート（異なる絵柄）は非常に弱いハンドです。レイズするには十分な強さがなく、コールするにもポットオッズ（コールに必要な金額に対するポットの大きさの比率）が有利ではありません。相手のベット額も不明ですが、このハンドで参加するのはリスクが高すぎます。"\n}'
2025-10-31 18:45:48,640 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで3と8のオフスート（異なる絵柄）は非常に弱いハンドです。レイズするには十分な強さがなく、コールするにもポットオッズ（コールに必要な金額に対するポットの大きさの比率）が有利ではありません。相手のベット額も不明ですが、このハンドで参加するのはリスクが高すぎます。"
}
2025-10-31 18:45:48,640 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップで3と8のオフスート（異なる絵柄）は非常に弱いハンドです。レイズするには十分な強さがなく、コールするにもポットオッズ（コールに必要な金額に対するポットの大きさの比率）が有利ではありません。相手のベット額も不明ですが、このハンドで参加するのはリスクが高すぎます。'}
2025-10-31 18:45:48,640 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:45:48,640 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:45:48,640 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:45:48,640 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップで3と8のオフスート（異なる絵柄）は非常に弱いハンドです。レイズするには十分な強さがなく、コールするにもポットオッズ（コールに必要な金額に対するポットの大きさの比率）が有利ではありません。相手のベット額も不明ですが、このハンドで参加するのはリスクが高すぎます。
2025-10-31 18:45:48,641 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:45:48,642 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:48,643 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:48,643 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:45:48,643 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:45:48,643 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:48,643 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:48,644 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:45:48,644 - poker_game - INFO - Community cards: []
2025-10-31 18:45:48,644 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:48,644 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=active
2025-10-31 18:45:48,644 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:48,645 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:48,645 - poker_game - INFO -   P4(Agent4): chips=6000, bet=20, status=active
2025-10-31 18:45:48,645 - poker_game - INFO - ==================================================
2025-10-31 18:45:48,645 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:45:48,656 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:48,657 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:48,657 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:45:48,657 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:45:48,658 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:48,658 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:48,658 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:48,658 - poker_game - INFO - Community cards: []
2025-10-31 18:45:48,658 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:48,658 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=folded
2025-10-31 18:45:48,658 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:48,658 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:48,658 - poker_game - INFO -   P4(Agent4): chips=6000, bet=20, status=active
2025-10-31 18:45:48,658 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:45:48,658 - poker_game - INFO - ==================================================
2025-10-31 18:45:48,658 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:48,659 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:48,659 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:45:48,659 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:45:48,659 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:48,659 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:48,659 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:45:48,659 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:45:48,659 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:45:48,660 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:45:48,660 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:45:48,660 - poker_game - INFO - Betting complete: Last raiser 1 is no longer active
2025-10-31 18:45:48,660 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:48,660 - poker_game - INFO - Hand #3, Phase: preflop
2025-10-31 18:45:48,660 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:45:48,660 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:45:48,661 - poker_game - INFO - Last raiser: 1
2025-10-31 18:45:48,661 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:48,661 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:48,661 - poker_game - INFO - Community cards: []
2025-10-31 18:45:48,661 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:48,662 - poker_game - INFO -   P1(Agent1): chips=1980, bet=20, status=folded
2025-10-31 18:45:48,662 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:48,662 - poker_game - INFO -   P3(Agent3): chips=1960, bet=20, status=active
2025-10-31 18:45:48,662 - poker_game - INFO -   P4(Agent4): chips=6000, bet=20, status=active
2025-10-31 18:45:48,662 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:45:48,663 - poker_game - INFO - ==================================================
2025-10-31 18:45:43,657 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:45:43,658 - poker_game - INFO - Betting round complete: True
2025-10-31 18:45:43,659 - poker_game - INFO - Remaining players: 2
2025-10-31 18:45:43,659 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:45:43,659 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:45:43,659 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:45:43,672 - poker_game - INFO - Starting new betting round
2025-10-31 18:45:43,673 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:45:43,673 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:45:43,673 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:45:43,674 - poker_game - DEBUG - Dealer button: 3
2025-10-31 18:45:43,674 - poker_game - INFO - First actor: Player 4 (by phase rule), was 3
2025-10-31 18:45:43,674 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:45:43,675 - poker_game - INFO - Hand #3, Phase: flop
2025-10-31 18:45:43,675 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:45:43,675 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:45:43,675 - poker_game - INFO - Last raiser: None
2025-10-31 18:45:43,676 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:43,676 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:43,676 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦']
2025-10-31 18:45:43,676 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:43,677 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:45:43,677 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:43,678 - poker_game - INFO -   P3(Agent3): chips=1960, bet=0, status=active
2025-10-31 18:45:43,678 - poker_game - INFO -   P4(Agent4): chips=6000, bet=0, status=active
2025-10-31 18:45:43,679 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:45:43,679 - poker_game - INFO - ==================================================
2025-10-31 18:45:43,681 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "J♣",
    "A♥"
  ],
  "community": [
    "J♠",
    "6♣",
    "K♦"
  ],
  "your_chips": 6000,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1980,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1960,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6000)"
  ],
  "history": [
    "Player 4 raised to 1445",
    "Player 0 called 1445",
    "Player 2 called 1445",
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦"
  ]
}
2025-10-31 18:45:43,701 - poker_game - DEBUG - Create Session: {'id': '5fe7325b-7bed-4928-bafa-2253e6f3c776', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903943.698075}
2025-10-31 18:45:53,744 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:45:58,939 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_jjTqd8zSo3EDkknb0zFdaedt', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1328, 'totalTokenCount': 1345}, 'invocationId': 'e-9cf92b54-5f37-413b-8f0f-3292afacb612', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'V5vBHzPx', 'timestamp': 1761903943.713933}, {'content': {'parts': [{'functionResponse': {'id': 'call_jjTqd8zSo3EDkknb0zFdaedt', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-9cf92b54-5f37-413b-8f0f-3292afacb612', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'dZDHyoEh', 'timestamp': 1761903949.728875}, {'content': {'parts': [{'functionCall': {'id': 'call_I8XKqUlN7EpUKcrtCoyUs7q2', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_bSYM7O4dDFE5iIQdwzgOGwll', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['J♣', 'A♥'], 'community': ['J♠', '6♣', 'K♦'], 'your_chips': 6000, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1980, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1960, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6000)'], 'history': ['Player 4 raised to 1445', 'Player 0 called 1445', 'Player 2 called 1445', 'River dealt: 4♠', 'Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥', 'Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦', 'Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥', 'Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥', 'Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: J♠, 6♣, K♦']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.8}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 587, 'promptTokenCount': 1852, 'totalTokenCount': 2439}, 'invocationId': 'e-9cf92b54-5f37-413b-8f0f-3292afacb612', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'nL49dXZY', 'timestamp': 1761903949.730778}, {'content': {'parts': [{'functionResponse': {'id': 'call_I8XKqUlN7EpUKcrtCoyUs7q2', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_bSYM7O4dDFE5iIQdwzgOGwll', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 39, 'reasoning': '期待値が高い（48.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 39'}}}], 'role': 'user'}, 'invocationId': 'T7k03MyK', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'b1hXjflg', 'timestamp': 1761903956.111405}, {'content': {'parts': [{'text': '{"action":"raise","amount":39,"reasoning":"期待値が高い(48.00(ポットに対して80.00%))ため、2/3ポットでベットします。ベット額: 39"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 52, 'promptTokenCount': 2596, 'totalTokenCount': 2648}, 'invocationId': 'e-9cf92b54-5f37-413b-8f0f-3292afacb612', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'i6d0708Q', 'timestamp': 1761903956.113973}]
2025-10-31 18:45:58,942 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:45:58,942 - poker_game - DEBUG - {"action":"raise","amount":39,"reasoning":"期待値が高い(48.00(ポットに対して80.00%))ため、2/3ポットでベットします。ベット額: 39"}
2025-10-31 18:45:58,943 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:45:58,943 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":39,"reasoning":"期待値が高い(48.00(ポットに対して80.00%))ため、2/3ポットでベットします。ベット額: 39"}'
2025-10-31 18:45:58,943 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:45:58,944 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":39,"reasoning":"期待値が高い(48.00(ポットに対して80.00%))ため、2/3ポットでベットします。ベット額: 39"}
2025-10-31 18:45:58,944 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 39, 'reasoning': '期待値が高い(48.00(ポットに対して80.00%))ため、2/3ポットでベットします。ベット額: 39'}
2025-10-31 18:45:58,944 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 39
2025-10-31 18:45:58,944 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (6000)']
2025-10-31 18:45:58,944 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:45:58,944 - poker_game - DEBUG - [Agent4] Raise amount 39 is valid (min: 20)
2025-10-31 18:45:58,944 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 39}
2025-10-31 18:45:58,944 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 39, 期待値が高い(48.00(ポットに対して80.00%))ため、2/3ポットでベットします。ベット額: 39
2025-10-31 18:45:58,947 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 39
2025-10-31 18:45:58,948 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:45:58,948 - poker_game - INFO - Hand #3, Phase: flop
2025-10-31 18:45:58,948 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:45:58,948 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:45:58,949 - poker_game - INFO - Last raiser: None
2025-10-31 18:45:58,949 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:58,949 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:58,949 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦']
2025-10-31 18:45:58,949 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:58,949 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:45:58,950 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:58,950 - poker_game - INFO -   P3(Agent3): chips=1960, bet=0, status=active
2025-10-31 18:45:58,950 - poker_game - INFO -   P4(Agent4): chips=6000, bet=0, status=active
2025-10-31 18:45:58,950 - poker_game - INFO - ==================================================
2025-10-31 18:45:58,950 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 39
2025-10-31 18:45:58,962 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:45:58,963 - poker_game - INFO - Hand #3, Phase: flop
2025-10-31 18:45:58,963 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:45:58,963 - poker_game - INFO - Pot: 99, Current bet: 39
2025-10-31 18:45:58,963 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:58,963 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:58,963 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:58,964 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦']
2025-10-31 18:45:58,964 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:58,964 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:45:58,964 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:58,964 - poker_game - INFO -   P3(Agent3): chips=1960, bet=0, status=active
2025-10-31 18:45:58,964 - poker_game - INFO -   P4(Agent4): chips=5961, bet=39, status=active
2025-10-31 18:45:58,964 - poker_game - INFO - Extra: Action: Player 4 raised to 39
2025-10-31 18:45:58,964 - poker_game - INFO - ==================================================
2025-10-31 18:45:58,965 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:45:58,965 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:45:58,965 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:45:58,965 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:45:58,965 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:45:58,965 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:45:58,965 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:45:58,966 - poker_game - DEBUG - Player bets: [0, 39], Current bet: 39, All same: False
2025-10-31 18:45:58,966 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:45:58,966 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:45:58,966 - poker_game - INFO - Hand #3, Phase: flop
2025-10-31 18:45:58,967 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:45:58,967 - poker_game - INFO - Pot: 99, Current bet: 39
2025-10-31 18:45:58,967 - poker_game - INFO - Last raiser: 4
2025-10-31 18:45:58,967 - poker_game - INFO - Betting round complete: False
2025-10-31 18:45:58,967 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:45:58,967 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦']
2025-10-31 18:45:58,967 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:45:58,967 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:45:58,967 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:45:58,968 - poker_game - INFO -   P3(Agent3): chips=1960, bet=0, status=active
2025-10-31 18:45:58,968 - poker_game - INFO -   P4(Agent4): chips=5961, bet=39, status=active
2025-10-31 18:45:58,968 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:45:58,968 - poker_game - INFO - ==================================================
2025-10-31 18:45:59,070 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "3♣",
    "Q♦"
  ],
  "community": [
    "J♠",
    "6♣",
    "K♦"
  ],
  "your_chips": 1960,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 99,
  "to_call": 39,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1980,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5961,
      "bet": 39,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (39)",
    "raise (min 59)",
    "all-in (1960)"
  ],
  "history": [
    "Player 0 called 1445",
    "Player 2 called 1445",
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39"
  ]
}
2025-10-31 18:45:59,080 - poker_game - DEBUG - Create Session: {'id': '5ffcb768-c87e-4562-a701-338143faaf74', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761903959.0777032}
2025-10-31 18:46:01,312 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 39,\n  "reasoning": "フロップ（3枚のコミュニティカードが開かれた段階）で、あなたの手札は3♣Q♦、コミュニティカードはJ♠6♣K♦です。あなたの手札には強い役はできていません。しかし、相手（プレイヤー4）のベット額39に対して、コール（相手と同じ額を支払うこと）に必要な額は39です。ポットサイズ（勝負で争われるチップの総額）は99なので、コールして次のカード（ターン）を見る価値はあると判断しました。フォールド（降りる）するには惜しい状況です。レイズ（さらにベット額を上げる）するには、あなたの手札の強さが足りません。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 173, 'promptTokenCount': 996, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 996}], 'totalTokenCount': 1169}, 'invocationId': 'e-a306bea4-6c4c-472b-a581-a9aa93e73c3b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'TD6LyWZu', 'timestamp': 1761903959.087736}]
2025-10-31 18:46:01,313 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:46:01,313 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 39,
  "reasoning": "フロップ（3枚のコミュニティカードが開かれた段階）で、あなたの手札は3♣Q♦、コミュニティカードはJ♠6♣K♦です。あなたの手札には強い役はできていません。しかし、相手（プレイヤー4）のベット額39に対して、コール（相手と同じ額を支払うこと）に必要な額は39です。ポットサイズ（勝負で争われるチップの総額）は99なので、コールして次のカード（ターン）を見る価値はあると判断しました。フォールド（降りる）するには惜しい状況です。レイズ（さらにベット額を上げる）するには、あなたの手札の強さが足りません。"
}
```
2025-10-31 18:46:01,314 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:46:01,314 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 39,\n  "reasoning": "フロップ（3枚のコミュニティカードが開かれた段階）で、あなたの手札は3♣Q♦、コミュニティカードはJ♠6♣K♦です。あなたの手札には強い役はできていません。しかし、相手（プレイヤー4）のベット額39に対して、コール（相手と同じ額を支払うこと）に必要な額は39です。ポットサイズ（勝負で争われるチップの総額）は99なので、コールして次のカード（ターン）を見る価値はあると判断しました。フォールド（降りる）するには惜しい状況です。レイズ（さらにベット額を上げる）するには、あなたの手札の強さが足りません。"\n}\n```'
2025-10-31 18:46:01,315 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:46:01,315 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 39,\n  "reasoning": "フロップ（3枚のコミュニティカードが開かれた段階）で、あなたの手札は3♣Q♦、コミュニティカードはJ♠6♣K♦です。あなたの手札には強い役はできていません。しかし、相手（プレイヤー4）のベット額39に対して、コール（相手と同じ額を支払うこと）に必要な額は39です。ポットサイズ（勝負で争われるチップの総額）は99なので、コールして次のカード（ターン）を見る価値はあると判断しました。フォールド（降りる）するには惜しい状況です。レイズ（さらにベット額を上げる）するには、あなたの手札の強さが足りません。"\n}'
2025-10-31 18:46:01,315 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 39,
  "reasoning": "フロップ（3枚のコミュニティカードが開かれた段階）で、あなたの手札は3♣Q♦、コミュニティカードはJ♠6♣K♦です。あなたの手札には強い役はできていません。しかし、相手（プレイヤー4）のベット額39に対して、コール（相手と同じ額を支払うこと）に必要な額は39です。ポットサイズ（勝負で争われるチップの総額）は99なので、コールして次のカード（ターン）を見る価値はあると判断しました。フォールド（降りる）するには惜しい状況です。レイズ（さらにベット額を上げる）するには、あなたの手札の強さが足りません。"
}
2025-10-31 18:46:01,316 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 39, 'reasoning': 'フロップ（3枚のコミュニティカードが開かれた段階）で、あなたの手札は3♣Q♦、コミュニティカードはJ♠6♣K♦です。あなたの手札には強い役はできていません。しかし、相手（プレイヤー4）のベット額39に対して、コール（相手と同じ額を支払うこと）に必要な額は39です。ポットサイズ（勝負で争われるチップの総額）は99なので、コールして次のカード（ターン）を見る価値はあると判断しました。フォールド（降りる）するには惜しい状況です。レイズ（さらにベット額を上げる）するには、あなたの手札の強さが足りません。'}
2025-10-31 18:46:01,316 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 39
2025-10-31 18:46:01,316 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (39)', 'raise (min 59)', 'all-in (1960)']
2025-10-31 18:46:01,316 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (39)': 39
2025-10-31 18:46:01,316 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 39}
2025-10-31 18:46:01,316 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 39, フロップ（3枚のコミュニティカードが開かれた段階）で、あなたの手札は3♣Q♦、コミュニティカードはJ♠6♣K♦です。あなたの手札には強い役はできていません。しかし、相手（プレイヤー4）のベット額39に対して、コール（相手と同じ額を支払うこと）に必要な額は39です。ポットサイズ（勝負で争われるチップの総額）は99なので、コールして次のカード（ターン）を見る価値はあると判断しました。フォールド（降りる）するには惜しい状況です。レイズ（さらにベット額を上げる）するには、あなたの手札の強さが足りません。
2025-10-31 18:46:01,319 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 39
2025-10-31 18:46:01,319 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:01,320 - poker_game - INFO - Hand #3, Phase: flop
2025-10-31 18:46:01,320 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:46:01,320 - poker_game - INFO - Pot: 99, Current bet: 39
2025-10-31 18:46:01,320 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:01,321 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:01,321 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:01,321 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦']
2025-10-31 18:46:01,321 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:01,322 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:01,322 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:01,322 - poker_game - INFO -   P3(Agent3): chips=1960, bet=0, status=active
2025-10-31 18:46:01,322 - poker_game - INFO -   P4(Agent4): chips=5961, bet=39, status=active
2025-10-31 18:46:01,322 - poker_game - INFO - ==================================================
2025-10-31 18:46:01,323 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 39
2025-10-31 18:46:01,340 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:01,341 - poker_game - INFO - Hand #3, Phase: flop
2025-10-31 18:46:01,341 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:46:01,341 - poker_game - INFO - Pot: 138, Current bet: 39
2025-10-31 18:46:01,342 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:01,342 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:01,343 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:01,343 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦']
2025-10-31 18:46:01,343 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:01,344 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:01,344 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:01,344 - poker_game - INFO -   P3(Agent3): chips=1921, bet=39, status=active
2025-10-31 18:46:01,344 - poker_game - INFO -   P4(Agent4): chips=5961, bet=39, status=active
2025-10-31 18:46:01,345 - poker_game - INFO - Extra: Action: Player 3 called 39
2025-10-31 18:46:01,345 - poker_game - INFO - ==================================================
2025-10-31 18:46:01,346 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:01,346 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:01,346 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:46:01,346 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:46:01,346 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:01,346 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:01,346 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:46:01,347 - poker_game - DEBUG - Player bets: [39, 39], Current bet: 39, All same: True
2025-10-31 18:46:01,347 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:46:01,347 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:01,347 - poker_game - INFO - Hand #3, Phase: flop
2025-10-31 18:46:01,347 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:46:01,348 - poker_game - INFO - Pot: 138, Current bet: 39
2025-10-31 18:46:01,348 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:01,348 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:01,348 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:01,348 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦']
2025-10-31 18:46:01,349 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:01,349 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:01,349 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:01,349 - poker_game - INFO -   P3(Agent3): chips=1921, bet=39, status=active
2025-10-31 18:46:01,349 - poker_game - INFO -   P4(Agent4): chips=5961, bet=39, status=active
2025-10-31 18:46:01,349 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:46:01,350 - poker_game - INFO - ==================================================
2025-10-31 18:46:01,451 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:46:01,451 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:01,451 - poker_game - INFO - Remaining players: 2
2025-10-31 18:46:01,452 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:46:01,452 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:46:01,452 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:46:01,464 - poker_game - INFO - Starting new betting round
2025-10-31 18:46:01,464 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:46:01,465 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:46:01,465 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:46:01,465 - poker_game - DEBUG - Dealer button: 3
2025-10-31 18:46:01,465 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 18:46:01,466 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:46:01,466 - poker_game - INFO - Hand #3, Phase: turn
2025-10-31 18:46:01,466 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:46:01,467 - poker_game - INFO - Pot: 138, Current bet: 0
2025-10-31 18:46:01,467 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:01,467 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:01,468 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:01,468 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:01,469 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:01,469 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:01,469 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:01,470 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=active
2025-10-31 18:46:01,470 - poker_game - INFO -   P4(Agent4): chips=5961, bet=0, status=active
2025-10-31 18:46:01,470 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:46:01,471 - poker_game - INFO - ==================================================
2025-10-31 18:46:01,472 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "J♣",
    "A♥"
  ],
  "community": [
    "J♠",
    "6♣",
    "K♦",
    "8♣"
  ],
  "your_chips": 5961,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 59,
  "pot": 138,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1980,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1921,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5961)"
  ],
  "history": [
    "River dealt: 4♠",
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣"
  ]
}
2025-10-31 18:46:01,503 - poker_game - DEBUG - Create Session: {'id': '58556664-c557-420a-97f6-009399415f97', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903961.500494}
2025-10-31 18:46:11,676 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:46:15,005 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_f1jcjxV1tgGiVbbjLtIF2wKq', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1331, 'totalTokenCount': 1348}, 'invocationId': 'e-5e99a90f-087e-41c7-9874-f6e4f44b4cc8', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Db387UVp', 'timestamp': 1761903961.522494}, {'content': {'parts': [{'functionResponse': {'id': 'call_f1jcjxV1tgGiVbbjLtIF2wKq', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-5e99a90f-087e-41c7-9874-f6e4f44b4cc8', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'UtNhuTyU', 'timestamp': 1761903962.488131}, {'content': {'parts': [{'functionCall': {'id': 'call_k9sch7v06lPlrSIFUG3PdTzj', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_lNV2jUfrTJE58F2kE95nIvaf', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['J♣', 'A♥'], 'community': ['J♠', '6♣', 'K♦', '8♣'], 'your_chips': 5961, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 59, 'pot': 138, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1980, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1921, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (5961)'], 'history': ['River dealt: 4♠', 'Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥', 'Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦', 'Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥', 'Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥', 'Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: J♠, 6♣, K♦', 'Player 4 raised to 39', 'Player 3 called 39', 'Turn dealt: 8♣']}, 'call_amount': 0, 'pot_after_call': 138, 'equity': 0.79}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 588, 'promptTokenCount': 1855, 'totalTokenCount': 2443}, 'invocationId': 'e-5e99a90f-087e-41c7-9874-f6e4f44b4cc8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'OWXw5AKW', 'timestamp': 1761903962.489698}, {'content': {'parts': [{'functionResponse': {'id': 'call_k9sch7v06lPlrSIFUG3PdTzj', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_lNV2jUfrTJE58F2kE95nIvaf', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 91, 'reasoning': '期待値が高い（109.02(ポットに対して79.00%）ため、2/3ポットでベットします。ベット額: 91'}}}], 'role': 'user'}, 'invocationId': 'IK3zeKyz', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'SRU919Df', 'timestamp': 1761903972.508004}, {'content': {'parts': [{'text': '{"action":"raise","amount":91,"reasoning":"期待値が高い(109.02(ポットに対して79.00%)ため、2/3ポットでベットします。ベット額: 91"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 51, 'promptTokenCount': 2600, 'totalTokenCount': 2651}, 'invocationId': 'e-5e99a90f-087e-41c7-9874-f6e4f44b4cc8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'W5iMjCoP', 'timestamp': 1761903972.515183}]
2025-10-31 18:46:15,007 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:46:15,007 - poker_game - DEBUG - {"action":"raise","amount":91,"reasoning":"期待値が高い(109.02(ポットに対して79.00%)ため、2/3ポットでベットします。ベット額: 91"}
2025-10-31 18:46:15,008 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:46:15,008 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":91,"reasoning":"期待値が高い(109.02(ポットに対して79.00%)ため、2/3ポットでベットします。ベット額: 91"}'
2025-10-31 18:46:15,009 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:46:15,009 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":91,"reasoning":"期待値が高い(109.02(ポットに対して79.00%)ため、2/3ポットでベットします。ベット額: 91"}
2025-10-31 18:46:15,009 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 91, 'reasoning': '期待値が高い(109.02(ポットに対して79.00%)ため、2/3ポットでベットします。ベット額: 91'}
2025-10-31 18:46:15,009 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 91
2025-10-31 18:46:15,009 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (5961)']
2025-10-31 18:46:15,009 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:46:15,009 - poker_game - DEBUG - [Agent4] Raise amount 91 is valid (min: 20)
2025-10-31 18:46:15,010 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 91}
2025-10-31 18:46:15,010 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 91, 期待値が高い(109.02(ポットに対して79.00%)ため、2/3ポットでベットします。ベット額: 91
2025-10-31 18:46:15,012 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 91
2025-10-31 18:46:15,013 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:15,014 - poker_game - INFO - Hand #3, Phase: turn
2025-10-31 18:46:15,014 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:46:15,016 - poker_game - INFO - Pot: 138, Current bet: 0
2025-10-31 18:46:15,016 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:15,017 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:15,017 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:15,018 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:15,018 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:15,018 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:15,019 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:15,019 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=active
2025-10-31 18:46:15,020 - poker_game - INFO -   P4(Agent4): chips=5961, bet=0, status=active
2025-10-31 18:46:15,020 - poker_game - INFO - ==================================================
2025-10-31 18:46:15,020 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 91
2025-10-31 18:46:15,032 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:15,033 - poker_game - INFO - Hand #3, Phase: turn
2025-10-31 18:46:15,033 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:46:15,034 - poker_game - INFO - Pot: 229, Current bet: 91
2025-10-31 18:46:15,035 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:15,035 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:15,036 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:15,036 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:15,036 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:15,037 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:15,037 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:15,037 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=active
2025-10-31 18:46:15,038 - poker_game - INFO -   P4(Agent4): chips=5870, bet=91, status=active
2025-10-31 18:46:15,038 - poker_game - INFO - Extra: Action: Player 4 raised to 91
2025-10-31 18:46:15,038 - poker_game - INFO - ==================================================
2025-10-31 18:46:15,039 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:15,039 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:15,040 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:46:15,040 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:46:15,040 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:15,041 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:15,041 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:46:15,041 - poker_game - DEBUG - Player bets: [0, 91], Current bet: 91, All same: False
2025-10-31 18:46:15,042 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:46:15,042 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:15,042 - poker_game - INFO - Hand #3, Phase: turn
2025-10-31 18:46:15,043 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:46:15,043 - poker_game - INFO - Pot: 229, Current bet: 91
2025-10-31 18:46:15,043 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:15,044 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:15,044 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:15,045 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:15,045 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:15,046 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:15,047 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:15,048 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=active
2025-10-31 18:46:15,048 - poker_game - INFO -   P4(Agent4): chips=5870, bet=91, status=active
2025-10-31 18:46:15,049 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:46:15,049 - poker_game - INFO - ==================================================
2025-10-31 18:46:15,151 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "3♣",
    "Q♦"
  ],
  "community": [
    "J♠",
    "6♣",
    "K♦",
    "8♣"
  ],
  "your_chips": 1921,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 59,
  "pot": 229,
  "to_call": 91,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1980,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5870,
      "bet": 91,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (91)",
    "raise (min 111)",
    "all-in (1921)"
  ],
  "history": [
    "Showdown: Player 0 hand=Two Pair: 4s and 3s - K♥, 4♣, 4♠, 3♣, 3♥ cards=J♥, K♥",
    "Showdown: Player 2 hand=Two Pair: 4s and 3s - 10♠, 4♣, 4♠, 3♣, 3♥ cards=5♥, 8♦",
    "Showdown: Player 4 hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥ cards=3♠, 8♥",
    "Side pot layer 0: amount=40, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91"
  ]
}
2025-10-31 18:46:15,162 - poker_game - DEBUG - Create Session: {'id': '149b929f-9fa3-4572-9e61-6f8292dc647c', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761903975.1596}
2025-10-31 18:46:17,349 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "私は「J♠, 6♣, K♦, 8♣」のコミュニティカードに対して、「3♣, Q♦」という手札を持っています。これはペアもストレートもフラッシュも作れない、弱い手札です。相手（プレイヤー4）はすでにベットをしており、コールするには91チップ必要ですが、勝てる見込みは低いため、フォールドを選択します。 相手のチップ量が多く、過去の履歴からもアグレッシブなプレイヤーである可能性が示唆されます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 139, 'promptTokenCount': 1001, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 1001}], 'totalTokenCount': 1140}, 'invocationId': 'e-aca31e3e-fc45-4ebd-81b6-2ea9c582b194', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'oYYxiKCK', 'timestamp': 1761903975.177338}]
2025-10-31 18:46:17,350 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:46:17,350 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "私は「J♠, 6♣, K♦, 8♣」のコミュニティカードに対して、「3♣, Q♦」という手札を持っています。これはペアもストレートもフラッシュも作れない、弱い手札です。相手（プレイヤー4）はすでにベットをしており、コールするには91チップ必要ですが、勝てる見込みは低いため、フォールドを選択します。 相手のチップ量が多く、過去の履歴からもアグレッシブなプレイヤーである可能性が示唆されます。"
}
```
2025-10-31 18:46:17,350 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:46:17,350 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "私は「J♠, 6♣, K♦, 8♣」のコミュニティカードに対して、「3♣, Q♦」という手札を持っています。これはペアもストレートもフラッシュも作れない、弱い手札です。相手（プレイヤー4）はすでにベットをしており、コールするには91チップ必要ですが、勝てる見込みは低いため、フォールドを選択します。 相手のチップ量が多く、過去の履歴からもアグレッシブなプレイヤーである可能性が示唆されます。"\n}\n```'
2025-10-31 18:46:17,351 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:46:17,351 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "私は「J♠, 6♣, K♦, 8♣」のコミュニティカードに対して、「3♣, Q♦」という手札を持っています。これはペアもストレートもフラッシュも作れない、弱い手札です。相手（プレイヤー4）はすでにベットをしており、コールするには91チップ必要ですが、勝てる見込みは低いため、フォールドを選択します。 相手のチップ量が多く、過去の履歴からもアグレッシブなプレイヤーである可能性が示唆されます。"\n}'
2025-10-31 18:46:17,351 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "私は「J♠, 6♣, K♦, 8♣」のコミュニティカードに対して、「3♣, Q♦」という手札を持っています。これはペアもストレートもフラッシュも作れない、弱い手札です。相手（プレイヤー4）はすでにベットをしており、コールするには91チップ必要ですが、勝てる見込みは低いため、フォールドを選択します。 相手のチップ量が多く、過去の履歴からもアグレッシブなプレイヤーである可能性が示唆されます。"
}
2025-10-31 18:46:17,351 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '私は「J♠, 6♣, K♦, 8♣」のコミュニティカードに対して、「3♣, Q♦」という手札を持っています。これはペアもストレートもフラッシュも作れない、弱い手札です。相手（プレイヤー4）はすでにベットをしており、コールするには91チップ必要ですが、勝てる見込みは低いため、フォールドを選択します。 相手のチップ量が多く、過去の履歴からもアグレッシブなプレイヤーである可能性が示唆されます。'}
2025-10-31 18:46:17,351 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:46:17,351 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:46:17,351 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:46:17,352 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, 私は「J♠, 6♣, K♦, 8♣」のコミュニティカードに対して、「3♣, Q♦」という手札を持っています。これはペアもストレートもフラッシュも作れない、弱い手札です。相手（プレイヤー4）はすでにベットをしており、コールするには91チップ必要ですが、勝てる見込みは低いため、フォールドを選択します。 相手のチップ量が多く、過去の履歴からもアグレッシブなプレイヤーである可能性が示唆されます。
2025-10-31 18:46:17,352 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:46:17,352 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:17,353 - poker_game - INFO - Hand #3, Phase: turn
2025-10-31 18:46:17,353 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:46:17,353 - poker_game - INFO - Pot: 229, Current bet: 91
2025-10-31 18:46:17,353 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:17,353 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:17,354 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:17,354 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:17,354 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:17,354 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:17,354 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:17,355 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=active
2025-10-31 18:46:17,355 - poker_game - INFO -   P4(Agent4): chips=5870, bet=91, status=active
2025-10-31 18:46:17,355 - poker_game - INFO - ==================================================
2025-10-31 18:46:17,355 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:46:17,363 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:17,364 - poker_game - INFO - Hand #3, Phase: turn
2025-10-31 18:46:17,364 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:46:17,364 - poker_game - INFO - Pot: 229, Current bet: 91
2025-10-31 18:46:17,364 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:17,365 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:17,365 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:46:17,365 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:17,366 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:17,366 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:17,366 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:17,366 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=folded
2025-10-31 18:46:17,367 - poker_game - INFO -   P4(Agent4): chips=5870, bet=91, status=active
2025-10-31 18:46:17,367 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:46:17,367 - poker_game - INFO - ==================================================
2025-10-31 18:46:17,368 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:17,368 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:17,368 - poker_game - DEBUG - Active players: [4]
2025-10-31 18:46:17,368 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:46:17,368 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:17,368 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:17,369 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:46:17,369 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:46:17,369 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:17,369 - poker_game - INFO - Hand #3, Phase: turn
2025-10-31 18:46:17,370 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:46:17,370 - poker_game - INFO - Pot: 229, Current bet: 91
2025-10-31 18:46:17,370 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:17,371 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:17,371 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:46:17,371 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:17,371 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:17,372 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:17,373 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:17,374 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=folded
2025-10-31 18:46:17,375 - poker_game - INFO -   P4(Agent4): chips=5870, bet=91, status=active
2025-10-31 18:46:17,376 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:46:17,376 - poker_game - INFO - ==================================================
2025-10-31 18:46:17,477 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:46:17,477 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:17,478 - poker_game - INFO - Remaining players: 1
2025-10-31 18:46:17,478 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:46:17,479 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:46:17,479 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:46:17,480 - poker_game - INFO - Hand #3, Phase: showdown
2025-10-31 18:46:17,480 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:46:17,480 - poker_game - INFO - Pot: 229, Current bet: 91
2025-10-31 18:46:17,481 - poker_game - INFO - Last raiser: 4
2025-10-31 18:46:17,481 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:17,482 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:46:17,482 - poker_game - INFO - Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:17,483 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:17,483 - poker_game - INFO -   P1(Agent1): chips=1980, bet=0, status=folded
2025-10-31 18:46:17,484 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:17,484 - poker_game - INFO -   P3(Agent3): chips=1921, bet=0, status=folded
2025-10-31 18:46:17,484 - poker_game - INFO -   P4(Agent4): chips=5870, bet=91, status=active
2025-10-31 18:46:17,485 - poker_game - INFO - ==================================================
2025-10-31 18:46:17,486 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:46:17,487 - poker_game - INFO - Pot: 229, Community cards: ['J♠', '6♣', 'K♦', '8♣']
2025-10-31 18:46:17,488 - poker_game - INFO -   Player 4 status=active cards=['J♣', 'A♥']
2025-10-31 18:46:17,489 - poker_game - INFO - Showdown winner by default: Player 4 awarded 229
2025-10-31 18:46:17,490 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:46:17,491 - poker_game - INFO - === STARTING NEW HAND #4 ===
2025-10-31 18:46:17,492 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:46:17,493 - poker_game - INFO - Moving dealer button
2025-10-31 18:46:17,494 - poker_game - INFO - Posting blinds
2025-10-31 18:46:17,516 - poker_game - INFO - Dealing hole cards
2025-10-31 18:46:17,516 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:46:17,528 - poker_game - INFO - Started new hand in database: hand_id=4
2025-10-31 18:46:17,529 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:46:17,530 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:17,530 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:17,530 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:46:17,531 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:17,531 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:17,531 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:46:17,532 - poker_game - INFO - Community cards: []
2025-10-31 18:46:17,532 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:17,532 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=active
2025-10-31 18:46:17,533 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:17,534 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:17,535 - poker_game - INFO -   P4(Agent4): chips=6099, bet=0, status=active
2025-10-31 18:46:17,536 - poker_game - INFO - ==================================================
2025-10-31 18:46:17,537 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "3♦",
    "Q♣"
  ],
  "community": [],
  "your_chips": 6099,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1901,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (6099)"
  ],
  "history": [
    "Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 18:46:17,550 - poker_game - DEBUG - Create Session: {'id': '6ad2293e-d102-4691-8e0c-88a73346080a', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903977.5472622}
2025-10-31 18:46:27,706 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:46:30,088 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_mUNrvkPdJRhqdsN3rcA5lKrT', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1140, 'totalTokenCount': 1157}, 'invocationId': 'e-ad3d9ef4-ebda-4ad5-94ce-665fa18cf884', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'QxUatX4w', 'timestamp': 1761903977.564037}, {'content': {'parts': [{'functionResponse': {'id': 'call_mUNrvkPdJRhqdsN3rcA5lKrT', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-ad3d9ef4-ebda-4ad5-94ce-665fa18cf884', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'VmYMrrIC', 'timestamp': 1761903978.813748}, {'content': {'parts': [{'functionCall': {'id': 'call_AKtMpGqOia3kbcGdSkhQu80e', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_Obk7hBZhjzXIWdti6rpuWKFZ', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['3♦', 'Q♣'], 'community': [], 'your_chips': 6099, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1970, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 1901, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (6099)]', 'history:[', 'Side pot layer 1: amount=5970, winners=4 best_hand=Full House: 3s over 4s - 4♣, 4♠, 3♠, 3♣, 3♥', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: J♠, 6♣, K♦', 'Player 4 raised to 39', 'Player 3 called 39', 'Turn dealt: 8♣', 'Player 4 raised to 91', 'Player 3 folded', 'Showdown: Player 4 won 229', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 405, 'promptTokenCount': 1664, 'totalTokenCount': 2069}, 'invocationId': 'e-ad3d9ef4-ebda-4ad5-94ce-665fa18cf884', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 't7XGv4zn', 'timestamp': 1761903978.817548}, {'content': {'parts': [{'functionResponse': {'id': 'call_AKtMpGqOia3kbcGdSkhQu80e', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_Obk7hBZhjzXIWdti6rpuWKFZ', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 20, 'reasoning': 'ポットオッズを満たしており（8.00(ポットに対して26.67%）、コールが妥当と判断。コール額: 20'}}}], 'role': 'user'}, 'invocationId': '8bupUkeM', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Xabcb9sZ', 'timestamp': 1761903987.934737}, {'content': {'parts': [{'text': '{"action":"call","amount":20,"reasoning":"ポットを満たしおり（8.00(ポットに対して26.67%)）、コールが妥当と判定。コール額: 20"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 53, 'promptTokenCount': 2233, 'totalTokenCount': 2286}, 'invocationId': 'e-ad3d9ef4-ebda-4ad5-94ce-665fa18cf884', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'rRy0qQYY', 'timestamp': 1761903987.939022}]
2025-10-31 18:46:30,088 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:46:30,089 - poker_game - DEBUG - {"action":"call","amount":20,"reasoning":"ポットを満たしおり（8.00(ポットに対して26.67%)）、コールが妥当と判定。コール額: 20"}
2025-10-31 18:46:30,089 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:46:30,089 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":20,"reasoning":"ポットを満たしおり（8.00(ポットに対して26.67%)）、コールが妥当と判定。コール額: 20"}'
2025-10-31 18:46:30,089 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:46:30,089 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":20,"reasoning":"ポットを満たしおり（8.00(ポットに対して26.67%)）、コールが妥当と判定。コール額: 20"}
2025-10-31 18:46:30,089 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'ポットを満たしおり（8.00(ポットに対して26.67%)）、コールが妥当と判定。コール額: 20'}
2025-10-31 18:46:30,090 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 20
2025-10-31 18:46:30,090 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (6099)']
2025-10-31 18:46:30,090 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (20)': 20
2025-10-31 18:46:30,090 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:46:30,090 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 20, ポットを満たしおり（8.00(ポットに対して26.67%)）、コールが妥当と判定。コール額: 20
2025-10-31 18:46:30,091 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 20
2025-10-31 18:46:30,091 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:30,091 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:30,091 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:30,091 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:46:30,091 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:30,092 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:30,092 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:46:30,092 - poker_game - INFO - Community cards: []
2025-10-31 18:46:30,092 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:30,092 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=active
2025-10-31 18:46:30,093 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:30,093 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:30,093 - poker_game - INFO -   P4(Agent4): chips=6099, bet=0, status=active
2025-10-31 18:46:30,093 - poker_game - INFO - ==================================================
2025-10-31 18:46:30,093 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 20
2025-10-31 18:46:30,104 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:30,104 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:30,104 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:30,104 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:30,105 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:30,105 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:30,105 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:46:30,105 - poker_game - INFO - Community cards: []
2025-10-31 18:46:30,106 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:30,106 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=active
2025-10-31 18:46:30,106 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:30,107 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:30,107 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:30,107 - poker_game - INFO - Extra: Action: Player 4 called 20
2025-10-31 18:46:30,107 - poker_game - INFO - ==================================================
2025-10-31 18:46:30,108 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:30,108 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:30,108 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:46:30,108 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:46:30,109 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:30,109 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:30,109 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:46:30,109 - poker_game - DEBUG - Player bets: [10, 20, 20], Current bet: 20, All same: False
2025-10-31 18:46:30,109 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:46:30,110 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:30,110 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:30,110 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:46:30,110 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:30,111 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:30,111 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:30,111 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:46:30,111 - poker_game - INFO - Community cards: []
2025-10-31 18:46:30,112 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:30,113 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=active
2025-10-31 18:46:30,114 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:30,115 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:30,116 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:30,116 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:46:30,117 - poker_game - INFO - ==================================================
2025-10-31 18:46:30,221 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "9♠",
    "2♣"
  ],
  "community": [],
  "your_chips": 1970,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1901,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6079,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1970)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20"
  ]
}
2025-10-31 18:46:30,238 - poker_game - DEBUG - Create Session: {'id': '04c233b9-461b-4ec4-be32-12fc223bba97', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761903990.2343237}
2025-10-31 18:46:31,638 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで9ハイ・オフスーツ（異なるスートの9と2）は非常に弱いハンドです。ポットに参加するには、アグレッシブなプレイ（レイズ）も、ポットを守るためのコールも、このハンドでは価値がありません。したがって、フォールド（降りる）が最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 101, 'promptTokenCount': 780, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 780}], 'totalTokenCount': 881}, 'invocationId': 'e-c27ef926-1ebd-4fa7-92b3-4b07408281e8', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '0HOIGlR8', 'timestamp': 1761903990.253464}]
2025-10-31 18:46:31,638 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:46:31,639 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで9ハイ・オフスーツ（異なるスートの9と2）は非常に弱いハンドです。ポットに参加するには、アグレッシブなプレイ（レイズ）も、ポットを守るためのコールも、このハンドでは価値がありません。したがって、フォールド（降りる）が最善の選択です。"
}
```
2025-10-31 18:46:31,639 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:46:31,639 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで9ハイ・オフスーツ（異なるスートの9と2）は非常に弱いハンドです。ポットに参加するには、アグレッシブなプレイ（レイズ）も、ポットを守るためのコールも、このハンドでは価値がありません。したがって、フォールド（降りる）が最善の選択です。"\n}\n```'
2025-10-31 18:46:31,640 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:46:31,640 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで9ハイ・オフスーツ（異なるスートの9と2）は非常に弱いハンドです。ポットに参加するには、アグレッシブなプレイ（レイズ）も、ポットを守るためのコールも、このハンドでは価値がありません。したがって、フォールド（降りる）が最善の選択です。"\n}'
2025-10-31 18:46:31,640 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで9ハイ・オフスーツ（異なるスートの9と2）は非常に弱いハンドです。ポットに参加するには、アグレッシブなプレイ（レイズ）も、ポットを守るためのコールも、このハンドでは価値がありません。したがって、フォールド（降りる）が最善の選択です。"
}
2025-10-31 18:46:31,640 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップで9ハイ・オフスーツ（異なるスートの9と2）は非常に弱いハンドです。ポットに参加するには、アグレッシブなプレイ（レイズ）も、ポットを守るためのコールも、このハンドでは価値がありません。したがって、フォールド（降りる）が最善の選択です。'}
2025-10-31 18:46:31,641 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:46:31,641 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:46:31,641 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:46:31,641 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップで9ハイ・オフスーツ（異なるスートの9と2）は非常に弱いハンドです。ポットに参加するには、アグレッシブなプレイ（レイズ）も、ポットを守るためのコールも、このハンドでは価値がありません。したがって、フォールド（降りる）が最善の選択です。
2025-10-31 18:46:31,642 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:46:31,643 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:31,643 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:31,643 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:46:31,644 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:31,644 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:31,644 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:31,645 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:46:31,645 - poker_game - INFO - Community cards: []
2025-10-31 18:46:31,646 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:31,646 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=active
2025-10-31 18:46:31,646 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:31,647 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:31,647 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:31,647 - poker_game - INFO - ==================================================
2025-10-31 18:46:31,648 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:46:31,659 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:31,659 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:31,660 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:46:31,660 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:31,660 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:31,661 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:31,661 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:31,662 - poker_game - INFO - Community cards: []
2025-10-31 18:46:31,662 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:31,663 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=folded
2025-10-31 18:46:31,663 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:31,664 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:31,664 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:31,664 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:46:31,664 - poker_game - INFO - ==================================================
2025-10-31 18:46:31,665 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:31,665 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:31,666 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:46:31,666 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:46:31,666 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:31,667 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:31,667 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:46:31,667 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:46:31,667 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:46:31,667 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 18:46:31,668 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:46:31,668 - poker_game - DEBUG - Next after last raiser 3: 4
2025-10-31 18:46:31,668 - poker_game - DEBUG - Betting continues: Current player 3 != next after raiser 4
2025-10-31 18:46:31,668 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:31,668 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:31,669 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:31,669 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:31,669 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:31,670 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:31,670 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:31,671 - poker_game - INFO - Community cards: []
2025-10-31 18:46:31,671 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:31,671 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=folded
2025-10-31 18:46:31,672 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:31,672 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:31,673 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:31,673 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:46:31,674 - poker_game - INFO - ==================================================
2025-10-31 18:46:31,777 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "5♦",
    "J♥"
  ],
  "community": [],
  "your_chips": 1901,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 10,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6079,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (1901)"
  ],
  "history": [
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded"
  ]
}
2025-10-31 18:46:31,788 - poker_game - DEBUG - Create Session: {'id': '6b2876da-7e52-49e8-a192-0565dd818c8d', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761903991.786265}
2025-10-31 18:46:33,332 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、あなたの手札（J-5オフスーツ）は中程度の強さです。ポットに30（SB10+BB20）あり、コールするには20必要です。対戦相手はまだアクションしておらず、ポットオッズ（コールに必要な20に対してポットは30）は悪くありません。フロップ以降の展開を見て、より有利な状況でプレイできる可能性があります。したがって、コールを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 126, 'promptTokenCount': 771, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 771}], 'totalTokenCount': 897}, 'invocationId': 'e-e637c210-5f9c-484e-a4f1-1fc1e6076c86', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '2udB122X', 'timestamp': 1761903991.795538}]
2025-10-31 18:46:33,332 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:46:33,333 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで、あなたの手札（J-5オフスーツ）は中程度の強さです。ポットに30（SB10+BB20）あり、コールするには20必要です。対戦相手はまだアクションしておらず、ポットオッズ（コールに必要な20に対してポットは30）は悪くありません。フロップ以降の展開を見て、より有利な状況でプレイできる可能性があります。したがって、コールを選択します。"
}
```
2025-10-31 18:46:33,333 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:46:33,333 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、あなたの手札（J-5オフスーツ）は中程度の強さです。ポットに30（SB10+BB20）あり、コールするには20必要です。対戦相手はまだアクションしておらず、ポットオッズ（コールに必要な20に対してポットは30）は悪くありません。フロップ以降の展開を見て、より有利な状況でプレイできる可能性があります。したがって、コールを選択します。"\n}\n```'
2025-10-31 18:46:33,333 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:46:33,333 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、あなたの手札（J-5オフスーツ）は中程度の強さです。ポットに30（SB10+BB20）あり、コールするには20必要です。対戦相手はまだアクションしておらず、ポットオッズ（コールに必要な20に対してポットは30）は悪くありません。フロップ以降の展開を見て、より有利な状況でプレイできる可能性があります。したがって、コールを選択します。"\n}'
2025-10-31 18:46:33,333 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで、あなたの手札（J-5オフスーツ）は中程度の強さです。ポットに30（SB10+BB20）あり、コールするには20必要です。対戦相手はまだアクションしておらず、ポットオッズ（コールに必要な20に対してポットは30）は悪くありません。フロップ以降の展開を見て、より有利な状況でプレイできる可能性があります。したがって、コールを選択します。"
}
2025-10-31 18:46:33,334 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップで、あなたの手札（J-5オフスーツ）は中程度の強さです。ポットに30（SB10+BB20）あり、コールするには20必要です。対戦相手はまだアクションしておらず、ポットオッズ（コールに必要な20に対してポットは30）は悪くありません。フロップ以降の展開を見て、より有利な状況でプレイできる可能性があります。したがって、コールを選択します。'}
2025-10-31 18:46:33,334 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 20
2025-10-31 18:46:33,334 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (1901)']
2025-10-31 18:46:33,334 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:46:33,334 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 20, プリフロップで、あなたの手札（J-5オフスーツ）は中程度の強さです。ポットに30（SB10+BB20）あり、コールするには20必要です。対戦相手はまだアクションしておらず、ポットオッズ（コールに必要な20に対してポットは30）は悪くありません。フロップ以降の展開を見て、より有利な状況でプレイできる可能性があります。したがって、コールを選択します。
2025-10-31 18:46:33,335 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 20
2025-10-31 18:46:33,335 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:33,336 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:33,336 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:33,336 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:33,337 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:33,337 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:33,337 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:33,337 - poker_game - INFO - Community cards: []
2025-10-31 18:46:33,337 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:33,338 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=folded
2025-10-31 18:46:33,338 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:33,338 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:33,338 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:33,338 - poker_game - INFO - ==================================================
2025-10-31 18:46:33,339 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:46:33,353 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:33,353 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:33,354 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:33,354 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:33,354 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:33,354 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:33,354 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:33,354 - poker_game - INFO - Community cards: []
2025-10-31 18:46:33,355 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:33,355 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=folded
2025-10-31 18:46:33,355 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:33,355 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:33,355 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:33,356 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:46:33,356 - poker_game - INFO - ==================================================
2025-10-31 18:46:33,356 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:33,356 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:33,356 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:46:33,356 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:46:33,357 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:33,357 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:33,357 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:46:33,357 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:46:33,357 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:46:33,357 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 18:46:33,357 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:46:33,357 - poker_game - DEBUG - Next after last raiser 3: 4
2025-10-31 18:46:33,358 - poker_game - INFO - Betting complete: Back to player 4 after last raiser 3
2025-10-31 18:46:33,358 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:33,358 - poker_game - INFO - Hand #4, Phase: preflop
2025-10-31 18:46:33,359 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:33,359 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:46:33,359 - poker_game - INFO - Last raiser: 3
2025-10-31 18:46:33,359 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:33,359 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:33,360 - poker_game - INFO - Community cards: []
2025-10-31 18:46:33,360 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:33,360 - poker_game - INFO -   P1(Agent1): chips=1970, bet=10, status=folded
2025-10-31 18:46:33,360 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:33,360 - poker_game - INFO -   P3(Agent3): chips=1901, bet=20, status=active
2025-10-31 18:46:33,361 - poker_game - INFO -   P4(Agent4): chips=6079, bet=20, status=active
2025-10-31 18:46:33,361 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:46:33,361 - poker_game - INFO - ==================================================
2025-10-31 18:46:33,462 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:46:33,463 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:33,463 - poker_game - INFO - Remaining players: 2
2025-10-31 18:46:33,464 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:46:33,464 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:46:33,464 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:46:33,477 - poker_game - INFO - Starting new betting round
2025-10-31 18:46:33,477 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:46:33,478 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:46:33,478 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:46:33,478 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:46:33,479 - poker_game - INFO - First actor: Player 3 (by phase rule), was 4
2025-10-31 18:46:33,479 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:46:33,479 - poker_game - INFO - Hand #4, Phase: flop
2025-10-31 18:46:33,480 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:33,481 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:33,481 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:33,482 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:33,482 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:33,483 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣']
2025-10-31 18:46:33,483 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:33,484 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:33,484 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:33,484 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:33,484 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:33,485 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:46:33,485 - poker_game - INFO - ==================================================
2025-10-31 18:46:33,486 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "5♦",
    "J♥"
  ],
  "community": [
    "4♠",
    "J♠",
    "5♣"
  ],
  "your_chips": 1901,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6079,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1901)"
  ],
  "history": [
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣"
  ]
}
2025-10-31 18:46:33,501 - poker_game - DEBUG - Create Session: {'id': '0711d13c-23d8-44fa-ba38-2167bec0fe97', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761903993.4978197}
2025-10-31 18:46:35,268 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップでツーペア（Jと5）が完成しました。これは強いハンドなので、ベットがないためチェックし、相手のアクションを見てからコールします。相手がベットしてきた場合も、ツーペアは十分強いのでコールします。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 80, 'promptTokenCount': 793, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 793}], 'totalTokenCount': 873}, 'invocationId': 'e-8681b790-a209-4140-8a76-d18dff59cd0e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'i8s86hRh', 'timestamp': 1761903993.515387}]
2025-10-31 18:46:35,268 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:46:35,269 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "フロップでツーペア（Jと5）が完成しました。これは強いハンドなので、ベットがないためチェックし、相手のアクションを見てからコールします。相手がベットしてきた場合も、ツーペアは十分強いのでコールします。"
}
```
2025-10-31 18:46:35,269 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:46:35,269 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップでツーペア（Jと5）が完成しました。これは強いハンドなので、ベットがないためチェックし、相手のアクションを見てからコールします。相手がベットしてきた場合も、ツーペアは十分強いのでコールします。"\n}\n```'
2025-10-31 18:46:35,269 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:46:35,269 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップでツーペア（Jと5）が完成しました。これは強いハンドなので、ベットがないためチェックし、相手のアクションを見てからコールします。相手がベットしてきた場合も、ツーペアは十分強いのでコールします。"\n}'
2025-10-31 18:46:35,269 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "フロップでツーペア（Jと5）が完成しました。これは強いハンドなので、ベットがないためチェックし、相手のアクションを見てからコールします。相手がベットしてきた場合も、ツーペアは十分強いのでコールします。"
}
2025-10-31 18:46:35,270 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': 'フロップでツーペア（Jと5）が完成しました。これは強いハンドなので、ベットがないためチェックし、相手のアクションを見てからコールします。相手がベットしてきた場合も、ツーペアは十分強いのでコールします。'}
2025-10-31 18:46:35,271 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 0
2025-10-31 18:46:35,271 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1901)']
2025-10-31 18:46:35,271 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:46:35,271 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 0, フロップでツーペア（Jと5）が完成しました。これは強いハンドなので、ベットがないためチェックし、相手のアクションを見てからコールします。相手がベットしてきた場合も、ツーペアは十分強いのでコールします。
2025-10-31 18:46:35,275 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 0
2025-10-31 18:46:35,276 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:35,276 - poker_game - INFO - Hand #4, Phase: flop
2025-10-31 18:46:35,277 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:35,277 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:35,278 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:35,278 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:35,278 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:35,279 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣']
2025-10-31 18:46:35,279 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:35,280 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:35,280 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:35,280 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:35,281 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:35,281 - poker_game - INFO - ==================================================
2025-10-31 18:46:35,281 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:46:35,293 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:35,294 - poker_game - INFO - Hand #4, Phase: flop
2025-10-31 18:46:35,295 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:35,295 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:35,296 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:35,296 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:35,296 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:35,297 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣']
2025-10-31 18:46:35,297 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:35,298 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:35,299 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:35,299 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:35,300 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:35,300 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:46:35,300 - poker_game - INFO - ==================================================
2025-10-31 18:46:35,301 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:35,301 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:35,302 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:46:35,302 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:46:35,302 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:35,303 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:35,303 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:46:35,303 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:46:35,303 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:46:35,303 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:46:35,304 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:46:35,304 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:46:35,304 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:46:35,304 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:35,304 - poker_game - INFO - Hand #4, Phase: flop
2025-10-31 18:46:35,305 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:35,305 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:35,306 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:35,306 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:35,307 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:35,307 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣']
2025-10-31 18:46:35,308 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:35,308 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:35,308 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:35,309 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:35,309 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:35,309 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:46:35,310 - poker_game - INFO - ==================================================
2025-10-31 18:46:35,411 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "3♦",
    "Q♣"
  ],
  "community": [
    "4♠",
    "J♠",
    "5♣"
  ],
  "your_chips": 6079,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1901,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6079)"
  ],
  "history": [
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked"
  ]
}
2025-10-31 18:46:35,429 - poker_game - DEBUG - Create Session: {'id': '6f0625f1-dcec-4539-b7b4-891bb5cdabb3', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761903995.4261463}
2025-10-31 18:46:45,600 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:46:48,784 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_Qm26DIxLid9q9Cy6WKoZExwD', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1118, 'totalTokenCount': 1135}, 'invocationId': 'e-3f1de02f-cfc5-438d-a1fb-f9e085a4eb54', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ftBWggXD', 'timestamp': 1761903995.443957}, {'content': {'parts': [{'functionResponse': {'id': 'call_Qm26DIxLid9q9Cy6WKoZExwD', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-3f1de02f-cfc5-438d-a1fb-f9e085a4eb54', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'SG2DF8ij', 'timestamp': 1761903996.551558}, {'content': {'parts': [{'functionCall': {'id': 'call_hZ5fRBTRh97GAyFFfQmiHw0Q', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['3♦', 'Q♣'], 'community': ['4♠', 'J♠', '5♣'], 'your_chips': 6079, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 50, 'to_call': 0, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1970, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1901, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6079)'], 'history': ['Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: J♠, 6♣, K♦', 'Player 4 raised to 39', 'Player 3 called 39', 'Showdown: Player 4 won 229', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 checked', 'Flop dealt: 4♠, J♠, 5♣', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 50, 'equity': 0.4}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_34VM3zy99omkuhlRIVQr7zqt', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['3♦', 'Q♣'], 'community': ['4♠', 'J♠', '5♣'], 'your_chips': 6079, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 50, 'to_call': 0, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1970, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1901, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6079)'], 'history': ['Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: J♠, 6♣, K♦', 'Player 4 raised to 39', 'Player 3 called 39', 'Showdown: Player 4 won 229', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 checked', 'Flop dealt: 4♠, J♠, 5♣', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 50, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 656, 'promptTokenCount': 1642, 'totalTokenCount': 2298}, 'invocationId': 'e-3f1de02f-cfc5-438d-a1fb-f9e085a4eb54', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'hTOUOYqM', 'timestamp': 1761903996.557084}, {'content': {'parts': [{'functionResponse': {'id': 'call_hZ5fRBTRh97GAyFFfQmiHw0Q', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（20.00(ポットに対して40.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_34VM3zy99omkuhlRIVQr7zqt', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（20.00(ポットに対して40.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': '8NwsQZ46', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Cj5v6H80', 'timestamp': 1761904006.65847}, {'content': {'parts': [{'text': '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い（20.00(ポットに対して40.00%)ため、チェックします"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 47, 'promptTokenCount': 2524, 'totalTokenCount': 2571}, 'invocationId': 'e-3f1de02f-cfc5-438d-a1fb-f9e085a4eb54', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'qq3P83Gv', 'timestamp': 1761904006.663096}]
2025-10-31 18:46:48,785 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:46:48,785 - poker_game - DEBUG - {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い（20.00(ポットに対して40.00%)ため、チェックします"
}
2025-10-31 18:46:48,786 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:46:48,787 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い（20.00(ポットに対して40.00%)ため、チェックします"\n}'
2025-10-31 18:46:48,787 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:46:48,787 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い（20.00(ポットに対して40.00%)ため、チェックします"
}
2025-10-31 18:46:48,787 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（20.00(ポットに対して40.00%)ため、チェックします'}
2025-10-31 18:46:48,787 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:46:48,788 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:46:48,788 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:46:48,788 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（20.00(ポットに対して40.00%)ため、チェックします
2025-10-31 18:46:48,790 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:46:48,791 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:48,791 - poker_game - INFO - Hand #4, Phase: flop
2025-10-31 18:46:48,792 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:48,792 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:48,793 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:48,793 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:48,794 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:48,795 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣']
2025-10-31 18:46:48,795 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:48,796 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:48,796 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:48,797 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:48,797 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:48,798 - poker_game - INFO - ==================================================
2025-10-31 18:46:48,798 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:46:48,812 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:48,813 - poker_game - INFO - Hand #4, Phase: flop
2025-10-31 18:46:48,813 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:48,814 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:48,814 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:48,814 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:48,815 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:48,815 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣']
2025-10-31 18:46:48,816 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:48,816 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:48,816 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:48,817 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:48,817 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:48,818 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:46:48,818 - poker_game - INFO - ==================================================
2025-10-31 18:46:48,819 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:48,819 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:48,820 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:46:48,820 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:46:48,821 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:48,821 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:48,821 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:46:48,822 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:46:48,822 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:46:48,822 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:46:48,823 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:46:48,823 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:46:48,823 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 18:46:48,824 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:48,825 - poker_game - INFO - Hand #4, Phase: flop
2025-10-31 18:46:48,825 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:48,826 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:48,826 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:48,826 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:48,826 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:48,827 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣']
2025-10-31 18:46:48,827 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:48,827 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:48,828 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:48,828 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:48,829 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:48,829 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:46:48,829 - poker_game - INFO - ==================================================
2025-10-31 18:46:48,932 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:46:48,933 - poker_game - INFO - Betting round complete: True
2025-10-31 18:46:48,933 - poker_game - INFO - Remaining players: 2
2025-10-31 18:46:48,934 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:46:48,934 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:46:48,935 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:46:48,946 - poker_game - INFO - Starting new betting round
2025-10-31 18:46:48,946 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:46:48,947 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:46:48,947 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:46:48,947 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:46:48,948 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 18:46:48,948 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:46:48,949 - poker_game - INFO - Hand #4, Phase: turn
2025-10-31 18:46:48,950 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:48,950 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:48,951 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:48,951 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:48,951 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:48,952 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣']
2025-10-31 18:46:48,953 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:48,953 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:48,954 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:48,954 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:48,955 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:48,955 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:46:48,956 - poker_game - INFO - ==================================================
2025-10-31 18:46:48,957 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "5♦",
    "J♥"
  ],
  "community": [
    "4♠",
    "J♠",
    "5♣",
    "7♣"
  ],
  "your_chips": 1901,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6079,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1901)"
  ],
  "history": [
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣"
  ]
}
2025-10-31 18:46:48,968 - poker_game - DEBUG - Create Session: {'id': '07964132-85f0-44a2-8e01-40a0661b2bd7', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904008.9645483}
2025-10-31 18:46:50,827 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（4♠ J♠ 5♣ 7♣）で、あなたの手札（5♦ J♥）はツーペア（Jと5）を作っています。これは強いハンドですが、相手のハンドは不明です。相手がより強いツーペアやスリーカードを持っている可能性も考慮し、まずはチェックで様子を見ます。もし相手がベットしてきたら、その額に応じてコールするかフォールドするかを判断します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 121, 'promptTokenCount': 790, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 790}], 'totalTokenCount': 911}, 'invocationId': 'e-640b065c-3a9a-422c-910e-adf8e455cbb0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'NC8YByOT', 'timestamp': 1761904008.983292}]
2025-10-31 18:46:50,828 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:46:50,828 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "現在のボード（4♠ J♠ 5♣ 7♣）で、あなたの手札（5♦ J♥）はツーペア（Jと5）を作っています。これは強いハンドですが、相手のハンドは不明です。相手がより強いツーペアやスリーカードを持っている可能性も考慮し、まずはチェックで様子を見ます。もし相手がベットしてきたら、その額に応じてコールするかフォールドするかを判断します。"
}
```
2025-10-31 18:46:50,828 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:46:50,829 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（4♠ J♠ 5♣ 7♣）で、あなたの手札（5♦ J♥）はツーペア（Jと5）を作っています。これは強いハンドですが、相手のハンドは不明です。相手がより強いツーペアやスリーカードを持っている可能性も考慮し、まずはチェックで様子を見ます。もし相手がベットしてきたら、その額に応じてコールするかフォールドするかを判断します。"\n}\n```'
2025-10-31 18:46:50,829 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:46:50,829 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（4♠ J♠ 5♣ 7♣）で、あなたの手札（5♦ J♥）はツーペア（Jと5）を作っています。これは強いハンドですが、相手のハンドは不明です。相手がより強いツーペアやスリーカードを持っている可能性も考慮し、まずはチェックで様子を見ます。もし相手がベットしてきたら、その額に応じてコールするかフォールドするかを判断します。"\n}'
2025-10-31 18:46:50,829 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "現在のボード（4♠ J♠ 5♣ 7♣）で、あなたの手札（5♦ J♥）はツーペア（Jと5）を作っています。これは強いハンドですが、相手のハンドは不明です。相手がより強いツーペアやスリーカードを持っている可能性も考慮し、まずはチェックで様子を見ます。もし相手がベットしてきたら、その額に応じてコールするかフォールドするかを判断します。"
}
2025-10-31 18:46:50,830 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '現在のボード（4♠ J♠ 5♣ 7♣）で、あなたの手札（5♦ J♥）はツーペア（Jと5）を作っています。これは強いハンドですが、相手のハンドは不明です。相手がより強いツーペアやスリーカードを持っている可能性も考慮し、まずはチェックで様子を見ます。もし相手がベットしてきたら、その額に応じてコールするかフォールドするかを判断します。'}
2025-10-31 18:46:50,830 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:46:50,830 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:46:50,830 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:46:50,831 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, 現在のボード（4♠ J♠ 5♣ 7♣）で、あなたの手札（5♦ J♥）はツーペア（Jと5）を作っています。これは強いハンドですが、相手のハンドは不明です。相手がより強いツーペアやスリーカードを持っている可能性も考慮し、まずはチェックで様子を見ます。もし相手がベットしてきたら、その額に応じてコールするかフォールドするかを判断します。
2025-10-31 18:46:50,832 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:46:50,833 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:46:50,833 - poker_game - INFO - Hand #4, Phase: turn
2025-10-31 18:46:50,834 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:50,834 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:50,834 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:50,835 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:50,835 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:50,836 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣']
2025-10-31 18:46:50,836 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:50,836 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:50,837 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:50,837 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:50,838 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:50,838 - poker_game - INFO - ==================================================
2025-10-31 18:46:50,839 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:46:50,857 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:46:50,858 - poker_game - INFO - Hand #4, Phase: turn
2025-10-31 18:46:50,858 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:46:50,859 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:50,859 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:50,859 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:50,860 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:50,860 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣']
2025-10-31 18:46:50,860 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:50,861 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:50,861 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:50,861 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:50,862 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:50,862 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:46:50,862 - poker_game - INFO - ==================================================
2025-10-31 18:46:50,863 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:46:50,863 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:46:50,863 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:46:50,864 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:46:50,864 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:46:50,865 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:46:50,865 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:46:50,866 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:46:50,866 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:46:50,866 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:46:50,867 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:46:50,867 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:46:50,867 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:46:50,867 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:46:50,868 - poker_game - INFO - Hand #4, Phase: turn
2025-10-31 18:46:50,869 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:46:50,870 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:46:50,870 - poker_game - INFO - Last raiser: None
2025-10-31 18:46:50,871 - poker_game - INFO - Betting round complete: False
2025-10-31 18:46:50,872 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:46:50,873 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣']
2025-10-31 18:46:50,873 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:46:50,873 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:46:50,874 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:46:50,874 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:46:50,875 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:46:50,875 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:46:50,876 - poker_game - INFO - ==================================================
2025-10-31 18:46:50,980 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "3♦",
    "Q♣"
  ],
  "community": [
    "4♠",
    "J♠",
    "5♣",
    "7♣"
  ],
  "your_chips": 6079,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1901,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6079)"
  ],
  "history": [
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked"
  ]
}
2025-10-31 18:46:50,995 - poker_game - DEBUG - Create Session: {'id': 'a508b5b0-6786-468b-a99f-e15919737b76', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904010.9915476}
2025-10-31 18:47:01,132 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:47:02,858 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_gEdQrwIi6Wi28m8dUwNeTXgm', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1113, 'totalTokenCount': 1130}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'MjvAWcSj', 'timestamp': 1761904011.014063}, {'content': {'parts': [{'functionResponse': {'id': 'call_gEdQrwIi6Wi28m8dUwNeTXgm', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'KEoouin4', 'timestamp': 1761904012.15617}, {'content': {'parts': [{'functionCall': {'id': 'call_1dQ58TFEInDo42xEAzewzdKM', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1637, 'totalTokenCount': 1657}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '2awymxV5', 'timestamp': 1761904012.15862}, {'content': {'parts': [{'functionResponse': {'id': 'call_1dQ58TFEInDo42xEAzewzdKM', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'HuUCgnUS', 'timestamp': 1761904013.102839}, {'content': {'parts': [{'functionCall': {'id': 'call_SF50UNDmsT1CQ73yddEimz5g', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1199, 'totalTokenCount': 1216}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'gtKNLpXw', 'timestamp': 1761904013.106789}, {'content': {'parts': [{'functionResponse': {'id': 'call_SF50UNDmsT1CQ73yddEimz5g', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Z63sp3yn', 'timestamp': 1761904014.425525}, {'content': {'parts': [{'functionCall': {'id': 'call_N0ir35R64PlJtb7wxGcU6CBO', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['3♦', 'Q♣'], 'community': ['4♠', 'J♠', '5♣', '7♣'], 'your_chips': 6079, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 50, 'to_call': 0, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1970, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1901, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6079)'], 'history': ['Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: J♠, 6♣, K♦', 'Player 4 raised to 39', 'Player 3 called 39', 'Turn dealt: 8♣', 'Player 4 raised to 91', 'Player 3 folded', 'Showdown: Player 4 won 229', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 checked', 'Flop dealt: 4♠, J♠, 5♣', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 7♣', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 50, 'equity': 0.3}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 334, 'promptTokenCount': 1729, 'totalTokenCount': 2063}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'HfINiF4w', 'timestamp': 1761904014.433187}, {'content': {'parts': [{'functionResponse': {'id': 'call_N0ir35R64PlJtb7wxGcU6CBO', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（15.00(ポットに対して30.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'zS1BZm4t', 'timestamp': 1761904020.999463}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（15.00(ポットに対して30.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2114, 'totalTokenCount': 2152}, 'invocationId': 'e-b7470fc8-1e6b-4085-a2af-3dd867ed9ab0', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'URT5bWel', 'timestamp': 1761904021.001682}]
2025-10-31 18:47:02,858 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:47:02,859 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（15.00(ポットに対して30.00%）ため、チェックします"}
2025-10-31 18:47:02,859 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:47:02,859 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（15.00(ポットに対して30.00%）ため、チェックします"}'
2025-10-31 18:47:02,859 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:47:02,859 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（15.00(ポットに対して30.00%）ため、チェックします"}
2025-10-31 18:47:02,859 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（15.00(ポットに対して30.00%）ため、チェックします'}
2025-10-31 18:47:02,860 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:47:02,860 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:47:02,860 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:47:02,860 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（15.00(ポットに対して30.00%）ため、チェックします
2025-10-31 18:47:02,860 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:47:02,861 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:02,861 - poker_game - INFO - Hand #4, Phase: turn
2025-10-31 18:47:02,861 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:47:02,862 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:02,862 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:02,862 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:02,862 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:02,862 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣']
2025-10-31 18:47:02,863 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:02,863 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:02,863 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:02,863 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:02,863 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:02,864 - poker_game - INFO - ==================================================
2025-10-31 18:47:02,864 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:47:02,883 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:02,884 - poker_game - INFO - Hand #4, Phase: turn
2025-10-31 18:47:02,884 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:47:02,884 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:02,885 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:02,885 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:02,885 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:02,885 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣']
2025-10-31 18:47:02,886 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:02,886 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:02,886 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:02,886 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:02,886 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:02,887 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:47:02,887 - poker_game - INFO - ==================================================
2025-10-31 18:47:02,887 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:02,887 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:02,887 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:47:02,887 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:47:02,888 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:02,888 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:02,888 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:47:02,888 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:47:02,888 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:47:02,888 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:47:02,888 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:47:02,889 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:47:02,889 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 18:47:02,889 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:02,890 - poker_game - INFO - Hand #4, Phase: turn
2025-10-31 18:47:02,891 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:47:02,891 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:02,892 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:02,892 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:02,893 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:02,893 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣']
2025-10-31 18:47:02,894 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:02,895 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:02,896 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:02,896 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:02,896 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:02,896 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:47:02,897 - poker_game - INFO - ==================================================
2025-10-31 18:47:02,998 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:47:02,998 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:02,999 - poker_game - INFO - Remaining players: 2
2025-10-31 18:47:02,999 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:47:03,000 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:47:03,000 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:47:03,012 - poker_game - INFO - Starting new betting round
2025-10-31 18:47:03,013 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:47:03,013 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:47:03,013 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:47:03,014 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:47:03,014 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 18:47:03,014 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:47:03,015 - poker_game - INFO - Hand #4, Phase: river
2025-10-31 18:47:03,015 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:47:03,016 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:03,016 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:03,017 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:03,017 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:03,018 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:03,018 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:03,018 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:03,019 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:03,019 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:03,019 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:03,020 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:47:03,021 - poker_game - INFO - ==================================================
2025-10-31 18:47:03,022 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "5♦",
    "J♥"
  ],
  "community": [
    "4♠",
    "J♠",
    "5♣",
    "7♣",
    "2♠"
  ],
  "your_chips": 1901,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6079,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1901)"
  ],
  "history": [
    "Player 1 folded",
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠"
  ]
}
2025-10-31 18:47:03,036 - poker_game - DEBUG - Create Session: {'id': '2bee2fa5-c5bf-4cbf-b714-71e959c02b96', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904023.0328007}
2025-10-31 18:47:05,214 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）で、あなたの手札はJと5でツーペア（J J 5 5）が完成しています。コミュニティカードにJと5が1枚ずつあり、あなたの手札と合わせるとJが2枚、5が2枚でツーペアです。これは良いハンドですが、相手のハンドが不明なこと、そしてポットがそれほど大きくないことから、ここではリスクを冒さずにチェックをして様子を見るのが最善です。もし相手がベットしてきたら、あなたのハンドの強さを考慮してコールするかどうかを判断します。相手がチェックしてきた場合は、ショーダウン（お互いの手札を見せ合うこと）に進みます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 174, 'promptTokenCount': 787, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 787}], 'totalTokenCount': 961}, 'invocationId': 'e-1bdd1c65-1e4f-44ac-a2d1-e83a421f771b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'CgcFhhIR', 'timestamp': 1761904023.047312}]
2025-10-31 18:47:05,215 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:47:05,215 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカード）で、あなたの手札はJと5でツーペア（J J 5 5）が完成しています。コミュニティカードにJと5が1枚ずつあり、あなたの手札と合わせるとJが2枚、5が2枚でツーペアです。これは良いハンドですが、相手のハンドが不明なこと、そしてポットがそれほど大きくないことから、ここではリスクを冒さずにチェックをして様子を見るのが最善です。もし相手がベットしてきたら、あなたのハンドの強さを考慮してコールするかどうかを判断します。相手がチェックしてきた場合は、ショーダウン（お互いの手札を見せ合うこと）に進みます。"
}
```
2025-10-31 18:47:05,217 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:47:05,217 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）で、あなたの手札はJと5でツーペア（J J 5 5）が完成しています。コミュニティカードにJと5が1枚ずつあり、あなたの手札と合わせるとJが2枚、5が2枚でツーペアです。これは良いハンドですが、相手のハンドが不明なこと、そしてポットがそれほど大きくないことから、ここではリスクを冒さずにチェックをして様子を見るのが最善です。もし相手がベットしてきたら、あなたのハンドの強さを考慮してコールするかどうかを判断します。相手がチェックしてきた場合は、ショーダウン（お互いの手札を見せ合うこと）に進みます。"\n}\n```'
2025-10-31 18:47:05,217 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:47:05,218 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）で、あなたの手札はJと5でツーペア（J J 5 5）が完成しています。コミュニティカードにJと5が1枚ずつあり、あなたの手札と合わせるとJが2枚、5が2枚でツーペアです。これは良いハンドですが、相手のハンドが不明なこと、そしてポットがそれほど大きくないことから、ここではリスクを冒さずにチェックをして様子を見るのが最善です。もし相手がベットしてきたら、あなたのハンドの強さを考慮してコールするかどうかを判断します。相手がチェックしてきた場合は、ショーダウン（お互いの手札を見せ合うこと）に進みます。"\n}'
2025-10-31 18:47:05,218 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカード）で、あなたの手札はJと5でツーペア（J J 5 5）が完成しています。コミュニティカードにJと5が1枚ずつあり、あなたの手札と合わせるとJが2枚、5が2枚でツーペアです。これは良いハンドですが、相手のハンドが不明なこと、そしてポットがそれほど大きくないことから、ここではリスクを冒さずにチェックをして様子を見るのが最善です。もし相手がベットしてきたら、あなたのハンドの強さを考慮してコールするかどうかを判断します。相手がチェックしてきた場合は、ショーダウン（お互いの手札を見せ合うこと）に進みます。"
}
2025-10-31 18:47:05,218 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最後のカード）で、あなたの手札はJと5でツーペア（J J 5 5）が完成しています。コミュニティカードにJと5が1枚ずつあり、あなたの手札と合わせるとJが2枚、5が2枚でツーペアです。これは良いハンドですが、相手のハンドが不明なこと、そしてポットがそれほど大きくないことから、ここではリスクを冒さずにチェックをして様子を見るのが最善です。もし相手がベットしてきたら、あなたのハンドの強さを考慮してコールするかどうかを判断します。相手がチェックしてきた場合は、ショーダウン（お互いの手札を見せ合うこと）に進みます。'}
2025-10-31 18:47:05,218 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:47:05,218 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:47:05,218 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:47:05,218 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, リバー（最後のカード）で、あなたの手札はJと5でツーペア（J J 5 5）が完成しています。コミュニティカードにJと5が1枚ずつあり、あなたの手札と合わせるとJが2枚、5が2枚でツーペアです。これは良いハンドですが、相手のハンドが不明なこと、そしてポットがそれほど大きくないことから、ここではリスクを冒さずにチェックをして様子を見るのが最善です。もし相手がベットしてきたら、あなたのハンドの強さを考慮してコールするかどうかを判断します。相手がチェックしてきた場合は、ショーダウン（お互いの手札を見せ合うこと）に進みます。
2025-10-31 18:47:05,219 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:47:05,219 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:05,219 - poker_game - INFO - Hand #4, Phase: river
2025-10-31 18:47:05,220 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:47:05,220 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:05,220 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:05,220 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:05,220 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:05,221 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:05,221 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:05,221 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:05,221 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:05,221 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:05,221 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:05,222 - poker_game - INFO - ==================================================
2025-10-31 18:47:05,222 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:47:05,239 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:05,240 - poker_game - INFO - Hand #4, Phase: river
2025-10-31 18:47:05,240 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:47:05,240 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:05,240 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:05,241 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:05,241 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:05,241 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:05,241 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:05,242 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:05,242 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:05,242 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:05,242 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:05,242 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:47:05,243 - poker_game - INFO - ==================================================
2025-10-31 18:47:05,243 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:05,243 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:05,243 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:47:05,243 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:47:05,244 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:05,244 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:05,244 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:47:05,244 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:47:05,244 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:47:05,244 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:47:05,244 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:47:05,245 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:47:05,245 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:47:05,245 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:05,245 - poker_game - INFO - Hand #4, Phase: river
2025-10-31 18:47:05,245 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:47:05,245 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:05,245 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:05,246 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:05,246 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:05,246 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:05,246 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:05,246 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:05,247 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:05,247 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:05,247 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:05,247 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:47:05,248 - poker_game - INFO - ==================================================
2025-10-31 18:47:05,353 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "3♦",
    "Q♣"
  ],
  "community": [
    "4♠",
    "J♠",
    "5♣",
    "7♣",
    "2♠"
  ],
  "your_chips": 6079,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1970,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1901,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6079)"
  ],
  "history": [
    "Flop dealt: J♠, 6♣, K♦",
    "Player 4 raised to 39",
    "Player 3 called 39",
    "Turn dealt: 8♣",
    "Player 4 raised to 91",
    "Player 3 folded",
    "Showdown: Player 4 won 229",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked"
  ]
}
2025-10-31 18:47:05,363 - poker_game - DEBUG - Create Session: {'id': 'c40c523f-5260-4620-9bd6-b5edbe3680ab', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904025.3616276}
2025-10-31 18:47:15,368 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:47:19,942 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_vLDOYy9W9vriKPrM2uHY1OQ0', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1118, 'totalTokenCount': 1135}, 'invocationId': 'e-f285ca8d-f8a5-463f-9164-8a3a96b3af51', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'O2AUpqO9', 'timestamp': 1761904025.378167}, {'content': {'parts': [{'functionResponse': {'id': 'call_vLDOYy9W9vriKPrM2uHY1OQ0', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f285ca8d-f8a5-463f-9164-8a3a96b3af51', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'CML84GPZ', 'timestamp': 1761904026.365686}, {'content': {'parts': [{'functionCall': {'id': 'call_7stz4o6RPlkLyZnDA1DUhOty', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['3♦', 'Q♣'], 'community': ['4♠', 'J♠', '5♣', '7♣', '2♠'], 'your_chips': 6079, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 50, 'to_call': 0, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1970, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1901, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6079)'], 'history': ['Flop dealt: J♠, 6♣, K♦', 'Player 4 raised to 39', 'Player 3 called 39', 'Turn dealt: 8♣', 'Player 4 raised to 91', 'Player 3 folded', 'Showdown: Player 4 won 229', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 checked', 'Flop dealt: 4♠, J♠, 5♣', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 7♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 2♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 50, 'equity': 0.0}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_hnIa3ce4TsycBSFDXqp19j9v', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['3♦', 'Q♣'], 'community': ['4♠', 'J♠', '5♣', '7♣', '2♠'], 'your_chips': 6079, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 50, 'to_call': 0, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1970, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1901, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6079)'], 'history': ['Flop dealt: J♠, 6♣, K♦', 'Player 4 raised to 39', 'Player 3 called 39', 'Turn dealt: 8♣', 'Player 4 raised to 91', 'Player 3 folded', 'Showdown: Player 4 won 229', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 checked', 'Flop dealt: 4♠, J♠, 5♣', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 7♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 2♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 50, 'equity': 0.0}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 690, 'promptTokenCount': 1642, 'totalTokenCount': 2332}, 'invocationId': 'e-f285ca8d-f8a5-463f-9164-8a3a96b3af51', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ydeBi3x4', 'timestamp': 1761904026.367132}, {'content': {'parts': [{'functionResponse': {'id': 'call_7stz4o6RPlkLyZnDA1DUhOty', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（0.00(ポットに対して0.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_hnIa3ce4TsycBSFDXqp19j9v', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（0.00(ポットに対して0.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'VIHyQaPw', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'XVPaMm5Q', 'timestamp': 1761904037.859085}, {'content': {'parts': [{'text': '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い(0.00(ポットに対し0.00%)ため、チェックします"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 47, 'promptTokenCount': 2556, 'totalTokenCount': 2603}, 'invocationId': 'e-f285ca8d-f8a5-463f-9164-8a3a96b3af51', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'goeix5jG', 'timestamp': 1761904037.863249}]
2025-10-31 18:47:19,942 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:47:19,942 - poker_game - DEBUG - {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い(0.00(ポットに対し0.00%)ため、チェックします"
}
2025-10-31 18:47:19,943 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:47:19,943 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い(0.00(ポットに対し0.00%)ため、チェックします"\n}'
2025-10-31 18:47:19,943 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:47:19,943 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い(0.00(ポットに対し0.00%)ため、チェックします"
}
2025-10-31 18:47:19,943 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い(0.00(ポットに対し0.00%)ため、チェックします'}
2025-10-31 18:47:19,943 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:47:19,943 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:47:19,944 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:47:19,944 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い(0.00(ポットに対し0.00%)ため、チェックします
2025-10-31 18:47:19,944 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:47:19,945 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:19,945 - poker_game - INFO - Hand #4, Phase: river
2025-10-31 18:47:19,945 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:47:19,945 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:19,945 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:19,945 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:19,946 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:19,946 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:19,946 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:19,946 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:19,946 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:19,946 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:19,947 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:19,947 - poker_game - INFO - ==================================================
2025-10-31 18:47:19,947 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:47:19,970 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:19,970 - poker_game - INFO - Hand #4, Phase: river
2025-10-31 18:47:19,970 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:47:19,971 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:19,971 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:19,971 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:19,971 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:19,971 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:19,971 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:19,971 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:19,971 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:19,971 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:19,971 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:19,971 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:47:19,971 - poker_game - INFO - ==================================================
2025-10-31 18:47:19,972 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:19,972 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:19,972 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:47:19,972 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:47:19,972 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:19,972 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:19,972 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:47:19,973 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:47:19,973 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:47:19,973 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:47:19,973 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:47:19,973 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:47:19,973 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 18:47:19,973 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:19,973 - poker_game - INFO - Hand #4, Phase: river
2025-10-31 18:47:19,973 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:47:19,974 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:19,974 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:19,974 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:19,974 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:19,974 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:19,974 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:19,974 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:19,974 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:19,974 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:19,974 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:19,974 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:47:19,975 - poker_game - INFO - ==================================================
2025-10-31 18:47:20,077 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:47:20,078 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:20,078 - poker_game - INFO - Remaining players: 2
2025-10-31 18:47:20,078 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:47:20,079 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:47:20,079 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:47:20,079 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:47:20,080 - poker_game - INFO - Hand #4, Phase: showdown
2025-10-31 18:47:20,080 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:47:20,080 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:20,080 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:20,081 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:20,081 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:20,081 - poker_game - INFO - Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:20,082 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:20,082 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=folded
2025-10-31 18:47:20,083 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:20,083 - poker_game - INFO -   P3(Agent3): chips=1901, bet=0, status=active
2025-10-31 18:47:20,083 - poker_game - INFO -   P4(Agent4): chips=6079, bet=0, status=active
2025-10-31 18:47:20,084 - poker_game - INFO - ==================================================
2025-10-31 18:47:20,084 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:47:20,084 - poker_game - INFO - Pot: 50, Community cards: ['4♠', 'J♠', '5♣', '7♣', '2♠']
2025-10-31 18:47:20,085 - poker_game - INFO -   Player 3 status=active cards=['5♦', 'J♥']
2025-10-31 18:47:20,085 - poker_game - INFO -   Player 4 status=active cards=['3♦', 'Q♣']
2025-10-31 18:47:20,088 - poker_game - INFO -   Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=['5♦', 'J♥']
2025-10-31 18:47:20,088 - poker_game - INFO -   Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=['3♦', 'Q♣']
2025-10-31 18:47:20,089 - poker_game - INFO - Pot layer 0: amount=30, contributors=[1, 3, 4]
2025-10-31 18:47:20,089 - poker_game - INFO - Pot layer 1: amount=20, contributors=[3, 4]
2025-10-31 18:47:20,090 - poker_game - INFO - Showdown total awarded: 50 (game.pot=50)
2025-10-31 18:47:20,093 - poker_game - INFO - Showdown winners (aggregated): [3]
2025-10-31 18:47:20,095 - poker_game - INFO -   Awarded 50 to Player 3 (hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣)
2025-10-31 18:47:20,095 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:47:20,135 - poker_game - INFO - === STARTING NEW HAND #5 ===
2025-10-31 18:47:20,136 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:47:20,136 - poker_game - INFO - Moving dealer button
2025-10-31 18:47:20,137 - poker_game - INFO - Posting blinds
2025-10-31 18:47:20,163 - poker_game - INFO - Dealing hole cards
2025-10-31 18:47:20,164 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:47:20,172 - poker_game - INFO - Started new hand in database: hand_id=5
2025-10-31 18:47:20,173 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:47:20,174 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:20,174 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:47:20,175 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:47:20,175 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:20,175 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:20,176 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:47:20,176 - poker_game - INFO - Community cards: []
2025-10-31 18:47:20,176 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:20,177 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=active
2025-10-31 18:47:20,177 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:20,177 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=active
2025-10-31 18:47:20,178 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:20,179 - poker_game - INFO - ==================================================
2025-10-31 18:47:20,180 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "8♣",
    "J♣"
  ],
  "community": [],
  "your_chips": 1970,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1941,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6059,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1970)"
  ],
  "history": [
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:47:20,190 - poker_game - DEBUG - Create Session: {'id': '0de9aceb-792a-4e56-8847-9987fac85e3b', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904040.187499}
2025-10-31 18:47:21,909 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、私の手札はJ♣8♣です。これは「スーテッドコネクター」で、フラッシュやストレートを作る可能性があります。しかし、まだコミュニティカードがないため、有利な役はできていません。ポットのサイズ（30）と、コールに必要な金額（20）を考慮すると、ゲームに参加する価値はあります。相手のベット額（4番プレイヤーは20、3番プレイヤーは10）は、それほど強くないことを示唆しています。この状況では、フロップを見て、それから戦略を練るのが最善です。"\n}'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 151, 'promptTokenCount': 892, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 892}], 'totalTokenCount': 1043}, 'invocationId': 'e-17311fec-d123-4065-b20e-01df0ae23e3b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '70jDvyDS', 'timestamp': 1761904040.200805}]
2025-10-31 18:47:21,909 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:47:21,909 - poker_game - DEBUG - {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで、私の手札はJ♣8♣です。これは「スーテッドコネクター」で、フラッシュやストレートを作る可能性があります。しかし、まだコミュニティカードがないため、有利な役はできていません。ポットのサイズ（30）と、コールに必要な金額（20）を考慮すると、ゲームに参加する価値はあります。相手のベット額（4番プレイヤーは20、3番プレイヤーは10）は、それほど強くないことを示唆しています。この状況では、フロップを見て、それから戦略を練るのが最善です。"
}
2025-10-31 18:47:21,909 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:47:21,909 - poker_game - DEBUG - [Agent1] Raw response content: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、私の手札はJ♣8♣です。これは「スーテッドコネクター」で、フラッシュやストレートを作る可能性があります。しかし、まだコミュニティカードがないため、有利な役はできていません。ポットのサイズ（30）と、コールに必要な金額（20）を考慮すると、ゲームに参加する価値はあります。相手のベット額（4番プレイヤーは20、3番プレイヤーは10）は、それほど強くないことを示唆しています。この状況では、フロップを見て、それから戦略を練るのが最善です。"\n}'
2025-10-31 18:47:21,910 - poker_game - DEBUG - [Agent1] No markdown code block detected
2025-10-31 18:47:21,910 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで、私の手札はJ♣8♣です。これは「スーテッドコネクター」で、フラッシュやストレートを作る可能性があります。しかし、まだコミュニティカードがないため、有利な役はできていません。ポットのサイズ（30）と、コールに必要な金額（20）を考慮すると、ゲームに参加する価値はあります。相手のベット額（4番プレイヤーは20、3番プレイヤーは10）は、それほど強くないことを示唆しています。この状況では、フロップを見て、それから戦略を練るのが最善です。"
}
2025-10-31 18:47:21,910 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップで、私の手札はJ♣8♣です。これは「スーテッドコネクター」で、フラッシュやストレートを作る可能性があります。しかし、まだコミュニティカードがないため、有利な役はできていません。ポットのサイズ（30）と、コールに必要な金額（20）を考慮すると、ゲームに参加する価値はあります。相手のベット額（4番プレイヤーは20、3番プレイヤーは10）は、それほど強くないことを示唆しています。この状況では、フロップを見て、それから戦略を練るのが最善です。'}
2025-10-31 18:47:21,910 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 20
2025-10-31 18:47:21,910 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (1970)']
2025-10-31 18:47:21,910 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (20)': 20
2025-10-31 18:47:21,911 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:47:21,911 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 20, プリフロップで、私の手札はJ♣8♣です。これは「スーテッドコネクター」で、フラッシュやストレートを作る可能性があります。しかし、まだコミュニティカードがないため、有利な役はできていません。ポットのサイズ（30）と、コールに必要な金額（20）を考慮すると、ゲームに参加する価値はあります。相手のベット額（4番プレイヤーは20、3番プレイヤーは10）は、それほど強くないことを示唆しています。この状況では、フロップを見て、それから戦略を練るのが最善です。
2025-10-31 18:47:21,911 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 20
2025-10-31 18:47:21,912 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:21,912 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:21,912 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:47:21,912 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:47:21,912 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:21,912 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:21,913 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:47:21,913 - poker_game - INFO - Community cards: []
2025-10-31 18:47:21,913 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:21,913 - poker_game - INFO -   P1(Agent1): chips=1970, bet=0, status=active
2025-10-31 18:47:21,913 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:21,914 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=active
2025-10-31 18:47:21,914 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:21,914 - poker_game - INFO - ==================================================
2025-10-31 18:47:21,914 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 20
2025-10-31 18:47:21,938 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:21,938 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:21,938 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:47:21,938 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:21,939 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:21,939 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:21,939 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:47:21,939 - poker_game - INFO - Community cards: []
2025-10-31 18:47:21,939 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:21,939 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:21,939 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:21,939 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=active
2025-10-31 18:47:21,939 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:21,939 - poker_game - INFO - Extra: Action: Player 1 called 20
2025-10-31 18:47:21,940 - poker_game - INFO - ==================================================
2025-10-31 18:47:21,940 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:21,940 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:21,940 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:47:21,940 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:47:21,940 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:21,940 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:21,940 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:47:21,940 - poker_game - DEBUG - Player bets: [20, 10, 20], Current bet: 20, All same: False
2025-10-31 18:47:21,940 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:47:21,940 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:21,940 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:21,941 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:47:21,941 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:21,941 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:21,941 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:21,941 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:47:21,941 - poker_game - INFO - Community cards: []
2025-10-31 18:47:21,941 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:21,941 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:21,941 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:21,941 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=active
2025-10-31 18:47:21,941 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:21,942 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:47:21,942 - poker_game - INFO - ==================================================
2025-10-31 18:47:22,043 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "8♠",
    "4♣"
  ],
  "community": [],
  "your_chips": 1941,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1950,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6059,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1941)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20"
  ]
}
2025-10-31 18:47:22,055 - poker_game - DEBUG - Create Session: {'id': '939640cb-5c6a-41ea-86fa-dadf3d83ab24', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904042.0535557}
2025-10-31 18:47:23,671 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで8と4という弱いハンドを持っているため、フォールドするのが最善です。ポットはまだ小さく、このハンドでこれ以上チップを投資する価値はありません。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 69, 'promptTokenCount': 892, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 892}], 'totalTokenCount': 961}, 'invocationId': 'e-70547be3-b524-42ac-af63-6901210f7f02', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'MEqnOJSX', 'timestamp': 1761904042.065462}]
2025-10-31 18:47:23,672 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:47:23,672 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで8と4という弱いハンドを持っているため、フォールドするのが最善です。ポットはまだ小さく、このハンドでこれ以上チップを投資する価値はありません。"
}
```
2025-10-31 18:47:23,672 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:47:23,672 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで8と4という弱いハンドを持っているため、フォールドするのが最善です。ポットはまだ小さく、このハンドでこれ以上チップを投資する価値はありません。"\n}\n```'
2025-10-31 18:47:23,672 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:47:23,672 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで8と4という弱いハンドを持っているため、フォールドするのが最善です。ポットはまだ小さく、このハンドでこれ以上チップを投資する価値はありません。"\n}'
2025-10-31 18:47:23,672 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで8と4という弱いハンドを持っているため、フォールドするのが最善です。ポットはまだ小さく、このハンドでこれ以上チップを投資する価値はありません。"
}
2025-10-31 18:47:23,672 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップで8と4という弱いハンドを持っているため、フォールドするのが最善です。ポットはまだ小さく、このハンドでこれ以上チップを投資する価値はありません。'}
2025-10-31 18:47:23,673 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:47:23,673 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:47:23,673 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:47:23,673 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップで8と4という弱いハンドを持っているため、フォールドするのが最善です。ポットはまだ小さく、このハンドでこれ以上チップを投資する価値はありません。
2025-10-31 18:47:23,674 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:47:23,674 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:23,674 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:23,674 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:47:23,674 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:23,675 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:23,675 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:23,675 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:47:23,675 - poker_game - INFO - Community cards: []
2025-10-31 18:47:23,675 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:23,675 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:23,675 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:23,675 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=active
2025-10-31 18:47:23,675 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:23,676 - poker_game - INFO - ==================================================
2025-10-31 18:47:23,676 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:47:23,690 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:23,690 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:23,690 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:47:23,690 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:23,691 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:23,691 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:23,691 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:23,691 - poker_game - INFO - Community cards: []
2025-10-31 18:47:23,691 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:23,692 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:23,692 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:23,692 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=folded
2025-10-31 18:47:23,692 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:23,692 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:47:23,693 - poker_game - INFO - ==================================================
2025-10-31 18:47:23,693 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:23,693 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:23,693 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:47:23,693 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:47:23,694 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:23,694 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:23,694 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:47:23,694 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:47:23,694 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:47:23,694 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:47:23,694 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:47:23,695 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:47:23,695 - poker_game - DEBUG - Betting continues: Current player 4 != next after raiser 1
2025-10-31 18:47:23,695 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:23,695 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:23,695 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:23,695 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:23,695 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:23,696 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:23,696 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:23,696 - poker_game - INFO - Community cards: []
2025-10-31 18:47:23,696 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:23,696 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:23,697 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:23,697 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=folded
2025-10-31 18:47:23,697 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:23,697 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:47:23,697 - poker_game - INFO - ==================================================
2025-10-31 18:47:23,798 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "7♣",
    "2♣"
  ],
  "community": [],
  "your_chips": 6059,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1950,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1941,
      "bet": 10,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (6059)"
  ],
  "history": [
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded"
  ]
}
2025-10-31 18:47:23,810 - poker_game - DEBUG - Create Session: {'id': '631acee1-37fd-44b0-9db7-974dccdeda1c', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904043.8075993}
2025-10-31 18:47:33,983 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:47:35,085 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_v0Vdt0afOAm1NmZP1mBebzKA', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1227, 'totalTokenCount': 1244}, 'invocationId': 'e-176d8af0-6506-4942-92ec-8473dca9d5a5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'BBEE7ev5', 'timestamp': 1761904043.821933}, {'content': {'parts': [{'functionResponse': {'id': 'call_v0Vdt0afOAm1NmZP1mBebzKA', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-176d8af0-6506-4942-92ec-8473dca9d5a5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'm22ZBgQ8', 'timestamp': 1761904045.00385}, {'content': {'parts': [{'functionCall': {'id': 'call_sC7vkTiKYCf6AZt840EndcNz', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['7♣', '2♣'], 'community': [], 'your_chips': 6059, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 50, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1950, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1941, 'bet': 10, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (6059)'], 'history': ['Player 4 called 20', 'Player 1 folded', 'Player 3 checked', 'Flop dealt: 4♠, J♠, 5♣', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 7♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 2♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣', 'Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 folded']}, 'call_amount': 0, 'pot_after_call': 50, 'equity': 0.1}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 451, 'promptTokenCount': 1751, 'totalTokenCount': 2202}, 'invocationId': 'e-176d8af0-6506-4942-92ec-8473dca9d5a5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'uLpjrJKo', 'timestamp': 1761904045.006175}, {'content': {'parts': [{'functionResponse': {'id': 'call_sC7vkTiKYCf6AZt840EndcNz', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（5.00(ポットに対して10.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-176d8af0-6506-4942-92ec-8473dca9d5a5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'WWAQ8HbX', 'timestamp': 1761904053.571535}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（5.00(ポットに対して10.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2253, 'totalTokenCount': 2291}, 'invocationId': 'e-176d8af0-6506-4942-92ec-8473dca9d5a5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'r66B8ArG', 'timestamp': 1761904053.579639}]
2025-10-31 18:47:35,086 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:47:35,086 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（5.00(ポットに対して10.00%）ため、チェックします"}
2025-10-31 18:47:35,087 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:47:35,087 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（5.00(ポットに対して10.00%）ため、チェックします"}'
2025-10-31 18:47:35,088 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:47:35,088 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（5.00(ポットに対して10.00%）ため、チェックします"}
2025-10-31 18:47:35,088 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（5.00(ポットに対して10.00%）ため、チェックします'}
2025-10-31 18:47:35,088 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:47:35,088 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:47:35,089 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:47:35,089 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（5.00(ポットに対して10.00%）ため、チェックします
2025-10-31 18:47:35,090 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:47:35,090 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:35,091 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:35,092 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:35,094 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:35,094 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:35,095 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:35,097 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:35,099 - poker_game - INFO - Community cards: []
2025-10-31 18:47:35,099 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:35,101 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:35,101 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:35,102 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=folded
2025-10-31 18:47:35,102 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:35,103 - poker_game - INFO - ==================================================
2025-10-31 18:47:35,103 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:47:35,115 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:35,116 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:35,117 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:35,117 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:35,117 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:35,117 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:35,118 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:35,118 - poker_game - INFO - Community cards: []
2025-10-31 18:47:35,118 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:35,118 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:35,119 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:35,119 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=folded
2025-10-31 18:47:35,119 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:35,120 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:47:35,120 - poker_game - INFO - ==================================================
2025-10-31 18:47:35,121 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:35,121 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:35,121 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:47:35,121 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:47:35,122 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:35,122 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:35,122 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:47:35,122 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:47:35,122 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:47:35,122 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:47:35,123 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:47:35,123 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:47:35,123 - poker_game - INFO - Betting complete: Back to player 1 after last raiser 4
2025-10-31 18:47:35,123 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:35,124 - poker_game - INFO - Hand #5, Phase: preflop
2025-10-31 18:47:35,124 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:47:35,125 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:47:35,125 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:35,126 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:35,126 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:35,127 - poker_game - INFO - Community cards: []
2025-10-31 18:47:35,127 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:35,128 - poker_game - INFO -   P1(Agent1): chips=1950, bet=20, status=active
2025-10-31 18:47:35,129 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:35,129 - poker_game - INFO -   P3(Agent3): chips=1941, bet=10, status=folded
2025-10-31 18:47:35,130 - poker_game - INFO -   P4(Agent4): chips=6059, bet=20, status=active
2025-10-31 18:47:35,130 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:47:35,130 - poker_game - INFO - ==================================================
2025-10-31 18:47:37,617 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:47:37,618 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:37,618 - poker_game - INFO - Remaining players: 2
2025-10-31 18:47:37,618 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:47:37,618 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:47:37,619 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:47:37,629 - poker_game - INFO - Starting new betting round
2025-10-31 18:47:37,630 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:47:37,630 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:47:37,631 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:47:37,631 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:47:37,631 - poker_game - INFO - First actor: Player 4 (by phase rule), was 1
2025-10-31 18:47:37,632 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:47:37,632 - poker_game - INFO - Hand #5, Phase: flop
2025-10-31 18:47:37,633 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:37,633 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:37,634 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:37,634 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:37,635 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:37,635 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥']
2025-10-31 18:47:37,636 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:37,636 - poker_game - INFO -   P1(Agent1): chips=1950, bet=0, status=active
2025-10-31 18:47:37,637 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:37,637 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:37,638 - poker_game - INFO -   P4(Agent4): chips=6059, bet=0, status=active
2025-10-31 18:47:37,638 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:47:37,638 - poker_game - INFO - ==================================================
2025-10-31 18:47:37,639 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "7♣",
    "2♣"
  ],
  "community": [
    "Q♠",
    "7♠",
    "6♥"
  ],
  "your_chips": 6059,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1950,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1941,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6059)"
  ],
  "history": [
    "Player 3 checked",
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥"
  ]
}
2025-10-31 18:47:37,649 - poker_game - DEBUG - Create Session: {'id': '4ed63d8c-4022-47e7-a767-55e7fb8e5eef', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904057.6468189}
2025-10-31 18:47:47,724 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:47:49,344 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_m5sIBOZANVd7TUuZMa67VdeS', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1255, 'totalTokenCount': 1272}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'BkdtQitC', 'timestamp': 1761904057.661969}, {'content': {'parts': [{'functionResponse': {'id': 'call_m5sIBOZANVd7TUuZMa67VdeS', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'YlpyHEP7', 'timestamp': 1761904053.765498}, {'content': {'parts': [{'functionCall': {'id': 'call_bAd9yyFiYY0GjHjViXJdpMcS', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1779, 'totalTokenCount': 1799}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'd0RaU7qd', 'timestamp': 1761904053.771062}, {'content': {'parts': [{'functionResponse': {'id': 'call_bAd9yyFiYY0GjHjViXJdpMcS', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'XU2vWk69', 'timestamp': 1761904055.909107}, {'content': {'parts': [{'functionCall': {'id': 'call_kLaclkl6QdLV6Mqm9hF0UpZ1', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1341, 'totalTokenCount': 1358}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'C21HUc2v', 'timestamp': 1761904055.912866}, {'content': {'parts': [{'functionResponse': {'id': 'call_kLaclkl6QdLV6Mqm9hF0UpZ1', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '1Kx2xEq1', 'timestamp': 1761904057.025875}, {'content': {'parts': [{'functionCall': {'id': 'call_N0GU6ZxbRocZQXA8KAsosUAX', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['7♣', '2♣'], 'community': ['Q♠', '7♠', '6♥'], 'your_chips': 6059, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 50, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1950, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1941, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6059)'], 'history': ['Player 3 checked', 'Flop dealt: 4♠, J♠, 5♣', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 7♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 2♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣', 'Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 folded', 'Player 4 checked', 'Flop dealt: Q♠, 7♠, 6♥']}, 'call_amount': 0, 'pot_after_call': 50, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 487, 'promptTokenCount': 1871, 'totalTokenCount': 2358}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'OOP4zKKD', 'timestamp': 1761904057.02786}, {'content': {'parts': [{'functionResponse': {'id': 'call_N0GU6ZxbRocZQXA8KAsosUAX', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 25, 'reasoning': '期待値が見込める（25.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 25'}}}], 'role': 'user'}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '0EmIJt6N', 'timestamp': 1761904067.510291}, {'content': {'parts': [{'text': '{"action":"raise","amount":25,"reasoning":"期待値が見込める（25.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 25"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2411, 'totalTokenCount': 2467}, 'invocationId': 'e-e71134cb-b394-4899-9f24-53908c236f17', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '0oW9lcR4', 'timestamp': 1761904067.513601}]
2025-10-31 18:47:49,345 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:47:49,345 - poker_game - DEBUG - {"action":"raise","amount":25,"reasoning":"期待値が見込める（25.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 25"}
2025-10-31 18:47:49,345 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":25,"reasoning":"期待値が見込める（25.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 25"}'
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":25,"reasoning":"期待値が見込める（25.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 25"}
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 25, 'reasoning': '期待値が見込める（25.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 25'}
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 25
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (6059)']
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:47:49,346 - poker_game - DEBUG - [Agent4] Raise amount 25 is valid (min: 20)
2025-10-31 18:47:49,347 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 25}
2025-10-31 18:47:49,347 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 25, 期待値が見込める（25.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 25
2025-10-31 18:47:49,347 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 25
2025-10-31 18:47:49,348 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:49,348 - poker_game - INFO - Hand #5, Phase: flop
2025-10-31 18:47:49,348 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:49,348 - poker_game - INFO - Pot: 50, Current bet: 0
2025-10-31 18:47:49,348 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:49,349 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:49,349 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:49,349 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥']
2025-10-31 18:47:49,349 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:49,349 - poker_game - INFO -   P1(Agent1): chips=1950, bet=0, status=active
2025-10-31 18:47:49,349 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:49,350 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:49,350 - poker_game - INFO -   P4(Agent4): chips=6059, bet=0, status=active
2025-10-31 18:47:49,350 - poker_game - INFO - ==================================================
2025-10-31 18:47:49,350 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 25
2025-10-31 18:47:49,362 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:49,362 - poker_game - INFO - Hand #5, Phase: flop
2025-10-31 18:47:49,362 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:49,363 - poker_game - INFO - Pot: 75, Current bet: 25
2025-10-31 18:47:49,363 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:49,363 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:49,363 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:49,364 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥']
2025-10-31 18:47:49,364 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:49,364 - poker_game - INFO -   P1(Agent1): chips=1950, bet=0, status=active
2025-10-31 18:47:49,364 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:49,365 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:49,365 - poker_game - INFO -   P4(Agent4): chips=6034, bet=25, status=active
2025-10-31 18:47:49,365 - poker_game - INFO - Extra: Action: Player 4 raised to 25
2025-10-31 18:47:49,365 - poker_game - INFO - ==================================================
2025-10-31 18:47:49,366 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:49,366 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:49,366 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:47:49,366 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:47:49,366 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:49,367 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:49,367 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:47:49,367 - poker_game - DEBUG - Player bets: [0, 25], Current bet: 25, All same: False
2025-10-31 18:47:49,367 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:47:49,367 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:49,367 - poker_game - INFO - Hand #5, Phase: flop
2025-10-31 18:47:49,367 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:47:49,368 - poker_game - INFO - Pot: 75, Current bet: 25
2025-10-31 18:47:49,368 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:49,368 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:49,368 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:49,368 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥']
2025-10-31 18:47:49,369 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:49,369 - poker_game - INFO -   P1(Agent1): chips=1950, bet=0, status=active
2025-10-31 18:47:49,369 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:49,369 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:49,370 - poker_game - INFO -   P4(Agent4): chips=6034, bet=25, status=active
2025-10-31 18:47:49,370 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:47:49,370 - poker_game - INFO - ==================================================
2025-10-31 18:47:49,473 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "8♣",
    "J♣"
  ],
  "community": [
    "Q♠",
    "7♠",
    "6♥"
  ],
  "your_chips": 1950,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 75,
  "to_call": 25,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1941,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6034,
      "bet": 25,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (25)",
    "raise (min 45)",
    "all-in (1950)"
  ],
  "history": [
    "Flop dealt: 4♠, J♠, 5♣",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25"
  ]
}
2025-10-31 18:47:49,482 - poker_game - DEBUG - Create Session: {'id': '01ad6f8b-7c45-48e2-87b6-7cc2d351f3ae', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904069.4799738}
2025-10-31 18:47:52,136 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 25,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）の時点で、私は「J♣ 8♣」という手札を持っています。コミュニティカードは「Q♠ 7♠ 6♥」です。このボード（コミュニティカードの組み合わせ）では、私にはフラッシュ（同じスートのカードが5枚揃うこと）のドロー（役が完成する可能性）があり、具体的にはスペード（♠）のフラッシュが完成する可能性があります。また、ジャック（J）とエイト（8）でペア（同じ数字のカードが2枚揃うこと）も作れます。相手（プレイヤー4）は25をベットしてきました。これはコール（相手のベット額と同額を支払うこと）するには比較的小さな額です。私の手札はまだ強い役ができていませんが、フラッシュが完成する可能性があり、相手のベット額もそこまで高くないため、コールして次のカード（ターン）を見るのが最善と考えられます。フォールド（降りること）するには、まだ役が完成する見込みがあるため惜しいです。レイズ（ベット額を上げる行為）するには、現時点ではまだ役が弱いため、リスクが高いと判断しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 288, 'promptTokenCount': 916, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 916}], 'totalTokenCount': 1204}, 'invocationId': 'e-83dd8aed-75ec-433f-8ff9-084facc536a6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'hCpJm6sR', 'timestamp': 1761904069.493538}]
2025-10-31 18:47:52,136 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:47:52,136 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 25,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）の時点で、私は「J♣ 8♣」という手札を持っています。コミュニティカードは「Q♠ 7♠ 6♥」です。このボード（コミュニティカードの組み合わせ）では、私にはフラッシュ（同じスートのカードが5枚揃うこと）のドロー（役が完成する可能性）があり、具体的にはスペード（♠）のフラッシュが完成する可能性があります。また、ジャック（J）とエイト（8）でペア（同じ数字のカードが2枚揃うこと）も作れます。相手（プレイヤー4）は25をベットしてきました。これはコール（相手のベット額と同額を支払うこと）するには比較的小さな額です。私の手札はまだ強い役ができていませんが、フラッシュが完成する可能性があり、相手のベット額もそこまで高くないため、コールして次のカード（ターン）を見るのが最善と考えられます。フォールド（降りること）するには、まだ役が完成する見込みがあるため惜しいです。レイズ（ベット額を上げる行為）するには、現時点ではまだ役が弱いため、リスクが高いと判断しました。"
}
```
2025-10-31 18:47:52,136 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:47:52,136 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 25,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）の時点で、私は「J♣ 8♣」という手札を持っています。コミュニティカードは「Q♠ 7♠ 6♥」です。このボード（コミュニティカードの組み合わせ）では、私にはフラッシュ（同じスートのカードが5枚揃うこと）のドロー（役が完成する可能性）があり、具体的にはスペード（♠）のフラッシュが完成する可能性があります。また、ジャック（J）とエイト（8）でペア（同じ数字のカードが2枚揃うこと）も作れます。相手（プレイヤー4）は25をベットしてきました。これはコール（相手のベット額と同額を支払うこと）するには比較的小さな額です。私の手札はまだ強い役ができていませんが、フラッシュが完成する可能性があり、相手のベット額もそこまで高くないため、コールして次のカード（ターン）を見るのが最善と考えられます。フォールド（降りること）するには、まだ役が完成する見込みがあるため惜しいです。レイズ（ベット額を上げる行為）するには、現時点ではまだ役が弱いため、リスクが高いと判断しました。"\n}\n```'
2025-10-31 18:47:52,136 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:47:52,137 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 25,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）の時点で、私は「J♣ 8♣」という手札を持っています。コミュニティカードは「Q♠ 7♠ 6♥」です。このボード（コミュニティカードの組み合わせ）では、私にはフラッシュ（同じスートのカードが5枚揃うこと）のドロー（役が完成する可能性）があり、具体的にはスペード（♠）のフラッシュが完成する可能性があります。また、ジャック（J）とエイト（8）でペア（同じ数字のカードが2枚揃うこと）も作れます。相手（プレイヤー4）は25をベットしてきました。これはコール（相手のベット額と同額を支払うこと）するには比較的小さな額です。私の手札はまだ強い役ができていませんが、フラッシュが完成する可能性があり、相手のベット額もそこまで高くないため、コールして次のカード（ターン）を見るのが最善と考えられます。フォールド（降りること）するには、まだ役が完成する見込みがあるため惜しいです。レイズ（ベット額を上げる行為）するには、現時点ではまだ役が弱いため、リスクが高いと判断しました。"\n}'
2025-10-31 18:47:52,137 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 25,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）の時点で、私は「J♣ 8♣」という手札を持っています。コミュニティカードは「Q♠ 7♠ 6♥」です。このボード（コミュニティカードの組み合わせ）では、私にはフラッシュ（同じスートのカードが5枚揃うこと）のドロー（役が完成する可能性）があり、具体的にはスペード（♠）のフラッシュが完成する可能性があります。また、ジャック（J）とエイト（8）でペア（同じ数字のカードが2枚揃うこと）も作れます。相手（プレイヤー4）は25をベットしてきました。これはコール（相手のベット額と同額を支払うこと）するには比較的小さな額です。私の手札はまだ強い役ができていませんが、フラッシュが完成する可能性があり、相手のベット額もそこまで高くないため、コールして次のカード（ターン）を見るのが最善と考えられます。フォールド（降りること）するには、まだ役が完成する見込みがあるため惜しいです。レイズ（ベット額を上げる行為）するには、現時点ではまだ役が弱いため、リスクが高いと判断しました。"
}
2025-10-31 18:47:52,137 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 25, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）の時点で、私は「J♣ 8♣」という手札を持っています。コミュニティカードは「Q♠ 7♠ 6♥」です。このボード（コミュニティカードの組み合わせ）では、私にはフラッシュ（同じスートのカードが5枚揃うこと）のドロー（役が完成する可能性）があり、具体的にはスペード（♠）のフラッシュが完成する可能性があります。また、ジャック（J）とエイト（8）でペア（同じ数字のカードが2枚揃うこと）も作れます。相手（プレイヤー4）は25をベットしてきました。これはコール（相手のベット額と同額を支払うこと）するには比較的小さな額です。私の手札はまだ強い役ができていませんが、フラッシュが完成する可能性があり、相手のベット額もそこまで高くないため、コールして次のカード（ターン）を見るのが最善と考えられます。フォールド（降りること）するには、まだ役が完成する見込みがあるため惜しいです。レイズ（ベット額を上げる行為）するには、現時点ではまだ役が弱いため、リスクが高いと判断しました。'}
2025-10-31 18:47:52,137 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 25
2025-10-31 18:47:52,137 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (25)', 'raise (min 45)', 'all-in (1950)']
2025-10-31 18:47:52,137 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (25)': 25
2025-10-31 18:47:52,137 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 25}
2025-10-31 18:47:52,137 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 25, フロップ（最初の3枚のコミュニティカード）の時点で、私は「J♣ 8♣」という手札を持っています。コミュニティカードは「Q♠ 7♠ 6♥」です。このボード（コミュニティカードの組み合わせ）では、私にはフラッシュ（同じスートのカードが5枚揃うこと）のドロー（役が完成する可能性）があり、具体的にはスペード（♠）のフラッシュが完成する可能性があります。また、ジャック（J）とエイト（8）でペア（同じ数字のカードが2枚揃うこと）も作れます。相手（プレイヤー4）は25をベットしてきました。これはコール（相手のベット額と同額を支払うこと）するには比較的小さな額です。私の手札はまだ強い役ができていませんが、フラッシュが完成する可能性があり、相手のベット額もそこまで高くないため、コールして次のカード（ターン）を見るのが最善と考えられます。フォールド（降りること）するには、まだ役が完成する見込みがあるため惜しいです。レイズ（ベット額を上げる行為）するには、現時点ではまだ役が弱いため、リスクが高いと判断しました。
2025-10-31 18:47:52,138 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 25
2025-10-31 18:47:52,138 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:47:52,139 - poker_game - INFO - Hand #5, Phase: flop
2025-10-31 18:47:52,139 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:47:52,139 - poker_game - INFO - Pot: 75, Current bet: 25
2025-10-31 18:47:52,139 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:52,139 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:52,140 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:52,140 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥']
2025-10-31 18:47:52,140 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:52,140 - poker_game - INFO -   P1(Agent1): chips=1950, bet=0, status=active
2025-10-31 18:47:52,141 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:52,141 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:52,141 - poker_game - INFO -   P4(Agent4): chips=6034, bet=25, status=active
2025-10-31 18:47:52,143 - poker_game - INFO - ==================================================
2025-10-31 18:47:52,143 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 25
2025-10-31 18:47:52,154 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:47:52,154 - poker_game - INFO - Hand #5, Phase: flop
2025-10-31 18:47:52,154 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:47:52,155 - poker_game - INFO - Pot: 100, Current bet: 25
2025-10-31 18:47:52,155 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:52,155 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:52,155 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:52,156 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥']
2025-10-31 18:47:52,156 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:52,156 - poker_game - INFO -   P1(Agent1): chips=1925, bet=25, status=active
2025-10-31 18:47:52,156 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:52,156 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:52,157 - poker_game - INFO -   P4(Agent4): chips=6034, bet=25, status=active
2025-10-31 18:47:52,157 - poker_game - INFO - Extra: Action: Player 1 called 25
2025-10-31 18:47:52,157 - poker_game - INFO - ==================================================
2025-10-31 18:47:52,157 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:47:52,157 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:47:52,158 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:47:52,158 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:47:52,158 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:47:52,158 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:47:52,158 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:47:52,158 - poker_game - DEBUG - Player bets: [25, 25], Current bet: 25, All same: True
2025-10-31 18:47:52,158 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:47:52,159 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:47:52,159 - poker_game - INFO - Hand #5, Phase: flop
2025-10-31 18:47:52,159 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:52,159 - poker_game - INFO - Pot: 100, Current bet: 25
2025-10-31 18:47:52,159 - poker_game - INFO - Last raiser: 4
2025-10-31 18:47:52,159 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:52,160 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:52,160 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥']
2025-10-31 18:47:52,160 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:52,160 - poker_game - INFO -   P1(Agent1): chips=1925, bet=25, status=active
2025-10-31 18:47:52,160 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:52,161 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:52,161 - poker_game - INFO -   P4(Agent4): chips=6034, bet=25, status=active
2025-10-31 18:47:52,161 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:47:52,161 - poker_game - INFO - ==================================================
2025-10-31 18:47:52,262 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:47:52,263 - poker_game - INFO - Betting round complete: True
2025-10-31 18:47:52,263 - poker_game - INFO - Remaining players: 2
2025-10-31 18:47:52,263 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:47:52,263 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:47:52,264 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:47:52,276 - poker_game - INFO - Starting new betting round
2025-10-31 18:47:52,277 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:47:52,278 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:47:52,278 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:47:52,278 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:47:52,279 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 18:47:52,279 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:47:52,279 - poker_game - INFO - Hand #5, Phase: turn
2025-10-31 18:47:52,280 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:47:52,280 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:47:52,281 - poker_game - INFO - Last raiser: None
2025-10-31 18:47:52,281 - poker_game - INFO - Betting round complete: False
2025-10-31 18:47:52,282 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:47:52,282 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠']
2025-10-31 18:47:52,283 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:47:52,283 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:47:52,284 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:47:52,284 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:47:52,285 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:47:52,285 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:47:52,286 - poker_game - INFO - ==================================================
2025-10-31 18:47:52,286 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "7♣",
    "2♣"
  ],
  "community": [
    "Q♠",
    "7♠",
    "6♥",
    "10♠"
  ],
  "your_chips": 6034,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 45,
  "pot": 100,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1925,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1941,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6034)"
  ],
  "history": [
    "Player 4 checked",
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠"
  ]
}
2025-10-31 18:47:52,302 - poker_game - DEBUG - Create Session: {'id': '214b2cf4-c200-41bb-b8f7-352f9c584228', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904072.293027}
2025-10-31 18:48:02,328 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:48:02,167 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_ZH9LQMLTorpOlZ7W6QdOOcMa', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1255, 'totalTokenCount': 1272}, 'invocationId': 'e-90a3d2f8-6cdb-4848-a42c-f3b97076abe2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'seRTfPo6', 'timestamp': 1761904072.316538}, {'content': {'parts': [{'functionResponse': {'id': 'call_ZH9LQMLTorpOlZ7W6QdOOcMa', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-90a3d2f8-6cdb-4848-a42c-f3b97076abe2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'rzH9gckN', 'timestamp': 1761904073.259103}, {'content': {'parts': [{'functionCall': {'id': 'call_5ZiydnGcI7OTjcLXtPtkHDfq', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['7♣', '2♣'], 'community': ['Q♠', '7♠', '6♥', '10♠'], 'your_chips': 6034, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 45, 'pot': 100, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1925, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1941, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6034)'], 'history': ['Player 4 checked', 'Turn dealt: 7♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 2♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥', 'Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣', 'Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 folded', 'Player 4 checked', 'Flop dealt: Q♠, 7♠, 6♥', 'Player 4 raised to 25', 'Player 1 called 25', 'Turn dealt: 10♠']}, 'call_amount': 0, 'pot_after_call': 100, 'equity': 0.4}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_vki7C48vFn5rODy8R2boibT3', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 512, 'promptTokenCount': 1779, 'totalTokenCount': 2291}, 'invocationId': 'e-90a3d2f8-6cdb-4848-a42c-f3b97076abe2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'XnDSku6Q', 'timestamp': 1761904073.263031}, {'content': {'parts': [{'functionResponse': {'id': 'call_5ZiydnGcI7OTjcLXtPtkHDfq', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（40.00(ポットに対して40.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_vki7C48vFn5rODy8R2boibT3', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'VpRttBjW', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'KtU8JJ8p', 'timestamp': 1761904080.515602}, {'content': {'parts': [{'text': '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い（40.00(ポットに対して40.00%）ため、チェックします"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 48, 'promptTokenCount': 1945, 'totalTokenCount': 1993}, 'invocationId': 'e-90a3d2f8-6cdb-4848-a42c-f3b97076abe2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '3XzT9Jsa', 'timestamp': 1761904080.517735}]
2025-10-31 18:48:02,168 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:48:02,169 - poker_game - DEBUG - {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い（40.00(ポットに対して40.00%）ため、チェックします"
}
2025-10-31 18:48:02,169 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:48:02,169 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い（40.00(ポットに対して40.00%）ため、チェックします"\n}'
2025-10-31 18:48:02,169 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:48:02,170 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い（40.00(ポットに対して40.00%）ため、チェックします"
}
2025-10-31 18:48:02,170 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（40.00(ポットに対して40.00%）ため、チェックします'}
2025-10-31 18:48:02,170 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:48:02,170 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:48:02,170 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:48:02,170 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（40.00(ポットに対して40.00%）ため、チェックします
2025-10-31 18:48:02,171 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:48:02,171 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:02,171 - poker_game - INFO - Hand #5, Phase: turn
2025-10-31 18:48:02,171 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:02,172 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:02,172 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:02,172 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:02,172 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:02,172 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠']
2025-10-31 18:48:02,172 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:02,173 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:02,173 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:02,173 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:02,173 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:02,173 - poker_game - INFO - ==================================================
2025-10-31 18:48:02,173 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:48:02,207 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:02,207 - poker_game - INFO - Hand #5, Phase: turn
2025-10-31 18:48:02,208 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:02,208 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:02,208 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:02,208 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:02,208 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:02,209 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠']
2025-10-31 18:48:02,209 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:02,209 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:02,210 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:02,210 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:02,210 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:02,210 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:48:02,210 - poker_game - INFO - ==================================================
2025-10-31 18:48:02,211 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:02,211 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:02,211 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:48:02,211 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:48:02,211 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:02,211 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:02,212 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:48:02,212 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:48:02,212 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:48:02,212 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:48:02,212 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:48:02,212 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:48:02,212 - poker_game - DEBUG - Betting continues: Current player 1 != first actor 4
2025-10-31 18:48:02,212 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:02,213 - poker_game - INFO - Hand #5, Phase: turn
2025-10-31 18:48:02,213 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:48:02,213 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:02,213 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:02,214 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:02,214 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:02,214 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠']
2025-10-31 18:48:02,214 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:02,214 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:02,214 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:02,215 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:02,215 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:02,215 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:48:02,215 - poker_game - INFO - ==================================================
2025-10-31 18:48:02,317 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "8♣",
    "J♣"
  ],
  "community": [
    "Q♠",
    "7♠",
    "6♥",
    "10♠"
  ],
  "your_chips": 1925,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 45,
  "pot": 100,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1941,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6034,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1925)"
  ],
  "history": [
    "Turn dealt: 7♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked"
  ]
}
2025-10-31 18:48:02,327 - poker_game - DEBUG - Create Session: {'id': '9e199f46-b175-49bb-9824-0ea45157e824', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904082.3248684}
2025-10-31 18:48:04,491 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在、コールすべき金額は0で、相手はチェックしました。私の手札は、フロップ（コミュニティカード）と合わせて、テン（10）とジャック（J）のペア（pair）であり、さらにクラブ（♣）のスリーカード（three cards of the same suit）が揃っています。このスリーカードはフラッシュ（flush）という強い役になる可能性があります。相手のチェックは、相手も強い手を持っていないか、またはブラフ（bluff）である可能性を示唆しています。そのため、このままゲームを進めるためにチェックを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 152, 'promptTokenCount': 915, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 915}], 'totalTokenCount': 1067}, 'invocationId': 'e-ed61dfbc-886d-42ff-9982-6507a926606c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'AyNRLvND', 'timestamp': 1761904082.336891}]
2025-10-31 18:48:04,491 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:48:04,492 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "現在、コールすべき金額は0で、相手はチェックしました。私の手札は、フロップ（コミュニティカード）と合わせて、テン（10）とジャック（J）のペア（pair）であり、さらにクラブ（♣）のスリーカード（three cards of the same suit）が揃っています。このスリーカードはフラッシュ（flush）という強い役になる可能性があります。相手のチェックは、相手も強い手を持っていないか、またはブラフ（bluff）である可能性を示唆しています。そのため、このままゲームを進めるためにチェックを選択します。"
}
```
2025-10-31 18:48:04,492 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:48:04,492 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在、コールすべき金額は0で、相手はチェックしました。私の手札は、フロップ（コミュニティカード）と合わせて、テン（10）とジャック（J）のペア（pair）であり、さらにクラブ（♣）のスリーカード（three cards of the same suit）が揃っています。このスリーカードはフラッシュ（flush）という強い役になる可能性があります。相手のチェックは、相手も強い手を持っていないか、またはブラフ（bluff）である可能性を示唆しています。そのため、このままゲームを進めるためにチェックを選択します。"\n}\n```'
2025-10-31 18:48:04,492 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:48:04,492 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在、コールすべき金額は0で、相手はチェックしました。私の手札は、フロップ（コミュニティカード）と合わせて、テン（10）とジャック（J）のペア（pair）であり、さらにクラブ（♣）のスリーカード（three cards of the same suit）が揃っています。このスリーカードはフラッシュ（flush）という強い役になる可能性があります。相手のチェックは、相手も強い手を持っていないか、またはブラフ（bluff）である可能性を示唆しています。そのため、このままゲームを進めるためにチェックを選択します。"\n}'
2025-10-31 18:48:04,492 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "現在、コールすべき金額は0で、相手はチェックしました。私の手札は、フロップ（コミュニティカード）と合わせて、テン（10）とジャック（J）のペア（pair）であり、さらにクラブ（♣）のスリーカード（three cards of the same suit）が揃っています。このスリーカードはフラッシュ（flush）という強い役になる可能性があります。相手のチェックは、相手も強い手を持っていないか、またはブラフ（bluff）である可能性を示唆しています。そのため、このままゲームを進めるためにチェックを選択します。"
}
2025-10-31 18:48:04,493 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': '現在、コールすべき金額は0で、相手はチェックしました。私の手札は、フロップ（コミュニティカード）と合わせて、テン（10）とジャック（J）のペア（pair）であり、さらにクラブ（♣）のスリーカード（three cards of the same suit）が揃っています。このスリーカードはフラッシュ（flush）という強い役になる可能性があります。相手のチェックは、相手も強い手を持っていないか、またはブラフ（bluff）である可能性を示唆しています。そのため、このままゲームを進めるためにチェックを選択します。'}
2025-10-31 18:48:04,493 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 0
2025-10-31 18:48:04,493 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1925)']
2025-10-31 18:48:04,493 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:48:04,493 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 0, 現在、コールすべき金額は0で、相手はチェックしました。私の手札は、フロップ（コミュニティカード）と合わせて、テン（10）とジャック（J）のペア（pair）であり、さらにクラブ（♣）のスリーカード（three cards of the same suit）が揃っています。このスリーカードはフラッシュ（flush）という強い役になる可能性があります。相手のチェックは、相手も強い手を持っていないか、またはブラフ（bluff）である可能性を示唆しています。そのため、このままゲームを進めるためにチェックを選択します。
2025-10-31 18:48:04,494 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 0
2025-10-31 18:48:04,494 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:04,494 - poker_game - INFO - Hand #5, Phase: turn
2025-10-31 18:48:04,495 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:48:04,495 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:04,496 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:04,496 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:04,497 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:04,497 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠']
2025-10-31 18:48:04,497 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:04,497 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:04,498 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:04,498 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:04,498 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:04,498 - poker_game - INFO - ==================================================
2025-10-31 18:48:04,498 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:48:04,519 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:04,522 - poker_game - INFO - Hand #5, Phase: turn
2025-10-31 18:48:04,523 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:48:04,523 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:04,524 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:04,524 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:04,524 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:04,525 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠']
2025-10-31 18:48:04,526 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:04,526 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:04,527 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:04,527 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:04,528 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:04,528 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:48:04,528 - poker_game - INFO - ==================================================
2025-10-31 18:48:04,529 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:04,529 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:04,530 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:48:04,530 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:48:04,530 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:04,531 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:04,531 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:48:04,531 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:48:04,531 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:48:04,531 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:48:04,532 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:48:04,532 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:48:04,532 - poker_game - INFO - Betting complete: Back to first actor 4 (all players have acted)
2025-10-31 18:48:04,532 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:04,533 - poker_game - INFO - Hand #5, Phase: turn
2025-10-31 18:48:04,533 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:04,533 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:04,534 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:04,534 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:04,534 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:04,535 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠']
2025-10-31 18:48:04,535 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:04,535 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:04,536 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:04,536 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:04,536 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:04,537 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:48:04,537 - poker_game - INFO - ==================================================
2025-10-31 18:48:04,639 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:48:04,639 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:04,640 - poker_game - INFO - Remaining players: 2
2025-10-31 18:48:04,640 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:48:04,641 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:48:04,641 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:48:04,653 - poker_game - INFO - Starting new betting round
2025-10-31 18:48:04,653 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:48:04,654 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:48:04,654 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:48:04,654 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:48:04,654 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 18:48:04,655 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:48:04,655 - poker_game - INFO - Hand #5, Phase: river
2025-10-31 18:48:04,656 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:04,656 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:04,656 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:04,657 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:04,657 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:04,658 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:04,658 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:04,659 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:04,660 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:04,660 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:04,661 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:04,662 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:48:04,662 - poker_game - INFO - ==================================================
2025-10-31 18:48:04,663 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "7♣",
    "2♣"
  ],
  "community": [
    "Q♠",
    "7♠",
    "6♥",
    "10♠",
    "K♠"
  ],
  "your_chips": 6034,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 45,
  "pot": 100,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1925,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1941,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6034)"
  ],
  "history": [
    "Player 4 checked",
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠"
  ]
}
2025-10-31 18:48:04,678 - poker_game - DEBUG - Create Session: {'id': '2f727dba-d141-475b-8aaa-45e22541769d', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904084.675161}
2025-10-31 18:48:14,745 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:48:17,641 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_6382TuPcrlPDL9lhkOK9PW7g', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1260, 'totalTokenCount': 1277}, 'invocationId': 'e-8d11e818-0c18-43f9-8349-62b76f334696', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IwuBGpXE', 'timestamp': 1761904084.766096}, {'content': {'parts': [{'functionResponse': {'id': 'call_6382TuPcrlPDL9lhkOK9PW7g', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-8d11e818-0c18-43f9-8349-62b76f334696', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'G3dsoPMR', 'timestamp': 1761904085.794054}, {'content': {'parts': [{'functionCall': {'id': 'call_09uALrGtXJydYpmtZd5QVape', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['7♣', '2♣'], 'community': ['Q♠', '7♠', '6♥', '10♠', 'K♠'], 'your_chips': 6034, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 45, 'pot': 100, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1925, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1941, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6034)'], 'history': ['Player 4 checked', 'River dealt: 2♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠', 'Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 folded', 'Player 4 checked', 'Flop dealt: Q♠, 7♠, 6♥', 'Player 4 raised to 25', 'Player 1 called 25', 'Turn dealt: 10♠', 'Player 4 checked', 'Player 1 checked']}, 'call_amount': 0, 'pot_after_call': 100, 'equity': 0.0}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 457, 'promptTokenCount': 1784, 'totalTokenCount': 2241}, 'invocationId': 'e-8d11e818-0c18-43f9-8349-62b76f334696', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IhOAKSV6', 'timestamp': 1761904085.797387}, {'content': {'parts': [{'functionResponse': {'id': 'call_09uALrGtXJydYpmtZd5QVape', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（0.00(ポットに対して0.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-8d11e818-0c18-43f9-8349-62b76f334696', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'AjcuAxfw', 'timestamp': 1761904096.173411}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2292, 'totalTokenCount': 2330}, 'invocationId': 'e-8d11e818-0c18-43f9-8349-62b76f334696', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '75beG4xN', 'timestamp': 1761904096.175076}]
2025-10-31 18:48:17,642 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:48:17,642 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}
2025-10-31 18:48:17,642 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:48:17,643 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}'
2025-10-31 18:48:17,643 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:48:17,643 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}
2025-10-31 18:48:17,643 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（0.00(ポットに対して0.00%）ため、チェックします'}
2025-10-31 18:48:17,643 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:48:17,643 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:48:17,643 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:48:17,644 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（0.00(ポットに対して0.00%）ため、チェックします
2025-10-31 18:48:17,644 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:48:17,644 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:17,645 - poker_game - INFO - Hand #5, Phase: river
2025-10-31 18:48:17,645 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:17,645 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:17,646 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:17,647 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:17,648 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:17,648 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:17,648 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:17,648 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:17,648 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:17,649 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:17,649 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:17,649 - poker_game - INFO - ==================================================
2025-10-31 18:48:17,649 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:48:17,657 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:17,657 - poker_game - INFO - Hand #5, Phase: river
2025-10-31 18:48:17,658 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:17,658 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:17,658 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:17,658 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:17,658 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:17,658 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:17,659 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:17,659 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:17,659 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:17,659 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:17,660 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:17,660 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:48:17,660 - poker_game - INFO - ==================================================
2025-10-31 18:48:17,660 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:17,660 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:17,660 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:48:17,660 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:48:17,661 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:17,661 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:17,661 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:48:17,661 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:48:17,661 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:48:17,661 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:48:17,661 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:48:17,661 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:48:17,662 - poker_game - DEBUG - Betting continues: Current player 1 != first actor 4
2025-10-31 18:48:17,662 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:17,662 - poker_game - INFO - Hand #5, Phase: river
2025-10-31 18:48:17,662 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:48:17,662 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:17,662 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:17,663 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:17,663 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:17,663 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:17,663 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:17,663 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:17,663 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:17,663 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:17,664 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:17,664 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:48:17,664 - poker_game - INFO - ==================================================
2025-10-31 18:48:17,766 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "8♣",
    "J♣"
  ],
  "community": [
    "Q♠",
    "7♠",
    "6♥",
    "10♠",
    "K♠"
  ],
  "your_chips": 1925,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 45,
  "pot": 100,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1941,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6034,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1925)"
  ],
  "history": [
    "River dealt: 2♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣ cards=5♦, J♥",
    "Showdown: Player 4 hand=High Card: Q♣ - Q♣, J♠, 7♣, 5♣, 4♠ cards=3♦, Q♣",
    "Side pot layer 0: amount=30, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Side pot layer 1: amount=20, winners=3 best_hand=Two Pair: Js and 5s - J♥, J♠, 7♣, 5♦, 5♣",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked"
  ]
}
2025-10-31 18:48:17,775 - poker_game - DEBUG - Create Session: {'id': 'ec8884e5-6020-467d-a3dd-aa8566a94554', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904097.7727888}
2025-10-31 18:48:20,463 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）まで来て、コミュニティカードは Q♠, 7♠, 6♥, 10♠, K♠ となっています。あなたの手札は 8♣, J♣ です。コミュニティカードの K♠, 10♠, 7♠, Q♠ とあなたの J♣ を合わせると、クラブ（♣）は2枚しかありませんが、フロップ、ターン、リバーでスペード（♠）が3枚出ており、相手のK♠、10♠、Q♠、7♠ の可能性を考えると、ストレート（7, 8, 9, 10, J や 10, J, Q, K, A など）やフラッシュ（同じスートが5枚揃うこと）の可能性が考えられます。しかし、あなたの手札のクラブは2枚だけなので、フラッシュは完成していません。また、ストレートも完成していません。相手はベットしていないため、こちらもチェックしてショーダウン（カードを公開して勝者を決めること）に進むのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 261, 'promptTokenCount': 920, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 920}], 'totalTokenCount': 1181}, 'invocationId': 'e-6632446b-7c63-4fcf-b67e-5206523f4213', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'd70cngIo', 'timestamp': 1761904097.785852}]
2025-10-31 18:48:20,463 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:48:20,463 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカード）まで来て、コミュニティカードは Q♠, 7♠, 6♥, 10♠, K♠ となっています。あなたの手札は 8♣, J♣ です。コミュニティカードの K♠, 10♠, 7♠, Q♠ とあなたの J♣ を合わせると、クラブ（♣）は2枚しかありませんが、フロップ、ターン、リバーでスペード（♠）が3枚出ており、相手のK♠、10♠、Q♠、7♠ の可能性を考えると、ストレート（7, 8, 9, 10, J や 10, J, Q, K, A など）やフラッシュ（同じスートが5枚揃うこと）の可能性が考えられます。しかし、あなたの手札のクラブは2枚だけなので、フラッシュは完成していません。また、ストレートも完成していません。相手はベットしていないため、こちらもチェックしてショーダウン（カードを公開して勝者を決めること）に進むのが最善です。"
}
```
2025-10-31 18:48:20,463 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:48:20,463 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）まで来て、コミュニティカードは Q♠, 7♠, 6♥, 10♠, K♠ となっています。あなたの手札は 8♣, J♣ です。コミュニティカードの K♠, 10♠, 7♠, Q♠ とあなたの J♣ を合わせると、クラブ（♣）は2枚しかありませんが、フロップ、ターン、リバーでスペード（♠）が3枚出ており、相手のK♠、10♠、Q♠、7♠ の可能性を考えると、ストレート（7, 8, 9, 10, J や 10, J, Q, K, A など）やフラッシュ（同じスートが5枚揃うこと）の可能性が考えられます。しかし、あなたの手札のクラブは2枚だけなので、フラッシュは完成していません。また、ストレートも完成していません。相手はベットしていないため、こちらもチェックしてショーダウン（カードを公開して勝者を決めること）に進むのが最善です。"\n}\n```'
2025-10-31 18:48:20,464 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:48:20,464 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）まで来て、コミュニティカードは Q♠, 7♠, 6♥, 10♠, K♠ となっています。あなたの手札は 8♣, J♣ です。コミュニティカードの K♠, 10♠, 7♠, Q♠ とあなたの J♣ を合わせると、クラブ（♣）は2枚しかありませんが、フロップ、ターン、リバーでスペード（♠）が3枚出ており、相手のK♠、10♠、Q♠、7♠ の可能性を考えると、ストレート（7, 8, 9, 10, J や 10, J, Q, K, A など）やフラッシュ（同じスートが5枚揃うこと）の可能性が考えられます。しかし、あなたの手札のクラブは2枚だけなので、フラッシュは完成していません。また、ストレートも完成していません。相手はベットしていないため、こちらもチェックしてショーダウン（カードを公開して勝者を決めること）に進むのが最善です。"\n}'
2025-10-31 18:48:20,464 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカード）まで来て、コミュニティカードは Q♠, 7♠, 6♥, 10♠, K♠ となっています。あなたの手札は 8♣, J♣ です。コミュニティカードの K♠, 10♠, 7♠, Q♠ とあなたの J♣ を合わせると、クラブ（♣）は2枚しかありませんが、フロップ、ターン、リバーでスペード（♠）が3枚出ており、相手のK♠、10♠、Q♠、7♠ の可能性を考えると、ストレート（7, 8, 9, 10, J や 10, J, Q, K, A など）やフラッシュ（同じスートが5枚揃うこと）の可能性が考えられます。しかし、あなたの手札のクラブは2枚だけなので、フラッシュは完成していません。また、ストレートも完成していません。相手はベットしていないため、こちらもチェックしてショーダウン（カードを公開して勝者を決めること）に進むのが最善です。"
}
2025-10-31 18:48:20,464 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最後のカード）まで来て、コミュニティカードは Q♠, 7♠, 6♥, 10♠, K♠ となっています。あなたの手札は 8♣, J♣ です。コミュニティカードの K♠, 10♠, 7♠, Q♠ とあなたの J♣ を合わせると、クラブ（♣）は2枚しかありませんが、フロップ、ターン、リバーでスペード（♠）が3枚出ており、相手のK♠、10♠、Q♠、7♠ の可能性を考えると、ストレート（7, 8, 9, 10, J や 10, J, Q, K, A など）やフラッシュ（同じスートが5枚揃うこと）の可能性が考えられます。しかし、あなたの手札のクラブは2枚だけなので、フラッシュは完成していません。また、ストレートも完成していません。相手はベットしていないため、こちらもチェックしてショーダウン（カードを公開して勝者を決めること）に進むのが最善です。'}
2025-10-31 18:48:20,464 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 18:48:20,464 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 18:48:20,465 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:48:20,465 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, リバー（最後のカード）まで来て、コミュニティカードは Q♠, 7♠, 6♥, 10♠, K♠ となっています。あなたの手札は 8♣, J♣ です。コミュニティカードの K♠, 10♠, 7♠, Q♠ とあなたの J♣ を合わせると、クラブ（♣）は2枚しかありませんが、フロップ、ターン、リバーでスペード（♠）が3枚出ており、相手のK♠、10♠、Q♠、7♠ の可能性を考えると、ストレート（7, 8, 9, 10, J や 10, J, Q, K, A など）やフラッシュ（同じスートが5枚揃うこと）の可能性が考えられます。しかし、あなたの手札のクラブは2枚だけなので、フラッシュは完成していません。また、ストレートも完成していません。相手はベットしていないため、こちらもチェックしてショーダウン（カードを公開して勝者を決めること）に進むのが最善です。
2025-10-31 18:48:20,465 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 18:48:20,466 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:20,466 - poker_game - INFO - Hand #5, Phase: river
2025-10-31 18:48:20,466 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:48:20,466 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:20,469 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:20,470 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:20,472 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:20,472 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:20,472 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:20,472 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:20,472 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:20,472 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:20,472 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:20,473 - poker_game - INFO - ==================================================
2025-10-31 18:48:20,473 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:48:20,491 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:20,491 - poker_game - INFO - Hand #5, Phase: river
2025-10-31 18:48:20,492 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:48:20,492 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:20,492 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:20,492 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:20,492 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:20,493 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:20,493 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:20,493 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:20,493 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:20,493 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:20,493 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:20,493 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:48:20,494 - poker_game - INFO - ==================================================
2025-10-31 18:48:20,494 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:20,494 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:20,494 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:48:20,494 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:48:20,495 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:20,495 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:20,495 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:48:20,495 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:48:20,495 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:48:20,495 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:48:20,495 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:48:20,496 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:48:20,496 - poker_game - INFO - Betting complete: Back to first actor 4 (all players have acted)
2025-10-31 18:48:20,496 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:20,496 - poker_game - INFO - Hand #5, Phase: river
2025-10-31 18:48:20,497 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:20,497 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:20,497 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:20,497 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:20,498 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:20,498 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:20,498 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:20,498 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:20,498 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:20,498 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:20,499 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:20,499 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:48:20,499 - poker_game - INFO - ==================================================
2025-10-31 18:48:20,599 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:48:20,600 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:20,600 - poker_game - INFO - Remaining players: 2
2025-10-31 18:48:20,601 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:48:20,601 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:48:20,601 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:48:20,602 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:48:20,602 - poker_game - INFO - Hand #5, Phase: showdown
2025-10-31 18:48:20,602 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:48:20,603 - poker_game - INFO - Pot: 100, Current bet: 0
2025-10-31 18:48:20,603 - poker_game - INFO - Last raiser: None
2025-10-31 18:48:20,603 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:20,604 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:20,604 - poker_game - INFO - Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:20,604 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:20,605 - poker_game - INFO -   P1(Agent1): chips=1925, bet=0, status=active
2025-10-31 18:48:20,605 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:20,605 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=folded
2025-10-31 18:48:20,606 - poker_game - INFO -   P4(Agent4): chips=6034, bet=0, status=active
2025-10-31 18:48:20,606 - poker_game - INFO - ==================================================
2025-10-31 18:48:20,606 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:48:20,607 - poker_game - INFO - Pot: 100, Community cards: ['Q♠', '7♠', '6♥', '10♠', 'K♠']
2025-10-31 18:48:20,607 - poker_game - INFO -   Player 1 status=active cards=['8♣', 'J♣']
2025-10-31 18:48:20,607 - poker_game - INFO -   Player 4 status=active cards=['7♣', '2♣']
2025-10-31 18:48:20,610 - poker_game - INFO -   Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=['8♣', 'J♣']
2025-10-31 18:48:20,610 - poker_game - INFO -   Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=['7♣', '2♣']
2025-10-31 18:48:20,611 - poker_game - INFO - Pot layer 0: amount=30, contributors=[1, 3, 4]
2025-10-31 18:48:20,611 - poker_game - INFO - Pot layer 1: amount=70, contributors=[1, 4]
2025-10-31 18:48:20,612 - poker_game - INFO - Showdown total awarded: 100 (game.pot=100)
2025-10-31 18:48:20,612 - poker_game - INFO - Showdown winners (aggregated): [4]
2025-10-31 18:48:20,613 - poker_game - INFO -   Awarded 100 to Player 4 (hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠)
2025-10-31 18:48:20,613 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:48:20,641 - poker_game - INFO - === STARTING NEW HAND #6 ===
2025-10-31 18:48:20,642 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:48:20,643 - poker_game - INFO - Moving dealer button
2025-10-31 18:48:20,643 - poker_game - INFO - Posting blinds
2025-10-31 18:48:20,661 - poker_game - INFO - Dealing hole cards
2025-10-31 18:48:20,662 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:48:20,673 - poker_game - INFO - Started new hand in database: hand_id=6
2025-10-31 18:48:20,674 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:48:20,674 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:20,674 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:48:20,675 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:48:20,675 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:20,675 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:20,676 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:20,676 - poker_game - INFO - Community cards: []
2025-10-31 18:48:20,676 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:20,677 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:20,677 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:20,678 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=active
2025-10-31 18:48:20,678 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=active
2025-10-31 18:48:20,679 - poker_game - INFO - ==================================================
2025-10-31 18:48:20,681 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "6♠",
    "6♥"
  ],
  "community": [],
  "your_chips": 1941,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1905,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6124,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1941)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 18:48:20,694 - poker_game - DEBUG - Create Session: {'id': 'df2a8213-9a50-4dbd-8c4f-c176a41824be', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904100.692149}
2025-10-31 18:48:22,839 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで66（ポケットシックス）というペアを持っている。これは中程度の強さの手札であり、レイズされた場合でもコールしてフロップを見る価値がある。相手のレイズ額（20）は、私のポット（30）と、コールに必要な額（20）を考慮すると、コールするのが最も合理的な判断です。フロップを見て、ペアが完成するか、より良い役が作れるか判断します。All-inはまだ早く、フォールドはもったいない。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 140, 'promptTokenCount': 897, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 897}], 'totalTokenCount': 1037}, 'invocationId': 'e-c0f4403e-4f1a-48a4-9429-8b10c9d1d4a2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QEqiwS4t', 'timestamp': 1761904100.704232}]
2025-10-31 18:48:22,839 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:48:22,839 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで66（ポケットシックス）というペアを持っている。これは中程度の強さの手札であり、レイズされた場合でもコールしてフロップを見る価値がある。相手のレイズ額（20）は、私のポット（30）と、コールに必要な額（20）を考慮すると、コールするのが最も合理的な判断です。フロップを見て、ペアが完成するか、より良い役が作れるか判断します。All-inはまだ早く、フォールドはもったいない。"
}
```
2025-10-31 18:48:22,840 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:48:22,840 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで66（ポケットシックス）というペアを持っている。これは中程度の強さの手札であり、レイズされた場合でもコールしてフロップを見る価値がある。相手のレイズ額（20）は、私のポット（30）と、コールに必要な額（20）を考慮すると、コールするのが最も合理的な判断です。フロップを見て、ペアが完成するか、より良い役が作れるか判断します。All-inはまだ早く、フォールドはもったいない。"\n}\n```'
2025-10-31 18:48:22,840 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:48:22,840 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで66（ポケットシックス）というペアを持っている。これは中程度の強さの手札であり、レイズされた場合でもコールしてフロップを見る価値がある。相手のレイズ額（20）は、私のポット（30）と、コールに必要な額（20）を考慮すると、コールするのが最も合理的な判断です。フロップを見て、ペアが完成するか、より良い役が作れるか判断します。All-inはまだ早く、フォールドはもったいない。"\n}'
2025-10-31 18:48:22,841 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで66（ポケットシックス）というペアを持っている。これは中程度の強さの手札であり、レイズされた場合でもコールしてフロップを見る価値がある。相手のレイズ額（20）は、私のポット（30）と、コールに必要な額（20）を考慮すると、コールするのが最も合理的な判断です。フロップを見て、ペアが完成するか、より良い役が作れるか判断します。All-inはまだ早く、フォールドはもったいない。"
}
2025-10-31 18:48:22,841 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップで66（ポケットシックス）というペアを持っている。これは中程度の強さの手札であり、レイズされた場合でもコールしてフロップを見る価値がある。相手のレイズ額（20）は、私のポット（30）と、コールに必要な額（20）を考慮すると、コールするのが最も合理的な判断です。フロップを見て、ペアが完成するか、より良い役が作れるか判断します。All-inはまだ早く、フォールドはもったいない。'}
2025-10-31 18:48:22,841 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 20
2025-10-31 18:48:22,841 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (1941)']
2025-10-31 18:48:22,841 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (20)': 20
2025-10-31 18:48:22,841 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:48:22,842 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 20, プリフロップで66（ポケットシックス）というペアを持っている。これは中程度の強さの手札であり、レイズされた場合でもコールしてフロップを見る価値がある。相手のレイズ額（20）は、私のポット（30）と、コールに必要な額（20）を考慮すると、コールするのが最も合理的な判断です。フロップを見て、ペアが完成するか、より良い役が作れるか判断します。All-inはまだ早く、フォールドはもったいない。
2025-10-31 18:48:22,843 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 20
2025-10-31 18:48:22,843 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:22,844 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:22,844 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:48:22,844 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:48:22,845 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:22,845 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:22,846 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:22,846 - poker_game - INFO - Community cards: []
2025-10-31 18:48:22,846 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:22,847 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:22,847 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:22,848 - poker_game - INFO -   P3(Agent3): chips=1941, bet=0, status=active
2025-10-31 18:48:22,848 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=active
2025-10-31 18:48:22,848 - poker_game - INFO - ==================================================
2025-10-31 18:48:22,849 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 20
2025-10-31 18:48:22,862 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:22,863 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:22,863 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:48:22,864 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:22,864 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:22,865 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:22,865 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:22,866 - poker_game - INFO - Community cards: []
2025-10-31 18:48:22,866 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:22,867 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:22,867 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:22,867 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:22,868 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=active
2025-10-31 18:48:22,868 - poker_game - INFO - Extra: Action: Player 3 called 20
2025-10-31 18:48:22,868 - poker_game - INFO - ==================================================
2025-10-31 18:48:22,869 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:22,869 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:22,869 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:48:22,870 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:48:22,870 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:22,870 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:22,871 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:48:22,871 - poker_game - DEBUG - Player bets: [20, 20, 10], Current bet: 20, All same: False
2025-10-31 18:48:22,871 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:48:22,871 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:22,872 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:22,873 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:48:22,874 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:22,874 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:22,875 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:22,875 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:22,876 - poker_game - INFO - Community cards: []
2025-10-31 18:48:22,876 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:22,877 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:22,877 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:22,878 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:22,878 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=active
2025-10-31 18:48:22,879 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:48:22,879 - poker_game - INFO - ==================================================
2025-10-31 18:48:22,982 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "8♣",
    "2♥"
  ],
  "community": [],
  "your_chips": 6124,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1905,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1921,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (6124)"
  ],
  "history": [
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20"
  ]
}
2025-10-31 18:48:22,996 - poker_game - DEBUG - Create Session: {'id': 'beded8c4-a483-482f-a0ce-6711ee3cf8cb', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904102.9944358}
2025-10-31 18:48:33,118 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:48:33,880 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_ODY3pTjqOYKkNbrj6w53U5W4', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1237, 'totalTokenCount': 1254}, 'invocationId': 'e-3f41a273-2aaa-4c8a-b62d-381cd160dbb2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'XSgSocy6', 'timestamp': 1761904103.006838}, {'content': {'parts': [{'functionResponse': {'id': 'call_ODY3pTjqOYKkNbrj6w53U5W4', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-3f41a273-2aaa-4c8a-b62d-381cd160dbb2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'IAMrhUQd', 'timestamp': 1761904104.283308}, {'content': {'parts': [{'functionCall': {'id': 'call_RCXzVqUMRpX8wbZLoFEWyU4a', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['8♣', '2♥'], 'community': [], 'your_chips': 6124, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 50, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1905, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1921, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (6124)'], 'history': ['Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 folded', 'Player 4 checked', 'Flop dealt: Q♠, 7♠, 6♥', 'Player 4 raised to 25', 'Player 1 called 25', 'Player 1 checked', 'Player 4 checked', 'Player 1 checked', 'Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣', 'Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠', 'Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠', 'Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20']}, 'call_amount': 10, 'pot_after_call': 60, 'equity': 0.1}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 439, 'promptTokenCount': 1761, 'totalTokenCount': 2200}, 'invocationId': 'e-3f41a273-2aaa-4c8a-b62d-381cd160dbb2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '1VhnSKXx', 'timestamp': 1761904104.284682}, {'content': {'parts': [{'functionResponse': {'id': 'call_RCXzVqUMRpX8wbZLoFEWyU4a', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-3.00(ポットに対して-6.00%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'e-3f41a273-2aaa-4c8a-b62d-381cd160dbb2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'HaoAQsjj', 'timestamp': 1761904112.375955}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が-3.00(ポットに対して-6.00%で、マイナスなのでフォールド"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 41, 'promptTokenCount': 2254, 'totalTokenCount': 2295}, 'invocationId': 'e-3f41a273-2aaa-4c8a-b62d-381cd160dbb2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 's8fe6cdJ', 'timestamp': 1761904112.379679}]
2025-10-31 18:48:33,880 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:48:33,881 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が-3.00(ポットに対して-6.00%で、マイナスなのでフォールド"}
2025-10-31 18:48:33,881 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:48:33,881 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が-3.00(ポットに対して-6.00%で、マイナスなのでフォールド"}'
2025-10-31 18:48:33,881 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:48:33,881 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が-3.00(ポットに対して-6.00%で、マイナスなのでフォールド"}
2025-10-31 18:48:33,881 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-3.00(ポットに対して-6.00%で、マイナスなのでフォールド'}
2025-10-31 18:48:33,882 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:48:33,882 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:48:33,882 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:48:33,882 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が-3.00(ポットに対して-6.00%で、マイナスなのでフォールド
2025-10-31 18:48:33,882 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:48:33,883 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:33,883 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:33,883 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:48:33,883 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:33,883 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:33,884 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:33,884 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:33,884 - poker_game - INFO - Community cards: []
2025-10-31 18:48:33,884 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:33,884 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:33,885 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:33,885 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:33,885 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=active
2025-10-31 18:48:33,885 - poker_game - INFO - ==================================================
2025-10-31 18:48:33,885 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:48:33,899 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:33,900 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:33,900 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:48:33,900 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:33,901 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:33,901 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:33,902 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:33,902 - poker_game - INFO - Community cards: []
2025-10-31 18:48:33,902 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:33,902 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:33,903 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:33,903 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:33,904 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=folded
2025-10-31 18:48:33,904 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:48:33,904 - poker_game - INFO - ==================================================
2025-10-31 18:48:33,905 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:33,905 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:33,905 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:48:33,905 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:48:33,905 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:33,906 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:33,906 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:48:33,906 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:48:33,906 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:48:33,906 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:48:33,907 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:48:33,907 - poker_game - DEBUG - Next after last raiser 1: 3
2025-10-31 18:48:33,907 - poker_game - DEBUG - Betting continues: Current player 1 != next after raiser 3
2025-10-31 18:48:33,907 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:33,908 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:33,908 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:48:33,909 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:33,909 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:33,910 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:33,910 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:33,910 - poker_game - INFO - Community cards: []
2025-10-31 18:48:33,911 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:33,911 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:33,912 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:33,912 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:33,912 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=folded
2025-10-31 18:48:33,912 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:48:33,913 - poker_game - INFO - ==================================================
2025-10-31 18:48:34,014 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "A♥",
    "2♦"
  ],
  "community": [],
  "your_chips": 1905,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1921,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6124,
      "bet": 10,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (1905)"
  ],
  "history": [
    "Player 1 called 20",
    "Player 3 folded",
    "Player 4 checked",
    "Flop dealt: Q♠, 7♠, 6♥",
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded"
  ]
}
2025-10-31 18:48:34,025 - poker_game - DEBUG - Create Session: {'id': 'cfb67ea9-a897-4f7e-8a7d-94de566e75b8', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904114.0228791}
2025-10-31 18:48:35,961 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップでAハイ2、Aハイ2は非常に弱いハンド（弱いカード）なので、フォールド（降りる）のが最善の選択です。特に、プレイヤー3がすでに20をベットしており、アクションが回ってくる前にフォールドされたため、アクションは私に回ってきていません。しかし、この状況では、プリフロップでAハイ2は通常プレイしないハンドであり、フォールドするのが最も賢明な判断です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 126, 'promptTokenCount': 888, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 888}], 'totalTokenCount': 1014}, 'invocationId': 'e-56fe44dc-bd18-4f6e-8406-97aec715470c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'KvZLeugF', 'timestamp': 1761904114.034979}]
2025-10-31 18:48:35,961 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:48:35,961 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップでAハイ2、Aハイ2は非常に弱いハンド（弱いカード）なので、フォールド（降りる）のが最善の選択です。特に、プレイヤー3がすでに20をベットしており、アクションが回ってくる前にフォールドされたため、アクションは私に回ってきていません。しかし、この状況では、プリフロップでAハイ2は通常プレイしないハンドであり、フォールドするのが最も賢明な判断です。"
}
```
2025-10-31 18:48:35,962 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:48:35,962 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップでAハイ2、Aハイ2は非常に弱いハンド（弱いカード）なので、フォールド（降りる）のが最善の選択です。特に、プレイヤー3がすでに20をベットしており、アクションが回ってくる前にフォールドされたため、アクションは私に回ってきていません。しかし、この状況では、プリフロップでAハイ2は通常プレイしないハンドであり、フォールドするのが最も賢明な判断です。"\n}\n```'
2025-10-31 18:48:35,962 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:48:35,962 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップでAハイ2、Aハイ2は非常に弱いハンド（弱いカード）なので、フォールド（降りる）のが最善の選択です。特に、プレイヤー3がすでに20をベットしており、アクションが回ってくる前にフォールドされたため、アクションは私に回ってきていません。しかし、この状況では、プリフロップでAハイ2は通常プレイしないハンドであり、フォールドするのが最も賢明な判断です。"\n}'
2025-10-31 18:48:35,962 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップでAハイ2、Aハイ2は非常に弱いハンド（弱いカード）なので、フォールド（降りる）のが最善の選択です。特に、プレイヤー3がすでに20をベットしており、アクションが回ってくる前にフォールドされたため、アクションは私に回ってきていません。しかし、この状況では、プリフロップでAハイ2は通常プレイしないハンドであり、フォールドするのが最も賢明な判断です。"
}
2025-10-31 18:48:35,963 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップでAハイ2、Aハイ2は非常に弱いハンド（弱いカード）なので、フォールド（降りる）のが最善の選択です。特に、プレイヤー3がすでに20をベットしており、アクションが回ってくる前にフォールドされたため、アクションは私に回ってきていません。しかし、この状況では、プリフロップでAハイ2は通常プレイしないハンドであり、フォールドするのが最も賢明な判断です。'}
2025-10-31 18:48:35,963 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:48:35,963 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:48:35,964 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:48:35,964 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップでAハイ2、Aハイ2は非常に弱いハンド（弱いカード）なので、フォールド（降りる）のが最善の選択です。特に、プレイヤー3がすでに20をベットしており、アクションが回ってくる前にフォールドされたため、アクションは私に回ってきていません。しかし、この状況では、プリフロップでAハイ2は通常プレイしないハンドであり、フォールドするのが最も賢明な判断です。
2025-10-31 18:48:35,965 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:48:35,965 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:35,966 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:35,966 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:48:35,966 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:35,967 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:35,967 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:35,967 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:35,967 - poker_game - INFO - Community cards: []
2025-10-31 18:48:35,968 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:35,968 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=active
2025-10-31 18:48:35,968 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:35,968 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:35,968 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=folded
2025-10-31 18:48:35,969 - poker_game - INFO - ==================================================
2025-10-31 18:48:35,969 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:48:35,982 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:35,983 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:35,984 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:48:35,984 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:35,984 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:35,985 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:35,985 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:48:35,985 - poker_game - INFO - Community cards: []
2025-10-31 18:48:35,986 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:35,986 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=folded
2025-10-31 18:48:35,986 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:35,987 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:35,987 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=folded
2025-10-31 18:48:35,987 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:48:35,987 - poker_game - INFO - ==================================================
2025-10-31 18:48:35,987 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:35,988 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:35,988 - poker_game - DEBUG - Active players: [3]
2025-10-31 18:48:35,988 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:48:35,988 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:35,989 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:35,989 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:48:35,989 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:48:35,989 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:35,990 - poker_game - INFO - Hand #6, Phase: preflop
2025-10-31 18:48:35,990 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:48:35,990 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:35,991 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:35,991 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:35,991 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:48:35,991 - poker_game - INFO - Community cards: []
2025-10-31 18:48:35,992 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:35,992 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=folded
2025-10-31 18:48:35,992 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:35,993 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:35,993 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=folded
2025-10-31 18:48:35,993 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:48:35,994 - poker_game - INFO - ==================================================
2025-10-31 18:48:36,096 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:48:36,097 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:36,097 - poker_game - INFO - Remaining players: 1
2025-10-31 18:48:36,098 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:48:36,098 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:48:36,099 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:48:36,100 - poker_game - INFO - Hand #6, Phase: showdown
2025-10-31 18:48:36,100 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:48:36,101 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:36,101 - poker_game - INFO - Last raiser: 1
2025-10-31 18:48:36,102 - poker_game - INFO - Betting round complete: True
2025-10-31 18:48:36,102 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:48:36,103 - poker_game - INFO - Community cards: []
2025-10-31 18:48:36,103 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:36,104 - poker_game - INFO -   P1(Agent1): chips=1905, bet=20, status=folded
2025-10-31 18:48:36,104 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:36,105 - poker_game - INFO -   P3(Agent3): chips=1921, bet=20, status=active
2025-10-31 18:48:36,105 - poker_game - INFO -   P4(Agent4): chips=6124, bet=10, status=folded
2025-10-31 18:48:36,105 - poker_game - INFO - ==================================================
2025-10-31 18:48:36,106 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:48:36,106 - poker_game - INFO - Pot: 50, Community cards: []
2025-10-31 18:48:36,107 - poker_game - INFO -   Player 3 status=active cards=['6♠', '6♥']
2025-10-31 18:48:36,107 - poker_game - INFO - Showdown winner by default: Player 3 awarded 50
2025-10-31 18:48:36,108 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:48:36,108 - poker_game - INFO - === STARTING NEW HAND #7 ===
2025-10-31 18:48:36,109 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:48:36,110 - poker_game - INFO - Moving dealer button
2025-10-31 18:48:36,111 - poker_game - INFO - Posting blinds
2025-10-31 18:48:36,135 - poker_game - INFO - Dealing hole cards
2025-10-31 18:48:36,135 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:48:36,145 - poker_game - INFO - Started new hand in database: hand_id=7
2025-10-31 18:48:36,146 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:48:36,147 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:36,147 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:48:36,148 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:48:36,148 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:36,149 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:36,149 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:36,149 - poker_game - INFO - Community cards: []
2025-10-31 18:48:36,150 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:36,150 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=active
2025-10-31 18:48:36,151 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:36,151 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:36,152 - poker_game - INFO -   P4(Agent4): chips=6124, bet=0, status=active
2025-10-31 18:48:36,152 - poker_game - INFO - ==================================================
2025-10-31 18:48:36,153 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "6♠",
    "5♠"
  ],
  "community": [],
  "your_chips": 6124,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1895,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1951,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (6124)"
  ],
  "history": [
    "Player 4 raised to 25",
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 18:48:36,167 - poker_game - DEBUG - Create Session: {'id': '3ff0f346-14b4-47ac-819f-4050cfb93d5f', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904116.163481}
2025-10-31 18:48:46,349 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:48:56,170 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 18:48:56,832 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_Q6WO7PmyFRI4AMVIHUdx5sn1', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1233, 'totalTokenCount': 1250}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'zwx2LUCB', 'timestamp': 1761904116.179495}, {'content': {'parts': [{'functionResponse': {'id': 'call_Q6WO7PmyFRI4AMVIHUdx5sn1', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'fC1v2edl', 'timestamp': 1761904117.278594}, {'content': {'parts': [{'functionCall': {'id': 'call_NgvKdGXZKT9gizY6vCXQCIel', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1757, 'totalTokenCount': 1777}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'GrPKfcXa', 'timestamp': 1761904117.283313}, {'content': {'parts': [{'functionResponse': {'id': 'call_NgvKdGXZKT9gizY6vCXQCIel', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'Wbcw80hN', 'timestamp': 1761904118.663708}, {'content': {'parts': [{'functionCall': {'id': 'call_cG2cu2i4hd3RChkeyfnGGlyW', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1319, 'totalTokenCount': 1336}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 's69KIhzS', 'timestamp': 1761904118.665148}, {'content': {'parts': [{'functionResponse': {'id': 'call_cG2cu2i4hd3RChkeyfnGGlyW', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'sdFaN73e', 'timestamp': 1761904119.417101}, {'content': {'parts': [{'functionCall': {'id': 'call_I01EpBKyxalfGa3EMlQVzCee', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1849, 'totalTokenCount': 1869}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'TENuc2hl', 'timestamp': 1761904119.420154}, {'content': {'parts': [{'functionResponse': {'id': 'call_I01EpBKyxalfGa3EMlQVzCee', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'zp8mnypz', 'timestamp': 1761904120.763272}, {'content': {'parts': [{'functionCall': {'id': 'call_hoPZoKF0KgwInDez99yC2lXy', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1405, 'totalTokenCount': 1422}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'QfpptbGE', 'timestamp': 1761904120.765167}, {'content': {'parts': [{'functionResponse': {'id': 'call_hoPZoKF0KgwInDez99yC2lXy', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'DdGX7GQc', 'timestamp': 1761904121.954847}, {'content': {'parts': [{'functionCall': {'id': 'call_WiwqSrXRWl2U6mecb43wHEwg', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1941, 'totalTokenCount': 1961}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'zq5NX8YJ', 'timestamp': 1761904121.960438}, {'content': {'parts': [{'functionResponse': {'id': 'call_WiwqSrXRWl2U6mecb43wHEwg', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'dH4DQz4G', 'timestamp': 1761904123.073437}, {'content': {'parts': [{'functionCall': {'id': 'call_swXPxfSdxxjc2uA4a7WjANXn', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1491, 'totalTokenCount': 1508}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'e52RcaIK', 'timestamp': 1761904123.075413}, {'content': {'parts': [{'functionResponse': {'id': 'call_swXPxfSdxxjc2uA4a7WjANXn', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '1OkrZfre', 'timestamp': 1761904124.516364}, {'content': {'parts': [{'functionCall': {'id': 'call_rCohB2CT5QMHRqa9jopeE3hN', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2033, 'totalTokenCount': 2053}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'sDFfkrTx', 'timestamp': 1761904124.519735}, {'content': {'parts': [{'functionResponse': {'id': 'call_rCohB2CT5QMHRqa9jopeE3hN', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'x1oD3JAm', 'timestamp': 1761904125.874951}, {'content': {'parts': [{'functionCall': {'id': 'call_khRBTZjY95lpfZRETVrU1Bye', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1577, 'totalTokenCount': 1594}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'QiE0iRU1', 'timestamp': 1761904125.882952}, {'content': {'parts': [{'functionResponse': {'id': 'call_khRBTZjY95lpfZRETVrU1Bye', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'TvFu0ebl', 'timestamp': 1761904126.940237}, {'content': {'parts': [{'functionCall': {'id': 'call_LYw6zMhMnWXDzUOFUmQQ6py5', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2125, 'totalTokenCount': 2145}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ktf9RRll', 'timestamp': 1761904126.943291}, {'content': {'parts': [{'functionResponse': {'id': 'call_LYw6zMhMnWXDzUOFUmQQ6py5', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'YI8esfCH', 'timestamp': 1761904128.104331}, {'content': {'parts': [{'functionCall': {'id': 'call_jp0Re0ekoOwtdGFF8Ot5CXg4', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_NuQ2fvpoOQYLNNA47AyaIed8', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 50, 'promptTokenCount': 1663, 'totalTokenCount': 1713}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'vNw4Ar7n', 'timestamp': 1761904128.110709}, {'content': {'parts': [{'functionResponse': {'id': 'call_jp0Re0ekoOwtdGFF8Ot5CXg4', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_NuQ2fvpoOQYLNNA47AyaIed8', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'o7I1QOyy', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '0o6iNTYQ', 'timestamp': 1761904130.143116}, {'content': {'parts': [{'functionCall': {'id': 'call_Vh2aywDKeNByZhYFBfYBladB', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2262, 'totalTokenCount': 2282}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'SQegYO1h', 'timestamp': 1761904130.146943}, {'content': {'parts': [{'functionResponse': {'id': 'call_Vh2aywDKeNByZhYFBfYBladB', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'ov2Nt9uW', 'timestamp': 1761904131.291884}, {'content': {'parts': [{'functionCall': {'id': 'call_svLkpraED2kuhiEvh5xWC0H4', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1789, 'totalTokenCount': 1806}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Dqe7RxnN', 'timestamp': 1761904131.297626}, {'content': {'parts': [{'functionResponse': {'id': 'call_svLkpraED2kuhiEvh5xWC0H4', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'ypdq8wl8', 'timestamp': 1761904132.356361}, {'content': {'parts': [{'functionCall': {'id': 'call_XUgxt2nCV7z77Iz2UAQwhlvb', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2354, 'totalTokenCount': 2374}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'HA54DaIA', 'timestamp': 1761904132.360727}, {'content': {'parts': [{'functionResponse': {'id': 'call_XUgxt2nCV7z77Iz2UAQwhlvb', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'Bz9x4gTI', 'timestamp': 1761904133.750814}, {'content': {'parts': [{'text': '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "手札が6♠と5♠であり、スーテッドコネクターです。ポットが30と小さいため、20のコールをすることでポットに参加し、フロップでの強い手作りのチャンスを狙います。"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 87, 'promptTokenCount': 1875, 'totalTokenCount': 1962}, 'invocationId': 'e-97646ba8-f81c-4ea4-a789-e6fda86c2974', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ZXqLjsDQ', 'timestamp': 1761904133.756172}]
2025-10-31 18:48:56,833 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:48:56,833 - poker_game - DEBUG - {
  "action": "call",
  "amount": 20,
  "reasoning": "手札が6♠と5♠であり、スーテッドコネクターです。ポットが30と小さいため、20のコールをすることでポットに参加し、フロップでの強い手作りのチャンスを狙います。"
}
2025-10-31 18:48:56,834 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:48:56,834 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "手札が6♠と5♠であり、スーテッドコネクターです。ポットが30と小さいため、20のコールをすることでポットに参加し、フロップでの強い手作りのチャンスを狙います。"\n}'
2025-10-31 18:48:56,834 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:48:56,835 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "手札が6♠と5♠であり、スーテッドコネクターです。ポットが30と小さいため、20のコールをすることでポットに参加し、フロップでの強い手作りのチャンスを狙います。"
}
2025-10-31 18:48:56,835 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': '手札が6♠と5♠であり、スーテッドコネクターです。ポットが30と小さいため、20のコールをすることでポットに参加し、フロップでの強い手作りのチャンスを狙います。'}
2025-10-31 18:48:56,835 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 20
2025-10-31 18:48:56,835 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (6124)']
2025-10-31 18:48:56,835 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (20)': 20
2025-10-31 18:48:56,835 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:48:56,835 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 20, 手札が6♠と5♠であり、スーテッドコネクターです。ポットが30と小さいため、20のコールをすることでポットに参加し、フロップでの強い手作りのチャンスを狙います。
2025-10-31 18:48:56,836 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 20
2025-10-31 18:48:56,837 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:56,837 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:56,837 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:48:56,837 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:48:56,838 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:56,838 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:56,838 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:56,838 - poker_game - INFO - Community cards: []
2025-10-31 18:48:56,838 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:56,839 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=active
2025-10-31 18:48:56,839 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:56,839 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:56,840 - poker_game - INFO -   P4(Agent4): chips=6124, bet=0, status=active
2025-10-31 18:48:56,840 - poker_game - INFO - ==================================================
2025-10-31 18:48:56,841 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 20
2025-10-31 18:48:56,851 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:56,851 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:56,852 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:48:56,852 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:56,852 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:56,853 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:56,853 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:56,854 - poker_game - INFO - Community cards: []
2025-10-31 18:48:56,854 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:56,854 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=active
2025-10-31 18:48:56,855 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:56,855 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:56,855 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:56,855 - poker_game - INFO - Extra: Action: Player 4 called 20
2025-10-31 18:48:56,856 - poker_game - INFO - ==================================================
2025-10-31 18:48:56,856 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:56,857 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:56,857 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:48:56,857 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:48:56,857 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:56,858 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:56,858 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:48:56,858 - poker_game - DEBUG - Player bets: [10, 20, 20], Current bet: 20, All same: False
2025-10-31 18:48:56,859 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:48:56,859 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:56,859 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:56,860 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:48:56,861 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:56,861 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:56,862 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:56,862 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:56,863 - poker_game - INFO - Community cards: []
2025-10-31 18:48:56,864 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:56,864 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=active
2025-10-31 18:48:56,865 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:56,866 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:56,866 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:56,867 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:48:56,868 - poker_game - INFO - ==================================================
2025-10-31 18:48:56,969 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "3♥",
    "8♥"
  ],
  "community": [],
  "your_chips": 1895,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1951,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6104,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1895)"
  ],
  "history": [
    "Player 1 called 25",
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20"
  ]
}
2025-10-31 18:48:56,979 - poker_game - DEBUG - Create Session: {'id': '4f3d0fef-5ff4-4363-85e7-2778a0531e9d', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904136.9771597}
2025-10-31 18:48:56,052 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（Pre-flop）では、あなたの手札は3♥8♥で、これは弱いハンドです。ポットにはすでに50ありますが、コールするには10必要です。しかし、他のプレイヤーのアクションや過去の履歴を見ると、このハンドで勝つ可能性は低いです。したがって、フォールド（Fold）して損失を最小限に抑えるのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 112, 'promptTokenCount': 894, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 894}], 'totalTokenCount': 1006}, 'invocationId': 'e-b3515104-c575-4ae9-a024-fc67e060efd7', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'gJqmUYzZ', 'timestamp': 1761904136.989936}]
2025-10-31 18:48:56,053 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:48:56,053 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（Pre-flop）では、あなたの手札は3♥8♥で、これは弱いハンドです。ポットにはすでに50ありますが、コールするには10必要です。しかし、他のプレイヤーのアクションや過去の履歴を見ると、このハンドで勝つ可能性は低いです。したがって、フォールド（Fold）して損失を最小限に抑えるのが最善です。"
}
```
2025-10-31 18:48:56,054 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:48:56,054 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（Pre-flop）では、あなたの手札は3♥8♥で、これは弱いハンドです。ポットにはすでに50ありますが、コールするには10必要です。しかし、他のプレイヤーのアクションや過去の履歴を見ると、このハンドで勝つ可能性は低いです。したがって、フォールド（Fold）して損失を最小限に抑えるのが最善です。"\n}\n```'
2025-10-31 18:48:56,054 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:48:56,055 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（Pre-flop）では、あなたの手札は3♥8♥で、これは弱いハンドです。ポットにはすでに50ありますが、コールするには10必要です。しかし、他のプレイヤーのアクションや過去の履歴を見ると、このハンドで勝つ可能性は低いです。したがって、フォールド（Fold）して損失を最小限に抑えるのが最善です。"\n}'
2025-10-31 18:48:56,055 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（Pre-flop）では、あなたの手札は3♥8♥で、これは弱いハンドです。ポットにはすでに50ありますが、コールするには10必要です。しかし、他のプレイヤーのアクションや過去の履歴を見ると、このハンドで勝つ可能性は低いです。したがって、フォールド（Fold）して損失を最小限に抑えるのが最善です。"
}
2025-10-31 18:48:56,055 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（Pre-flop）では、あなたの手札は3♥8♥で、これは弱いハンドです。ポットにはすでに50ありますが、コールするには10必要です。しかし、他のプレイヤーのアクションや過去の履歴を見ると、このハンドで勝つ可能性は低いです。したがって、フォールド（Fold）して損失を最小限に抑えるのが最善です。'}
2025-10-31 18:48:56,056 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:48:56,056 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:48:56,056 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:48:56,056 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップ（Pre-flop）では、あなたの手札は3♥8♥で、これは弱いハンドです。ポットにはすでに50ありますが、コールするには10必要です。しかし、他のプレイヤーのアクションや過去の履歴を見ると、このハンドで勝つ可能性は低いです。したがって、フォールド（Fold）して損失を最小限に抑えるのが最善です。
2025-10-31 18:48:56,057 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:48:56,058 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:56,058 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:56,059 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:48:56,059 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:56,059 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:56,060 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:56,060 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:48:56,060 - poker_game - INFO - Community cards: []
2025-10-31 18:48:56,061 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:56,061 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=active
2025-10-31 18:48:56,062 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:56,063 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:56,064 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:56,065 - poker_game - INFO - ==================================================
2025-10-31 18:48:56,065 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:48:56,079 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:56,080 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:56,080 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:48:56,081 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:56,081 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:56,082 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:56,082 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:56,082 - poker_game - INFO - Community cards: []
2025-10-31 18:48:56,083 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:56,083 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:48:56,084 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:56,084 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:56,085 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:56,086 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:48:56,086 - poker_game - INFO - ==================================================
2025-10-31 18:48:56,086 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:56,086 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:56,087 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:48:56,087 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:48:56,087 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:56,088 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:56,088 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:48:56,089 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:48:56,090 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:48:56,092 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 18:48:56,093 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:48:56,093 - poker_game - DEBUG - Next after last raiser 3: 4
2025-10-31 18:48:56,093 - poker_game - DEBUG - Betting continues: Current player 3 != next after raiser 4
2025-10-31 18:48:56,094 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:56,095 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:56,095 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:48:56,096 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:56,097 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:56,097 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:56,097 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:56,097 - poker_game - INFO - Community cards: []
2025-10-31 18:48:56,098 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:56,098 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:48:56,098 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:56,099 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:56,099 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:56,099 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:48:56,099 - poker_game - INFO - ==================================================
2025-10-31 18:48:56,200 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "A♣",
    "10♠"
  ],
  "community": [],
  "your_chips": 1951,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 50,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1895,
      "bet": 10,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6104,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (1951)"
  ],
  "history": [
    "Turn dealt: 10♠",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded"
  ]
}
2025-10-31 18:48:56,215 - poker_game - DEBUG - Create Session: {'id': 'b8d21f03-b851-40c0-affb-3f5aee161770', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904136.2121649}
2025-10-31 18:48:57,617 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "プリフロップ（役が確定する前の段階）で、A10は強いハンドです。ポットが50で、コール額が0なので、レイズしてポットを大きくし、相手にプレッシャーをかけます。最小レイズ額は40なので、40にレイズします。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 98, 'promptTokenCount': 888, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 888}], 'totalTokenCount': 986}, 'invocationId': 'e-02329139-5e3e-4510-a40a-3d321cae17e1', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QUUDqu5A', 'timestamp': 1761904136.224872}]
2025-10-31 18:48:57,618 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:48:57,618 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 40,
  "reasoning": "プリフロップ（役が確定する前の段階）で、A10は強いハンドです。ポットが50で、コール額が0なので、レイズしてポットを大きくし、相手にプレッシャーをかけます。最小レイズ額は40なので、40にレイズします。"
}
```
2025-10-31 18:48:57,619 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:48:57,619 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "プリフロップ（役が確定する前の段階）で、A10は強いハンドです。ポットが50で、コール額が0なので、レイズしてポットを大きくし、相手にプレッシャーをかけます。最小レイズ額は40なので、40にレイズします。"\n}\n```'
2025-10-31 18:48:57,619 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:48:57,619 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "プリフロップ（役が確定する前の段階）で、A10は強いハンドです。ポットが50で、コール額が0なので、レイズしてポットを大きくし、相手にプレッシャーをかけます。最小レイズ額は40なので、40にレイズします。"\n}'
2025-10-31 18:48:57,619 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 40,
  "reasoning": "プリフロップ（役が確定する前の段階）で、A10は強いハンドです。ポットが50で、コール額が0なので、レイズしてポットを大きくし、相手にプレッシャーをかけます。最小レイズ額は40なので、40にレイズします。"
}
2025-10-31 18:48:57,620 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 40, 'reasoning': 'プリフロップ（役が確定する前の段階）で、A10は強いハンドです。ポットが50で、コール額が0なので、レイズしてポットを大きくし、相手にプレッシャーをかけます。最小レイズ額は40なので、40にレイズします。'}
2025-10-31 18:48:57,620 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 40
2025-10-31 18:48:57,620 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (1951)']
2025-10-31 18:48:57,620 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 18:48:57,620 - poker_game - DEBUG - [Agent3] Raise amount 40 is valid (min: 40)
2025-10-31 18:48:57,620 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 40}
2025-10-31 18:48:57,620 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 40, プリフロップ（役が確定する前の段階）で、A10は強いハンドです。ポットが50で、コール額が0なので、レイズしてポットを大きくし、相手にプレッシャーをかけます。最小レイズ額は40なので、40にレイズします。
2025-10-31 18:48:57,621 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 40
2025-10-31 18:48:57,622 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:48:57,622 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:57,622 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:48:57,623 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:48:57,623 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:57,623 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:57,624 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:57,625 - poker_game - INFO - Community cards: []
2025-10-31 18:48:57,625 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:57,626 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:48:57,627 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:57,627 - poker_game - INFO -   P3(Agent3): chips=1951, bet=20, status=active
2025-10-31 18:48:57,628 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:57,628 - poker_game - INFO - ==================================================
2025-10-31 18:48:57,629 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 60
2025-10-31 18:48:57,644 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:48:57,644 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:57,645 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:48:57,645 - poker_game - INFO - Pot: 90, Current bet: 60
2025-10-31 18:48:57,646 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:57,646 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:57,647 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:57,647 - poker_game - INFO - Community cards: []
2025-10-31 18:48:57,648 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:57,648 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:48:57,648 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:57,649 - poker_game - INFO -   P3(Agent3): chips=1911, bet=60, status=active
2025-10-31 18:48:57,649 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:57,650 - poker_game - INFO - Extra: Action: Player 3 raised to 60
2025-10-31 18:48:57,650 - poker_game - INFO - ==================================================
2025-10-31 18:48:57,650 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:48:57,651 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:48:57,651 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:48:57,651 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:48:57,652 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:48:57,652 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:48:57,652 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:48:57,652 - poker_game - DEBUG - Player bets: [60, 20], Current bet: 60, All same: False
2025-10-31 18:48:57,653 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:48:57,653 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:48:57,653 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:48:57,653 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:48:57,654 - poker_game - INFO - Pot: 90, Current bet: 60
2025-10-31 18:48:57,654 - poker_game - INFO - Last raiser: 3
2025-10-31 18:48:57,655 - poker_game - INFO - Betting round complete: False
2025-10-31 18:48:57,655 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:48:57,655 - poker_game - INFO - Community cards: []
2025-10-31 18:48:57,655 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:48:57,656 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:48:57,656 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:48:57,657 - poker_game - INFO -   P3(Agent3): chips=1911, bet=60, status=active
2025-10-31 18:48:57,657 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:48:57,657 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:48:57,658 - poker_game - INFO - ==================================================
2025-10-31 18:48:57,759 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "6♠",
    "5♠"
  ],
  "community": [],
  "your_chips": 6104,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 90,
  "to_call": 40,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1895,
      "bet": 10,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1911,
      "bet": 60,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (40)",
    "raise (min 80)",
    "all-in (6104)"
  ],
  "history": [
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: K♠",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60"
  ]
}
2025-10-31 18:48:57,772 - poker_game - DEBUG - Create Session: {'id': '75ba4521-24eb-4070-ade2-3d56cba7e3da', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904137.7693377}
2025-10-31 18:49:07,805 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:49:17,179 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_1wnCa7kvxkyvu2z3XfoQfCgs', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1231, 'totalTokenCount': 1248}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'TssGRnZa', 'timestamp': 1761904137.783379}, {'content': {'parts': [{'functionResponse': {'id': 'call_1wnCa7kvxkyvu2z3XfoQfCgs', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'gvw9mdKT', 'timestamp': 1761904138.934889}, {'content': {'parts': [{'functionCall': {'id': 'call_GkinvK8H6pyR6WbpWLp0t2oW', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1755, 'totalTokenCount': 1775}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'WX3mScd7', 'timestamp': 1761904138.938223}, {'content': {'parts': [{'functionResponse': {'id': 'call_GkinvK8H6pyR6WbpWLp0t2oW', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'OTFGODxk', 'timestamp': 1761904140.49925}, {'content': {'parts': [{'functionCall': {'id': 'call_vzvmye9bmyvLFYhOXyRVeBYv', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1317, 'totalTokenCount': 1334}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'dTJgajxL', 'timestamp': 1761904140.500669}, {'content': {'parts': [{'functionResponse': {'id': 'call_vzvmye9bmyvLFYhOXyRVeBYv', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'DTDQb7il', 'timestamp': 1761904141.628817}, {'content': {'parts': [{'functionCall': {'id': 'call_w3VkQ15cYGJjRT9Zypqtws5q', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1847, 'totalTokenCount': 1867}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'jn3fVwIn', 'timestamp': 1761904141.630941}, {'content': {'parts': [{'functionResponse': {'id': 'call_w3VkQ15cYGJjRT9Zypqtws5q', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'bHrOQLar', 'timestamp': 1761904143.417365}, {'content': {'parts': [{'functionCall': {'id': 'call_abiTDnJiuI0PabzGIDlXei6X', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1403, 'totalTokenCount': 1420}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'iAIupQg2', 'timestamp': 1761904143.419155}, {'content': {'parts': [{'functionResponse': {'id': 'call_abiTDnJiuI0PabzGIDlXei6X', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'pPfuSk5H', 'timestamp': 1761904144.450573}, {'content': {'parts': [{'functionCall': {'id': 'call_m3TWmtj45xDoVfwHMkr42uut', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['6♠', '5♠'], 'community': [], 'your_chips': 6104, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 90, 'to_call': 40, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1895, 'bet': 10, 'status': 'folded'}, {'id': 3, 'chips': 1911, 'bet': 60, 'status': 'active'}], 'actions': ['fold', 'call (40)', 'raise (min 80)', 'all-in (6104)'], 'history': ['Player 4 checked', 'Player 1 checked', 'River dealt: K♠', 'Player 4 checked', 'Player 1 checked', 'Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣', 'Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣', 'Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠', 'Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 50', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 raised to 60']}, 'call_amount': 40, 'pot_after_call': 130, 'equity': 0.3}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 463, 'promptTokenCount': 1939, 'totalTokenCount': 2402}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'GMV6mDCm', 'timestamp': 1761904144.454632}, {'content': {'parts': [{'functionResponse': {'id': 'call_m3TWmtj45xDoVfwHMkr42uut', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が11.00(ポットに対して12.22%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Nb7KiuiO', 'timestamp': 1761904155.380388}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が11.00(ポットに対して12.22%で、マイナスなのでフォールド"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 39, 'promptTokenCount': 2454, 'totalTokenCount': 2493}, 'invocationId': 'e-6631add5-6ec5-408d-a3f2-b65aa8ce6bd5', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'zMHoXW5O', 'timestamp': 1761904155.386037}]
2025-10-31 18:49:17,179 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:49:17,180 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が11.00(ポットに対して12.22%で、マイナスなのでフォールド"}
2025-10-31 18:49:17,180 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:49:17,181 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が11.00(ポットに対して12.22%で、マイナスなのでフォールド"}'
2025-10-31 18:49:17,181 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:49:17,181 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が11.00(ポットに対して12.22%で、マイナスなのでフォールド"}
2025-10-31 18:49:17,181 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が11.00(ポットに対して12.22%で、マイナスなのでフォールド'}
2025-10-31 18:49:17,181 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:49:17,181 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:49:17,181 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:49:17,181 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が11.00(ポットに対して12.22%で、マイナスなのでフォールド
2025-10-31 18:49:17,182 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:49:17,182 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:17,182 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:49:17,183 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:49:17,183 - poker_game - INFO - Pot: 90, Current bet: 60
2025-10-31 18:49:17,183 - poker_game - INFO - Last raiser: 3
2025-10-31 18:49:17,183 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:17,183 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:49:17,183 - poker_game - INFO - Community cards: []
2025-10-31 18:49:17,183 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:17,183 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:49:17,184 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:17,184 - poker_game - INFO -   P3(Agent3): chips=1911, bet=60, status=active
2025-10-31 18:49:17,184 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=active
2025-10-31 18:49:17,184 - poker_game - INFO - ==================================================
2025-10-31 18:49:17,185 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:49:17,195 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:17,195 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:49:17,195 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:49:17,195 - poker_game - INFO - Pot: 90, Current bet: 60
2025-10-31 18:49:17,196 - poker_game - INFO - Last raiser: 3
2025-10-31 18:49:17,196 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:17,196 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:49:17,196 - poker_game - INFO - Community cards: []
2025-10-31 18:49:17,196 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:17,196 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:49:17,196 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:17,197 - poker_game - INFO -   P3(Agent3): chips=1911, bet=60, status=active
2025-10-31 18:49:17,197 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=folded
2025-10-31 18:49:17,197 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:49:17,197 - poker_game - INFO - ==================================================
2025-10-31 18:49:17,197 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:17,197 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:17,197 - poker_game - DEBUG - Active players: [3]
2025-10-31 18:49:17,197 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:49:17,197 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:17,197 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:17,198 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:49:17,198 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:49:17,198 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:17,198 - poker_game - INFO - Hand #7, Phase: preflop
2025-10-31 18:49:17,198 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:49:17,198 - poker_game - INFO - Pot: 90, Current bet: 60
2025-10-31 18:49:17,199 - poker_game - INFO - Last raiser: 3
2025-10-31 18:49:17,199 - poker_game - INFO - Betting round complete: True
2025-10-31 18:49:17,199 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:49:17,199 - poker_game - INFO - Community cards: []
2025-10-31 18:49:17,199 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:17,199 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:49:17,199 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:17,199 - poker_game - INFO -   P3(Agent3): chips=1911, bet=60, status=active
2025-10-31 18:49:17,199 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=folded
2025-10-31 18:49:17,199 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:49:17,200 - poker_game - INFO - ==================================================
2025-10-31 18:49:17,300 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:49:17,301 - poker_game - INFO - Betting round complete: True
2025-10-31 18:49:17,301 - poker_game - INFO - Remaining players: 1
2025-10-31 18:49:17,301 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:49:17,302 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:49:17,302 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:49:17,302 - poker_game - INFO - Hand #7, Phase: showdown
2025-10-31 18:49:17,303 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:49:17,303 - poker_game - INFO - Pot: 90, Current bet: 60
2025-10-31 18:49:17,303 - poker_game - INFO - Last raiser: 3
2025-10-31 18:49:17,304 - poker_game - INFO - Betting round complete: True
2025-10-31 18:49:17,304 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:49:17,304 - poker_game - INFO - Community cards: []
2025-10-31 18:49:17,304 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:17,305 - poker_game - INFO -   P1(Agent1): chips=1895, bet=10, status=folded
2025-10-31 18:49:17,305 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:17,305 - poker_game - INFO -   P3(Agent3): chips=1911, bet=60, status=active
2025-10-31 18:49:17,306 - poker_game - INFO -   P4(Agent4): chips=6104, bet=20, status=folded
2025-10-31 18:49:17,306 - poker_game - INFO - ==================================================
2025-10-31 18:49:17,306 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:49:17,306 - poker_game - INFO - Pot: 90, Community cards: []
2025-10-31 18:49:17,307 - poker_game - INFO -   Player 3 status=active cards=['A♣', '10♠']
2025-10-31 18:49:17,307 - poker_game - INFO - Showdown winner by default: Player 3 awarded 90
2025-10-31 18:49:17,307 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:49:17,307 - poker_game - INFO - === STARTING NEW HAND #8 ===
2025-10-31 18:49:17,308 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:49:17,308 - poker_game - INFO - Moving dealer button
2025-10-31 18:49:17,308 - poker_game - INFO - Posting blinds
2025-10-31 18:49:17,340 - poker_game - INFO - Dealing hole cards
2025-10-31 18:49:17,341 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:49:17,357 - poker_game - INFO - Started new hand in database: hand_id=8
2025-10-31 18:49:17,358 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:49:17,358 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:17,358 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:49:17,359 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:49:17,359 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:17,359 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:17,359 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:17,360 - poker_game - INFO - Community cards: []
2025-10-31 18:49:17,360 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:17,360 - poker_game - INFO -   P1(Agent1): chips=1895, bet=0, status=active
2025-10-31 18:49:17,361 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:17,361 - poker_game - INFO -   P3(Agent3): chips=1991, bet=10, status=active
2025-10-31 18:49:17,361 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:17,362 - poker_game - INFO - ==================================================
2025-10-31 18:49:17,363 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "Q♠",
    "A♣"
  ],
  "community": [],
  "your_chips": 1895,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1991,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6084,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1895)"
  ],
  "history": [
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:49:17,377 - poker_game - DEBUG - Create Session: {'id': '0cf4ab6b-9d1a-494c-ac87-5942f159e9f2', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904157.3753042}
2025-10-31 18:49:19,361 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "私はエースとクイーン（A-Q）という非常に強いハンドを持っています。プリフロップ（カードが配られた直後の最初のラウンド）で、ポットはすでに30ありますが、コールするために必要なのは20だけです。これは有利な状況であり、フロップ（コミュニティカードが開かれる次のラウンド）を見て、さらに強いハンドを作るチャンスがあります。レイズも選択肢ですが、相手のプレイスタイルが不明なため、まずはコールして様子を見るのが安全です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 132, 'promptTokenCount': 905, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 905}], 'totalTokenCount': 1037}, 'invocationId': 'e-bec90167-13b6-4af6-bd09-803470cef2d1', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'JQauYZtx', 'timestamp': 1761904157.392242}]
2025-10-31 18:49:19,361 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:49:19,362 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "私はエースとクイーン（A-Q）という非常に強いハンドを持っています。プリフロップ（カードが配られた直後の最初のラウンド）で、ポットはすでに30ありますが、コールするために必要なのは20だけです。これは有利な状況であり、フロップ（コミュニティカードが開かれる次のラウンド）を見て、さらに強いハンドを作るチャンスがあります。レイズも選択肢ですが、相手のプレイスタイルが不明なため、まずはコールして様子を見るのが安全です。"
}
```
2025-10-31 18:49:19,362 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:49:19,362 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "私はエースとクイーン（A-Q）という非常に強いハンドを持っています。プリフロップ（カードが配られた直後の最初のラウンド）で、ポットはすでに30ありますが、コールするために必要なのは20だけです。これは有利な状況であり、フロップ（コミュニティカードが開かれる次のラウンド）を見て、さらに強いハンドを作るチャンスがあります。レイズも選択肢ですが、相手のプレイスタイルが不明なため、まずはコールして様子を見るのが安全です。"\n}\n```'
2025-10-31 18:49:19,362 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:49:19,363 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "私はエースとクイーン（A-Q）という非常に強いハンドを持っています。プリフロップ（カードが配られた直後の最初のラウンド）で、ポットはすでに30ありますが、コールするために必要なのは20だけです。これは有利な状況であり、フロップ（コミュニティカードが開かれる次のラウンド）を見て、さらに強いハンドを作るチャンスがあります。レイズも選択肢ですが、相手のプレイスタイルが不明なため、まずはコールして様子を見るのが安全です。"\n}'
2025-10-31 18:49:19,363 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "私はエースとクイーン（A-Q）という非常に強いハンドを持っています。プリフロップ（カードが配られた直後の最初のラウンド）で、ポットはすでに30ありますが、コールするために必要なのは20だけです。これは有利な状況であり、フロップ（コミュニティカードが開かれる次のラウンド）を見て、さらに強いハンドを作るチャンスがあります。レイズも選択肢ですが、相手のプレイスタイルが不明なため、まずはコールして様子を見るのが安全です。"
}
2025-10-31 18:49:19,363 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': '私はエースとクイーン（A-Q）という非常に強いハンドを持っています。プリフロップ（カードが配られた直後の最初のラウンド）で、ポットはすでに30ありますが、コールするために必要なのは20だけです。これは有利な状況であり、フロップ（コミュニティカードが開かれる次のラウンド）を見て、さらに強いハンドを作るチャンスがあります。レイズも選択肢ですが、相手のプレイスタイルが不明なため、まずはコールして様子を見るのが安全です。'}
2025-10-31 18:49:19,363 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 20
2025-10-31 18:49:19,363 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (1895)']
2025-10-31 18:49:19,363 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (20)': 20
2025-10-31 18:49:19,363 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:49:19,363 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 20, 私はエースとクイーン（A-Q）という非常に強いハンドを持っています。プリフロップ（カードが配られた直後の最初のラウンド）で、ポットはすでに30ありますが、コールするために必要なのは20だけです。これは有利な状況であり、フロップ（コミュニティカードが開かれる次のラウンド）を見て、さらに強いハンドを作るチャンスがあります。レイズも選択肢ですが、相手のプレイスタイルが不明なため、まずはコールして様子を見るのが安全です。
2025-10-31 18:49:19,364 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 20
2025-10-31 18:49:19,364 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:19,365 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:19,365 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:49:19,365 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:49:19,365 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:19,365 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:19,366 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:19,366 - poker_game - INFO - Community cards: []
2025-10-31 18:49:19,366 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:19,366 - poker_game - INFO -   P1(Agent1): chips=1895, bet=0, status=active
2025-10-31 18:49:19,366 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:19,366 - poker_game - INFO -   P3(Agent3): chips=1991, bet=10, status=active
2025-10-31 18:49:19,366 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:19,367 - poker_game - INFO - ==================================================
2025-10-31 18:49:19,367 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 20
2025-10-31 18:49:19,376 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:19,377 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:19,377 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:49:19,378 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:49:19,378 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:19,379 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:19,379 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:19,380 - poker_game - INFO - Community cards: []
2025-10-31 18:49:19,380 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:19,381 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:19,381 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:19,382 - poker_game - INFO -   P3(Agent3): chips=1991, bet=10, status=active
2025-10-31 18:49:19,382 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:19,382 - poker_game - INFO - Extra: Action: Player 1 called 20
2025-10-31 18:49:19,383 - poker_game - INFO - ==================================================
2025-10-31 18:49:19,383 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:19,384 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:19,384 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:19,384 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:49:19,384 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:19,385 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:19,385 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:19,385 - poker_game - DEBUG - Player bets: [20, 10, 20], Current bet: 20, All same: False
2025-10-31 18:49:19,385 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:49:19,386 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:19,386 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:19,386 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:19,386 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:49:19,387 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:19,387 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:19,387 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:19,388 - poker_game - INFO - Community cards: []
2025-10-31 18:49:19,388 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:19,388 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:19,389 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:19,389 - poker_game - INFO -   P3(Agent3): chips=1991, bet=10, status=active
2025-10-31 18:49:19,389 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:19,390 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:49:19,390 - poker_game - INFO - ==================================================
2025-10-31 18:49:19,495 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "7♣",
    "A♦"
  ],
  "community": [],
  "your_chips": 1991,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1875,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6084,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1991)"
  ],
  "history": [
    "Showdown: Player 1 hand=High Card: K♠ - K♠, Q♠, J♣, 10♠, 8♣ cards=8♣, J♣",
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20"
  ]
}
2025-10-31 18:49:19,503 - poker_game - DEBUG - Create Session: {'id': '1f6a8edd-7ba1-4a73-986d-b88191b9d548', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904159.5023637}
2025-10-31 18:49:21,296 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップでA-7オフスート（A7o）は、一般的に標準的なレンジ（プレイするハンドの範囲）では強くありません。しかし、この状況では、ポットにはすでに50があり、コールするには10しか必要ありません。これは非常に有利なポットオッズ（コールに必要な金額に対してポットのサイズ）です。相手がレイズしてきたわけではなく、コールしてフロップを見ることができます。フロップでエースや7が出れば強いハンドになる可能性があります。ポジション（席順）は不利ですが、このオッズならコールが合理的です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 150, 'promptTokenCount': 910, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 910}], 'totalTokenCount': 1060}, 'invocationId': 'e-29c39da6-a859-417d-b4f4-8c3b55d8f7f2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'BEEMAMWM', 'timestamp': 1761904159.509201}]
2025-10-31 18:49:21,297 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:49:21,297 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップでA-7オフスート（A7o）は、一般的に標準的なレンジ（プレイするハンドの範囲）では強くありません。しかし、この状況では、ポットにはすでに50があり、コールするには10しか必要ありません。これは非常に有利なポットオッズ（コールに必要な金額に対してポットのサイズ）です。相手がレイズしてきたわけではなく、コールしてフロップを見ることができます。フロップでエースや7が出れば強いハンドになる可能性があります。ポジション（席順）は不利ですが、このオッズならコールが合理的です。"
}
```
2025-10-31 18:49:21,298 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:49:21,298 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップでA-7オフスート（A7o）は、一般的に標準的なレンジ（プレイするハンドの範囲）では強くありません。しかし、この状況では、ポットにはすでに50があり、コールするには10しか必要ありません。これは非常に有利なポットオッズ（コールに必要な金額に対してポットのサイズ）です。相手がレイズしてきたわけではなく、コールしてフロップを見ることができます。フロップでエースや7が出れば強いハンドになる可能性があります。ポジション（席順）は不利ですが、このオッズならコールが合理的です。"\n}\n```'
2025-10-31 18:49:21,298 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:49:21,299 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップでA-7オフスート（A7o）は、一般的に標準的なレンジ（プレイするハンドの範囲）では強くありません。しかし、この状況では、ポットにはすでに50があり、コールするには10しか必要ありません。これは非常に有利なポットオッズ（コールに必要な金額に対してポットのサイズ）です。相手がレイズしてきたわけではなく、コールしてフロップを見ることができます。フロップでエースや7が出れば強いハンドになる可能性があります。ポジション（席順）は不利ですが、このオッズならコールが合理的です。"\n}'
2025-10-31 18:49:21,299 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップでA-7オフスート（A7o）は、一般的に標準的なレンジ（プレイするハンドの範囲）では強くありません。しかし、この状況では、ポットにはすでに50があり、コールするには10しか必要ありません。これは非常に有利なポットオッズ（コールに必要な金額に対してポットのサイズ）です。相手がレイズしてきたわけではなく、コールしてフロップを見ることができます。フロップでエースや7が出れば強いハンドになる可能性があります。ポジション（席順）は不利ですが、このオッズならコールが合理的です。"
}
2025-10-31 18:49:21,299 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップでA-7オフスート（A7o）は、一般的に標準的なレンジ（プレイするハンドの範囲）では強くありません。しかし、この状況では、ポットにはすでに50があり、コールするには10しか必要ありません。これは非常に有利なポットオッズ（コールに必要な金額に対してポットのサイズ）です。相手がレイズしてきたわけではなく、コールしてフロップを見ることができます。フロップでエースや7が出れば強いハンドになる可能性があります。ポジション（席順）は不利ですが、このオッズならコールが合理的です。'}
2025-10-31 18:49:21,299 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 10
2025-10-31 18:49:21,299 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (1991)']
2025-10-31 18:49:21,300 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (10)': 10
2025-10-31 18:49:21,300 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:49:21,300 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 10, プリフロップでA-7オフスート（A7o）は、一般的に標準的なレンジ（プレイするハンドの範囲）では強くありません。しかし、この状況では、ポットにはすでに50があり、コールするには10しか必要ありません。これは非常に有利なポットオッズ（コールに必要な金額に対してポットのサイズ）です。相手がレイズしてきたわけではなく、コールしてフロップを見ることができます。フロップでエースや7が出れば強いハンドになる可能性があります。ポジション（席順）は不利ですが、このオッズならコールが合理的です。
2025-10-31 18:49:21,301 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 10
2025-10-31 18:49:21,301 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:21,301 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:21,302 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:21,302 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:49:21,303 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:21,303 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:21,304 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:21,304 - poker_game - INFO - Community cards: []
2025-10-31 18:49:21,304 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:21,305 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:21,305 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:21,306 - poker_game - INFO -   P3(Agent3): chips=1991, bet=10, status=active
2025-10-31 18:49:21,306 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:21,307 - poker_game - INFO - ==================================================
2025-10-31 18:49:21,307 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 10
2025-10-31 18:49:21,319 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:21,319 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:21,320 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:21,320 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:49:21,321 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:21,321 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:21,322 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:21,322 - poker_game - INFO - Community cards: []
2025-10-31 18:49:21,322 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:21,323 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:21,323 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:21,323 - poker_game - INFO -   P3(Agent3): chips=1981, bet=20, status=active
2025-10-31 18:49:21,324 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:21,324 - poker_game - INFO - Extra: Action: Player 3 called 10
2025-10-31 18:49:21,325 - poker_game - INFO - ==================================================
2025-10-31 18:49:21,325 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:21,326 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:21,326 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:21,326 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:49:21,327 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:21,327 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:21,328 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:21,328 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:49:21,328 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:49:21,329 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:49:21,329 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:49:21,329 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:49:21,329 - poker_game - DEBUG - Betting continues: Current player 4 != next after raiser 1
2025-10-31 18:49:21,329 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:21,330 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:21,330 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:21,331 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:49:21,332 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:21,332 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:21,333 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:21,333 - poker_game - INFO - Community cards: []
2025-10-31 18:49:21,333 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:21,333 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:21,333 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:21,334 - poker_game - INFO -   P3(Agent3): chips=1981, bet=20, status=active
2025-10-31 18:49:21,334 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:21,334 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:49:21,335 - poker_game - INFO - ==================================================
2025-10-31 18:49:21,437 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "K♦",
    "Q♦"
  ],
  "community": [],
  "your_chips": 6084,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1875,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1981,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (6084)"
  ],
  "history": [
    "Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣",
    "Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10"
  ]
}
2025-10-31 18:49:21,447 - poker_game - DEBUG - Create Session: {'id': '586c4ba6-bc29-4507-b93c-6cd7c811e2e5', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904161.445167}
2025-10-31 18:49:31,484 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:49:36,002 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_HYCSRvlV8LEb6dhlIjAcc5iC', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1200, 'totalTokenCount': 1217}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'TwIVhM4y', 'timestamp': 1761904161.458128}, {'content': {'parts': [{'functionResponse': {'id': 'call_HYCSRvlV8LEb6dhlIjAcc5iC', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'lOfyERIJ', 'timestamp': 1761904162.361768}, {'content': {'parts': [{'functionCall': {'id': 'call_p9vDEP4L2e4i00wfKZtEyoHA', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1724, 'totalTokenCount': 1741}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'JmpP0MbJ', 'timestamp': 1761904162.367104}, {'content': {'parts': [{'functionResponse': {'id': 'call_p9vDEP4L2e4i00wfKZtEyoHA', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '3cFy8MXQ', 'timestamp': 1761904163.931187}, {'content': {'parts': [{'functionCall': {'id': 'call_dp0REapPTa4L5YldWPExYKzS', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1755, 'totalTokenCount': 1775}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IlxLetlE', 'timestamp': 1761904163.934763}, {'content': {'parts': [{'functionResponse': {'id': 'call_dp0REapPTa4L5YldWPExYKzS', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '5RW1Kk3i', 'timestamp': 1761904162.447659}, {'content': {'parts': [{'functionCall': {'id': 'call_eFFvah1bbhTXwd62mu5aOaYm', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1338, 'totalTokenCount': 1355}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '5Vjn6Kj0', 'timestamp': 1761904162.4508}, {'content': {'parts': [{'functionResponse': {'id': 'call_eFFvah1bbhTXwd62mu5aOaYm', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Fvt1oLAg', 'timestamp': 1761904164.312998}, {'content': {'parts': [{'functionCall': {'id': 'call_AZ4qHY77aoXBuRYDoYQoN7Uq', 'args': {'call_amount': 0, 'pot_after_call': 60, 'equity': 0.65}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 29, 'promptTokenCount': 1847, 'totalTokenCount': 1876}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '9ygVY0TP', 'timestamp': 1761904164.329666}, {'content': {'parts': [{'functionResponse': {'id': 'call_AZ4qHY77aoXBuRYDoYQoN7Uq', 'name': 'action_decision', 'response': {'error': 'Invoking `action_decision()` failed as the following mandatory input parameters are not present:\ngame_state\nYou could retry calling this tool, but it is IMPORTANT for you to provide all the mandatory parameters.'}}}], 'role': 'user'}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'zmyf1dxz', 'timestamp': 1761904165.604775}, {'content': {'parts': [{'functionCall': {'id': 'call_eJ0uPvN44twitK2emBRKhDuu', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['K♦', 'Q♦'], 'community': [], 'your_chips': 6084, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1875, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1981, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (6084)'], 'history': ['Showdown: Player 4 hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠ cards=7♣, 2♣', 'Side pot layer 0: amount=30, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠', 'Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 50', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 raised to 60', 'Player 4 folded', 'Showdown: Player 3 won 90', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.65}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 431, 'promptTokenCount': 1932, 'totalTokenCount': 2363}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '6rWFQeyB', 'timestamp': 1761904165.606844}, {'content': {'parts': [{'functionResponse': {'id': 'call_eJ0uPvN44twitK2emBRKhDuu', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（39.00(ポットに対して65.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'qUZmFcQ0', 'timestamp': 1761904174.755839}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（39.00(ポットに対して65.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2414, 'totalTokenCount': 2452}, 'invocationId': 'e-908ec1fe-ee50-4ee6-89f3-6996f2efce9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'syeRqtHf', 'timestamp': 1761904174.758158}]
2025-10-31 18:49:36,002 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:49:36,003 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（39.00(ポットに対して65.00%）ため、チェックします"}
2025-10-31 18:49:36,003 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:49:36,003 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（39.00(ポットに対して65.00%）ため、チェックします"}'
2025-10-31 18:49:36,004 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:49:36,004 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（39.00(ポットに対して65.00%）ため、チェックします"}
2025-10-31 18:49:36,004 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（39.00(ポットに対して65.00%）ため、チェックします'}
2025-10-31 18:49:36,004 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:49:36,004 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:49:36,004 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:49:36,004 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（39.00(ポットに対して65.00%）ため、チェックします
2025-10-31 18:49:36,005 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:49:36,005 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:36,006 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:36,006 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:36,006 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:49:36,006 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:36,006 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:36,006 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:36,006 - poker_game - INFO - Community cards: []
2025-10-31 18:49:36,006 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:36,007 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:36,007 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:36,007 - poker_game - INFO -   P3(Agent3): chips=1981, bet=20, status=active
2025-10-31 18:49:36,007 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:36,007 - poker_game - INFO - ==================================================
2025-10-31 18:49:36,007 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:49:36,024 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:36,024 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:36,025 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:36,025 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:49:36,025 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:36,025 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:36,025 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:36,025 - poker_game - INFO - Community cards: []
2025-10-31 18:49:36,026 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:36,026 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:36,026 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:36,026 - poker_game - INFO -   P3(Agent3): chips=1981, bet=20, status=active
2025-10-31 18:49:36,026 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:36,027 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:49:36,027 - poker_game - INFO - ==================================================
2025-10-31 18:49:36,027 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:36,027 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:36,027 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:36,027 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:49:36,028 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:36,028 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:36,028 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:36,028 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:49:36,028 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:49:36,028 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:49:36,028 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:49:36,028 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:49:36,029 - poker_game - INFO - Betting complete: Back to player 1 after last raiser 4
2025-10-31 18:49:36,029 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:36,029 - poker_game - INFO - Hand #8, Phase: preflop
2025-10-31 18:49:36,029 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:49:36,029 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:49:36,030 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:36,030 - poker_game - INFO - Betting round complete: True
2025-10-31 18:49:36,030 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:36,030 - poker_game - INFO - Community cards: []
2025-10-31 18:49:36,030 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:36,031 - poker_game - INFO -   P1(Agent1): chips=1875, bet=20, status=active
2025-10-31 18:49:36,031 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:36,031 - poker_game - INFO -   P3(Agent3): chips=1981, bet=20, status=active
2025-10-31 18:49:36,031 - poker_game - INFO -   P4(Agent4): chips=6084, bet=20, status=active
2025-10-31 18:49:36,031 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:49:36,031 - poker_game - INFO - ==================================================
2025-10-31 18:49:36,133 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:49:36,133 - poker_game - INFO - Betting round complete: True
2025-10-31 18:49:36,134 - poker_game - INFO - Remaining players: 3
2025-10-31 18:49:36,134 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:49:36,134 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:49:36,135 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:49:36,135 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:49:36,144 - poker_game - INFO - Starting new betting round
2025-10-31 18:49:36,145 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:49:36,145 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:49:36,145 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 18:49:36,145 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:49:36,146 - poker_game - INFO - First actor: Player 3 (by phase rule), was 1
2025-10-31 18:49:36,146 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:49:36,146 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:36,146 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:36,147 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:49:36,147 - poker_game - INFO - Last raiser: None
2025-10-31 18:49:36,147 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:36,147 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:36,148 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:36,148 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:36,149 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:36,149 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:36,149 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:36,150 - poker_game - INFO -   P4(Agent4): chips=6084, bet=0, status=active
2025-10-31 18:49:36,150 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:49:36,151 - poker_game - INFO - ==================================================
2025-10-31 18:49:36,151 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "7♣",
    "A♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥"
  ],
  "your_chips": 1981,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1875,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6084,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1981)"
  ],
  "history": [
    "Side pot layer 1: amount=70, winners=4 best_hand=One Pair: 7s - K♠, Q♠, 10♠, 7♣, 7♠",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥"
  ]
}
2025-10-31 18:49:36,163 - poker_game - DEBUG - Create Session: {'id': 'f1b5e107-2273-4783-b030-36f5036f71ae', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904176.1613588}
2025-10-31 18:49:38,477 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）が配られ、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはペア（同じ数字のカードが2枚）の6があります。これは「ペア」という役であり、あなたのAハイよりも強い可能性があります。しかし、現時点では相手がこのペア以上の役を持っているか不明です。ポットは60で、コール（相手のベット額と同じ額を支払うこと）もレイズ（ベット額を増やすこと）も必要ないため、まずは様子を見るためにチェックを選択します。これにより、相手の出方を見てから次の行動を決めることができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 167, 'promptTokenCount': 827, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 827}], 'totalTokenCount': 994}, 'invocationId': 'e-7d1c16ce-e824-4e8e-a0f0-a8553636a7ee', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '19ml2fJz', 'timestamp': 1761904176.171435}]
2025-10-31 18:49:38,477 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:49:38,477 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）が配られ、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはペア（同じ数字のカードが2枚）の6があります。これは「ペア」という役であり、あなたのAハイよりも強い可能性があります。しかし、現時点では相手がこのペア以上の役を持っているか不明です。ポットは60で、コール（相手のベット額と同じ額を支払うこと）もレイズ（ベット額を増やすこと）も必要ないため、まずは様子を見るためにチェックを選択します。これにより、相手の出方を見てから次の行動を決めることができます。"
}
```
2025-10-31 18:49:38,478 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:49:38,478 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）が配られ、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはペア（同じ数字のカードが2枚）の6があります。これは「ペア」という役であり、あなたのAハイよりも強い可能性があります。しかし、現時点では相手がこのペア以上の役を持っているか不明です。ポットは60で、コール（相手のベット額と同じ額を支払うこと）もレイズ（ベット額を増やすこと）も必要ないため、まずは様子を見るためにチェックを選択します。これにより、相手の出方を見てから次の行動を決めることができます。"\n}\n```'
2025-10-31 18:49:38,478 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:49:38,478 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）が配られ、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはペア（同じ数字のカードが2枚）の6があります。これは「ペア」という役であり、あなたのAハイよりも強い可能性があります。しかし、現時点では相手がこのペア以上の役を持っているか不明です。ポットは60で、コール（相手のベット額と同じ額を支払うこと）もレイズ（ベット額を増やすこと）も必要ないため、まずは様子を見るためにチェックを選択します。これにより、相手の出方を見てから次の行動を決めることができます。"\n}'
2025-10-31 18:49:38,478 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）が配られ、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはペア（同じ数字のカードが2枚）の6があります。これは「ペア」という役であり、あなたのAハイよりも強い可能性があります。しかし、現時点では相手がこのペア以上の役を持っているか不明です。ポットは60で、コール（相手のベット額と同じ額を支払うこと）もレイズ（ベット額を増やすこと）も必要ないため、まずは様子を見るためにチェックを選択します。これにより、相手の出方を見てから次の行動を決めることができます。"
}
2025-10-31 18:49:38,478 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）が配られ、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはペア（同じ数字のカードが2枚）の6があります。これは「ペア」という役であり、あなたのAハイよりも強い可能性があります。しかし、現時点では相手がこのペア以上の役を持っているか不明です。ポットは60で、コール（相手のベット額と同じ額を支払うこと）もレイズ（ベット額を増やすこと）も必要ないため、まずは様子を見るためにチェックを選択します。これにより、相手の出方を見てから次の行動を決めることができます。'}
2025-10-31 18:49:38,478 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:49:38,479 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:49:38,479 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:49:38,479 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, フロップ（最初の3枚のコミュニティカード）が配られ、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはペア（同じ数字のカードが2枚）の6があります。これは「ペア」という役であり、あなたのAハイよりも強い可能性があります。しかし、現時点では相手がこのペア以上の役を持っているか不明です。ポットは60で、コール（相手のベット額と同じ額を支払うこと）もレイズ（ベット額を増やすこと）も必要ないため、まずは様子を見るためにチェックを選択します。これにより、相手の出方を見てから次の行動を決めることができます。
2025-10-31 18:49:38,479 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:49:38,480 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:38,480 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:38,480 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:38,480 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:49:38,481 - poker_game - INFO - Last raiser: None
2025-10-31 18:49:38,481 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:38,481 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:38,481 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:38,482 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:38,482 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:38,482 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:38,482 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:38,483 - poker_game - INFO -   P4(Agent4): chips=6084, bet=0, status=active
2025-10-31 18:49:38,483 - poker_game - INFO - ==================================================
2025-10-31 18:49:38,483 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:49:38,493 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:38,493 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:38,494 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:38,494 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:49:38,494 - poker_game - INFO - Last raiser: None
2025-10-31 18:49:38,494 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:38,495 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:38,495 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:38,496 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:38,496 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:38,496 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:38,496 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:38,496 - poker_game - INFO -   P4(Agent4): chips=6084, bet=0, status=active
2025-10-31 18:49:38,497 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:49:38,497 - poker_game - INFO - ==================================================
2025-10-31 18:49:38,498 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:38,498 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:38,499 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:38,499 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:49:38,500 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:38,500 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:38,501 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:38,501 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 18:49:38,501 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:49:38,501 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:49:38,501 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:49:38,501 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:49:38,502 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:49:38,502 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:38,502 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:38,502 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:38,503 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:49:38,503 - poker_game - INFO - Last raiser: None
2025-10-31 18:49:38,503 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:38,504 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:38,504 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:38,504 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:38,505 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:38,505 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:38,505 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:38,505 - poker_game - INFO -   P4(Agent4): chips=6084, bet=0, status=active
2025-10-31 18:49:38,506 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:49:38,506 - poker_game - INFO - ==================================================
2025-10-31 18:49:38,609 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "K♦",
    "Q♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥"
  ],
  "your_chips": 6084,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1875,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1981,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6084)"
  ],
  "history": [
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked"
  ]
}
2025-10-31 18:49:38,621 - poker_game - DEBUG - Create Session: {'id': '56a0784b-02e9-4b7b-bedb-66bf89e50acd', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904178.619349}
2025-10-31 18:49:48,675 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:49:51,236 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_Ddxl4PlUvNecjDR7512fj71V', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1106, 'totalTokenCount': 1123}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'WaRxeN9p', 'timestamp': 1761904178.632217}, {'content': {'parts': [{'functionResponse': {'id': 'call_Ddxl4PlUvNecjDR7512fj71V', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'PA2IV17H', 'timestamp': 1761904179.555167}, {'content': {'parts': [{'functionCall': {'id': 'call_wmv64tzOworpDYnAFbxMyean', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1630, 'totalTokenCount': 1650}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'I3QFTr1G', 'timestamp': 1761904179.557}, {'content': {'parts': [{'functionResponse': {'id': 'call_wmv64tzOworpDYnAFbxMyean', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'aWKgDalA', 'timestamp': 1761904180.616978}, {'content': {'parts': [{'functionCall': {'id': 'call_XRY7bOpUy56yY4RskT4TstUA', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1192, 'totalTokenCount': 1209}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '51ISoEeB', 'timestamp': 1761904180.618987}, {'content': {'parts': [{'functionResponse': {'id': 'call_XRY7bOpUy56yY4RskT4TstUA', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'uHDG5Oe5', 'timestamp': 1761904181.515506}, {'content': {'parts': [{'functionCall': {'id': 'call_xAt9g8LkH0VgYeNssPNqGS9e', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['K♦', 'Q♦'], 'community': ['6♠', '9♣', '6♥'], 'your_chips': 6084, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1875, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1981, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6084)'], 'history': ['Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 50', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 raised to 60', 'Player 4 folded', 'Showdown: Player 3 won 90', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 6♠, 9♣, 6♥', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 345, 'promptTokenCount': 1722, 'totalTokenCount': 2067}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'P4pVAVsc', 'timestamp': 1761904181.517659}, {'content': {'parts': [{'functionResponse': {'id': 'call_xAt9g8LkH0VgYeNssPNqGS9e', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 30, 'reasoning': '期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30'}}}], 'role': 'user'}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'zagJFgof', 'timestamp': 1761904189.061548}, {'content': {'parts': [{'text': '{"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2120, 'totalTokenCount': 2176}, 'invocationId': 'e-412e55c4-c0c9-4bd2-a4fb-6dae347fc793', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'AyRoQ12U', 'timestamp': 1761904189.063693}]
2025-10-31 18:49:51,237 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:49:51,238 - poker_game - DEBUG - {"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}
2025-10-31 18:49:51,239 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:49:51,239 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}'
2025-10-31 18:49:51,239 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:49:51,240 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}
2025-10-31 18:49:51,240 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 30, 'reasoning': '期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30'}
2025-10-31 18:49:51,240 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 30
2025-10-31 18:49:51,240 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (6084)']
2025-10-31 18:49:51,240 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:49:51,241 - poker_game - DEBUG - [Agent4] Raise amount 30 is valid (min: 20)
2025-10-31 18:49:51,241 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 30}
2025-10-31 18:49:51,241 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 30, 期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30
2025-10-31 18:49:51,242 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 30
2025-10-31 18:49:51,243 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:51,243 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:51,244 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:51,244 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:49:51,244 - poker_game - INFO - Last raiser: None
2025-10-31 18:49:51,245 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:51,245 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:51,245 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:51,246 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:51,246 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:51,247 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:51,247 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:51,247 - poker_game - INFO -   P4(Agent4): chips=6084, bet=0, status=active
2025-10-31 18:49:51,247 - poker_game - INFO - ==================================================
2025-10-31 18:49:51,248 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 30
2025-10-31 18:49:51,261 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:51,261 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:51,262 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:51,262 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:49:51,263 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:51,263 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:51,263 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:51,264 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:51,264 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:51,265 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:51,265 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:51,266 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:51,266 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:51,266 - poker_game - INFO - Extra: Action: Player 4 raised to 30
2025-10-31 18:49:51,266 - poker_game - INFO - ==================================================
2025-10-31 18:49:51,267 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:51,267 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:51,267 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:51,268 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:49:51,268 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:51,268 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:51,268 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:51,268 - poker_game - DEBUG - Player bets: [0, 0, 30], Current bet: 30, All same: False
2025-10-31 18:49:51,269 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:49:51,269 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:51,269 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:51,269 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:49:51,270 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:49:51,270 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:51,271 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:51,271 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:51,271 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:51,272 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:51,272 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:51,273 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:51,273 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:51,274 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:51,274 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:49:51,275 - poker_game - INFO - ==================================================
2025-10-31 18:49:51,376 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "Q♠",
    "A♣"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥"
  ],
  "your_chips": 1875,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 90,
  "to_call": 30,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1981,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6054,
      "bet": 30,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (30)",
    "raise (min 50)",
    "all-in (1875)"
  ],
  "history": [
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30"
  ]
}
2025-10-31 18:49:51,385 - poker_game - DEBUG - Create Session: {'id': 'd2422f73-63a6-4a22-848a-b4747f5835a3', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904191.383736}
2025-10-31 18:49:50,873 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（ボードに開かれた3枚のカード）は6♠ 9♣ 6♥です。私の手札はQ♠ A♣で、ペアは持っていません。しかし、Aハイ（エースが一番強いカード）は比較的強いハンドです。相手が30をベットしてきた（フォールド、コール、レイズの選択肢がある）状況で、コール（相手のベット額と同額を支払うこと）を選択します。これは、相手のハンドがそれほど強くない可能性があり、私のAハイが勝てる可能性があるためです。また、まだポットがそれほど大きくなく、これ以上のベットはリスクが高いと判断しました。レイズ（ベット額を上げる）は、相手のハンドが強い場合のリスクが高すぎるため、現時点では避けます。フォールド（ゲームから降りること）は、Aハイという比較的強いハンドを捨てるには惜しいと判断しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 224, 'promptTokenCount': 792, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 792}], 'totalTokenCount': 1016}, 'invocationId': 'e-ef40af1f-f0af-41b9-ac13-41796283d47b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'u4Vxwird', 'timestamp': 1761904191.394444}]
2025-10-31 18:49:50,874 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:49:50,874 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 30,
  "reasoning": "フロップ（ボードに開かれた3枚のカード）は6♠ 9♣ 6♥です。私の手札はQ♠ A♣で、ペアは持っていません。しかし、Aハイ（エースが一番強いカード）は比較的強いハンドです。相手が30をベットしてきた（フォールド、コール、レイズの選択肢がある）状況で、コール（相手のベット額と同額を支払うこと）を選択します。これは、相手のハンドがそれほど強くない可能性があり、私のAハイが勝てる可能性があるためです。また、まだポットがそれほど大きくなく、これ以上のベットはリスクが高いと判断しました。レイズ（ベット額を上げる）は、相手のハンドが強い場合のリスクが高すぎるため、現時点では避けます。フォールド（ゲームから降りること）は、Aハイという比較的強いハンドを捨てるには惜しいと判断しました。"
}
```
2025-10-31 18:49:50,874 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（ボードに開かれた3枚のカード）は6♠ 9♣ 6♥です。私の手札はQ♠ A♣で、ペアは持っていません。しかし、Aハイ（エースが一番強いカード）は比較的強いハンドです。相手が30をベットしてきた（フォールド、コール、レイズの選択肢がある）状況で、コール（相手のベット額と同額を支払うこと）を選択します。これは、相手のハンドがそれほど強くない可能性があり、私のAハイが勝てる可能性があるためです。また、まだポットがそれほど大きくなく、これ以上のベットはリスクが高いと判断しました。レイズ（ベット額を上げる）は、相手のハンドが強い場合のリスクが高すぎるため、現時点では避けます。フォールド（ゲームから降りること）は、Aハイという比較的強いハンドを捨てるには惜しいと判断しました。"\n}\n```'
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（ボードに開かれた3枚のカード）は6♠ 9♣ 6♥です。私の手札はQ♠ A♣で、ペアは持っていません。しかし、Aハイ（エースが一番強いカード）は比較的強いハンドです。相手が30をベットしてきた（フォールド、コール、レイズの選択肢がある）状況で、コール（相手のベット額と同額を支払うこと）を選択します。これは、相手のハンドがそれほど強くない可能性があり、私のAハイが勝てる可能性があるためです。また、まだポットがそれほど大きくなく、これ以上のベットはリスクが高いと判断しました。レイズ（ベット額を上げる）は、相手のハンドが強い場合のリスクが高すぎるため、現時点では避けます。フォールド（ゲームから降りること）は、Aハイという比較的強いハンドを捨てるには惜しいと判断しました。"\n}'
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 30,
  "reasoning": "フロップ（ボードに開かれた3枚のカード）は6♠ 9♣ 6♥です。私の手札はQ♠ A♣で、ペアは持っていません。しかし、Aハイ（エースが一番強いカード）は比較的強いハンドです。相手が30をベットしてきた（フォールド、コール、レイズの選択肢がある）状況で、コール（相手のベット額と同額を支払うこと）を選択します。これは、相手のハンドがそれほど強くない可能性があり、私のAハイが勝てる可能性があるためです。また、まだポットがそれほど大きくなく、これ以上のベットはリスクが高いと判断しました。レイズ（ベット額を上げる）は、相手のハンドが強い場合のリスクが高すぎるため、現時点では避けます。フォールド（ゲームから降りること）は、Aハイという比較的強いハンドを捨てるには惜しいと判断しました。"
}
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 30, 'reasoning': 'フロップ（ボードに開かれた3枚のカード）は6♠ 9♣ 6♥です。私の手札はQ♠ A♣で、ペアは持っていません。しかし、Aハイ（エースが一番強いカード）は比較的強いハンドです。相手が30をベットしてきた（フォールド、コール、レイズの選択肢がある）状況で、コール（相手のベット額と同額を支払うこと）を選択します。これは、相手のハンドがそれほど強くない可能性があり、私のAハイが勝てる可能性があるためです。また、まだポットがそれほど大きくなく、これ以上のベットはリスクが高いと判断しました。レイズ（ベット額を上げる）は、相手のハンドが強い場合のリスクが高すぎるため、現時点では避けます。フォールド（ゲームから降りること）は、Aハイという比較的強いハンドを捨てるには惜しいと判断しました。'}
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 30
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (30)', 'raise (min 50)', 'all-in (1875)']
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (30)': 30
2025-10-31 18:49:50,875 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 30}
2025-10-31 18:49:50,875 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 30, フロップ（ボードに開かれた3枚のカード）は6♠ 9♣ 6♥です。私の手札はQ♠ A♣で、ペアは持っていません。しかし、Aハイ（エースが一番強いカード）は比較的強いハンドです。相手が30をベットしてきた（フォールド、コール、レイズの選択肢がある）状況で、コール（相手のベット額と同額を支払うこと）を選択します。これは、相手のハンドがそれほど強くない可能性があり、私のAハイが勝てる可能性があるためです。また、まだポットがそれほど大きくなく、これ以上のベットはリスクが高いと判断しました。レイズ（ベット額を上げる）は、相手のハンドが強い場合のリスクが高すぎるため、現時点では避けます。フォールド（ゲームから降りること）は、Aハイという比較的強いハンドを捨てるには惜しいと判断しました。
2025-10-31 18:49:50,876 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 30
2025-10-31 18:49:50,876 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:50,876 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:50,876 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:49:50,877 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:49:50,877 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:50,877 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:50,877 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:50,877 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:50,877 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:50,877 - poker_game - INFO -   P1(Agent1): chips=1875, bet=0, status=active
2025-10-31 18:49:50,877 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:50,877 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:50,877 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:50,877 - poker_game - INFO - ==================================================
2025-10-31 18:49:50,878 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 30
2025-10-31 18:49:50,885 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:50,886 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:50,886 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:49:50,886 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:49:50,886 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:50,887 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:50,887 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:50,887 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:50,887 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:50,888 - poker_game - INFO -   P1(Agent1): chips=1845, bet=30, status=active
2025-10-31 18:49:50,888 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:50,888 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:50,888 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:50,888 - poker_game - INFO - Extra: Action: Player 1 called 30
2025-10-31 18:49:50,889 - poker_game - INFO - ==================================================
2025-10-31 18:49:50,889 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:50,889 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:50,889 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:50,889 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:49:50,889 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:50,889 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:50,890 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:50,890 - poker_game - DEBUG - Player bets: [30, 0, 30], Current bet: 30, All same: False
2025-10-31 18:49:50,890 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:49:50,890 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:50,890 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:50,890 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:50,891 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:49:50,891 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:50,891 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:50,891 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:50,891 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:50,892 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:50,892 - poker_game - INFO -   P1(Agent1): chips=1845, bet=30, status=active
2025-10-31 18:49:50,892 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:50,892 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:50,892 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:50,893 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:49:50,893 - poker_game - INFO - ==================================================
2025-10-31 18:49:50,995 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "7♣",
    "A♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥"
  ],
  "your_chips": 1981,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 120,
  "to_call": 30,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1845,
      "bet": 30,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6054,
      "bet": 30,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (30)",
    "raise (min 50)",
    "all-in (1981)"
  ],
  "history": [
    "Player 3 called 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30"
  ]
}
2025-10-31 18:49:51,008 - poker_game - DEBUG - Create Session: {'id': '92ba5a18-917d-4d0b-8f85-53ea5d71b401', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904191.005365}
2025-10-31 18:49:53,457 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）であり、ペアはできていません。ボードには6が2枚（ペア）ありますが、あなたは6を持っていません。相手が30をベットしてきた状況で、コールに必要な金額は30です。これは、相手のベットコール（相手のベット額と同額を支払うこと）をするのに十分な金額です。レイズ（ベット額を上げる）するには、あなたのハンド（役）が強すぎるとは言えません。フォールド（降りること）は、まだ勝てる可能性が残っているため、早すぎます。したがって、コールして次のカード（ターン）を見るのが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 187, 'promptTokenCount': 792, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 792}], 'totalTokenCount': 979}, 'invocationId': 'e-88e1f12e-6aed-490d-8af7-5abf976da03d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'GPKFktUK', 'timestamp': 1761904191.021914}]
2025-10-31 18:49:53,457 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:49:53,458 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 30,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）であり、ペアはできていません。ボードには6が2枚（ペア）ありますが、あなたは6を持っていません。相手が30をベットしてきた状況で、コールに必要な金額は30です。これは、相手のベットコール（相手のベット額と同額を支払うこと）をするのに十分な金額です。レイズ（ベット額を上げる）するには、あなたのハンド（役）が強すぎるとは言えません。フォールド（降りること）は、まだ勝てる可能性が残っているため、早すぎます。したがって、コールして次のカード（ターン）を見るのが最善の選択です。"
}
```
2025-10-31 18:49:53,458 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:49:53,458 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）であり、ペアはできていません。ボードには6が2枚（ペア）ありますが、あなたは6を持っていません。相手が30をベットしてきた状況で、コールに必要な金額は30です。これは、相手のベットコール（相手のベット額と同額を支払うこと）をするのに十分な金額です。レイズ（ベット額を上げる）するには、あなたのハンド（役）が強すぎるとは言えません。フォールド（降りること）は、まだ勝てる可能性が残っているため、早すぎます。したがって、コールして次のカード（ターン）を見るのが最善の選択です。"\n}\n```'
2025-10-31 18:49:53,458 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:49:53,458 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）であり、ペアはできていません。ボードには6が2枚（ペア）ありますが、あなたは6を持っていません。相手が30をベットしてきた状況で、コールに必要な金額は30です。これは、相手のベットコール（相手のベット額と同額を支払うこと）をするのに十分な金額です。レイズ（ベット額を上げる）するには、あなたのハンド（役）が強すぎるとは言えません。フォールド（降りること）は、まだ勝てる可能性が残っているため、早すぎます。したがって、コールして次のカード（ターン）を見るのが最善の選択です。"\n}'
2025-10-31 18:49:53,458 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 30,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）であり、ペアはできていません。ボードには6が2枚（ペア）ありますが、あなたは6を持っていません。相手が30をベットしてきた状況で、コールに必要な金額は30です。これは、相手のベットコール（相手のベット額と同額を支払うこと）をするのに十分な金額です。レイズ（ベット額を上げる）するには、あなたのハンド（役）が強すぎるとは言えません。フォールド（降りること）は、まだ勝てる可能性が残っているため、早すぎます。したがって、コールして次のカード（ターン）を見るのが最善の選択です。"
}
2025-10-31 18:49:53,459 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 30, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）であり、ペアはできていません。ボードには6が2枚（ペア）ありますが、あなたは6を持っていません。相手が30をベットしてきた状況で、コールに必要な金額は30です。これは、相手のベットコール（相手のベット額と同額を支払うこと）をするのに十分な金額です。レイズ（ベット額を上げる）するには、あなたのハンド（役）が強すぎるとは言えません。フォールド（降りること）は、まだ勝てる可能性が残っているため、早すぎます。したがって、コールして次のカード（ターン）を見るのが最善の選択です。'}
2025-10-31 18:49:53,459 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 30
2025-10-31 18:49:53,459 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (30)', 'raise (min 50)', 'all-in (1981)']
2025-10-31 18:49:53,459 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (30)': 30
2025-10-31 18:49:53,459 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 30}
2025-10-31 18:49:53,459 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 30, フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）であり、ペアはできていません。ボードには6が2枚（ペア）ありますが、あなたは6を持っていません。相手が30をベットしてきた状況で、コールに必要な金額は30です。これは、相手のベットコール（相手のベット額と同額を支払うこと）をするのに十分な金額です。レイズ（ベット額を上げる）するには、あなたのハンド（役）が強すぎるとは言えません。フォールド（降りること）は、まだ勝てる可能性が残っているため、早すぎます。したがって、コールして次のカード（ターン）を見るのが最善の選択です。
2025-10-31 18:49:53,460 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 30
2025-10-31 18:49:53,460 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:53,460 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:53,460 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:53,461 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:49:53,461 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:53,461 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:53,461 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:53,461 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:53,461 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:53,462 - poker_game - INFO -   P1(Agent1): chips=1845, bet=30, status=active
2025-10-31 18:49:53,462 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:53,462 - poker_game - INFO -   P3(Agent3): chips=1981, bet=0, status=active
2025-10-31 18:49:53,462 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:53,462 - poker_game - INFO - ==================================================
2025-10-31 18:49:53,463 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 30
2025-10-31 18:49:53,474 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:53,474 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:53,475 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:53,475 - poker_game - INFO - Pot: 150, Current bet: 30
2025-10-31 18:49:53,475 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:53,476 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:53,476 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:53,476 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:53,476 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:53,476 - poker_game - INFO -   P1(Agent1): chips=1845, bet=30, status=active
2025-10-31 18:49:53,477 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:53,477 - poker_game - INFO -   P3(Agent3): chips=1951, bet=30, status=active
2025-10-31 18:49:53,477 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:53,477 - poker_game - INFO - Extra: Action: Player 3 called 30
2025-10-31 18:49:53,477 - poker_game - INFO - ==================================================
2025-10-31 18:49:53,477 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:53,477 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:53,478 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:53,478 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:49:53,478 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:53,478 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:53,478 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:53,478 - poker_game - DEBUG - Player bets: [30, 30, 30], Current bet: 30, All same: True
2025-10-31 18:49:53,478 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:49:53,478 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:53,479 - poker_game - INFO - Hand #8, Phase: flop
2025-10-31 18:49:53,479 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:53,480 - poker_game - INFO - Pot: 150, Current bet: 30
2025-10-31 18:49:53,480 - poker_game - INFO - Last raiser: 4
2025-10-31 18:49:53,480 - poker_game - INFO - Betting round complete: True
2025-10-31 18:49:53,480 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:53,480 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥']
2025-10-31 18:49:53,481 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:53,481 - poker_game - INFO -   P1(Agent1): chips=1845, bet=30, status=active
2025-10-31 18:49:53,481 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:53,481 - poker_game - INFO -   P3(Agent3): chips=1951, bet=30, status=active
2025-10-31 18:49:53,481 - poker_game - INFO -   P4(Agent4): chips=6054, bet=30, status=active
2025-10-31 18:49:53,482 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:49:53,482 - poker_game - INFO - ==================================================
2025-10-31 18:49:53,583 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:49:53,584 - poker_game - INFO - Betting round complete: True
2025-10-31 18:49:53,585 - poker_game - INFO - Remaining players: 3
2025-10-31 18:49:53,586 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:49:53,586 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:49:53,586 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:49:53,587 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:49:53,597 - poker_game - INFO - Starting new betting round
2025-10-31 18:49:53,598 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:49:53,598 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:49:53,599 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 18:49:53,599 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:49:53,599 - poker_game - INFO - First actor: Player 3 (by phase rule), was 4
2025-10-31 18:49:53,600 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:49:53,600 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:49:53,601 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:53,601 - poker_game - INFO - Pot: 150, Current bet: 0
2025-10-31 18:49:53,601 - poker_game - INFO - Last raiser: None
2025-10-31 18:49:53,602 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:53,602 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:53,602 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:49:53,603 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:53,603 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:49:53,603 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:53,604 - poker_game - INFO -   P3(Agent3): chips=1951, bet=0, status=active
2025-10-31 18:49:53,604 - poker_game - INFO -   P4(Agent4): chips=6054, bet=0, status=active
2025-10-31 18:49:53,604 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:49:53,604 - poker_game - INFO - ==================================================
2025-10-31 18:49:53,605 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "7♣",
    "A♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥",
    "J♠"
  ],
  "your_chips": 1951,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 150,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1845,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6054,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1951)"
  ],
  "history": [
    "Player 1 folded",
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠"
  ]
}
2025-10-31 18:49:53,617 - poker_game - DEBUG - Create Session: {'id': '32bd5213-71a3-48cc-bbc8-73cc779567b3', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904193.6139374}
2025-10-31 18:49:56,723 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 90,\n  "reasoning": "現在のボード（6♠, 9♣, 6♥, J♠）では、Aハイ（エースハイ：役がない状態）です。しかし、相手のプレイヤー4は、ターンで30をベットし、その後私がコールした後にさらにベットを強めています。これは、相手がこのボードで良いハンドを持っている可能性を示唆しています。私はAハイなので、このままコールするのはリスクが高いです。しかし、相手がブラフ（ bluff：弱いハンドで強く見せること）である可能性も考慮し、少しだけベットを上げて様子を見ます。もし相手がさらにコールしてきたら、私のハンドは非常に弱いと判断し、フォールド（fold：ゲームから降りること）を検討します。ベット額は、相手のベット額30の2倍の60に、ポットの150の1/4（約37.5）を足した97.5ですが、最小レイズ額20を考慮し、90に設定します。これは、相手にプレッシャーを与えつつ、自分の損失を最小限に抑えるための戦略です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 264, 'promptTokenCount': 793, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 793}], 'totalTokenCount': 1057}, 'invocationId': 'e-f443db12-4045-4983-a03d-ea21eee952a9', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'XpmfqCsD', 'timestamp': 1761904193.628353}]
2025-10-31 18:49:56,724 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:49:56,724 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 90,
  "reasoning": "現在のボード（6♠, 9♣, 6♥, J♠）では、Aハイ（エースハイ：役がない状態）です。しかし、相手のプレイヤー4は、ターンで30をベットし、その後私がコールした後にさらにベットを強めています。これは、相手がこのボードで良いハンドを持っている可能性を示唆しています。私はAハイなので、このままコールするのはリスクが高いです。しかし、相手がブラフ（ bluff：弱いハンドで強く見せること）である可能性も考慮し、少しだけベットを上げて様子を見ます。もし相手がさらにコールしてきたら、私のハンドは非常に弱いと判断し、フォールド（fold：ゲームから降りること）を検討します。ベット額は、相手のベット額30の2倍の60に、ポットの150の1/4（約37.5）を足した97.5ですが、最小レイズ額20を考慮し、90に設定します。これは、相手にプレッシャーを与えつつ、自分の損失を最小限に抑えるための戦略です。"
}
```
2025-10-31 18:49:56,724 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:49:56,724 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 90,\n  "reasoning": "現在のボード（6♠, 9♣, 6♥, J♠）では、Aハイ（エースハイ：役がない状態）です。しかし、相手のプレイヤー4は、ターンで30をベットし、その後私がコールした後にさらにベットを強めています。これは、相手がこのボードで良いハンドを持っている可能性を示唆しています。私はAハイなので、このままコールするのはリスクが高いです。しかし、相手がブラフ（ bluff：弱いハンドで強く見せること）である可能性も考慮し、少しだけベットを上げて様子を見ます。もし相手がさらにコールしてきたら、私のハンドは非常に弱いと判断し、フォールド（fold：ゲームから降りること）を検討します。ベット額は、相手のベット額30の2倍の60に、ポットの150の1/4（約37.5）を足した97.5ですが、最小レイズ額20を考慮し、90に設定します。これは、相手にプレッシャーを与えつつ、自分の損失を最小限に抑えるための戦略です。"\n}\n```'
2025-10-31 18:49:56,724 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:49:56,724 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 90,\n  "reasoning": "現在のボード（6♠, 9♣, 6♥, J♠）では、Aハイ（エースハイ：役がない状態）です。しかし、相手のプレイヤー4は、ターンで30をベットし、その後私がコールした後にさらにベットを強めています。これは、相手がこのボードで良いハンドを持っている可能性を示唆しています。私はAハイなので、このままコールするのはリスクが高いです。しかし、相手がブラフ（ bluff：弱いハンドで強く見せること）である可能性も考慮し、少しだけベットを上げて様子を見ます。もし相手がさらにコールしてきたら、私のハンドは非常に弱いと判断し、フォールド（fold：ゲームから降りること）を検討します。ベット額は、相手のベット額30の2倍の60に、ポットの150の1/4（約37.5）を足した97.5ですが、最小レイズ額20を考慮し、90に設定します。これは、相手にプレッシャーを与えつつ、自分の損失を最小限に抑えるための戦略です。"\n}'
2025-10-31 18:49:56,725 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 90,
  "reasoning": "現在のボード（6♠, 9♣, 6♥, J♠）では、Aハイ（エースハイ：役がない状態）です。しかし、相手のプレイヤー4は、ターンで30をベットし、その後私がコールした後にさらにベットを強めています。これは、相手がこのボードで良いハンドを持っている可能性を示唆しています。私はAハイなので、このままコールするのはリスクが高いです。しかし、相手がブラフ（ bluff：弱いハンドで強く見せること）である可能性も考慮し、少しだけベットを上げて様子を見ます。もし相手がさらにコールしてきたら、私のハンドは非常に弱いと判断し、フォールド（fold：ゲームから降りること）を検討します。ベット額は、相手のベット額30の2倍の60に、ポットの150の1/4（約37.5）を足した97.5ですが、最小レイズ額20を考慮し、90に設定します。これは、相手にプレッシャーを与えつつ、自分の損失を最小限に抑えるための戦略です。"
}
2025-10-31 18:49:56,725 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 90, 'reasoning': '現在のボード（6♠, 9♣, 6♥, J♠）では、Aハイ（エースハイ：役がない状態）です。しかし、相手のプレイヤー4は、ターンで30をベットし、その後私がコールした後にさらにベットを強めています。これは、相手がこのボードで良いハンドを持っている可能性を示唆しています。私はAハイなので、このままコールするのはリスクが高いです。しかし、相手がブラフ（ bluff：弱いハンドで強く見せること）である可能性も考慮し、少しだけベットを上げて様子を見ます。もし相手がさらにコールしてきたら、私のハンドは非常に弱いと判断し、フォールド（fold：ゲームから降りること）を検討します。ベット額は、相手のベット額30の2倍の60に、ポットの150の1/4（約37.5）を足した97.5ですが、最小レイズ額20を考慮し、90に設定します。これは、相手にプレッシャーを与えつつ、自分の損失を最小限に抑えるための戦略です。'}
2025-10-31 18:49:56,725 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 90
2025-10-31 18:49:56,725 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1951)']
2025-10-31 18:49:56,725 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:49:56,725 - poker_game - DEBUG - [Agent3] Raise amount 90 is valid (min: 20)
2025-10-31 18:49:56,725 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 90}
2025-10-31 18:49:56,726 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 90, 現在のボード（6♠, 9♣, 6♥, J♠）では、Aハイ（エースハイ：役がない状態）です。しかし、相手のプレイヤー4は、ターンで30をベットし、その後私がコールした後にさらにベットを強めています。これは、相手がこのボードで良いハンドを持っている可能性を示唆しています。私はAハイなので、このままコールするのはリスクが高いです。しかし、相手がブラフ（ bluff：弱いハンドで強く見せること）である可能性も考慮し、少しだけベットを上げて様子を見ます。もし相手がさらにコールしてきたら、私のハンドは非常に弱いと判断し、フォールド（fold：ゲームから降りること）を検討します。ベット額は、相手のベット額30の2倍の60に、ポットの150の1/4（約37.5）を足した97.5ですが、最小レイズ額20を考慮し、90に設定します。これは、相手にプレッシャーを与えつつ、自分の損失を最小限に抑えるための戦略です。
2025-10-31 18:49:56,726 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 90
2025-10-31 18:49:56,727 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:49:56,727 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:49:56,727 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:56,727 - poker_game - INFO - Pot: 150, Current bet: 0
2025-10-31 18:49:56,727 - poker_game - INFO - Last raiser: None
2025-10-31 18:49:56,727 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:56,728 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:56,728 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:49:56,728 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:56,728 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:49:56,728 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:56,729 - poker_game - INFO -   P3(Agent3): chips=1951, bet=0, status=active
2025-10-31 18:49:56,729 - poker_game - INFO -   P4(Agent4): chips=6054, bet=0, status=active
2025-10-31 18:49:56,729 - poker_game - INFO - ==================================================
2025-10-31 18:49:56,729 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 90
2025-10-31 18:49:56,736 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:49:56,736 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:49:56,737 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:49:56,737 - poker_game - INFO - Pot: 240, Current bet: 90
2025-10-31 18:49:56,737 - poker_game - INFO - Last raiser: 3
2025-10-31 18:49:56,737 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:56,737 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:56,738 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:49:56,738 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:56,738 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:49:56,738 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:56,739 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:49:56,739 - poker_game - INFO -   P4(Agent4): chips=6054, bet=0, status=active
2025-10-31 18:49:56,739 - poker_game - INFO - Extra: Action: Player 3 raised to 90
2025-10-31 18:49:56,739 - poker_game - INFO - ==================================================
2025-10-31 18:49:56,739 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:49:56,740 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:49:56,740 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:49:56,740 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:49:56,740 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:49:56,740 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:49:56,740 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:49:56,740 - poker_game - DEBUG - Player bets: [0, 90, 0], Current bet: 90, All same: False
2025-10-31 18:49:56,741 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:49:56,741 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:49:56,741 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:49:56,741 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:49:56,741 - poker_game - INFO - Pot: 240, Current bet: 90
2025-10-31 18:49:56,742 - poker_game - INFO - Last raiser: 3
2025-10-31 18:49:56,742 - poker_game - INFO - Betting round complete: False
2025-10-31 18:49:56,742 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:49:56,743 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:49:56,743 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:49:56,744 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:49:56,744 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:49:56,744 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:49:56,745 - poker_game - INFO -   P4(Agent4): chips=6054, bet=0, status=active
2025-10-31 18:49:56,745 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:49:56,745 - poker_game - INFO - ==================================================
2025-10-31 18:49:56,846 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "K♦",
    "Q♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥",
    "J♠"
  ],
  "your_chips": 6054,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 240,
  "to_call": 90,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1845,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1861,
      "bet": 90,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (90)",
    "raise (min 110)",
    "all-in (6054)"
  ],
  "history": [
    "Showdown: Player 3 won 50",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90"
  ]
}
2025-10-31 18:49:56,866 - poker_game - DEBUG - Create Session: {'id': '0430ef7f-0e9e-42f1-b360-2446888f8280', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904196.859253}
2025-10-31 18:50:06,981 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:50:13,709 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_2cRC6cuygznzsjqTrkzPWRlA', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1115, 'totalTokenCount': 1132}, 'invocationId': 'e-5e56b4b5-3688-4d93-bbfc-28ddfd48bef6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'xqSGIESV', 'timestamp': 1761904196.87909}, {'content': {'parts': [{'functionResponse': {'id': 'call_2cRC6cuygznzsjqTrkzPWRlA', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-5e56b4b5-3688-4d93-bbfc-28ddfd48bef6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'ra4LAROw', 'timestamp': 1761904197.844695}, {'content': {'parts': [{'functionCall': {'id': 'call_zg15ZjZ3chxhqjfx0AnZIkEM', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♦', 'Q♦'], 'community': ['6♠', '9♣', '6♥', 'J♠'], 'your_chips': 6054, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 50, 'pot': 240, 'to_call': 90, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1845, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1861, 'bet': 90, 'status': 'active'}], 'actions': ['fold', 'call (90)', 'raise (min 110)', 'all-in (6054)'], 'history': ['Showdown: Player 3 won 50', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 raised to 60', 'Player 4 folded', 'Showdown: Player 3 won 90', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 6♠, 9♣, 6♥', 'Player 3 checked', 'Player 4 raised to 30', 'Player 1 called 30', 'Player 3 called 30', 'Turn dealt: J♠', 'Player 3 raised to 90']}, 'call_amount': 90, 'pot_after_call': 330, 'equity': 0.4}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_hXj0Fko93LNlwMb7MAgcXK7x', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♦', 'Q♦'], 'community': ['6♠', '9♣', '6♥', 'J♠'], 'your_chips': 6054, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 50, 'pot': 240, 'to_call': 90, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1845, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1861, 'bet': 90, 'status': 'active'}], 'actions': ['fold', 'call (90)', 'raise (min 110)', 'all-in (6054)'], 'history': ['Showdown: Player 3 won 50', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 folded', 'Player 3 raised to 60', 'Player 4 folded', 'Showdown: Player 3 won 90', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 6♠, 9♣, 6♥', 'Player 3 checked', 'Player 4 raised to 30', 'Player 1 called 30', 'Player 3 called 30', 'Turn dealt: J♠', 'Player 3 raised to 90']}, 'call_amount': 90, 'pot_after_call': 330, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 690, 'promptTokenCount': 1639, 'totalTokenCount': 2329}, 'invocationId': 'e-5e56b4b5-3688-4d93-bbfc-28ddfd48bef6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ZZiX4gV0', 'timestamp': 1761904197.846339}, {'content': {'parts': [{'functionResponse': {'id': 'call_zg15ZjZ3chxhqjfx0AnZIkEM', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 90, 'reasoning': 'ポットオッズを満たしており（78.00(ポットに対して32.50%）、コールが妥当と判断。コール額: 90'}}}, {'functionResponse': {'id': 'call_hXj0Fko93LNlwMb7MAgcXK7x', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 90, 'reasoning': 'ポットオッズを満たしており（78.00(ポットに対して32.50%）、コールが妥当と判断。コール額: 90'}}}], 'role': 'user'}, 'invocationId': 'lEFjYxeJ', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'bX7WsmiI', 'timestamp': 1761904211.365075}, {'content': {'parts': [{'text': '{"action":"call","amount":90,"reasoning":"ポットを満たしながら得られる期待値は78.00(ポットに対し32.50%)、コールが妥当と判断。コール額: 90"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 57, 'promptTokenCount': 2637, 'totalTokenCount': 2694}, 'invocationId': 'e-5e56b4b5-3688-4d93-bbfc-28ddfd48bef6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'r7wiJdWN', 'timestamp': 1761904211.367527}]
2025-10-31 18:50:13,709 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:50:13,710 - poker_game - DEBUG - {"action":"call","amount":90,"reasoning":"ポットを満たしながら得られる期待値は78.00(ポットに対し32.50%)、コールが妥当と判断。コール額: 90"}
2025-10-31 18:50:13,710 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:50:13,710 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":90,"reasoning":"ポットを満たしながら得られる期待値は78.00(ポットに対し32.50%)、コールが妥当と判断。コール額: 90"}'
2025-10-31 18:50:13,710 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:50:13,711 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":90,"reasoning":"ポットを満たしながら得られる期待値は78.00(ポットに対し32.50%)、コールが妥当と判断。コール額: 90"}
2025-10-31 18:50:13,711 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 90, 'reasoning': 'ポットを満たしながら得られる期待値は78.00(ポットに対し32.50%)、コールが妥当と判断。コール額: 90'}
2025-10-31 18:50:13,711 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 90
2025-10-31 18:50:13,711 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (90)', 'raise (min 110)', 'all-in (6054)']
2025-10-31 18:50:13,711 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (90)': 90
2025-10-31 18:50:13,711 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 90}
2025-10-31 18:50:13,711 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 90, ポットを満たしながら得られる期待値は78.00(ポットに対し32.50%)、コールが妥当と判断。コール額: 90
2025-10-31 18:50:13,712 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 90
2025-10-31 18:50:13,712 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:50:13,713 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:13,713 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:13,713 - poker_game - INFO - Pot: 240, Current bet: 90
2025-10-31 18:50:13,713 - poker_game - INFO - Last raiser: 3
2025-10-31 18:50:13,713 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:13,714 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:13,714 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:13,714 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:13,714 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:50:13,715 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:13,715 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:50:13,715 - poker_game - INFO -   P4(Agent4): chips=6054, bet=0, status=active
2025-10-31 18:50:13,715 - poker_game - INFO - ==================================================
2025-10-31 18:50:13,715 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 90
2025-10-31 18:50:13,726 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:50:13,726 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:13,727 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:13,727 - poker_game - INFO - Pot: 330, Current bet: 90
2025-10-31 18:50:13,727 - poker_game - INFO - Last raiser: 3
2025-10-31 18:50:13,727 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:13,727 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:13,728 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:13,728 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:13,728 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:50:13,728 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:13,728 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:50:13,729 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:13,729 - poker_game - INFO - Extra: Action: Player 4 called 90
2025-10-31 18:50:13,729 - poker_game - INFO - ==================================================
2025-10-31 18:50:13,729 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:50:13,729 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:50:13,729 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:50:13,729 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:50:13,729 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:50:13,730 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:50:13,730 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:50:13,730 - poker_game - DEBUG - Player bets: [0, 90, 90], Current bet: 90, All same: False
2025-10-31 18:50:13,730 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:50:13,730 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:50:13,730 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:13,730 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:50:13,730 - poker_game - INFO - Pot: 330, Current bet: 90
2025-10-31 18:50:13,730 - poker_game - INFO - Last raiser: 3
2025-10-31 18:50:13,730 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:13,730 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:13,730 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:13,731 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:13,731 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:50:13,731 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:13,731 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:50:13,731 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:13,731 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:50:13,731 - poker_game - INFO - ==================================================
2025-10-31 18:50:13,833 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "Q♠",
    "A♣"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥",
    "J♠"
  ],
  "your_chips": 1845,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 330,
  "to_call": 90,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1861,
      "bet": 90,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5964,
      "bet": 90,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (90)",
    "raise (min 110)",
    "all-in (1845)"
  ],
  "history": [
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90"
  ]
}
2025-10-31 18:50:13,840 - poker_game - DEBUG - Create Session: {'id': '6b40bb79-b713-4d78-ae9e-588d00d108d4', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904213.8380196}
2025-10-31 18:50:16,343 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 270,\n  "reasoning": "現在のボード（6♠ 9♣ 6♥ J♠）では、あなたはAハイ（エースハイ）であり、強い役は持っていません。しかし、あなたの手札（Q♠ A♣）には、ダイヤのフラッシュ（同じマークが揃うこと）の可能性（キッカー・ドロー）と、ストレート（連続した数字が揃うこと）の可能性（ストレート・ドロー）が残っています。相手（Player 3）はターンでベットをしてきており、相手も何らかの役を持っている可能性があります。しかし、相手のベット額（90）に対して、あなたのポットサイズ（330）と相手のチップ量（1861）を考慮すると、ブラフ（はったり）を仕掛けてポットを大きく取るチャンスがあります。ミニマムレイズ（最低限のレイズ額）は110なので、相手のベット額90に加えて180（=270-90）をレイズして、合計270にするのが、相手にプレッシャーを与えつつ、もし相手がフォールド（降りる）した場合にポットを獲得できる可能性を高める戦略です。もし相手がコールしてきた場合でも、リバー（最後のコミュニティカード）でフラッシュやストレートが完成すれば、まだ勝てる可能性があります。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 311, 'promptTokenCount': 801, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 801}], 'totalTokenCount': 1112}, 'invocationId': 'e-5d36cbae-22d5-40b9-be71-eb0b313268e1', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'v0lM1n1w', 'timestamp': 1761904213.850154}]
2025-10-31 18:50:16,344 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:50:16,344 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 270,
  "reasoning": "現在のボード（6♠ 9♣ 6♥ J♠）では、あなたはAハイ（エースハイ）であり、強い役は持っていません。しかし、あなたの手札（Q♠ A♣）には、ダイヤのフラッシュ（同じマークが揃うこと）の可能性（キッカー・ドロー）と、ストレート（連続した数字が揃うこと）の可能性（ストレート・ドロー）が残っています。相手（Player 3）はターンでベットをしてきており、相手も何らかの役を持っている可能性があります。しかし、相手のベット額（90）に対して、あなたのポットサイズ（330）と相手のチップ量（1861）を考慮すると、ブラフ（はったり）を仕掛けてポットを大きく取るチャンスがあります。ミニマムレイズ（最低限のレイズ額）は110なので、相手のベット額90に加えて180（=270-90）をレイズして、合計270にするのが、相手にプレッシャーを与えつつ、もし相手がフォールド（降りる）した場合にポットを獲得できる可能性を高める戦略です。もし相手がコールしてきた場合でも、リバー（最後のコミュニティカード）でフラッシュやストレートが完成すれば、まだ勝てる可能性があります。"
}
```
2025-10-31 18:50:16,345 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:50:16,345 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 270,\n  "reasoning": "現在のボード（6♠ 9♣ 6♥ J♠）では、あなたはAハイ（エースハイ）であり、強い役は持っていません。しかし、あなたの手札（Q♠ A♣）には、ダイヤのフラッシュ（同じマークが揃うこと）の可能性（キッカー・ドロー）と、ストレート（連続した数字が揃うこと）の可能性（ストレート・ドロー）が残っています。相手（Player 3）はターンでベットをしてきており、相手も何らかの役を持っている可能性があります。しかし、相手のベット額（90）に対して、あなたのポットサイズ（330）と相手のチップ量（1861）を考慮すると、ブラフ（はったり）を仕掛けてポットを大きく取るチャンスがあります。ミニマムレイズ（最低限のレイズ額）は110なので、相手のベット額90に加えて180（=270-90）をレイズして、合計270にするのが、相手にプレッシャーを与えつつ、もし相手がフォールド（降りる）した場合にポットを獲得できる可能性を高める戦略です。もし相手がコールしてきた場合でも、リバー（最後のコミュニティカード）でフラッシュやストレートが完成すれば、まだ勝てる可能性があります。"\n}\n```'
2025-10-31 18:50:16,345 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:50:16,346 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 270,\n  "reasoning": "現在のボード（6♠ 9♣ 6♥ J♠）では、あなたはAハイ（エースハイ）であり、強い役は持っていません。しかし、あなたの手札（Q♠ A♣）には、ダイヤのフラッシュ（同じマークが揃うこと）の可能性（キッカー・ドロー）と、ストレート（連続した数字が揃うこと）の可能性（ストレート・ドロー）が残っています。相手（Player 3）はターンでベットをしてきており、相手も何らかの役を持っている可能性があります。しかし、相手のベット額（90）に対して、あなたのポットサイズ（330）と相手のチップ量（1861）を考慮すると、ブラフ（はったり）を仕掛けてポットを大きく取るチャンスがあります。ミニマムレイズ（最低限のレイズ額）は110なので、相手のベット額90に加えて180（=270-90）をレイズして、合計270にするのが、相手にプレッシャーを与えつつ、もし相手がフォールド（降りる）した場合にポットを獲得できる可能性を高める戦略です。もし相手がコールしてきた場合でも、リバー（最後のコミュニティカード）でフラッシュやストレートが完成すれば、まだ勝てる可能性があります。"\n}'
2025-10-31 18:50:16,346 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 270,
  "reasoning": "現在のボード（6♠ 9♣ 6♥ J♠）では、あなたはAハイ（エースハイ）であり、強い役は持っていません。しかし、あなたの手札（Q♠ A♣）には、ダイヤのフラッシュ（同じマークが揃うこと）の可能性（キッカー・ドロー）と、ストレート（連続した数字が揃うこと）の可能性（ストレート・ドロー）が残っています。相手（Player 3）はターンでベットをしてきており、相手も何らかの役を持っている可能性があります。しかし、相手のベット額（90）に対して、あなたのポットサイズ（330）と相手のチップ量（1861）を考慮すると、ブラフ（はったり）を仕掛けてポットを大きく取るチャンスがあります。ミニマムレイズ（最低限のレイズ額）は110なので、相手のベット額90に加えて180（=270-90）をレイズして、合計270にするのが、相手にプレッシャーを与えつつ、もし相手がフォールド（降りる）した場合にポットを獲得できる可能性を高める戦略です。もし相手がコールしてきた場合でも、リバー（最後のコミュニティカード）でフラッシュやストレートが完成すれば、まだ勝てる可能性があります。"
}
2025-10-31 18:50:16,346 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 270, 'reasoning': '現在のボード（6♠ 9♣ 6♥ J♠）では、あなたはAハイ（エースハイ）であり、強い役は持っていません。しかし、あなたの手札（Q♠ A♣）には、ダイヤのフラッシュ（同じマークが揃うこと）の可能性（キッカー・ドロー）と、ストレート（連続した数字が揃うこと）の可能性（ストレート・ドロー）が残っています。相手（Player 3）はターンでベットをしてきており、相手も何らかの役を持っている可能性があります。しかし、相手のベット額（90）に対して、あなたのポットサイズ（330）と相手のチップ量（1861）を考慮すると、ブラフ（はったり）を仕掛けてポットを大きく取るチャンスがあります。ミニマムレイズ（最低限のレイズ額）は110なので、相手のベット額90に加えて180（=270-90）をレイズして、合計270にするのが、相手にプレッシャーを与えつつ、もし相手がフォールド（降りる）した場合にポットを獲得できる可能性を高める戦略です。もし相手がコールしてきた場合でも、リバー（最後のコミュニティカード）でフラッシュやストレートが完成すれば、まだ勝てる可能性があります。'}
2025-10-31 18:50:16,346 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 270
2025-10-31 18:50:16,347 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'call (90)', 'raise (min 110)', 'all-in (1845)']
2025-10-31 18:50:16,347 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 110)': 110
2025-10-31 18:50:16,347 - poker_game - DEBUG - [Agent1] Raise amount 270 is valid (min: 110)
2025-10-31 18:50:16,347 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 270}
2025-10-31 18:50:16,347 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 270, 現在のボード（6♠ 9♣ 6♥ J♠）では、あなたはAハイ（エースハイ）であり、強い役は持っていません。しかし、あなたの手札（Q♠ A♣）には、ダイヤのフラッシュ（同じマークが揃うこと）の可能性（キッカー・ドロー）と、ストレート（連続した数字が揃うこと）の可能性（ストレート・ドロー）が残っています。相手（Player 3）はターンでベットをしてきており、相手も何らかの役を持っている可能性があります。しかし、相手のベット額（90）に対して、あなたのポットサイズ（330）と相手のチップ量（1861）を考慮すると、ブラフ（はったり）を仕掛けてポットを大きく取るチャンスがあります。ミニマムレイズ（最低限のレイズ額）は110なので、相手のベット額90に加えて180（=270-90）をレイズして、合計270にするのが、相手にプレッシャーを与えつつ、もし相手がフォールド（降りる）した場合にポットを獲得できる可能性を高める戦略です。もし相手がコールしてきた場合でも、リバー（最後のコミュニティカード）でフラッシュやストレートが完成すれば、まだ勝てる可能性があります。
2025-10-31 18:50:16,349 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 270
2025-10-31 18:50:16,349 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:50:16,350 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:16,350 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:50:16,351 - poker_game - INFO - Pot: 330, Current bet: 90
2025-10-31 18:50:16,351 - poker_game - INFO - Last raiser: 3
2025-10-31 18:50:16,352 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:16,352 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:16,353 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:16,354 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:16,354 - poker_game - INFO -   P1(Agent1): chips=1845, bet=0, status=active
2025-10-31 18:50:16,355 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:16,355 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:50:16,356 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:16,356 - poker_game - INFO - ==================================================
2025-10-31 18:50:16,356 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 360
2025-10-31 18:50:16,369 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:50:16,369 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:16,370 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:50:16,370 - poker_game - INFO - Pot: 690, Current bet: 360
2025-10-31 18:50:16,371 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:16,371 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:16,371 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:16,372 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:16,372 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:16,373 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:16,373 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:16,374 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:50:16,374 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:16,374 - poker_game - INFO - Extra: Action: Player 1 raised to 360
2025-10-31 18:50:16,375 - poker_game - INFO - ==================================================
2025-10-31 18:50:16,375 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:50:16,375 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:50:16,376 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:50:16,376 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:50:16,376 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:50:16,377 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:50:16,377 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:50:16,377 - poker_game - DEBUG - Player bets: [360, 90, 90], Current bet: 360, All same: False
2025-10-31 18:50:16,378 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:50:16,378 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:50:16,378 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:16,379 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:50:16,379 - poker_game - INFO - Pot: 690, Current bet: 360
2025-10-31 18:50:16,380 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:16,380 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:16,380 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:16,381 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:16,382 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:16,382 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:16,382 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:16,383 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:50:16,383 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:16,384 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:50:16,384 - poker_game - INFO - ==================================================
2025-10-31 18:50:16,486 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "7♣",
    "A♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥",
    "J♠"
  ],
  "your_chips": 1861,
  "your_bet_this_round": 90,
  "your_total_bet_this_hand": 140,
  "pot": 690,
  "to_call": 270,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 1485,
      "bet": 360,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5964,
      "bet": 90,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (270)",
    "raise (min 380)",
    "all-in (1861)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360"
  ]
}
2025-10-31 18:50:16,500 - poker_game - DEBUG - Create Session: {'id': '47f753f5-0ac1-4dd4-806e-5cdcc6e4fb69', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904216.4969764}
2025-10-31 18:50:18,367 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "現在の状況では、私の手札（A7オフスーツ）はボード（6♠ 9♣ 6♥ J♠）に対してあまり強いものではありません。プレイヤー1はすでに360ベットしており、コールするには270追加する必要があります。プレイヤー1のベット額は大きく、強力なハンドを持っている可能性が高いです。私のハンドはドロー（ストレートやフラッシュ）の可能性も低く、ペアができているわけでもないため、このベットコールはリスクに見合わないと判断しました。したがって、フォールドを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 143, 'promptTokenCount': 806, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 806}], 'totalTokenCount': 949}, 'invocationId': 'e-53edfc72-8a94-4cd8-8b8f-e9e44a6989ef', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'h1x2IdFl', 'timestamp': 1761904216.513821}]
2025-10-31 18:50:18,368 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:50:18,368 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "現在の状況では、私の手札（A7オフスーツ）はボード（6♠ 9♣ 6♥ J♠）に対してあまり強いものではありません。プレイヤー1はすでに360ベットしており、コールするには270追加する必要があります。プレイヤー1のベット額は大きく、強力なハンドを持っている可能性が高いです。私のハンドはドロー（ストレートやフラッシュ）の可能性も低く、ペアができているわけでもないため、このベットコールはリスクに見合わないと判断しました。したがって、フォールドを選択します。"
}
```
2025-10-31 18:50:18,369 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:50:18,369 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "現在の状況では、私の手札（A7オフスーツ）はボード（6♠ 9♣ 6♥ J♠）に対してあまり強いものではありません。プレイヤー1はすでに360ベットしており、コールするには270追加する必要があります。プレイヤー1のベット額は大きく、強力なハンドを持っている可能性が高いです。私のハンドはドロー（ストレートやフラッシュ）の可能性も低く、ペアができているわけでもないため、このベットコールはリスクに見合わないと判断しました。したがって、フォールドを選択します。"\n}\n```'
2025-10-31 18:50:18,369 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:50:18,369 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "現在の状況では、私の手札（A7オフスーツ）はボード（6♠ 9♣ 6♥ J♠）に対してあまり強いものではありません。プレイヤー1はすでに360ベットしており、コールするには270追加する必要があります。プレイヤー1のベット額は大きく、強力なハンドを持っている可能性が高いです。私のハンドはドロー（ストレートやフラッシュ）の可能性も低く、ペアができているわけでもないため、このベットコールはリスクに見合わないと判断しました。したがって、フォールドを選択します。"\n}'
2025-10-31 18:50:18,369 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "現在の状況では、私の手札（A7オフスーツ）はボード（6♠ 9♣ 6♥ J♠）に対してあまり強いものではありません。プレイヤー1はすでに360ベットしており、コールするには270追加する必要があります。プレイヤー1のベット額は大きく、強力なハンドを持っている可能性が高いです。私のハンドはドロー（ストレートやフラッシュ）の可能性も低く、ペアができているわけでもないため、このベットコールはリスクに見合わないと判断しました。したがって、フォールドを選択します。"
}
2025-10-31 18:50:18,370 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '現在の状況では、私の手札（A7オフスーツ）はボード（6♠ 9♣ 6♥ J♠）に対してあまり強いものではありません。プレイヤー1はすでに360ベットしており、コールするには270追加する必要があります。プレイヤー1のベット額は大きく、強力なハンドを持っている可能性が高いです。私のハンドはドロー（ストレートやフラッシュ）の可能性も低く、ペアができているわけでもないため、このベットコールはリスクに見合わないと判断しました。したがって、フォールドを選択します。'}
2025-10-31 18:50:18,370 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:50:18,370 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:50:18,370 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:50:18,370 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, 現在の状況では、私の手札（A7オフスーツ）はボード（6♠ 9♣ 6♥ J♠）に対してあまり強いものではありません。プレイヤー1はすでに360ベットしており、コールするには270追加する必要があります。プレイヤー1のベット額は大きく、強力なハンドを持っている可能性が高いです。私のハンドはドロー（ストレートやフラッシュ）の可能性も低く、ペアができているわけでもないため、このベットコールはリスクに見合わないと判断しました。したがって、フォールドを選択します。
2025-10-31 18:50:18,371 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:50:18,371 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:50:18,372 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:18,372 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:50:18,373 - poker_game - INFO - Pot: 690, Current bet: 360
2025-10-31 18:50:18,373 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:18,374 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:18,374 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:18,374 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:18,375 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:18,375 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:18,375 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:18,376 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=active
2025-10-31 18:50:18,376 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:18,376 - poker_game - INFO - ==================================================
2025-10-31 18:50:18,377 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:50:18,389 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:50:18,390 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:18,391 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:50:18,391 - poker_game - INFO - Pot: 690, Current bet: 360
2025-10-31 18:50:18,392 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:18,392 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:18,392 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:18,393 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:18,393 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:18,394 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:18,394 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:18,395 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=folded
2025-10-31 18:50:18,395 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:18,395 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:50:18,396 - poker_game - INFO - ==================================================
2025-10-31 18:50:18,396 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:50:18,397 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:50:18,397 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:50:18,397 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:50:18,397 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:50:18,398 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:50:18,398 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:50:18,398 - poker_game - DEBUG - Player bets: [360, 90], Current bet: 360, All same: False
2025-10-31 18:50:18,398 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:50:18,399 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:50:18,399 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:18,400 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:18,400 - poker_game - INFO - Pot: 690, Current bet: 360
2025-10-31 18:50:18,400 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:18,401 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:18,401 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:18,402 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:18,402 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:18,402 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:18,403 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:18,403 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=folded
2025-10-31 18:50:18,404 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:18,405 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:50:18,406 - poker_game - INFO - ==================================================
2025-10-31 18:50:18,508 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "K♦",
    "Q♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥",
    "J♠"
  ],
  "your_chips": 5964,
  "your_bet_this_round": 90,
  "your_total_bet_this_hand": 140,
  "pot": 690,
  "to_call": 270,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1485,
      "bet": 360,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1861,
      "bet": 90,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (270)",
    "raise (min 380)",
    "all-in (5964)"
  ],
  "history": [
    "Player 4 called 20",
    "Player 1 folded",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded"
  ]
}
2025-10-31 18:50:18,517 - poker_game - DEBUG - Create Session: {'id': 'ca962a15-5099-4cf5-b4cb-53e8186e6a2a', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904218.5160213}
2025-10-31 18:50:26,339 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_zItNRmtbN94jlQx47no1dHT9', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1108, 'totalTokenCount': 1125}, 'invocationId': 'e-f97f305f-4e34-43f0-b5cd-f6b4225e424e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'aWsVOgkG', 'timestamp': 1761904218.527584}, {'content': {'parts': [{'functionResponse': {'id': 'call_zItNRmtbN94jlQx47no1dHT9', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f97f305f-4e34-43f0-b5cd-f6b4225e424e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'YZOaUzYv', 'timestamp': 1761904216.782441}, {'content': {'parts': [{'functionCall': {'id': 'call_KWm6Sm3446RdS6kWW3ZT1XaB', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♦', 'Q♦'], 'community': ['6♠', '9♣', '6♥', 'J♠'], 'your_chips': 5964, 'your_bet_this_round': 90, 'your_total_bet_this_hand': 140, 'pot': 690, 'to_call': 270, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1485, 'bet': 360, 'status': 'active'}, {'id': 3, 'chips': 1861, 'bet': 90, 'status': 'folded'}], 'actions': ['fold', 'call (270)', 'raise (min 380)', 'all-in (5964)'], 'history': ['Player 4 called 20', 'Player 1 folded', 'Player 3 raised to 60', 'Player 4 folded', 'Showdown: Player 3 won 90', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 6♠, 9♣, 6♥', 'Player 3 checked', 'Player 4 raised to 30', 'Player 1 called 30', 'Player 3 called 30', 'Turn dealt: J♠', 'Player 3 raised to 90', 'Player 4 called 90', 'Player 1 raised to 360', 'Player 3 folded']}, 'call_amount': 270, 'pot_after_call': 960, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 346, 'promptTokenCount': 1632, 'totalTokenCount': 1978}, 'invocationId': 'e-f97f305f-4e34-43f0-b5cd-f6b4225e424e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'OEhZciPF', 'timestamp': 1761904216.784542}, {'content': {'parts': [{'functionResponse': {'id': 'call_KWm6Sm3446RdS6kWW3ZT1XaB', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 270, 'reasoning': 'ポットオッズを満たしており（222.00(ポットに対して32.17%）、コールが妥当と判断。コール額: 270'}}}], 'role': 'user'}, 'invocationId': 'e-f97f305f-4e34-43f0-b5cd-f6b4225e424e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Z6dCkh94', 'timestamp': 1761904224.491123}, {'content': {'parts': [{'text': '{"action":"call","amount":270,"reasoning":"ポットオッズを満たしており（222.00(ポットに対して32.17%）、コールが妥当と判断。コール額: 270"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2029, 'totalTokenCount': 2083}, 'invocationId': 'e-f97f305f-4e34-43f0-b5cd-f6b4225e424e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'sA3VhKpV', 'timestamp': 1761904224.495778}]
2025-10-31 18:50:26,339 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:50:26,339 - poker_game - DEBUG - {"action":"call","amount":270,"reasoning":"ポットオッズを満たしており（222.00(ポットに対して32.17%）、コールが妥当と判断。コール額: 270"}
2025-10-31 18:50:26,340 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:50:26,340 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":270,"reasoning":"ポットオッズを満たしており（222.00(ポットに対して32.17%）、コールが妥当と判断。コール額: 270"}'
2025-10-31 18:50:26,340 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:50:26,340 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":270,"reasoning":"ポットオッズを満たしており（222.00(ポットに対して32.17%）、コールが妥当と判断。コール額: 270"}
2025-10-31 18:50:26,340 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 270, 'reasoning': 'ポットオッズを満たしており（222.00(ポットに対して32.17%）、コールが妥当と判断。コール額: 270'}
2025-10-31 18:50:26,340 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 270
2025-10-31 18:50:26,340 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (270)', 'raise (min 380)', 'all-in (5964)']
2025-10-31 18:50:26,341 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (270)': 270
2025-10-31 18:50:26,341 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 270}
2025-10-31 18:50:26,341 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 270, ポットオッズを満たしており（222.00(ポットに対して32.17%）、コールが妥当と判断。コール額: 270
2025-10-31 18:50:26,341 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 270
2025-10-31 18:50:26,342 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:50:26,342 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:26,342 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:26,342 - poker_game - INFO - Pot: 690, Current bet: 360
2025-10-31 18:50:26,343 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:26,343 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:26,343 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:26,343 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:26,344 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:26,344 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:26,344 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:26,344 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=folded
2025-10-31 18:50:26,345 - poker_game - INFO -   P4(Agent4): chips=5964, bet=90, status=active
2025-10-31 18:50:26,345 - poker_game - INFO - ==================================================
2025-10-31 18:50:26,345 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 270
2025-10-31 18:50:26,352 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:50:26,353 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:26,353 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:26,353 - poker_game - INFO - Pot: 960, Current bet: 360
2025-10-31 18:50:26,353 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:26,353 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:26,354 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:26,354 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:26,354 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:26,354 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:26,354 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:26,355 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=folded
2025-10-31 18:50:26,355 - poker_game - INFO -   P4(Agent4): chips=5694, bet=360, status=active
2025-10-31 18:50:26,355 - poker_game - INFO - Extra: Action: Player 4 called 270
2025-10-31 18:50:26,355 - poker_game - INFO - ==================================================
2025-10-31 18:50:26,355 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:50:26,356 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:50:26,356 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:50:26,356 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:50:26,356 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:50:26,356 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:50:26,357 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:50:26,357 - poker_game - DEBUG - Player bets: [360, 360], Current bet: 360, All same: True
2025-10-31 18:50:26,357 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:50:26,357 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:50:26,358 - poker_game - INFO - Hand #8, Phase: turn
2025-10-31 18:50:26,358 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:50:26,358 - poker_game - INFO - Pot: 960, Current bet: 360
2025-10-31 18:50:26,359 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:26,359 - poker_game - INFO - Betting round complete: True
2025-10-31 18:50:26,359 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:26,359 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠']
2025-10-31 18:50:26,359 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:26,360 - poker_game - INFO -   P1(Agent1): chips=1485, bet=360, status=active
2025-10-31 18:50:26,360 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:26,360 - poker_game - INFO -   P3(Agent3): chips=1861, bet=90, status=folded
2025-10-31 18:50:26,360 - poker_game - INFO -   P4(Agent4): chips=5694, bet=360, status=active
2025-10-31 18:50:26,360 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:50:26,361 - poker_game - INFO - ==================================================
2025-10-31 18:50:26,462 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:50:26,462 - poker_game - INFO - Betting round complete: True
2025-10-31 18:50:26,463 - poker_game - INFO - Remaining players: 2
2025-10-31 18:50:26,463 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:50:26,463 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:50:26,463 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:50:26,473 - poker_game - INFO - Starting new betting round
2025-10-31 18:50:26,474 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:50:26,474 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:50:26,475 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:50:26,475 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:50:26,475 - poker_game - INFO - First actor: Player 4 (by phase rule), was 1
2025-10-31 18:50:26,476 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:50:26,476 - poker_game - INFO - Hand #8, Phase: river
2025-10-31 18:50:26,476 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:26,477 - poker_game - INFO - Pot: 960, Current bet: 0
2025-10-31 18:50:26,477 - poker_game - INFO - Last raiser: None
2025-10-31 18:50:26,477 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:26,478 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:26,478 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:26,479 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:26,480 - poker_game - INFO -   P1(Agent1): chips=1485, bet=0, status=active
2025-10-31 18:50:26,480 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:26,481 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:26,482 - poker_game - INFO -   P4(Agent4): chips=5694, bet=0, status=active
2025-10-31 18:50:26,482 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:50:26,483 - poker_game - INFO - ==================================================
2025-10-31 18:50:26,483 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "K♦",
    "Q♦"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥",
    "J♠",
    "Q♥"
  ],
  "your_chips": 5694,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 410,
  "pot": 960,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 1485,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1861,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5694)"
  ],
  "history": [
    "Player 3 raised to 60",
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥"
  ]
}
2025-10-31 18:50:26,492 - poker_game - DEBUG - Create Session: {'id': 'e43c0c82-d69f-4956-9cba-06fb861481f8', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904226.4899936}
2025-10-31 18:50:36,675 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:50:48,604 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 18:50:49,293 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_xIq2WaMLp3n763DSj4MhoeuC', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1112, 'totalTokenCount': 1129}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'nhBKnTvN', 'timestamp': 1761904226.503563}, {'content': {'parts': [{'functionResponse': {'id': 'call_xIq2WaMLp3n763DSj4MhoeuC', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'DB0azefX', 'timestamp': 1761904227.72244}, {'content': {'parts': [{'functionCall': {'id': 'call_Bm8QXaPZBsO67tAMMA9Xcgna', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1636, 'totalTokenCount': 1656}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'XHq14ojQ', 'timestamp': 1761904227.725413}, {'content': {'parts': [{'functionResponse': {'id': 'call_Bm8QXaPZBsO67tAMMA9Xcgna', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'ZOyCwsjr', 'timestamp': 1761904229.35536}, {'content': {'parts': [{'functionCall': {'id': 'call_ljiQdEjnHXyKesP6XBetbgyV', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1198, 'totalTokenCount': 1215}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ntqwaIpE', 'timestamp': 1761904229.358038}, {'content': {'parts': [{'functionResponse': {'id': 'call_ljiQdEjnHXyKesP6XBetbgyV', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'rhpUrMG7', 'timestamp': 1761904230.314293}, {'content': {'parts': [{'functionCall': {'id': 'call_0c5uVPSH5SgOn6RKlELlzdvD', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1728, 'totalTokenCount': 1748}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '7dN7wbE9', 'timestamp': 1761904230.316175}, {'content': {'parts': [{'functionResponse': {'id': 'call_0c5uVPSH5SgOn6RKlELlzdvD', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'Gt7S0pWR', 'timestamp': 1761904231.956685}, {'content': {'parts': [{'functionCall': {'id': 'call_ISjeAHXc5uUZO3jLEe8yZCPM', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1284, 'totalTokenCount': 1301}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '9bjfA4xA', 'timestamp': 1761904231.96259}, {'content': {'parts': [{'functionResponse': {'id': 'call_ISjeAHXc5uUZO3jLEe8yZCPM', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'xArmXZoA', 'timestamp': 1761904233.136047}, {'content': {'parts': [{'functionCall': {'id': 'call_PH2zWMIvaHDV3EUZ63HNQcfw', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1820, 'totalTokenCount': 1840}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'T417UfOp', 'timestamp': 1761904233.138832}, {'content': {'parts': [{'functionResponse': {'id': 'call_PH2zWMIvaHDV3EUZ63HNQcfw', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'tsFgTAU3', 'timestamp': 1761904234.423837}, {'content': {'parts': [{'functionCall': {'id': 'call_n4NlxJtqwBTAkaSapygdK4As', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1370, 'totalTokenCount': 1387}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '8pJFGYGL', 'timestamp': 1761904234.425804}, {'content': {'parts': [{'functionResponse': {'id': 'call_n4NlxJtqwBTAkaSapygdK4As', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'hPCt5vyo', 'timestamp': 1761904235.305922}, {'content': {'parts': [{'functionCall': {'id': 'call_LhurTvnCpzmiiz1iXtRRcWNk', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1912, 'totalTokenCount': 1932}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'WhpAVnly', 'timestamp': 1761904235.313141}, {'content': {'parts': [{'functionResponse': {'id': 'call_LhurTvnCpzmiiz1iXtRRcWNk', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'geLa1zmd', 'timestamp': 1761904236.375545}, {'content': {'parts': [{'functionCall': {'id': 'call_qFtyOk5pZKyyYxuZcV8mi1V0', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1456, 'totalTokenCount': 1473}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'D2Vll6c6', 'timestamp': 1761904236.381194}, {'content': {'parts': [{'functionResponse': {'id': 'call_qFtyOk5pZKyyYxuZcV8mi1V0', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'f5xJ6W0n', 'timestamp': 1761904237.409761}, {'content': {'parts': [{'functionCall': {'id': 'call_3Jgb6jP6aiLFnmlSEpkYgVkJ', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2004, 'totalTokenCount': 2024}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'DJKLlMCS', 'timestamp': 1761904237.412675}, {'content': {'parts': [{'functionResponse': {'id': 'call_3Jgb6jP6aiLFnmlSEpkYgVkJ', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'jzBHPcfG', 'timestamp': 1761904238.731535}, {'content': {'parts': [{'functionCall': {'id': 'call_jN1D0dmNtoitLIYBaXtrpM5w', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1542, 'totalTokenCount': 1559}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'yogdJpgu', 'timestamp': 1761904238.741005}, {'content': {'parts': [{'functionResponse': {'id': 'call_jN1D0dmNtoitLIYBaXtrpM5w', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'VCxYWAD0', 'timestamp': 1761904240.304711}, {'content': {'parts': [{'functionCall': {'id': 'call_oh2rSH54zSYNN72ALHyyWTy6', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2096, 'totalTokenCount': 2116}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'FzyiAdDv', 'timestamp': 1761904240.312159}, {'content': {'parts': [{'functionResponse': {'id': 'call_oh2rSH54zSYNN72ALHyyWTy6', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'YPM2NUKc', 'timestamp': 1761904241.672886}, {'content': {'parts': [{'functionCall': {'id': 'call_iP6CgaERmQONhaLbvkrqIUA2', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1628, 'totalTokenCount': 1645}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ktTACbI9', 'timestamp': 1761904241.676207}, {'content': {'parts': [{'functionResponse': {'id': 'call_iP6CgaERmQONhaLbvkrqIUA2', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'B2HOjQF2', 'timestamp': 1761904242.449432}, {'content': {'parts': [{'functionCall': {'id': 'call_oPw1O8zd3LrQvcgIrswpWEnI', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['K♦', 'Q♦'], 'community': ['6♠', '9♣', '6♥', 'J♠', 'Q♥'], 'your_chips': 5694, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 410, 'pot': 960, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 1485, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1861, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (5694)'], 'history': ['Player 3 raised to 60', 'Player 4 folded', 'Showdown: Player 3 won 90', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 6♠, 9♣, 6♥', 'Player 3 checked', 'Player 4 raised to 30', 'Player 1 called 30', 'Player 3 called 30', 'Turn dealt: J♠', 'Player 3 raised to 90', 'Player 4 called 90', 'Player 1 raised to 360', 'Player 3 folded', 'Player 4 called 270', 'River dealt: Q♥']}, 'call_amount': 0, 'pot_after_call': 960, 'equity': 0.8}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 331, 'promptTokenCount': 2188, 'totalTokenCount': 2519}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'c0LnOwLP', 'timestamp': 1761904242.461333}, {'content': {'parts': [{'functionResponse': {'id': 'call_oPw1O8zd3LrQvcgIrswpWEnI', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 633, 'reasoning': '期待値が高い（768.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 633'}}}], 'role': 'user'}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ORPsrv7d', 'timestamp': 1761904247.471132}, {'content': {'parts': [{'text': '{"action":"raise","amount":633,"reasoning":"期待値が高い（768.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 633"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 52, 'promptTokenCount': 2584, 'totalTokenCount': 2636}, 'invocationId': 'e-00234497-fc8a-425a-b4c7-8580c7297963', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '1cgPAf4g', 'timestamp': 1761904247.481865}]
2025-10-31 18:50:49,293 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:50:49,294 - poker_game - DEBUG - {"action":"raise","amount":633,"reasoning":"期待値が高い（768.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 633"}
2025-10-31 18:50:49,295 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:50:49,295 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":633,"reasoning":"期待値が高い（768.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 633"}'
2025-10-31 18:50:49,295 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:50:49,295 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":633,"reasoning":"期待値が高い（768.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 633"}
2025-10-31 18:50:49,295 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 633, 'reasoning': '期待値が高い（768.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 633'}
2025-10-31 18:50:49,295 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 633
2025-10-31 18:50:49,295 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (5694)']
2025-10-31 18:50:49,296 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:50:49,296 - poker_game - DEBUG - [Agent4] Raise amount 633 is valid (min: 20)
2025-10-31 18:50:49,296 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 633}
2025-10-31 18:50:49,296 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 633, 期待値が高い（768.00(ポットに対して80.00%）ため、2/3ポットでベットします。ベット額: 633
2025-10-31 18:50:49,297 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 633
2025-10-31 18:50:49,297 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:50:49,297 - poker_game - INFO - Hand #8, Phase: river
2025-10-31 18:50:49,298 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:49,298 - poker_game - INFO - Pot: 960, Current bet: 0
2025-10-31 18:50:49,298 - poker_game - INFO - Last raiser: None
2025-10-31 18:50:49,298 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:49,298 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:49,299 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:49,299 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:49,299 - poker_game - INFO -   P1(Agent1): chips=1485, bet=0, status=active
2025-10-31 18:50:49,299 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:49,300 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:49,300 - poker_game - INFO -   P4(Agent4): chips=5694, bet=0, status=active
2025-10-31 18:50:49,300 - poker_game - INFO - ==================================================
2025-10-31 18:50:49,300 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 633
2025-10-31 18:50:49,310 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:50:49,310 - poker_game - INFO - Hand #8, Phase: river
2025-10-31 18:50:49,311 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:49,311 - poker_game - INFO - Pot: 1593, Current bet: 633
2025-10-31 18:50:49,311 - poker_game - INFO - Last raiser: 4
2025-10-31 18:50:49,311 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:49,312 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:49,312 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:49,312 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:49,312 - poker_game - INFO -   P1(Agent1): chips=1485, bet=0, status=active
2025-10-31 18:50:49,313 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:49,313 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:49,313 - poker_game - INFO -   P4(Agent4): chips=5061, bet=633, status=active
2025-10-31 18:50:49,313 - poker_game - INFO - Extra: Action: Player 4 raised to 633
2025-10-31 18:50:49,314 - poker_game - INFO - ==================================================
2025-10-31 18:50:49,314 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:50:49,314 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:50:49,315 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:50:49,315 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:50:49,315 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:50:49,316 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:50:49,316 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:50:49,316 - poker_game - DEBUG - Player bets: [0, 633], Current bet: 633, All same: False
2025-10-31 18:50:49,316 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:50:49,317 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:50:49,317 - poker_game - INFO - Hand #8, Phase: river
2025-10-31 18:50:49,317 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:50:49,317 - poker_game - INFO - Pot: 1593, Current bet: 633
2025-10-31 18:50:49,318 - poker_game - INFO - Last raiser: 4
2025-10-31 18:50:49,318 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:49,318 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:49,318 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:49,318 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:49,319 - poker_game - INFO -   P1(Agent1): chips=1485, bet=0, status=active
2025-10-31 18:50:49,319 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:49,319 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:49,319 - poker_game - INFO -   P4(Agent4): chips=5061, bet=633, status=active
2025-10-31 18:50:49,320 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:50:49,320 - poker_game - INFO - ==================================================
2025-10-31 18:50:49,421 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "Q♠",
    "A♣"
  ],
  "community": [
    "6♠",
    "9♣",
    "6♥",
    "J♠",
    "Q♥"
  ],
  "your_chips": 1485,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 410,
  "pot": 1593,
  "to_call": 633,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1861,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5061,
      "bet": 633,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (633)",
    "raise (min 653)",
    "all-in (1485)"
  ],
  "history": [
    "Player 4 folded",
    "Showdown: Player 3 won 90",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥",
    "Player 4 raised to 633"
  ]
}
2025-10-31 18:50:49,432 - poker_game - DEBUG - Create Session: {'id': '11117c01-599b-465a-8444-b4ca4120639c', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904249.4287844}
2025-10-31 18:50:52,514 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 633,\n  "reasoning": "リバー（最終ストリート）で、あなたの手札は「Q♠ A♣」、コミュニティカードは「6♠ 9♣ 6♥ J♠ Q♥」です。あなたのハンドは、ツーペア（Qと6）で、Aのキッカー（ペアを構成しない最も強いカード）を持っています。対戦相手（Player 4）は、リバーで633をベットしてきました。これは、彼があなたよりも強いハンドを持っている可能性を示唆しています。しかし、あなたのツーペアは比較的強いハンドであり、ポットサイズ（1593 + 633 = 2226）に対してコール（相手のベット額と同額を支払うこと）する価値は十分にあります。彼がブラフ（虚張）している可能性も考慮し、コールを選択します。オールイン（全額ベット）は、相手がより強いハンドを持っている場合にチップを失うリスクが高すぎるため、現時点では避けます。レイズ（ベット額をさらに増やすこと）も、相手のベット額から推測されるハンドの強さを考えると、リスクが高いです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 265, 'promptTokenCount': 809, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 809}], 'totalTokenCount': 1074}, 'invocationId': 'e-8d786d86-5b5e-472b-b161-8c26d1c5bb9b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'gyvMMIKO', 'timestamp': 1761904249.442903}]
2025-10-31 18:50:52,514 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:50:52,515 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 633,
  "reasoning": "リバー（最終ストリート）で、あなたの手札は「Q♠ A♣」、コミュニティカードは「6♠ 9♣ 6♥ J♠ Q♥」です。あなたのハンドは、ツーペア（Qと6）で、Aのキッカー（ペアを構成しない最も強いカード）を持っています。対戦相手（Player 4）は、リバーで633をベットしてきました。これは、彼があなたよりも強いハンドを持っている可能性を示唆しています。しかし、あなたのツーペアは比較的強いハンドであり、ポットサイズ（1593 + 633 = 2226）に対してコール（相手のベット額と同額を支払うこと）する価値は十分にあります。彼がブラフ（虚張）している可能性も考慮し、コールを選択します。オールイン（全額ベット）は、相手がより強いハンドを持っている場合にチップを失うリスクが高すぎるため、現時点では避けます。レイズ（ベット額をさらに増やすこと）も、相手のベット額から推測されるハンドの強さを考えると、リスクが高いです。"
}
```
2025-10-31 18:50:52,515 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:50:52,516 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 633,\n  "reasoning": "リバー（最終ストリート）で、あなたの手札は「Q♠ A♣」、コミュニティカードは「6♠ 9♣ 6♥ J♠ Q♥」です。あなたのハンドは、ツーペア（Qと6）で、Aのキッカー（ペアを構成しない最も強いカード）を持っています。対戦相手（Player 4）は、リバーで633をベットしてきました。これは、彼があなたよりも強いハンドを持っている可能性を示唆しています。しかし、あなたのツーペアは比較的強いハンドであり、ポットサイズ（1593 + 633 = 2226）に対してコール（相手のベット額と同額を支払うこと）する価値は十分にあります。彼がブラフ（虚張）している可能性も考慮し、コールを選択します。オールイン（全額ベット）は、相手がより強いハンドを持っている場合にチップを失うリスクが高すぎるため、現時点では避けます。レイズ（ベット額をさらに増やすこと）も、相手のベット額から推測されるハンドの強さを考えると、リスクが高いです。"\n}\n```'
2025-10-31 18:50:52,516 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:50:52,516 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 633,\n  "reasoning": "リバー（最終ストリート）で、あなたの手札は「Q♠ A♣」、コミュニティカードは「6♠ 9♣ 6♥ J♠ Q♥」です。あなたのハンドは、ツーペア（Qと6）で、Aのキッカー（ペアを構成しない最も強いカード）を持っています。対戦相手（Player 4）は、リバーで633をベットしてきました。これは、彼があなたよりも強いハンドを持っている可能性を示唆しています。しかし、あなたのツーペアは比較的強いハンドであり、ポットサイズ（1593 + 633 = 2226）に対してコール（相手のベット額と同額を支払うこと）する価値は十分にあります。彼がブラフ（虚張）している可能性も考慮し、コールを選択します。オールイン（全額ベット）は、相手がより強いハンドを持っている場合にチップを失うリスクが高すぎるため、現時点では避けます。レイズ（ベット額をさらに増やすこと）も、相手のベット額から推測されるハンドの強さを考えると、リスクが高いです。"\n}'
2025-10-31 18:50:52,516 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 633,
  "reasoning": "リバー（最終ストリート）で、あなたの手札は「Q♠ A♣」、コミュニティカードは「6♠ 9♣ 6♥ J♠ Q♥」です。あなたのハンドは、ツーペア（Qと6）で、Aのキッカー（ペアを構成しない最も強いカード）を持っています。対戦相手（Player 4）は、リバーで633をベットしてきました。これは、彼があなたよりも強いハンドを持っている可能性を示唆しています。しかし、あなたのツーペアは比較的強いハンドであり、ポットサイズ（1593 + 633 = 2226）に対してコール（相手のベット額と同額を支払うこと）する価値は十分にあります。彼がブラフ（虚張）している可能性も考慮し、コールを選択します。オールイン（全額ベット）は、相手がより強いハンドを持っている場合にチップを失うリスクが高すぎるため、現時点では避けます。レイズ（ベット額をさらに増やすこと）も、相手のベット額から推測されるハンドの強さを考えると、リスクが高いです。"
}
2025-10-31 18:50:52,517 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 633, 'reasoning': 'リバー（最終ストリート）で、あなたの手札は「Q♠ A♣」、コミュニティカードは「6♠ 9♣ 6♥ J♠ Q♥」です。あなたのハンドは、ツーペア（Qと6）で、Aのキッカー（ペアを構成しない最も強いカード）を持っています。対戦相手（Player 4）は、リバーで633をベットしてきました。これは、彼があなたよりも強いハンドを持っている可能性を示唆しています。しかし、あなたのツーペアは比較的強いハンドであり、ポットサイズ（1593 + 633 = 2226）に対してコール（相手のベット額と同額を支払うこと）する価値は十分にあります。彼がブラフ（虚張）している可能性も考慮し、コールを選択します。オールイン（全額ベット）は、相手がより強いハンドを持っている場合にチップを失うリスクが高すぎるため、現時点では避けます。レイズ（ベット額をさらに増やすこと）も、相手のベット額から推測されるハンドの強さを考えると、リスクが高いです。'}
2025-10-31 18:50:52,517 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 633
2025-10-31 18:50:52,517 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (633)', 'raise (min 653)', 'all-in (1485)']
2025-10-31 18:50:52,517 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (633)': 633
2025-10-31 18:50:52,517 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 633}
2025-10-31 18:50:52,518 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 633, リバー（最終ストリート）で、あなたの手札は「Q♠ A♣」、コミュニティカードは「6♠ 9♣ 6♥ J♠ Q♥」です。あなたのハンドは、ツーペア（Qと6）で、Aのキッカー（ペアを構成しない最も強いカード）を持っています。対戦相手（Player 4）は、リバーで633をベットしてきました。これは、彼があなたよりも強いハンドを持っている可能性を示唆しています。しかし、あなたのツーペアは比較的強いハンドであり、ポットサイズ（1593 + 633 = 2226）に対してコール（相手のベット額と同額を支払うこと）する価値は十分にあります。彼がブラフ（虚張）している可能性も考慮し、コールを選択します。オールイン（全額ベット）は、相手がより強いハンドを持っている場合にチップを失うリスクが高すぎるため、現時点では避けます。レイズ（ベット額をさらに増やすこと）も、相手のベット額から推測されるハンドの強さを考えると、リスクが高いです。
2025-10-31 18:50:52,519 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 633
2025-10-31 18:50:52,520 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:50:52,520 - poker_game - INFO - Hand #8, Phase: river
2025-10-31 18:50:52,521 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:50:52,521 - poker_game - INFO - Pot: 1593, Current bet: 633
2025-10-31 18:50:52,522 - poker_game - INFO - Last raiser: 4
2025-10-31 18:50:52,525 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:52,526 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:52,527 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:52,528 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:52,528 - poker_game - INFO -   P1(Agent1): chips=1485, bet=0, status=active
2025-10-31 18:50:52,528 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:52,529 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:52,529 - poker_game - INFO -   P4(Agent4): chips=5061, bet=633, status=active
2025-10-31 18:50:52,530 - poker_game - INFO - ==================================================
2025-10-31 18:50:52,530 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 633
2025-10-31 18:50:52,543 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:50:52,544 - poker_game - INFO - Hand #8, Phase: river
2025-10-31 18:50:52,544 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:50:52,544 - poker_game - INFO - Pot: 2226, Current bet: 633
2025-10-31 18:50:52,545 - poker_game - INFO - Last raiser: 4
2025-10-31 18:50:52,545 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:52,546 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:52,546 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:52,547 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:52,547 - poker_game - INFO -   P1(Agent1): chips=852, bet=633, status=active
2025-10-31 18:50:52,547 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:52,548 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:52,548 - poker_game - INFO -   P4(Agent4): chips=5061, bet=633, status=active
2025-10-31 18:50:52,549 - poker_game - INFO - Extra: Action: Player 1 called 633
2025-10-31 18:50:52,549 - poker_game - INFO - ==================================================
2025-10-31 18:50:52,550 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:50:52,550 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:50:52,551 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:50:52,551 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:50:52,552 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:50:52,552 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:50:52,552 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:50:52,553 - poker_game - DEBUG - Player bets: [633, 633], Current bet: 633, All same: True
2025-10-31 18:50:52,553 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:50:52,554 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:50:52,554 - poker_game - INFO - Hand #8, Phase: river
2025-10-31 18:50:52,554 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:52,555 - poker_game - INFO - Pot: 2226, Current bet: 633
2025-10-31 18:50:52,555 - poker_game - INFO - Last raiser: 4
2025-10-31 18:50:52,556 - poker_game - INFO - Betting round complete: True
2025-10-31 18:50:52,557 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:52,557 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:52,557 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:52,558 - poker_game - INFO -   P1(Agent1): chips=852, bet=633, status=active
2025-10-31 18:50:52,558 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:52,558 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:52,559 - poker_game - INFO -   P4(Agent4): chips=5061, bet=633, status=active
2025-10-31 18:50:52,559 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:50:52,559 - poker_game - INFO - ==================================================
2025-10-31 18:50:52,660 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:50:52,661 - poker_game - INFO - Betting round complete: True
2025-10-31 18:50:52,661 - poker_game - INFO - Remaining players: 2
2025-10-31 18:50:52,661 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:50:52,661 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:50:52,661 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:50:52,662 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:50:52,662 - poker_game - INFO - Hand #8, Phase: showdown
2025-10-31 18:50:52,663 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:50:52,663 - poker_game - INFO - Pot: 2226, Current bet: 633
2025-10-31 18:50:52,664 - poker_game - INFO - Last raiser: 4
2025-10-31 18:50:52,664 - poker_game - INFO - Betting round complete: True
2025-10-31 18:50:52,664 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:52,665 - poker_game - INFO - Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:52,665 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:52,666 - poker_game - INFO -   P1(Agent1): chips=852, bet=633, status=active
2025-10-31 18:50:52,666 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:52,666 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:52,666 - poker_game - INFO -   P4(Agent4): chips=5061, bet=633, status=active
2025-10-31 18:50:52,667 - poker_game - INFO - ==================================================
2025-10-31 18:50:52,667 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:50:52,668 - poker_game - INFO - Pot: 2226, Community cards: ['6♠', '9♣', '6♥', 'J♠', 'Q♥']
2025-10-31 18:50:52,668 - poker_game - INFO -   Player 1 status=active cards=['Q♠', 'A♣']
2025-10-31 18:50:52,668 - poker_game - INFO -   Player 4 status=active cards=['K♦', 'Q♦']
2025-10-31 18:50:52,671 - poker_game - INFO -   Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=['Q♠', 'A♣']
2025-10-31 18:50:52,671 - poker_game - INFO -   Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=['K♦', 'Q♦']
2025-10-31 18:50:52,672 - poker_game - INFO - Pot layer 0: amount=420, contributors=[1, 3, 4]
2025-10-31 18:50:52,672 - poker_game - INFO - Pot layer 1: amount=1806, contributors=[1, 4]
2025-10-31 18:50:52,673 - poker_game - INFO - Showdown total awarded: 2226 (game.pot=2226)
2025-10-31 18:50:52,673 - poker_game - INFO - Showdown winners (aggregated): [1]
2025-10-31 18:50:52,674 - poker_game - INFO -   Awarded 2226 to Player 1 (hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥)
2025-10-31 18:50:52,674 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:50:52,703 - poker_game - INFO - === STARTING NEW HAND #9 ===
2025-10-31 18:50:52,704 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:50:52,705 - poker_game - INFO - Moving dealer button
2025-10-31 18:50:52,705 - poker_game - INFO - Posting blinds
2025-10-31 18:50:52,729 - poker_game - INFO - Dealing hole cards
2025-10-31 18:50:52,729 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:50:52,739 - poker_game - INFO - Started new hand in database: hand_id=9
2025-10-31 18:50:52,740 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:50:52,741 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:50:52,741 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:50:52,741 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:50:52,742 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:52,742 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:52,743 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:52,743 - poker_game - INFO - Community cards: []
2025-10-31 18:50:52,744 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:52,744 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:50:52,745 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:52,746 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=active
2025-10-31 18:50:52,746 - poker_game - INFO -   P4(Agent4): chips=5051, bet=10, status=active
2025-10-31 18:50:52,747 - poker_game - INFO - ==================================================
2025-10-31 18:50:52,748 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "7♦",
    "5♣"
  ],
  "community": [],
  "your_chips": 1861,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3058,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5051,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1861)"
  ],
  "history": [
    "Flop dealt: 6♠, 9♣, 6♥",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥",
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 18:50:52,760 - poker_game - DEBUG - Create Session: {'id': '2c0fe400-316f-4ff7-9fbc-5ac3f37e4c88', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904252.756822}
2025-10-31 18:50:54,569 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後）で、私の手札は7♦5♣です。これは非常に弱い手札であり、フロップ（コミュニティカード）がまだ配られていない段階では、コール（同額を支払う）またはレイズ（さらにベット額を上げる）をする価値がありません。ポット（全プレイヤーが賭けたチップの合計）は30で、コールするには20必要です。しかし、この手札では勝つ可能性が低いため、フォールド（降りる）のが最善の選択です。他のプレイヤーがすでにベットしているので、これ以上チップを失うリスクを避けます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 166, 'promptTokenCount': 919, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 919}], 'totalTokenCount': 1085}, 'invocationId': 'e-e87b15d1-35ff-4261-b383-816ae108edf3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'aXY7D8as', 'timestamp': 1761904252.771913}]
2025-10-31 18:50:54,569 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:50:54,570 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後）で、私の手札は7♦5♣です。これは非常に弱い手札であり、フロップ（コミュニティカード）がまだ配られていない段階では、コール（同額を支払う）またはレイズ（さらにベット額を上げる）をする価値がありません。ポット（全プレイヤーが賭けたチップの合計）は30で、コールするには20必要です。しかし、この手札では勝つ可能性が低いため、フォールド（降りる）のが最善の選択です。他のプレイヤーがすでにベットしているので、これ以上チップを失うリスクを避けます。"
}
```
2025-10-31 18:50:54,570 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:50:54,570 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後）で、私の手札は7♦5♣です。これは非常に弱い手札であり、フロップ（コミュニティカード）がまだ配られていない段階では、コール（同額を支払う）またはレイズ（さらにベット額を上げる）をする価値がありません。ポット（全プレイヤーが賭けたチップの合計）は30で、コールするには20必要です。しかし、この手札では勝つ可能性が低いため、フォールド（降りる）のが最善の選択です。他のプレイヤーがすでにベットしているので、これ以上チップを失うリスクを避けます。"\n}\n```'
2025-10-31 18:50:54,570 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:50:54,571 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後）で、私の手札は7♦5♣です。これは非常に弱い手札であり、フロップ（コミュニティカード）がまだ配られていない段階では、コール（同額を支払う）またはレイズ（さらにベット額を上げる）をする価値がありません。ポット（全プレイヤーが賭けたチップの合計）は30で、コールするには20必要です。しかし、この手札では勝つ可能性が低いため、フォールド（降りる）のが最善の選択です。他のプレイヤーがすでにベットしているので、これ以上チップを失うリスクを避けます。"\n}'
2025-10-31 18:50:54,571 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後）で、私の手札は7♦5♣です。これは非常に弱い手札であり、フロップ（コミュニティカード）がまだ配られていない段階では、コール（同額を支払う）またはレイズ（さらにベット額を上げる）をする価値がありません。ポット（全プレイヤーが賭けたチップの合計）は30で、コールするには20必要です。しかし、この手札では勝つ可能性が低いため、フォールド（降りる）のが最善の選択です。他のプレイヤーがすでにベットしているので、これ以上チップを失うリスクを避けます。"
}
2025-10-31 18:50:54,571 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（最初のカードが配られた後）で、私の手札は7♦5♣です。これは非常に弱い手札であり、フロップ（コミュニティカード）がまだ配られていない段階では、コール（同額を支払う）またはレイズ（さらにベット額を上げる）をする価値がありません。ポット（全プレイヤーが賭けたチップの合計）は30で、コールするには20必要です。しかし、この手札では勝つ可能性が低いため、フォールド（降りる）のが最善の選択です。他のプレイヤーがすでにベットしているので、これ以上チップを失うリスクを避けます。'}
2025-10-31 18:50:54,571 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:50:54,571 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:50:54,571 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:50:54,571 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップ（最初のカードが配られた後）で、私の手札は7♦5♣です。これは非常に弱い手札であり、フロップ（コミュニティカード）がまだ配られていない段階では、コール（同額を支払う）またはレイズ（さらにベット額を上げる）をする価値がありません。ポット（全プレイヤーが賭けたチップの合計）は30で、コールするには20必要です。しかし、この手札では勝つ可能性が低いため、フォールド（降りる）のが最善の選択です。他のプレイヤーがすでにベットしているので、これ以上チップを失うリスクを避けます。
2025-10-31 18:50:54,572 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:50:54,573 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:50:54,573 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:50:54,573 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:50:54,573 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:50:54,574 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:54,574 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:54,574 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:50:54,575 - poker_game - INFO - Community cards: []
2025-10-31 18:50:54,575 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:54,576 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:50:54,578 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:54,578 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=active
2025-10-31 18:50:54,579 - poker_game - INFO -   P4(Agent4): chips=5051, bet=10, status=active
2025-10-31 18:50:54,579 - poker_game - INFO - ==================================================
2025-10-31 18:50:54,580 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:50:54,593 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:50:54,594 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:50:54,594 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:50:54,594 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:50:54,595 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:54,595 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:54,596 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:54,596 - poker_game - INFO - Community cards: []
2025-10-31 18:50:54,596 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:54,596 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:50:54,597 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:54,597 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:54,598 - poker_game - INFO -   P4(Agent4): chips=5051, bet=10, status=active
2025-10-31 18:50:54,598 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:50:54,598 - poker_game - INFO - ==================================================
2025-10-31 18:50:54,599 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:50:54,600 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:50:54,601 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:50:54,602 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:50:54,602 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:50:54,603 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:50:54,604 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:50:54,604 - poker_game - DEBUG - Player bets: [20, 10], Current bet: 20, All same: False
2025-10-31 18:50:54,604 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:50:54,605 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:50:54,605 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:50:54,605 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:50:54,606 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:50:54,606 - poker_game - INFO - Last raiser: 1
2025-10-31 18:50:54,607 - poker_game - INFO - Betting round complete: False
2025-10-31 18:50:54,607 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:50:54,608 - poker_game - INFO - Community cards: []
2025-10-31 18:50:54,608 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:50:54,608 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:50:54,609 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:50:54,609 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:50:54,609 - poker_game - INFO -   P4(Agent4): chips=5051, bet=10, status=active
2025-10-31 18:50:54,610 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:50:54,610 - poker_game - INFO - ==================================================
2025-10-31 18:50:54,711 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "Q♠",
    "4♦"
  ],
  "community": [],
  "your_chips": 5051,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3058,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1861,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (5051)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥",
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded"
  ]
}
2025-10-31 18:50:54,755 - poker_game - DEBUG - Create Session: {'id': 'd290426c-6c4b-47de-a0e6-08f5fbb26d82', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904254.7520838}
2025-10-31 18:51:04,838 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:51:10,865 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_UwfEQCkZOfqupCZJPr1NXm3b', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1230, 'totalTokenCount': 1247}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ObIxc7IJ', 'timestamp': 1761904254.768678}, {'content': {'parts': [{'functionResponse': {'id': 'call_UwfEQCkZOfqupCZJPr1NXm3b', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Lc5meEeR', 'timestamp': 1761904256.104708}, {'content': {'parts': [{'functionCall': {'id': 'call_NfKwXX9Z8PaKhRoeiqVJPSRI', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1754, 'totalTokenCount': 1774}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'rYHpBljq', 'timestamp': 1761904256.106166}, {'content': {'parts': [{'functionResponse': {'id': 'call_NfKwXX9Z8PaKhRoeiqVJPSRI', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'MxcvaUuv', 'timestamp': 1761904257.567693}, {'content': {'parts': [{'functionCall': {'id': 'call_R4Z3hjpHt9NmHpbhxh1fDl7Q', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1316, 'totalTokenCount': 1333}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '7nsyxnbO', 'timestamp': 1761904257.570731}, {'content': {'parts': [{'functionResponse': {'id': 'call_R4Z3hjpHt9NmHpbhxh1fDl7Q', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '6OTRu9cL', 'timestamp': 1761904258.553525}, {'content': {'parts': [{'functionCall': {'id': 'call_JoLdpsVh0IEEvN3DBzBjqR3T', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['Q♠', '4♦'], 'community': [], 'your_chips': 5051, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3058, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1861, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (5051)'], 'history': ['Player 3 checked', 'Player 4 raised to 30', 'Player 1 called 30', 'Player 3 called 30', 'Turn dealt: J♠', 'Player 3 raised to 90', 'Player 4 called 90', 'Player 1 raised to 360', 'Player 3 folded', 'Player 4 called 270', 'River dealt: Q♥', 'Player 4 raised to 633', 'Player 1 called 633', 'Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣', 'Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦', 'Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 478, 'promptTokenCount': 1846, 'totalTokenCount': 2324}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'UPcTSJA6', 'timestamp': 1761904258.555428}, {'content': {'parts': [{'functionResponse': {'id': 'call_JoLdpsVh0IEEvN3DBzBjqR3T', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10'}}}], 'role': 'user'}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'VOANLSdE', 'timestamp': 1761904268.901549}, {'content': {'parts': [{'text': '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2375, 'totalTokenCount': 2429}, 'invocationId': 'e-d6cc8ae0-5e2b-40c3-82b4-805875f7ea0a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'LeaIsEcw', 'timestamp': 1761904268.903694}]
2025-10-31 18:51:10,866 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:51:10,866 - poker_game - DEBUG - {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10"}
2025-10-31 18:51:10,867 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:51:10,868 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10"}'
2025-10-31 18:51:10,868 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:51:10,868 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10"}
2025-10-31 18:51:10,868 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10'}
2025-10-31 18:51:10,868 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 10
2025-10-31 18:51:10,869 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (5051)']
2025-10-31 18:51:10,869 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (10)': 10
2025-10-31 18:51:10,869 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:51:10,869 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 10, ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10
2025-10-31 18:51:10,870 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 10
2025-10-31 18:51:10,871 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:10,871 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:51:10,871 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:10,871 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:51:10,872 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:10,872 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:10,872 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:10,873 - poker_game - INFO - Community cards: []
2025-10-31 18:51:10,873 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:10,874 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:51:10,874 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:10,874 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:10,875 - poker_game - INFO -   P4(Agent4): chips=5051, bet=10, status=active
2025-10-31 18:51:10,875 - poker_game - INFO - ==================================================
2025-10-31 18:51:10,875 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 10
2025-10-31 18:51:10,887 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:10,888 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:51:10,888 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:10,889 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:51:10,889 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:10,889 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:10,890 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:10,890 - poker_game - INFO - Community cards: []
2025-10-31 18:51:10,891 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:10,891 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:51:10,892 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:10,892 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:10,893 - poker_game - INFO -   P4(Agent4): chips=5041, bet=20, status=active
2025-10-31 18:51:10,893 - poker_game - INFO - Extra: Action: Player 4 called 10
2025-10-31 18:51:10,894 - poker_game - INFO - ==================================================
2025-10-31 18:51:10,894 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:10,894 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:10,895 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:51:10,895 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:51:10,895 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:10,895 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:10,895 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:51:10,896 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:51:10,896 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:51:10,896 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:51:10,896 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:51:10,896 - poker_game - DEBUG - Next after last raiser 1: 4
2025-10-31 18:51:10,897 - poker_game - DEBUG - Betting continues: Current player 1 != next after raiser 4
2025-10-31 18:51:10,897 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:10,897 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:51:10,897 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:10,898 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:51:10,898 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:10,898 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:10,899 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:10,899 - poker_game - INFO - Community cards: []
2025-10-31 18:51:10,899 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:10,900 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:51:10,900 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:10,900 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:10,901 - poker_game - INFO -   P4(Agent4): chips=5041, bet=20, status=active
2025-10-31 18:51:10,901 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:51:10,901 - poker_game - INFO - ==================================================
2025-10-31 18:51:11,003 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "5♥",
    "6♦"
  ],
  "community": [],
  "your_chips": 3058,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1861,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5041,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (3058)"
  ],
  "history": [
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥",
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10"
  ]
}
2025-10-31 18:51:11,012 - poker_game - DEBUG - Create Session: {'id': '97626690-78da-487b-a89f-02ec9200e570', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904271.0097387}
2025-10-31 18:51:13,017 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、私の手札は5♥6♦です。これは「スーテッドコネクター」（同じスーツで数字が連続しているカード）ですが、強い手札ではありません。ポットには40、私のベットは20、コールするには20必要です。相手（Player 4）はすでに20ベットしており、コールはポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いので、コールしてフロップを見ます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 128, 'promptTokenCount': 908, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 908}], 'totalTokenCount': 1036}, 'invocationId': 'e-74144bf9-2a53-4688-b445-a295bfbd93b0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ovkEzzVo', 'timestamp': 1761904271.021181}]
2025-10-31 18:51:13,018 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:51:13,018 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで、私の手札は5♥6♦です。これは「スーテッドコネクター」（同じスーツで数字が連続しているカード）ですが、強い手札ではありません。ポットには40、私のベットは20、コールするには20必要です。相手（Player 4）はすでに20ベットしており、コールはポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いので、コールしてフロップを見ます。"
}
```
2025-10-31 18:51:13,019 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:51:13,019 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、私の手札は5♥6♦です。これは「スーテッドコネクター」（同じスーツで数字が連続しているカード）ですが、強い手札ではありません。ポットには40、私のベットは20、コールするには20必要です。相手（Player 4）はすでに20ベットしており、コールはポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いので、コールしてフロップを見ます。"\n}\n```'
2025-10-31 18:51:13,019 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:51:13,019 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップで、私の手札は5♥6♦です。これは「スーテッドコネクター」（同じスーツで数字が連続しているカード）ですが、強い手札ではありません。ポットには40、私のベットは20、コールするには20必要です。相手（Player 4）はすでに20ベットしており、コールはポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いので、コールしてフロップを見ます。"\n}'
2025-10-31 18:51:13,019 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップで、私の手札は5♥6♦です。これは「スーテッドコネクター」（同じスーツで数字が連続しているカード）ですが、強い手札ではありません。ポットには40、私のベットは20、コールするには20必要です。相手（Player 4）はすでに20ベットしており、コールはポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いので、コールしてフロップを見ます。"
}
2025-10-31 18:51:13,019 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップで、私の手札は5♥6♦です。これは「スーテッドコネクター」（同じスーツで数字が連続しているカード）ですが、強い手札ではありません。ポットには40、私のベットは20、コールするには20必要です。相手（Player 4）はすでに20ベットしており、コールはポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いので、コールしてフロップを見ます。'}
2025-10-31 18:51:13,020 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 20
2025-10-31 18:51:13,020 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (3058)']
2025-10-31 18:51:13,020 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:51:13,020 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 20, プリフロップで、私の手札は5♥6♦です。これは「スーテッドコネクター」（同じスーツで数字が連続しているカード）ですが、強い手札ではありません。ポットには40、私のベットは20、コールするには20必要です。相手（Player 4）はすでに20ベットしており、コールはポットオッズ（ポットのサイズに対してコールに必要な金額の比率）が良いので、コールしてフロップを見ます。
2025-10-31 18:51:13,021 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 20
2025-10-31 18:51:13,021 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:13,022 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:51:13,022 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:13,022 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:51:13,022 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:13,023 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:13,023 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:13,023 - poker_game - INFO - Community cards: []
2025-10-31 18:51:13,023 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:13,024 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:51:13,024 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:13,024 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:13,024 - poker_game - INFO -   P4(Agent4): chips=5041, bet=20, status=active
2025-10-31 18:51:13,024 - poker_game - INFO - ==================================================
2025-10-31 18:51:13,025 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:51:13,035 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:13,036 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:51:13,037 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:13,037 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:51:13,037 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:13,038 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:13,038 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:13,039 - poker_game - INFO - Community cards: []
2025-10-31 18:51:13,039 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:13,039 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:51:13,040 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:13,040 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:13,040 - poker_game - INFO -   P4(Agent4): chips=5041, bet=20, status=active
2025-10-31 18:51:13,041 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:51:13,041 - poker_game - INFO - ==================================================
2025-10-31 18:51:13,042 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:13,042 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:13,042 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:51:13,042 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:51:13,043 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:13,043 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:13,043 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:51:13,043 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:51:13,044 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:51:13,044 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:51:13,044 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:51:13,044 - poker_game - DEBUG - Next after last raiser 1: 4
2025-10-31 18:51:13,044 - poker_game - INFO - Betting complete: Back to player 4 after last raiser 1
2025-10-31 18:51:13,045 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:13,045 - poker_game - INFO - Hand #9, Phase: preflop
2025-10-31 18:51:13,046 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:13,046 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:51:13,046 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:13,047 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:13,048 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:13,049 - poker_game - INFO - Community cards: []
2025-10-31 18:51:13,049 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:13,050 - poker_game - INFO -   P1(Agent1): chips=3058, bet=20, status=active
2025-10-31 18:51:13,051 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:13,051 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:13,052 - poker_game - INFO -   P4(Agent4): chips=5041, bet=20, status=active
2025-10-31 18:51:13,052 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:51:13,052 - poker_game - INFO - ==================================================
2025-10-31 18:51:13,155 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:51:13,155 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:13,156 - poker_game - INFO - Remaining players: 2
2025-10-31 18:51:13,156 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:51:13,156 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:51:13,156 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:51:13,166 - poker_game - INFO - Starting new betting round
2025-10-31 18:51:13,167 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:51:13,167 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:51:13,167 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:51:13,168 - poker_game - DEBUG - Dealer button: 3
2025-10-31 18:51:13,168 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 18:51:13,168 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:51:13,169 - poker_game - INFO - Hand #9, Phase: flop
2025-10-31 18:51:13,169 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:13,169 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:13,170 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:13,170 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:13,171 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:13,171 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠']
2025-10-31 18:51:13,172 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:13,173 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:13,173 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:13,174 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:13,174 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:13,175 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:51:13,175 - poker_game - INFO - ==================================================
2025-10-31 18:51:13,176 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "Q♠",
    "4♦"
  ],
  "community": [
    "A♠",
    "5♠",
    "7♠"
  ],
  "your_chips": 5041,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3058,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1861,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5041)"
  ],
  "history": [
    "Player 3 called 30",
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥",
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠"
  ]
}
2025-10-31 18:51:13,190 - poker_game - DEBUG - Create Session: {'id': '998fdf2c-47a7-487a-b007-80a770a50ee9', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904273.1872377}
2025-10-31 18:51:15,068 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_YG77pZvGrR3daokJjtMRf1nk', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1257, 'totalTokenCount': 1274}, 'invocationId': 'e-f8a777e8-5547-45da-a8dd-ba58efaeb095', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'kUhbWDhq', 'timestamp': 1761904273.201739}, {'content': {'parts': [{'functionResponse': {'id': 'call_YG77pZvGrR3daokJjtMRf1nk', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f8a777e8-5547-45da-a8dd-ba58efaeb095', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'sxlyCinR', 'timestamp': 1761904271.415134}, {'content': {'parts': [{'functionCall': {'id': 'call_a4XzKuFmU6S0c4LbTVCqW2ni', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1781, 'totalTokenCount': 1801}, 'invocationId': 'e-f8a777e8-5547-45da-a8dd-ba58efaeb095', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Q4MarlRM', 'timestamp': 1761904271.416828}, {'content': {'parts': [{'functionResponse': {'id': 'call_a4XzKuFmU6S0c4LbTVCqW2ni', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f8a777e8-5547-45da-a8dd-ba58efaeb095', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'PH3AvkYk', 'timestamp': 1761904272.784733}, {'content': {'parts': [{'text': '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップで8♠が出ているため、スチールする必要がなく、相手の行動やカードを待ちます。私の手札は弱く、他にリスクを取る理由もないため、チェックします。"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 80, 'promptTokenCount': 1343, 'totalTokenCount': 1423}, 'invocationId': 'e-f8a777e8-5547-45da-a8dd-ba58efaeb095', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'wKUf7zw4', 'timestamp': 1761904272.786507}]
2025-10-31 18:51:15,068 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:51:15,068 - poker_game - DEBUG - {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップで8♠が出ているため、スチールする必要がなく、相手の行動やカードを待ちます。私の手札は弱く、他にリスクを取る理由もないため、チェックします。"
}
2025-10-31 18:51:15,068 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:51:15,069 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップで8♠が出ているため、スチールする必要がなく、相手の行動やカードを待ちます。私の手札は弱く、他にリスクを取る理由もないため、チェックします。"\n}'
2025-10-31 18:51:15,069 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:51:15,069 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップで8♠が出ているため、スチールする必要がなく、相手の行動やカードを待ちます。私の手札は弱く、他にリスクを取る理由もないため、チェックします。"
}
2025-10-31 18:51:15,069 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップで8♠が出ているため、スチールする必要がなく、相手の行動やカードを待ちます。私の手札は弱く、他にリスクを取る理由もないため、チェックします。'}
2025-10-31 18:51:15,069 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:51:15,069 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:51:15,069 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:51:15,069 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, フロップで8♠が出ているため、スチールする必要がなく、相手の行動やカードを待ちます。私の手札は弱く、他にリスクを取る理由もないため、チェックします。
2025-10-31 18:51:15,070 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:51:15,070 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:15,071 - poker_game - INFO - Hand #9, Phase: flop
2025-10-31 18:51:15,071 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:15,071 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:15,071 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:15,071 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:15,071 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:15,072 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠']
2025-10-31 18:51:15,072 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:15,072 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:15,072 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:15,072 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:15,072 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:15,072 - poker_game - INFO - ==================================================
2025-10-31 18:51:15,073 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:51:15,086 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:15,087 - poker_game - INFO - Hand #9, Phase: flop
2025-10-31 18:51:15,087 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:15,087 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:15,087 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:15,087 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:15,088 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:15,088 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠']
2025-10-31 18:51:15,088 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:15,088 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:15,088 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:15,089 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:15,089 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:15,089 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:51:15,089 - poker_game - INFO - ==================================================
2025-10-31 18:51:15,089 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:15,090 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:15,090 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:51:15,090 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:51:15,090 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:15,090 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:15,090 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:51:15,090 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:51:15,090 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:51:15,090 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:51:15,091 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:51:15,091 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:51:15,091 - poker_game - DEBUG - Betting continues: Current player 1 != first actor 4
2025-10-31 18:51:15,091 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:15,091 - poker_game - INFO - Hand #9, Phase: flop
2025-10-31 18:51:15,091 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:15,091 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:15,091 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:15,092 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:15,092 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:15,092 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠']
2025-10-31 18:51:15,092 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:15,093 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:15,093 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:15,093 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:15,093 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:15,094 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:51:15,094 - poker_game - INFO - ==================================================
2025-10-31 18:51:15,197 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "5♥",
    "6♦"
  ],
  "community": [
    "A♠",
    "5♠",
    "7♠"
  ],
  "your_chips": 3058,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1861,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5041,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3058)"
  ],
  "history": [
    "Turn dealt: J♠",
    "Player 3 raised to 90",
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥",
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked"
  ]
}
2025-10-31 18:51:15,205 - poker_game - DEBUG - Create Session: {'id': '1e5538e5-c5b9-4fba-aef7-1634e08303c2', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904275.203117}
2025-10-31 18:51:17,126 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップには「A♠, 5♠, 7♠」があり、フラッシュのドロー（同じスートのカードが3枚揃っている状態）の可能性が高いボードです。私の手札は「5♥, 6♦」なので、ワンペア（同じ数字のカードが2枚揃っている状態）は持っていますが、フラッシュのドローはありません。相手（プレイヤー4）はチェックをしたので、こちらもチェックをして、次のカード（ターン）を見るのが最善です。コールする必要はありません。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 141, 'promptTokenCount': 926, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 926}], 'totalTokenCount': 1067}, 'invocationId': 'e-f25d3903-4558-4977-adfc-3d31eb04739e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'loWkaCMe', 'timestamp': 1761904275.214955}]
2025-10-31 18:51:17,127 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:51:17,127 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "フロップには「A♠, 5♠, 7♠」があり、フラッシュのドロー（同じスートのカードが3枚揃っている状態）の可能性が高いボードです。私の手札は「5♥, 6♦」なので、ワンペア（同じ数字のカードが2枚揃っている状態）は持っていますが、フラッシュのドローはありません。相手（プレイヤー4）はチェックをしたので、こちらもチェックをして、次のカード（ターン）を見るのが最善です。コールする必要はありません。"
}
```
2025-10-31 18:51:17,127 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:51:17,127 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップには「A♠, 5♠, 7♠」があり、フラッシュのドロー（同じスートのカードが3枚揃っている状態）の可能性が高いボードです。私の手札は「5♥, 6♦」なので、ワンペア（同じ数字のカードが2枚揃っている状態）は持っていますが、フラッシュのドローはありません。相手（プレイヤー4）はチェックをしたので、こちらもチェックをして、次のカード（ターン）を見るのが最善です。コールする必要はありません。"\n}\n```'
2025-10-31 18:51:17,127 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:51:17,127 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップには「A♠, 5♠, 7♠」があり、フラッシュのドロー（同じスートのカードが3枚揃っている状態）の可能性が高いボードです。私の手札は「5♥, 6♦」なので、ワンペア（同じ数字のカードが2枚揃っている状態）は持っていますが、フラッシュのドローはありません。相手（プレイヤー4）はチェックをしたので、こちらもチェックをして、次のカード（ターン）を見るのが最善です。コールする必要はありません。"\n}'
2025-10-31 18:51:17,128 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "フロップには「A♠, 5♠, 7♠」があり、フラッシュのドロー（同じスートのカードが3枚揃っている状態）の可能性が高いボードです。私の手札は「5♥, 6♦」なので、ワンペア（同じ数字のカードが2枚揃っている状態）は持っていますが、フラッシュのドローはありません。相手（プレイヤー4）はチェックをしたので、こちらもチェックをして、次のカード（ターン）を見るのが最善です。コールする必要はありません。"
}
2025-10-31 18:51:17,128 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': 'フロップには「A♠, 5♠, 7♠」があり、フラッシュのドロー（同じスートのカードが3枚揃っている状態）の可能性が高いボードです。私の手札は「5♥, 6♦」なので、ワンペア（同じ数字のカードが2枚揃っている状態）は持っていますが、フラッシュのドローはありません。相手（プレイヤー4）はチェックをしたので、こちらもチェックをして、次のカード（ターン）を見るのが最善です。コールする必要はありません。'}
2025-10-31 18:51:17,128 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 0
2025-10-31 18:51:17,128 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (3058)']
2025-10-31 18:51:17,128 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:51:17,128 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 0, フロップには「A♠, 5♠, 7♠」があり、フラッシュのドロー（同じスートのカードが3枚揃っている状態）の可能性が高いボードです。私の手札は「5♥, 6♦」なので、ワンペア（同じ数字のカードが2枚揃っている状態）は持っていますが、フラッシュのドローはありません。相手（プレイヤー4）はチェックをしたので、こちらもチェックをして、次のカード（ターン）を見るのが最善です。コールする必要はありません。
2025-10-31 18:51:17,129 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 0
2025-10-31 18:51:17,130 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:17,130 - poker_game - INFO - Hand #9, Phase: flop
2025-10-31 18:51:17,130 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:17,130 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:17,131 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:17,131 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:17,131 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:17,131 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠']
2025-10-31 18:51:17,132 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:17,132 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:17,132 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:17,132 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:17,133 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:17,133 - poker_game - INFO - ==================================================
2025-10-31 18:51:17,133 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:51:17,166 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:17,166 - poker_game - INFO - Hand #9, Phase: flop
2025-10-31 18:51:17,166 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:17,167 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:17,167 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:17,167 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:17,167 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:17,168 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠']
2025-10-31 18:51:17,168 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:17,168 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:17,169 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:17,169 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:17,169 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:17,169 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:51:17,169 - poker_game - INFO - ==================================================
2025-10-31 18:51:17,170 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:17,170 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:17,170 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:51:17,170 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:51:17,171 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:17,171 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:17,171 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:51:17,171 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:51:17,172 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:51:17,172 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:51:17,172 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:51:17,172 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:51:17,172 - poker_game - INFO - Betting complete: Back to first actor 4 (all players have acted)
2025-10-31 18:51:17,172 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:17,173 - poker_game - INFO - Hand #9, Phase: flop
2025-10-31 18:51:17,173 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:17,173 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:17,174 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:17,174 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:17,174 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:17,175 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠']
2025-10-31 18:51:17,175 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:17,175 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:17,176 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:17,176 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:17,176 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:17,177 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:51:17,177 - poker_game - INFO - ==================================================
2025-10-31 18:51:17,278 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:51:17,279 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:17,279 - poker_game - INFO - Remaining players: 2
2025-10-31 18:51:17,280 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:51:17,280 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:51:17,280 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:51:17,292 - poker_game - INFO - Starting new betting round
2025-10-31 18:51:17,293 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:51:17,294 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:51:17,294 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:51:17,294 - poker_game - DEBUG - Dealer button: 3
2025-10-31 18:51:17,294 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 18:51:17,295 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:51:17,295 - poker_game - INFO - Hand #9, Phase: turn
2025-10-31 18:51:17,295 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:17,296 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:17,296 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:17,296 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:17,296 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:17,297 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠', '10♠']
2025-10-31 18:51:17,299 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:17,300 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:17,300 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:17,300 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:17,301 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:17,301 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:51:17,301 - poker_game - INFO - ==================================================
2025-10-31 18:51:17,302 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "Q♠",
    "4♦"
  ],
  "community": [
    "A♠",
    "5♠",
    "7♠",
    "10♠"
  ],
  "your_chips": 5041,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3058,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1861,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5041)"
  ],
  "history": [
    "Player 4 called 90",
    "Player 1 raised to 360",
    "Player 3 folded",
    "Player 4 called 270",
    "River dealt: Q♥",
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠"
  ]
}
2025-10-31 18:51:17,333 - poker_game - DEBUG - Create Session: {'id': 'da5871bf-a6f1-4a0a-b70f-e6f4f038b919', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904277.3290784}
2025-10-31 18:51:22,263 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_OKnY2RntZY7YkMj7F3uRuoXK', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1258, 'totalTokenCount': 1275}, 'invocationId': 'e-2153add8-3d3c-475d-87af-b57a7f7a6e9b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '2lgflKku', 'timestamp': 1761904277.348615}, {'content': {'parts': [{'functionResponse': {'id': 'call_OKnY2RntZY7YkMj7F3uRuoXK', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-2153add8-3d3c-475d-87af-b57a7f7a6e9b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'FIIVBsxW', 'timestamp': 1761904278.160383}, {'content': {'parts': [{'functionCall': {'id': 'call_mZqtoUIvfmSzqEDdRAwt3A5g', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1782, 'totalTokenCount': 1802}, 'invocationId': 'e-2153add8-3d3c-475d-87af-b57a7f7a6e9b', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'HhtUAzjl', 'timestamp': 1761904278.163488}, {'content': {'parts': [{'functionResponse': {'id': 'call_mZqtoUIvfmSzqEDdRAwt3A5g', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-2153add8-3d3c-475d-87af-b57a7f7a6e9b', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'gf5dH3II', 'timestamp': 1761904279.723118}, {'content': {'parts': [{'text': '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "現在の手札はQ♠と4♦であり、コミュニティカードはすべてスペードで、完成されたフラッシュが可能です。しかし、対戦相手の行動から強い手が想定され、直接対抗する手段がないためフォールドします。"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 90, 'promptTokenCount': 1344, 'totalTokenCount': 1434}, 'invocationId': 'e-2153add8-3d3c-475d-87af-b57a7f7a6e9b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'pA8KljbK', 'timestamp': 1761904279.724492}]
2025-10-31 18:51:22,263 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:51:22,263 - poker_game - DEBUG - {
  "action": "fold",
  "amount": 0,
  "reasoning": "現在の手札はQ♠と4♦であり、コミュニティカードはすべてスペードで、完成されたフラッシュが可能です。しかし、対戦相手の行動から強い手が想定され、直接対抗する手段がないためフォールドします。"
}
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "現在の手札はQ♠と4♦であり、コミュニティカードはすべてスペードで、完成されたフラッシュが可能です。しかし、対戦相手の行動から強い手が想定され、直接対抗する手段がないためフォールドします。"\n}'
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "現在の手札はQ♠と4♦であり、コミュニティカードはすべてスペードで、完成されたフラッシュが可能です。しかし、対戦相手の行動から強い手が想定され、直接対抗する手段がないためフォールドします。"
}
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '現在の手札はQ♠と4♦であり、コミュニティカードはすべてスペードで、完成されたフラッシュが可能です。しかし、対戦相手の行動から強い手が想定され、直接対抗する手段がないためフォールドします。'}
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:51:22,264 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:51:22,264 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 現在の手札はQ♠と4♦であり、コミュニティカードはすべてスペードで、完成されたフラッシュが可能です。しかし、対戦相手の行動から強い手が想定され、直接対抗する手段がないためフォールドします。
2025-10-31 18:51:22,265 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:51:22,265 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:22,265 - poker_game - INFO - Hand #9, Phase: turn
2025-10-31 18:51:22,265 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:22,265 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:22,266 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:22,266 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:22,266 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:22,266 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠', '10♠']
2025-10-31 18:51:22,266 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:22,266 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:22,266 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:22,266 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:22,267 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:22,267 - poker_game - INFO - ==================================================
2025-10-31 18:51:22,267 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:51:22,286 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:22,287 - poker_game - INFO - Hand #9, Phase: turn
2025-10-31 18:51:22,287 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:51:22,287 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:22,287 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:22,287 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:22,288 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:51:22,288 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠', '10♠']
2025-10-31 18:51:22,288 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:22,288 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:22,288 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:22,288 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:22,289 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=folded
2025-10-31 18:51:22,289 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:51:22,289 - poker_game - INFO - ==================================================
2025-10-31 18:51:22,289 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:22,289 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:22,289 - poker_game - DEBUG - Active players: [1]
2025-10-31 18:51:22,289 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:51:22,290 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:22,290 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:22,290 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:51:22,290 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:51:22,290 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:22,290 - poker_game - INFO - Hand #9, Phase: turn
2025-10-31 18:51:22,291 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:22,291 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:22,291 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:22,291 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:22,292 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:51:22,292 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠', '10♠']
2025-10-31 18:51:22,292 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:22,292 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:22,292 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:22,293 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:22,293 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=folded
2025-10-31 18:51:22,293 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:51:22,293 - poker_game - INFO - ==================================================
2025-10-31 18:51:22,394 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:51:22,395 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:22,395 - poker_game - INFO - Remaining players: 1
2025-10-31 18:51:22,395 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:51:22,395 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:51:22,396 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:51:22,396 - poker_game - INFO - Hand #9, Phase: showdown
2025-10-31 18:51:22,396 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:51:22,396 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:51:22,397 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:22,397 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:22,397 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:51:22,397 - poker_game - INFO - Community cards: ['A♠', '5♠', '7♠', '10♠']
2025-10-31 18:51:22,398 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:22,398 - poker_game - INFO -   P1(Agent1): chips=3058, bet=0, status=active
2025-10-31 18:51:22,398 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:22,398 - poker_game - INFO -   P3(Agent3): chips=1861, bet=0, status=folded
2025-10-31 18:51:22,399 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=folded
2025-10-31 18:51:22,399 - poker_game - INFO - ==================================================
2025-10-31 18:51:22,399 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:51:22,399 - poker_game - INFO - Pot: 40, Community cards: ['A♠', '5♠', '7♠', '10♠']
2025-10-31 18:51:22,400 - poker_game - INFO -   Player 1 status=active cards=['5♥', '6♦']
2025-10-31 18:51:22,400 - poker_game - INFO - Showdown winner by default: Player 1 awarded 40
2025-10-31 18:51:22,400 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:51:22,401 - poker_game - INFO - === STARTING NEW HAND #10 ===
2025-10-31 18:51:22,401 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:51:22,401 - poker_game - INFO - Moving dealer button
2025-10-31 18:51:22,402 - poker_game - INFO - Posting blinds
2025-10-31 18:51:22,420 - poker_game - INFO - Dealing hole cards
2025-10-31 18:51:22,421 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:51:22,431 - poker_game - INFO - Started new hand in database: hand_id=10
2025-10-31 18:51:22,431 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:51:22,432 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:22,432 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:51:22,432 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:51:22,433 - poker_game - INFO - Last raiser: 3
2025-10-31 18:51:22,433 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:22,433 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:22,434 - poker_game - INFO - Community cards: []
2025-10-31 18:51:22,434 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:22,434 - poker_game - INFO -   P1(Agent1): chips=3088, bet=10, status=active
2025-10-31 18:51:22,435 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:22,435 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:22,435 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:22,436 - poker_game - INFO - ==================================================
2025-10-31 18:51:22,436 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "6♦",
    "6♣"
  ],
  "community": [],
  "your_chips": 5041,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3088,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1841,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (5041)"
  ],
  "history": [
    "River dealt: Q♥",
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 18:51:22,448 - poker_game - DEBUG - Create Session: {'id': 'b190118a-9e4d-414b-9891-165614e93c7d', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904282.4439232}
2025-10-31 18:51:32,626 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:51:43,139 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 18:51:39,356 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_QtmJv6qcRg0jXQeOOwT9pLoV', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1241, 'totalTokenCount': 1258}, 'invocationId': 'e-78bd038d-612a-437e-902e-868b40c3c43e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'N7sigjmU', 'timestamp': 1761904282.459591}, {'content': {'parts': [{'functionResponse': {'id': 'call_QtmJv6qcRg0jXQeOOwT9pLoV', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-78bd038d-612a-437e-902e-868b40c3c43e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'nSBHkf6N', 'timestamp': 1761904283.416395}, {'content': {'parts': [{'functionCall': {'id': 'call_19MnoedCs9jm1B1ouKa38YTF', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['6♦', '6♣'], 'community': [], 'your_chips': 5041, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3088, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 1841, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (5041)'], 'history': ['River dealt: Q♥', 'Player 4 raised to 633', 'Player 1 called 633', 'Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣', 'Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦', 'Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 checked', 'Flop dealt: A♠, 5♠, 7♠', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 10♠', 'Player 4 folded', 'Showdown: Player 1 won 40', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.5}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_qegIZjcX0PJ2GFOT5XO983gj', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['6♦', '6♣'], 'community': [], 'your_chips': 5041, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3088, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 1841, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (5041)'], 'history': ['River dealt: Q♥', 'Player 4 raised to 633', 'Player 1 called 633', 'Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣', 'Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦', 'Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 checked', 'Flop dealt: A♠, 5♠, 7♠', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 10♠', 'Player 4 folded', 'Showdown: Player 1 won 40', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 962, 'promptTokenCount': 1765, 'totalTokenCount': 2727}, 'invocationId': 'e-78bd038d-612a-437e-902e-868b40c3c43e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'PWnMTQoD', 'timestamp': 1761904283.418666}, {'content': {'parts': [{'functionResponse': {'id': 'call_19MnoedCs9jm1B1ouKa38YTF', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 20, 'reasoning': 'ポットオッズを満たしており（15.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 20'}}}, {'functionResponse': {'id': 'call_qegIZjcX0PJ2GFOT5XO983gj', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 20, 'reasoning': 'ポットオッズを満たしており（15.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 20'}}}], 'role': 'user'}, 'invocationId': '52V5t7YI', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'iRwkGEFG', 'timestamp': 1761904299.97602}, {'content': {'parts': [{'text': '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "ポットを満たしており(15.00(ポットに対して50.00%)、コールが妥当と判断。コール額: 20"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 62, 'promptTokenCount': 3035, 'totalTokenCount': 3097}, 'invocationId': 'e-78bd038d-612a-437e-902e-868b40c3c43e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '0gOPBleU', 'timestamp': 1761904299.978633}]
2025-10-31 18:51:39,357 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:51:39,357 - poker_game - DEBUG - {
  "action": "call",
  "amount": 20,
  "reasoning": "ポットを満たしており(15.00(ポットに対して50.00%)、コールが妥当と判断。コール額: 20"
}
2025-10-31 18:51:39,359 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:51:39,359 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "ポットを満たしており(15.00(ポットに対して50.00%)、コールが妥当と判断。コール額: 20"\n}'
2025-10-31 18:51:39,359 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:51:39,360 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "ポットを満たしており(15.00(ポットに対して50.00%)、コールが妥当と判断。コール額: 20"
}
2025-10-31 18:51:39,360 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'ポットを満たしており(15.00(ポットに対して50.00%)、コールが妥当と判断。コール額: 20'}
2025-10-31 18:51:39,360 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 20
2025-10-31 18:51:39,360 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (5041)']
2025-10-31 18:51:39,360 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (20)': 20
2025-10-31 18:51:39,361 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:51:39,361 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 20, ポットを満たしており(15.00(ポットに対して50.00%)、コールが妥当と判断。コール額: 20
2025-10-31 18:51:39,363 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 20
2025-10-31 18:51:39,364 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:39,364 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:39,365 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:51:39,365 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:51:39,365 - poker_game - INFO - Last raiser: 3
2025-10-31 18:51:39,366 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:39,366 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:39,367 - poker_game - INFO - Community cards: []
2025-10-31 18:51:39,367 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:39,368 - poker_game - INFO -   P1(Agent1): chips=3088, bet=10, status=active
2025-10-31 18:51:39,368 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:39,369 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:39,370 - poker_game - INFO -   P4(Agent4): chips=5041, bet=0, status=active
2025-10-31 18:51:39,371 - poker_game - INFO - ==================================================
2025-10-31 18:51:39,371 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 20
2025-10-31 18:51:39,384 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:39,385 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:39,385 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:51:39,386 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:51:39,386 - poker_game - INFO - Last raiser: 3
2025-10-31 18:51:39,387 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:39,387 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:39,387 - poker_game - INFO - Community cards: []
2025-10-31 18:51:39,388 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:39,388 - poker_game - INFO -   P1(Agent1): chips=3088, bet=10, status=active
2025-10-31 18:51:39,388 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:39,388 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:39,388 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:39,389 - poker_game - INFO - Extra: Action: Player 4 called 20
2025-10-31 18:51:39,389 - poker_game - INFO - ==================================================
2025-10-31 18:51:39,390 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:39,390 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:39,390 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:51:39,391 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:51:39,391 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:39,392 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:39,392 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:51:39,393 - poker_game - DEBUG - Player bets: [10, 20, 20], Current bet: 20, All same: False
2025-10-31 18:51:39,393 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:51:39,394 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:39,394 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:39,395 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:51:39,397 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:51:39,397 - poker_game - INFO - Last raiser: 3
2025-10-31 18:51:39,398 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:39,398 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:39,398 - poker_game - INFO - Community cards: []
2025-10-31 18:51:39,399 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:39,399 - poker_game - INFO -   P1(Agent1): chips=3088, bet=10, status=active
2025-10-31 18:51:39,399 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:39,400 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:39,400 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:39,400 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:51:39,401 - poker_game - INFO - ==================================================
2025-10-31 18:51:39,502 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "A♠",
    "10♥"
  ],
  "community": [],
  "your_chips": 3088,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1841,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5021,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (3088)"
  ],
  "history": [
    "Player 4 raised to 633",
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20"
  ]
}
2025-10-31 18:51:39,513 - poker_game - DEBUG - Create Session: {'id': '1ddbd5ab-3fc4-489f-a951-de544c2ed16a', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904299.510167}
2025-10-31 18:51:41,662 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "エースと10の強いハンド（A-10）を持っており、プリフロップ（フロップが出る前）の状況です。ポットはすでに大きく（50）、相手の一人がすでに20をベットしています。これ以上のコール（相手のベット額と同じ額を支払うこと）は、相手のハンドを過大評価することになる可能性があります。レイズ（ベット額を上げる）することで、相手にプレッシャーをかけ、ポットを大きくし、より有利な状況でフロップ以降のゲームを進めることができます。最低レイズ額の40にすることで、相手に十分なプレッシャーを与えつつ、自分のチップを過度に減らすリスクを抑えます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 177, 'promptTokenCount': 918, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 918}], 'totalTokenCount': 1095}, 'invocationId': 'e-88c66f97-a30b-4a1d-bf1b-e5c4e3479024', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'YQJJNQ4C', 'timestamp': 1761904299.522517}]
2025-10-31 18:51:41,662 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:51:41,663 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 40,
  "reasoning": "エースと10の強いハンド（A-10）を持っており、プリフロップ（フロップが出る前）の状況です。ポットはすでに大きく（50）、相手の一人がすでに20をベットしています。これ以上のコール（相手のベット額と同じ額を支払うこと）は、相手のハンドを過大評価することになる可能性があります。レイズ（ベット額を上げる）することで、相手にプレッシャーをかけ、ポットを大きくし、より有利な状況でフロップ以降のゲームを進めることができます。最低レイズ額の40にすることで、相手に十分なプレッシャーを与えつつ、自分のチップを過度に減らすリスクを抑えます。"
}
```
2025-10-31 18:51:41,663 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:51:41,664 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "エースと10の強いハンド（A-10）を持っており、プリフロップ（フロップが出る前）の状況です。ポットはすでに大きく（50）、相手の一人がすでに20をベットしています。これ以上のコール（相手のベット額と同じ額を支払うこと）は、相手のハンドを過大評価することになる可能性があります。レイズ（ベット額を上げる）することで、相手にプレッシャーをかけ、ポットを大きくし、より有利な状況でフロップ以降のゲームを進めることができます。最低レイズ額の40にすることで、相手に十分なプレッシャーを与えつつ、自分のチップを過度に減らすリスクを抑えます。"\n}\n```'
2025-10-31 18:51:41,664 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:51:41,664 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "エースと10の強いハンド（A-10）を持っており、プリフロップ（フロップが出る前）の状況です。ポットはすでに大きく（50）、相手の一人がすでに20をベットしています。これ以上のコール（相手のベット額と同じ額を支払うこと）は、相手のハンドを過大評価することになる可能性があります。レイズ（ベット額を上げる）することで、相手にプレッシャーをかけ、ポットを大きくし、より有利な状況でフロップ以降のゲームを進めることができます。最低レイズ額の40にすることで、相手に十分なプレッシャーを与えつつ、自分のチップを過度に減らすリスクを抑えます。"\n}'
2025-10-31 18:51:41,664 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 40,
  "reasoning": "エースと10の強いハンド（A-10）を持っており、プリフロップ（フロップが出る前）の状況です。ポットはすでに大きく（50）、相手の一人がすでに20をベットしています。これ以上のコール（相手のベット額と同じ額を支払うこと）は、相手のハンドを過大評価することになる可能性があります。レイズ（ベット額を上げる）することで、相手にプレッシャーをかけ、ポットを大きくし、より有利な状況でフロップ以降のゲームを進めることができます。最低レイズ額の40にすることで、相手に十分なプレッシャーを与えつつ、自分のチップを過度に減らすリスクを抑えます。"
}
2025-10-31 18:51:41,665 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 40, 'reasoning': 'エースと10の強いハンド（A-10）を持っており、プリフロップ（フロップが出る前）の状況です。ポットはすでに大きく（50）、相手の一人がすでに20をベットしています。これ以上のコール（相手のベット額と同じ額を支払うこと）は、相手のハンドを過大評価することになる可能性があります。レイズ（ベット額を上げる）することで、相手にプレッシャーをかけ、ポットを大きくし、より有利な状況でフロップ以降のゲームを進めることができます。最低レイズ額の40にすることで、相手に十分なプレッシャーを与えつつ、自分のチップを過度に減らすリスクを抑えます。'}
2025-10-31 18:51:41,665 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 40
2025-10-31 18:51:41,665 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (3088)']
2025-10-31 18:51:41,665 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 18:51:41,666 - poker_game - DEBUG - [Agent1] Raise amount 40 is valid (min: 40)
2025-10-31 18:51:41,666 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 40}
2025-10-31 18:51:41,666 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 40, エースと10の強いハンド（A-10）を持っており、プリフロップ（フロップが出る前）の状況です。ポットはすでに大きく（50）、相手の一人がすでに20をベットしています。これ以上のコール（相手のベット額と同じ額を支払うこと）は、相手のハンドを過大評価することになる可能性があります。レイズ（ベット額を上げる）することで、相手にプレッシャーをかけ、ポットを大きくし、より有利な状況でフロップ以降のゲームを進めることができます。最低レイズ額の40にすることで、相手に十分なプレッシャーを与えつつ、自分のチップを過度に減らすリスクを抑えます。
2025-10-31 18:51:41,667 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 40
2025-10-31 18:51:41,668 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:41,668 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:41,668 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:51:41,669 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:51:41,669 - poker_game - INFO - Last raiser: 3
2025-10-31 18:51:41,670 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:41,671 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:41,672 - poker_game - INFO - Community cards: []
2025-10-31 18:51:41,673 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:41,673 - poker_game - INFO -   P1(Agent1): chips=3088, bet=10, status=active
2025-10-31 18:51:41,674 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:41,675 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:41,675 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:41,676 - poker_game - INFO - ==================================================
2025-10-31 18:51:41,676 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 60
2025-10-31 18:51:41,691 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:41,691 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:41,692 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:51:41,692 - poker_game - INFO - Pot: 100, Current bet: 60
2025-10-31 18:51:41,693 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:41,693 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:41,693 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:41,693 - poker_game - INFO - Community cards: []
2025-10-31 18:51:41,694 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:41,694 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:41,694 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:41,695 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:41,695 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:41,695 - poker_game - INFO - Extra: Action: Player 1 raised to 60
2025-10-31 18:51:41,696 - poker_game - INFO - ==================================================
2025-10-31 18:51:41,696 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:41,696 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:41,696 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:51:41,697 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:51:41,697 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:41,697 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:41,698 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:51:41,698 - poker_game - DEBUG - Player bets: [60, 20, 20], Current bet: 60, All same: False
2025-10-31 18:51:41,698 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:51:41,698 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:41,699 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:41,699 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:51:41,700 - poker_game - INFO - Pot: 100, Current bet: 60
2025-10-31 18:51:41,700 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:41,700 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:41,701 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:41,701 - poker_game - INFO - Community cards: []
2025-10-31 18:51:41,702 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:41,702 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:41,703 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:41,703 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:41,704 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:41,706 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:51:41,707 - poker_game - INFO - ==================================================
2025-10-31 18:51:41,809 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "4♠",
    "9♣"
  ],
  "community": [],
  "your_chips": 1841,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 100,
  "to_call": 40,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3038,
      "bet": 60,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5021,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (40)",
    "raise (min 80)",
    "all-in (1841)"
  ],
  "history": [
    "Player 1 called 633",
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60"
  ]
}
2025-10-31 18:51:41,820 - poker_game - DEBUG - Create Session: {'id': '018dfecd-3e80-4012-ac9d-ecede517b9d6', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904301.8174477}
2025-10-31 18:51:43,588 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（カードが配られた直後）で、私の手札は4と9で、スーテッド（同じスート）でもコネクター（連続した数字）でもありません。これは非常に弱いハンドです。ポットは100で、コールするには40必要ですが、レイズ（ベット額を上げる）の可能性も考慮すると、この弱いハンドでこれ以上チップを失うのは賢明ではありません。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 120, 'promptTokenCount': 917, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 917}], 'totalTokenCount': 1037}, 'invocationId': 'e-200bbfbf-8ac9-40b2-a46c-ae74a4f30861', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'aaaKnMCR', 'timestamp': 1761904301.830887}]
2025-10-31 18:51:43,589 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:51:43,590 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（カードが配られた直後）で、私の手札は4と9で、スーテッド（同じスート）でもコネクター（連続した数字）でもありません。これは非常に弱いハンドです。ポットは100で、コールするには40必要ですが、レイズ（ベット額を上げる）の可能性も考慮すると、この弱いハンドでこれ以上チップを失うのは賢明ではありません。"
}
```
2025-10-31 18:51:43,590 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:51:43,590 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（カードが配られた直後）で、私の手札は4と9で、スーテッド（同じスート）でもコネクター（連続した数字）でもありません。これは非常に弱いハンドです。ポットは100で、コールするには40必要ですが、レイズ（ベット額を上げる）の可能性も考慮すると、この弱いハンドでこれ以上チップを失うのは賢明ではありません。"\n}\n```'
2025-10-31 18:51:43,590 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:51:43,591 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（カードが配られた直後）で、私の手札は4と9で、スーテッド（同じスート）でもコネクター（連続した数字）でもありません。これは非常に弱いハンドです。ポットは100で、コールするには40必要ですが、レイズ（ベット額を上げる）の可能性も考慮すると、この弱いハンドでこれ以上チップを失うのは賢明ではありません。"\n}'
2025-10-31 18:51:43,591 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（カードが配られた直後）で、私の手札は4と9で、スーテッド（同じスート）でもコネクター（連続した数字）でもありません。これは非常に弱いハンドです。ポットは100で、コールするには40必要ですが、レイズ（ベット額を上げる）の可能性も考慮すると、この弱いハンドでこれ以上チップを失うのは賢明ではありません。"
}
2025-10-31 18:51:43,591 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（カードが配られた直後）で、私の手札は4と9で、スーテッド（同じスート）でもコネクター（連続した数字）でもありません。これは非常に弱いハンドです。ポットは100で、コールするには40必要ですが、レイズ（ベット額を上げる）の可能性も考慮すると、この弱いハンドでこれ以上チップを失うのは賢明ではありません。'}
2025-10-31 18:51:43,591 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:51:43,592 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:51:43,592 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:51:43,592 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップ（カードが配られた直後）で、私の手札は4と9で、スーテッド（同じスート）でもコネクター（連続した数字）でもありません。これは非常に弱いハンドです。ポットは100で、コールするには40必要ですが、レイズ（ベット額を上げる）の可能性も考慮すると、この弱いハンドでこれ以上チップを失うのは賢明ではありません。
2025-10-31 18:51:43,593 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:51:43,594 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:43,594 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:43,594 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:51:43,594 - poker_game - INFO - Pot: 100, Current bet: 60
2025-10-31 18:51:43,595 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:43,595 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:43,596 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:51:43,596 - poker_game - INFO - Community cards: []
2025-10-31 18:51:43,596 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:43,597 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:43,597 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:43,598 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=active
2025-10-31 18:51:43,598 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:43,598 - poker_game - INFO - ==================================================
2025-10-31 18:51:43,599 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:51:43,613 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:43,613 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:43,613 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:51:43,614 - poker_game - INFO - Pot: 100, Current bet: 60
2025-10-31 18:51:43,614 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:43,615 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:43,615 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:43,615 - poker_game - INFO - Community cards: []
2025-10-31 18:51:43,616 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:43,616 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:43,617 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:43,617 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=folded
2025-10-31 18:51:43,617 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:43,618 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:51:43,618 - poker_game - INFO - ==================================================
2025-10-31 18:51:43,618 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:43,619 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:43,619 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:51:43,619 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:51:43,620 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:43,620 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:43,620 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:51:43,620 - poker_game - DEBUG - Player bets: [60, 20], Current bet: 60, All same: False
2025-10-31 18:51:43,620 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:51:43,621 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:43,621 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:43,621 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:51:43,621 - poker_game - INFO - Pot: 100, Current bet: 60
2025-10-31 18:51:43,622 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:43,622 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:43,622 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:43,623 - poker_game - INFO - Community cards: []
2025-10-31 18:51:43,623 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:43,624 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:43,624 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:43,625 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=folded
2025-10-31 18:51:43,625 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:43,626 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:51:43,626 - poker_game - INFO - ==================================================
2025-10-31 18:51:43,728 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "6♦",
    "6♣"
  ],
  "community": [],
  "your_chips": 5021,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 100,
  "to_call": 40,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3038,
      "bet": 60,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1841,
      "bet": 20,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (40)",
    "raise (min 80)",
    "all-in (5021)"
  ],
  "history": [
    "Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣",
    "Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦",
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded"
  ]
}
2025-10-31 18:51:43,739 - poker_game - DEBUG - Create Session: {'id': '9a03ff62-84e2-41ef-b50b-a3a62918af1b', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904303.7368321}
2025-10-31 18:51:53,919 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:51:55,885 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_7gfLZCP7dLr4Hw7fIdNQLPCT', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1241, 'totalTokenCount': 1258}, 'invocationId': 'e-6f3a3684-5704-4ad1-90ec-92e87ce97bd7', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'bS7LlRGQ', 'timestamp': 1761904303.748137}, {'content': {'parts': [{'functionResponse': {'id': 'call_7gfLZCP7dLr4Hw7fIdNQLPCT', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-6f3a3684-5704-4ad1-90ec-92e87ce97bd7', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'gdV3eaW5', 'timestamp': 1761904304.475054}, {'content': {'parts': [{'functionCall': {'id': 'call_ViqnzWID3Qn5Q9sgqrNdqBTx', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['6♦', '6♣'], 'community': [], 'your_chips': 5021, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 100, 'to_call': 40, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3038, 'bet': 60, 'status': 'active'}, {'id': 3, 'chips': 1841, 'bet': 20, 'status': 'folded'}], 'actions': ['fold', 'call (40)', 'raise (min 80)', 'all-in (5021)'], 'history': ['Showdown: Player 1 hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥ cards=Q♠, A♣', 'Showdown: Player 4 hand=Two Pair: Qs and 6s - K♦, Q♦, Q♥, 6♠, 6♥ cards=K♦, Q♦', 'Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 checked', 'Flop dealt: A♠, 5♠, 7♠', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 10♠', 'Player 4 folded', 'Showdown: Player 1 won 40', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 raised to 60', 'Player 3 folded']}, 'call_amount': 40, 'pot_after_call': 140, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 473, 'promptTokenCount': 1765, 'totalTokenCount': 2238}, 'invocationId': 'e-6f3a3684-5704-4ad1-90ec-92e87ce97bd7', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'nu22lJ70', 'timestamp': 1761904304.477089}, {'content': {'parts': [{'functionResponse': {'id': 'call_ViqnzWID3Qn5Q9sgqrNdqBTx', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 40, 'reasoning': 'ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 40'}}}], 'role': 'user'}, 'invocationId': 'e-6f3a3684-5704-4ad1-90ec-92e87ce97bd7', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'VqABb2dl', 'timestamp': 1761904313.717139}, {'content': {'parts': [{'text': '{"action":"call","amount":40,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 40"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2305, 'totalTokenCount': 2359}, 'invocationId': 'e-6f3a3684-5704-4ad1-90ec-92e87ce97bd7', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'NaYrQFIA', 'timestamp': 1761904313.719231}]
2025-10-31 18:51:55,886 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:51:55,886 - poker_game - DEBUG - {"action":"call","amount":40,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 40"}
2025-10-31 18:51:55,887 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:51:55,887 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":40,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 40"}'
2025-10-31 18:51:55,888 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:51:55,888 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":40,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 40"}
2025-10-31 18:51:55,888 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 40, 'reasoning': 'ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 40'}
2025-10-31 18:51:55,888 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 40
2025-10-31 18:51:55,888 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (40)', 'raise (min 80)', 'all-in (5021)']
2025-10-31 18:51:55,889 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (40)': 40
2025-10-31 18:51:55,889 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 40}
2025-10-31 18:51:55,889 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 40, ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 40
2025-10-31 18:51:55,892 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 40
2025-10-31 18:51:55,896 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:55,897 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:55,897 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:51:55,899 - poker_game - INFO - Pot: 100, Current bet: 60
2025-10-31 18:51:55,900 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:55,902 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:55,902 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:55,902 - poker_game - INFO - Community cards: []
2025-10-31 18:51:55,903 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:55,903 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:55,904 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:55,904 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=folded
2025-10-31 18:51:55,904 - poker_game - INFO -   P4(Agent4): chips=5021, bet=20, status=active
2025-10-31 18:51:55,905 - poker_game - INFO - ==================================================
2025-10-31 18:51:55,905 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 40
2025-10-31 18:51:55,919 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:55,921 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:55,921 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:51:55,922 - poker_game - INFO - Pot: 140, Current bet: 60
2025-10-31 18:51:55,922 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:55,923 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:55,923 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:55,924 - poker_game - INFO - Community cards: []
2025-10-31 18:51:55,924 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:55,924 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:55,925 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:55,925 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=folded
2025-10-31 18:51:55,925 - poker_game - INFO -   P4(Agent4): chips=4981, bet=60, status=active
2025-10-31 18:51:55,926 - poker_game - INFO - Extra: Action: Player 4 called 40
2025-10-31 18:51:55,926 - poker_game - INFO - ==================================================
2025-10-31 18:51:55,927 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:55,927 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:55,928 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:51:55,928 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:51:55,928 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:55,929 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:55,929 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:51:55,929 - poker_game - DEBUG - Player bets: [60, 60], Current bet: 60, All same: True
2025-10-31 18:51:55,929 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:51:55,930 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:55,930 - poker_game - INFO - Hand #10, Phase: preflop
2025-10-31 18:51:55,931 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:51:55,932 - poker_game - INFO - Pot: 140, Current bet: 60
2025-10-31 18:51:55,933 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:55,934 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:55,935 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:55,937 - poker_game - INFO - Community cards: []
2025-10-31 18:51:55,938 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:55,939 - poker_game - INFO -   P1(Agent1): chips=3038, bet=60, status=active
2025-10-31 18:51:55,940 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:55,940 - poker_game - INFO -   P3(Agent3): chips=1841, bet=20, status=folded
2025-10-31 18:51:55,940 - poker_game - INFO -   P4(Agent4): chips=4981, bet=60, status=active
2025-10-31 18:51:55,941 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:51:55,941 - poker_game - INFO - ==================================================
2025-10-31 18:51:56,047 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:51:56,048 - poker_game - INFO - Betting round complete: True
2025-10-31 18:51:56,048 - poker_game - INFO - Remaining players: 2
2025-10-31 18:51:56,049 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:51:56,049 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:51:56,049 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:51:56,060 - poker_game - INFO - Starting new betting round
2025-10-31 18:51:56,060 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:51:56,061 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:51:56,061 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:51:56,061 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:51:56,062 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 18:51:56,062 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:51:56,062 - poker_game - INFO - Hand #10, Phase: flop
2025-10-31 18:51:56,063 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:51:56,063 - poker_game - INFO - Pot: 140, Current bet: 0
2025-10-31 18:51:56,064 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:56,064 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:56,065 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:56,065 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥']
2025-10-31 18:51:56,066 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:56,066 - poker_game - INFO -   P1(Agent1): chips=3038, bet=0, status=active
2025-10-31 18:51:56,066 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:56,067 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:51:56,067 - poker_game - INFO -   P4(Agent4): chips=4981, bet=0, status=active
2025-10-31 18:51:56,068 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:51:56,068 - poker_game - INFO - ==================================================
2025-10-31 18:51:56,070 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "A♠",
    "10♥"
  ],
  "community": [
    "J♠",
    "9♠",
    "2♥"
  ],
  "your_chips": 3038,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 60,
  "pot": 140,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1841,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4981,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3038)"
  ],
  "history": [
    "Side pot layer 0: amount=420, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥"
  ]
}
2025-10-31 18:51:56,080 - poker_game - DEBUG - Create Session: {'id': 'c04e962a-911a-4ef8-8ce5-e6cd7e981a43', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904316.07733}
2025-10-31 18:51:58,106 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 140,\n  "reasoning": "フロップでフラッシュのドロー（同じスートのカードが3枚以上揃っている状態）が完成しました。このドローは非常に強力で、相手を圧倒する可能性があります。相手のベット額が不明ですが、ポットを大きくして、有利な状況で次のカード（ターン）を迎えるために、レイズをします。レイズ額は、相手がコールするかフォールドするかを迷うような、ある程度のプレッシャーを与える額にします。ここでは、ポット額の1倍である140にレイズします。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 146, 'promptTokenCount': 866, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 866}], 'totalTokenCount': 1012}, 'invocationId': 'e-94a49cbe-f368-4afc-8cec-4a2dc96c9b6e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'fdanb9o5', 'timestamp': 1761904316.089543}]
2025-10-31 18:51:58,106 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:51:58,106 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 140,
  "reasoning": "フロップでフラッシュのドロー（同じスートのカードが3枚以上揃っている状態）が完成しました。このドローは非常に強力で、相手を圧倒する可能性があります。相手のベット額が不明ですが、ポットを大きくして、有利な状況で次のカード（ターン）を迎えるために、レイズをします。レイズ額は、相手がコールするかフォールドするかを迷うような、ある程度のプレッシャーを与える額にします。ここでは、ポット額の1倍である140にレイズします。"
}
```
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 140,\n  "reasoning": "フロップでフラッシュのドロー（同じスートのカードが3枚以上揃っている状態）が完成しました。このドローは非常に強力で、相手を圧倒する可能性があります。相手のベット額が不明ですが、ポットを大きくして、有利な状況で次のカード（ターン）を迎えるために、レイズをします。レイズ額は、相手がコールするかフォールドするかを迷うような、ある程度のプレッシャーを与える額にします。ここでは、ポット額の1倍である140にレイズします。"\n}\n```'
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 140,\n  "reasoning": "フロップでフラッシュのドロー（同じスートのカードが3枚以上揃っている状態）が完成しました。このドローは非常に強力で、相手を圧倒する可能性があります。相手のベット額が不明ですが、ポットを大きくして、有利な状況で次のカード（ターン）を迎えるために、レイズをします。レイズ額は、相手がコールするかフォールドするかを迷うような、ある程度のプレッシャーを与える額にします。ここでは、ポット額の1倍である140にレイズします。"\n}'
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 140,
  "reasoning": "フロップでフラッシュのドロー（同じスートのカードが3枚以上揃っている状態）が完成しました。このドローは非常に強力で、相手を圧倒する可能性があります。相手のベット額が不明ですが、ポットを大きくして、有利な状況で次のカード（ターン）を迎えるために、レイズをします。レイズ額は、相手がコールするかフォールドするかを迷うような、ある程度のプレッシャーを与える額にします。ここでは、ポット額の1倍である140にレイズします。"
}
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 140, 'reasoning': 'フロップでフラッシュのドロー（同じスートのカードが3枚以上揃っている状態）が完成しました。このドローは非常に強力で、相手を圧倒する可能性があります。相手のベット額が不明ですが、ポットを大きくして、有利な状況で次のカード（ターン）を迎えるために、レイズをします。レイズ額は、相手がコールするかフォールドするかを迷うような、ある程度のプレッシャーを与える額にします。ここでは、ポット額の1倍である140にレイズします。'}
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 140
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (3038)']
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Raise amount 140 is valid (min: 20)
2025-10-31 18:51:58,107 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 140}
2025-10-31 18:51:58,108 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 140, フロップでフラッシュのドロー（同じスートのカードが3枚以上揃っている状態）が完成しました。このドローは非常に強力で、相手を圧倒する可能性があります。相手のベット額が不明ですが、ポットを大きくして、有利な状況で次のカード（ターン）を迎えるために、レイズをします。レイズ額は、相手がコールするかフォールドするかを迷うような、ある程度のプレッシャーを与える額にします。ここでは、ポット額の1倍である140にレイズします。
2025-10-31 18:51:58,108 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 140
2025-10-31 18:51:58,108 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:51:58,108 - poker_game - INFO - Hand #10, Phase: flop
2025-10-31 18:51:58,108 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:51:58,109 - poker_game - INFO - Pot: 140, Current bet: 0
2025-10-31 18:51:58,109 - poker_game - INFO - Last raiser: None
2025-10-31 18:51:58,109 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:58,109 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:58,109 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥']
2025-10-31 18:51:58,109 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:58,109 - poker_game - INFO -   P1(Agent1): chips=3038, bet=0, status=active
2025-10-31 18:51:58,109 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:58,109 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:51:58,109 - poker_game - INFO -   P4(Agent4): chips=4981, bet=0, status=active
2025-10-31 18:51:58,109 - poker_game - INFO - ==================================================
2025-10-31 18:51:58,110 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 140
2025-10-31 18:51:58,144 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:51:58,144 - poker_game - INFO - Hand #10, Phase: flop
2025-10-31 18:51:58,145 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:51:58,145 - poker_game - INFO - Pot: 280, Current bet: 140
2025-10-31 18:51:58,145 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:58,145 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:58,145 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:58,145 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥']
2025-10-31 18:51:58,146 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:58,146 - poker_game - INFO -   P1(Agent1): chips=2898, bet=140, status=active
2025-10-31 18:51:58,146 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:58,146 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:51:58,147 - poker_game - INFO -   P4(Agent4): chips=4981, bet=0, status=active
2025-10-31 18:51:58,147 - poker_game - INFO - Extra: Action: Player 1 raised to 140
2025-10-31 18:51:58,147 - poker_game - INFO - ==================================================
2025-10-31 18:51:58,147 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:51:58,147 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:51:58,147 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:51:58,147 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:51:58,147 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:51:58,148 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:51:58,148 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:51:58,148 - poker_game - DEBUG - Player bets: [140, 0], Current bet: 140, All same: False
2025-10-31 18:51:58,148 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:51:58,148 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:51:58,148 - poker_game - INFO - Hand #10, Phase: flop
2025-10-31 18:51:58,149 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:51:58,149 - poker_game - INFO - Pot: 280, Current bet: 140
2025-10-31 18:51:58,149 - poker_game - INFO - Last raiser: 1
2025-10-31 18:51:58,149 - poker_game - INFO - Betting round complete: False
2025-10-31 18:51:58,149 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:51:58,150 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥']
2025-10-31 18:51:58,150 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:51:58,150 - poker_game - INFO -   P1(Agent1): chips=2898, bet=140, status=active
2025-10-31 18:51:58,150 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:51:58,150 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:51:58,151 - poker_game - INFO -   P4(Agent4): chips=4981, bet=0, status=active
2025-10-31 18:51:58,151 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:51:58,151 - poker_game - INFO - ==================================================
2025-10-31 18:51:58,254 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "6♦",
    "6♣"
  ],
  "community": [
    "J♠",
    "9♠",
    "2♥"
  ],
  "your_chips": 4981,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 60,
  "pot": 280,
  "to_call": 140,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2898,
      "bet": 140,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1841,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (140)",
    "raise (min 160)",
    "all-in (4981)"
  ],
  "history": [
    "Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140"
  ]
}
2025-10-31 18:51:58,264 - poker_game - DEBUG - Create Session: {'id': '9c753db3-9b69-45c3-b31a-f708942a61e2', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904318.2621276}
2025-10-31 18:52:10,481 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:52:07,238 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_MIm7PLsbYmo9OwXFNOA2sLZU', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1155, 'totalTokenCount': 1172}, 'invocationId': 'e-9fe07ee5-470b-4a58-acf4-bea1284e6d5f', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'sizEfFXo', 'timestamp': 1761904318.277065}, {'content': {'parts': [{'functionResponse': {'id': 'call_MIm7PLsbYmo9OwXFNOA2sLZU', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-9fe07ee5-470b-4a58-acf4-bea1284e6d5f', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'QjI2B6SZ', 'timestamp': 1761904319.383947}, {'content': {'parts': [{'functionCall': {'id': 'call_TkwgOzyJxeVqKnM5Z2qknfC9', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['6♦', '6♣'], 'community': ['J♠', '9♠', '2♥'], 'your_chips': 4981, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 60, 'pot': 280, 'to_call': 140, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2898, 'bet': 140, 'status': 'active'}, {'id': 3, 'chips': 1841, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (140)', 'raise (min 160)', 'all-in (4981)'], 'history': ['Side pot layer 1: amount=1806, winners=1 best_hand=Two Pair: Qs and 6s - A♣, Q♠, Q♥, 6♠, 6♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 checked', 'Flop dealt: A♠, 5♠, 7♠', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 10♠', 'Player 4 folded', 'Showdown: Player 1 won 40', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 raised to 60', 'Player 3 folded', 'Player 4 called 40', 'Flop dealt: J♠, 9♠, 2♥', 'Player 1 raised to 140']}, 'call_amount': 140, 'pot_after_call': 420, 'equity': 0.55}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 395, 'promptTokenCount': 1679, 'totalTokenCount': 2074}, 'invocationId': 'e-9fe07ee5-470b-4a58-acf4-bea1284e6d5f', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IgEjL8zW', 'timestamp': 1761904319.38548}, {'content': {'parts': [{'functionResponse': {'id': 'call_TkwgOzyJxeVqKnM5Z2qknfC9', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 140, 'reasoning': 'ポットオッズを満たしており（168.00(ポットに対して60.00%）、コールが妥当と判断。コール額: 140'}}}], 'role': 'user'}, 'invocationId': 'e-9fe07ee5-470b-4a58-acf4-bea1284e6d5f', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'NmKwtSTt', 'timestamp': 1761904330.427925}, {'content': {'parts': [{'text': '{"action":"call","amount":140,"reasoning":"ポットオッズを満たしており（168.00(ポットに対して60.00%）、コールが妥当と判断。コール額: 140"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2125, 'totalTokenCount': 2179}, 'invocationId': 'e-9fe07ee5-470b-4a58-acf4-bea1284e6d5f', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'A2YEnHzK', 'timestamp': 1761904330.430537}]
2025-10-31 18:52:07,238 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:52:07,238 - poker_game - DEBUG - {"action":"call","amount":140,"reasoning":"ポットオッズを満たしており（168.00(ポットに対して60.00%）、コールが妥当と判断。コール額: 140"}
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":140,"reasoning":"ポットオッズを満たしており（168.00(ポットに対して60.00%）、コールが妥当と判断。コール額: 140"}'
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":140,"reasoning":"ポットオッズを満たしており（168.00(ポットに対して60.00%）、コールが妥当と判断。コール額: 140"}
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 140, 'reasoning': 'ポットオッズを満たしており（168.00(ポットに対して60.00%）、コールが妥当と判断。コール額: 140'}
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 140
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (140)', 'raise (min 160)', 'all-in (4981)']
2025-10-31 18:52:07,239 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (140)': 140
2025-10-31 18:52:07,240 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 140}
2025-10-31 18:52:07,240 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 140, ポットオッズを満たしており（168.00(ポットに対して60.00%）、コールが妥当と判断。コール額: 140
2025-10-31 18:52:07,240 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 140
2025-10-31 18:52:07,241 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:52:07,241 - poker_game - INFO - Hand #10, Phase: flop
2025-10-31 18:52:07,241 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:52:07,241 - poker_game - INFO - Pot: 280, Current bet: 140
2025-10-31 18:52:07,241 - poker_game - INFO - Last raiser: 1
2025-10-31 18:52:07,242 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:07,242 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:07,242 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥']
2025-10-31 18:52:07,242 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:07,242 - poker_game - INFO -   P1(Agent1): chips=2898, bet=140, status=active
2025-10-31 18:52:07,243 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:07,243 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:07,243 - poker_game - INFO -   P4(Agent4): chips=4981, bet=0, status=active
2025-10-31 18:52:07,243 - poker_game - INFO - ==================================================
2025-10-31 18:52:07,243 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 140
2025-10-31 18:52:07,265 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:52:07,266 - poker_game - INFO - Hand #10, Phase: flop
2025-10-31 18:52:07,266 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:52:07,266 - poker_game - INFO - Pot: 420, Current bet: 140
2025-10-31 18:52:07,266 - poker_game - INFO - Last raiser: 1
2025-10-31 18:52:07,267 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:07,267 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:07,267 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥']
2025-10-31 18:52:07,267 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:07,268 - poker_game - INFO -   P1(Agent1): chips=2898, bet=140, status=active
2025-10-31 18:52:07,268 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:07,268 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:07,268 - poker_game - INFO -   P4(Agent4): chips=4841, bet=140, status=active
2025-10-31 18:52:07,269 - poker_game - INFO - Extra: Action: Player 4 called 140
2025-10-31 18:52:07,269 - poker_game - INFO - ==================================================
2025-10-31 18:52:07,269 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:52:07,269 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:52:07,269 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:52:07,269 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:52:07,270 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:52:07,270 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:52:07,270 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:52:07,270 - poker_game - DEBUG - Player bets: [140, 140], Current bet: 140, All same: True
2025-10-31 18:52:07,270 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:52:07,271 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:52:07,271 - poker_game - INFO - Hand #10, Phase: flop
2025-10-31 18:52:07,271 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:07,271 - poker_game - INFO - Pot: 420, Current bet: 140
2025-10-31 18:52:07,271 - poker_game - INFO - Last raiser: 1
2025-10-31 18:52:07,272 - poker_game - INFO - Betting round complete: True
2025-10-31 18:52:07,272 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:07,272 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥']
2025-10-31 18:52:07,274 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:07,276 - poker_game - INFO -   P1(Agent1): chips=2898, bet=140, status=active
2025-10-31 18:52:07,277 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:07,277 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:07,278 - poker_game - INFO -   P4(Agent4): chips=4841, bet=140, status=active
2025-10-31 18:52:07,278 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:52:07,278 - poker_game - INFO - ==================================================
2025-10-31 18:52:07,379 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:52:07,380 - poker_game - INFO - Betting round complete: True
2025-10-31 18:52:07,380 - poker_game - INFO - Remaining players: 2
2025-10-31 18:52:07,381 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:52:07,381 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:52:07,381 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:52:07,391 - poker_game - INFO - Starting new betting round
2025-10-31 18:52:07,392 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:52:07,392 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:52:07,392 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:52:07,393 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:52:07,393 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 18:52:07,393 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:52:07,393 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:07,394 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:07,394 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 18:52:07,394 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:07,395 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:07,395 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:07,396 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:07,396 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:07,397 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:07,397 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:07,398 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:07,398 - poker_game - INFO -   P4(Agent4): chips=4841, bet=0, status=active
2025-10-31 18:52:07,399 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:52:07,400 - poker_game - INFO - ==================================================
2025-10-31 18:52:07,402 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "A♠",
    "10♥"
  ],
  "community": [
    "J♠",
    "9♠",
    "2♥",
    "4♣"
  ],
  "your_chips": 2898,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 200,
  "pot": 420,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1841,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4841,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (2898)"
  ],
  "history": [
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣"
  ]
}
2025-10-31 18:52:07,412 - poker_game - DEBUG - Create Session: {'id': '27dc020f-df8f-4e2c-a87f-dafa0aeb902f', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904327.4096365}
2025-10-31 18:52:10,183 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況はターン（Turn）で、コミュニティカードは J♠ 9♠ 2♥ 4♣ です。あなたの手札は A♠ 10♥ です。あなたの手札とコミュニティカードを合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣ となります。このボード（コミュニティカードの配置）では、フラッシュ（同じスートが5枚揃うこと）の可能性がまだありますが、あなたの手札にはスペード（♠）が1枚もなく、フラッシュを完成させることはできません。しかし、Aハイ（エースが最も強いカード）を持っており、相手がそれ以下のペアやブロークン（完成していない役）を持っている可能性を考えると、コール（Call：相手のベット額と同じ額を支払うこと）して、リバー（River：最後のコミュニティカード）を見るのが最善の選択です。相手のベット額は0で、チェック（Check：ベットせずに次のアクションに移ること）が可能なため、コールは0です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 249, 'promptTokenCount': 796, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 796}], 'totalTokenCount': 1045}, 'invocationId': 'e-5ca9c06a-3b2e-45e8-92a0-715de28bbe14', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '00MXQ76z', 'timestamp': 1761904327.42289}]
2025-10-31 18:52:10,183 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:52:10,183 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "現在の状況はターン（Turn）で、コミュニティカードは J♠ 9♠ 2♥ 4♣ です。あなたの手札は A♠ 10♥ です。あなたの手札とコミュニティカードを合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣ となります。このボード（コミュニティカードの配置）では、フラッシュ（同じスートが5枚揃うこと）の可能性がまだありますが、あなたの手札にはスペード（♠）が1枚もなく、フラッシュを完成させることはできません。しかし、Aハイ（エースが最も強いカード）を持っており、相手がそれ以下のペアやブロークン（完成していない役）を持っている可能性を考えると、コール（Call：相手のベット額と同じ額を支払うこと）して、リバー（River：最後のコミュニティカード）を見るのが最善の選択です。相手のベット額は0で、チェック（Check：ベットせずに次のアクションに移ること）が可能なため、コールは0です。"
}
```
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況はターン（Turn）で、コミュニティカードは J♠ 9♠ 2♥ 4♣ です。あなたの手札は A♠ 10♥ です。あなたの手札とコミュニティカードを合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣ となります。このボード（コミュニティカードの配置）では、フラッシュ（同じスートが5枚揃うこと）の可能性がまだありますが、あなたの手札にはスペード（♠）が1枚もなく、フラッシュを完成させることはできません。しかし、Aハイ（エースが最も強いカード）を持っており、相手がそれ以下のペアやブロークン（完成していない役）を持っている可能性を考えると、コール（Call：相手のベット額と同じ額を支払うこと）して、リバー（River：最後のコミュニティカード）を見るのが最善の選択です。相手のベット額は0で、チェック（Check：ベットせずに次のアクションに移ること）が可能なため、コールは0です。"\n}\n```'
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況はターン（Turn）で、コミュニティカードは J♠ 9♠ 2♥ 4♣ です。あなたの手札は A♠ 10♥ です。あなたの手札とコミュニティカードを合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣ となります。このボード（コミュニティカードの配置）では、フラッシュ（同じスートが5枚揃うこと）の可能性がまだありますが、あなたの手札にはスペード（♠）が1枚もなく、フラッシュを完成させることはできません。しかし、Aハイ（エースが最も強いカード）を持っており、相手がそれ以下のペアやブロークン（完成していない役）を持っている可能性を考えると、コール（Call：相手のベット額と同じ額を支払うこと）して、リバー（River：最後のコミュニティカード）を見るのが最善の選択です。相手のベット額は0で、チェック（Check：ベットせずに次のアクションに移ること）が可能なため、コールは0です。"\n}'
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "現在の状況はターン（Turn）で、コミュニティカードは J♠ 9♠ 2♥ 4♣ です。あなたの手札は A♠ 10♥ です。あなたの手札とコミュニティカードを合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣ となります。このボード（コミュニティカードの配置）では、フラッシュ（同じスートが5枚揃うこと）の可能性がまだありますが、あなたの手札にはスペード（♠）が1枚もなく、フラッシュを完成させることはできません。しかし、Aハイ（エースが最も強いカード）を持っており、相手がそれ以下のペアやブロークン（完成していない役）を持っている可能性を考えると、コール（Call：相手のベット額と同じ額を支払うこと）して、リバー（River：最後のコミュニティカード）を見るのが最善の選択です。相手のベット額は0で、チェック（Check：ベットせずに次のアクションに移ること）が可能なため、コールは0です。"
}
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': '現在の状況はターン（Turn）で、コミュニティカードは J♠ 9♠ 2♥ 4♣ です。あなたの手札は A♠ 10♥ です。あなたの手札とコミュニティカードを合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣ となります。このボード（コミュニティカードの配置）では、フラッシュ（同じスートが5枚揃うこと）の可能性がまだありますが、あなたの手札にはスペード（♠）が1枚もなく、フラッシュを完成させることはできません。しかし、Aハイ（エースが最も強いカード）を持っており、相手がそれ以下のペアやブロークン（完成していない役）を持っている可能性を考えると、コール（Call：相手のベット額と同じ額を支払うこと）して、リバー（River：最後のコミュニティカード）を見るのが最善の選択です。相手のベット額は0で、チェック（Check：ベットせずに次のアクションに移ること）が可能なため、コールは0です。'}
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 0
2025-10-31 18:52:10,184 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (2898)']
2025-10-31 18:52:10,185 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:52:10,185 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 0, 現在の状況はターン（Turn）で、コミュニティカードは J♠ 9♠ 2♥ 4♣ です。あなたの手札は A♠ 10♥ です。あなたの手札とコミュニティカードを合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣ となります。このボード（コミュニティカードの配置）では、フラッシュ（同じスートが5枚揃うこと）の可能性がまだありますが、あなたの手札にはスペード（♠）が1枚もなく、フラッシュを完成させることはできません。しかし、Aハイ（エースが最も強いカード）を持っており、相手がそれ以下のペアやブロークン（完成していない役）を持っている可能性を考えると、コール（Call：相手のベット額と同じ額を支払うこと）して、リバー（River：最後のコミュニティカード）を見るのが最善の選択です。相手のベット額は0で、チェック（Check：ベットせずに次のアクションに移ること）が可能なため、コールは0です。
2025-10-31 18:52:10,185 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 0
2025-10-31 18:52:10,186 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:52:10,186 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:10,186 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:10,186 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 18:52:10,187 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:10,187 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:10,187 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:10,188 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:10,188 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:10,188 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:10,188 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:10,188 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:10,188 - poker_game - INFO -   P4(Agent4): chips=4841, bet=0, status=active
2025-10-31 18:52:10,189 - poker_game - INFO - ==================================================
2025-10-31 18:52:10,189 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:52:10,208 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:52:10,209 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:10,209 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:10,209 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 18:52:10,209 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:10,209 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:10,209 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:10,210 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:10,210 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:10,210 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:10,210 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:10,210 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:10,210 - poker_game - INFO -   P4(Agent4): chips=4841, bet=0, status=active
2025-10-31 18:52:10,210 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:52:10,211 - poker_game - INFO - ==================================================
2025-10-31 18:52:10,211 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:52:10,211 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:52:10,211 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:52:10,211 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:52:10,211 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:52:10,211 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:52:10,211 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:52:10,211 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:52:10,211 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:52:10,211 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:52:10,211 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:52:10,211 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:52:10,211 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 1
2025-10-31 18:52:10,212 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:52:10,212 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:10,212 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:52:10,212 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 18:52:10,212 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:10,213 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:10,213 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:10,213 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:10,213 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:10,213 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:10,214 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:10,214 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:10,214 - poker_game - INFO -   P4(Agent4): chips=4841, bet=0, status=active
2025-10-31 18:52:10,214 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:52:10,214 - poker_game - INFO - ==================================================
2025-10-31 18:52:10,316 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "6♦",
    "6♣"
  ],
  "community": [
    "J♠",
    "9♠",
    "2♥",
    "4♣"
  ],
  "your_chips": 4841,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 200,
  "pot": 420,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2898,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1841,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4841)"
  ],
  "history": [
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked"
  ]
}
2025-10-31 18:52:10,325 - poker_game - DEBUG - Create Session: {'id': '64a79d3c-1db0-46c1-a383-56fb8ca048b6', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904330.3237448}
2025-10-31 18:52:20,353 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:52:20,366 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_jDSHHCuxGy3fShenrV42D8X7', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1113, 'totalTokenCount': 1130}, 'invocationId': 'e-064acdb5-25dd-481d-91af-bc49b83b378c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ejbSjbWk', 'timestamp': 1761904330.332733}, {'content': {'parts': [{'functionResponse': {'id': 'call_jDSHHCuxGy3fShenrV42D8X7', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-064acdb5-25dd-481d-91af-bc49b83b378c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'aQ33pdo3', 'timestamp': 1761904331.851776}, {'content': {'parts': [{'functionCall': {'id': 'call_n6lLnRKda6RY2LOADbv38RQk', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['6♦', '6♣'], 'community': ['J♠', '9♠', '2♥', '4♣'], 'your_chips': 4841, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 200, 'pot': 420, 'to_call': 0, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2898, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1841, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4841)'], 'history': ['Player 3 folded', 'Player 4 called 10', 'Player 1 checked', 'Flop dealt: A♠, 5♠, 7♠', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 10♠', 'Player 4 folded', 'Showdown: Player 1 won 40', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 raised to 60', 'Player 3 folded', 'Player 4 called 40', 'Flop dealt: J♠, 9♠, 2♥', 'Player 1 raised to 140', 'Player 4 called 140', 'Turn dealt: 4♣', 'Player 1 checked']}, 'call_amount': 0, 'pot_after_call': 420, 'equity': 0.6}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 350, 'promptTokenCount': 1637, 'totalTokenCount': 1987}, 'invocationId': 'e-064acdb5-25dd-481d-91af-bc49b83b378c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'DytdMuV0', 'timestamp': 1761904331.853239}, {'content': {'parts': [{'functionResponse': {'id': 'call_n6lLnRKda6RY2LOADbv38RQk', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 210, 'reasoning': '期待値が見込める（252.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 210'}}}], 'role': 'user'}, 'invocationId': 'e-064acdb5-25dd-481d-91af-bc49b83b378c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '7mfz5tzh', 'timestamp': 1761904338.284069}, {'content': {'parts': [{'text': '{"action":"raise","amount":210,"reasoning":"期待値が見込める（252.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 210"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2040, 'totalTokenCount': 2096}, 'invocationId': 'e-064acdb5-25dd-481d-91af-bc49b83b378c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'jX4onuPC', 'timestamp': 1761904338.286722}]
2025-10-31 18:52:20,367 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:52:20,368 - poker_game - DEBUG - {"action":"raise","amount":210,"reasoning":"期待値が見込める（252.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 210"}
2025-10-31 18:52:20,368 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:52:20,368 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":210,"reasoning":"期待値が見込める（252.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 210"}'
2025-10-31 18:52:20,368 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:52:20,368 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":210,"reasoning":"期待値が見込める（252.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 210"}
2025-10-31 18:52:20,369 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 210, 'reasoning': '期待値が見込める（252.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 210'}
2025-10-31 18:52:20,369 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 210
2025-10-31 18:52:20,369 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (4841)']
2025-10-31 18:52:20,369 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:52:20,369 - poker_game - DEBUG - [Agent4] Raise amount 210 is valid (min: 20)
2025-10-31 18:52:20,369 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 210}
2025-10-31 18:52:20,369 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 210, 期待値が見込める（252.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 210
2025-10-31 18:52:20,370 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 210
2025-10-31 18:52:20,371 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:52:20,371 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:20,372 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:52:20,372 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 18:52:20,373 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:20,373 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:20,373 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:20,374 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:20,374 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:20,374 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:20,374 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:20,374 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:20,374 - poker_game - INFO -   P4(Agent4): chips=4841, bet=0, status=active
2025-10-31 18:52:20,375 - poker_game - INFO - ==================================================
2025-10-31 18:52:20,375 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 210
2025-10-31 18:52:20,382 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:52:20,382 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:20,382 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:52:20,383 - poker_game - INFO - Pot: 630, Current bet: 210
2025-10-31 18:52:20,383 - poker_game - INFO - Last raiser: 4
2025-10-31 18:52:20,383 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:20,383 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:20,383 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:20,384 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:20,384 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:20,384 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:20,384 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:20,384 - poker_game - INFO -   P4(Agent4): chips=4631, bet=210, status=active
2025-10-31 18:52:20,384 - poker_game - INFO - Extra: Action: Player 4 raised to 210
2025-10-31 18:52:20,384 - poker_game - INFO - ==================================================
2025-10-31 18:52:20,385 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:52:20,385 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:52:20,385 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:52:20,385 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:52:20,385 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:52:20,386 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:52:20,386 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:52:20,386 - poker_game - DEBUG - Player bets: [0, 210], Current bet: 210, All same: False
2025-10-31 18:52:20,386 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:52:20,386 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:52:20,386 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:20,386 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:20,387 - poker_game - INFO - Pot: 630, Current bet: 210
2025-10-31 18:52:20,387 - poker_game - INFO - Last raiser: 4
2025-10-31 18:52:20,388 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:20,388 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:20,389 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:20,390 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:20,390 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:20,390 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:20,391 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:20,391 - poker_game - INFO -   P4(Agent4): chips=4631, bet=210, status=active
2025-10-31 18:52:20,391 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:52:20,391 - poker_game - INFO - ==================================================
2025-10-31 18:52:20,493 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "A♠",
    "10♥"
  ],
  "community": [
    "J♠",
    "9♠",
    "2♥",
    "4♣"
  ],
  "your_chips": 2898,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 200,
  "pot": 630,
  "to_call": 210,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1841,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4631,
      "bet": 210,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (210)",
    "raise (min 230)",
    "all-in (2898)"
  ],
  "history": [
    "Player 4 called 10",
    "Player 1 checked",
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210"
  ]
}
2025-10-31 18:52:20,501 - poker_game - DEBUG - Create Session: {'id': 'f0d1a232-b6f1-4579-8cb6-aad44720a83b', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904340.4998744}
2025-10-31 18:52:23,237 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 210,\n  "reasoning": "現在のターン（Turn）の状況で、あなたの手札はA♠ 10♥、コミュニティカードはJ♠ 9♠ 2♥ 4♣です。あなたの手札とコミュニティカードを組み合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣となり、ストレート（連続した数字）やフラッシュ（同じスート）は成立していません。しかし、A♠ J♠ 9♠ のカードがあり、フラッシュの可能性（同じスートが5枚揃うこと）が残っています。相手（Player 4）は210をベットしました。あなたはコール（相手のベット額と同じ額を払うこと）することで、次のリバー（River）のカードを見て、より強い役（例えばフラッシュ）を完成させる可能性があります。フォールド（相手のベット額を払わずに勝負を降りること）すると、それまでにつぎ込んだチップが無駄になります。レイズ（相手のベット額よりもさらに多くベットすること）は、現時点ではより強い役が完成していないため、リスクが高いと判断しました。したがって、コールが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 276, 'promptTokenCount': 805, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 805}], 'totalTokenCount': 1081}, 'invocationId': 'e-9c6c2de7-594e-4531-ab99-b273e6ed9db0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'saolwXPA', 'timestamp': 1761904340.510358}]
2025-10-31 18:52:23,237 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:52:23,237 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 210,
  "reasoning": "現在のターン（Turn）の状況で、あなたの手札はA♠ 10♥、コミュニティカードはJ♠ 9♠ 2♥ 4♣です。あなたの手札とコミュニティカードを組み合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣となり、ストレート（連続した数字）やフラッシュ（同じスート）は成立していません。しかし、A♠ J♠ 9♠ のカードがあり、フラッシュの可能性（同じスートが5枚揃うこと）が残っています。相手（Player 4）は210をベットしました。あなたはコール（相手のベット額と同じ額を払うこと）することで、次のリバー（River）のカードを見て、より強い役（例えばフラッシュ）を完成させる可能性があります。フォールド（相手のベット額を払わずに勝負を降りること）すると、それまでにつぎ込んだチップが無駄になります。レイズ（相手のベット額よりもさらに多くベットすること）は、現時点ではより強い役が完成していないため、リスクが高いと判断しました。したがって、コールが最善の選択です。"
}
```
2025-10-31 18:52:23,237 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:52:23,237 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 210,\n  "reasoning": "現在のターン（Turn）の状況で、あなたの手札はA♠ 10♥、コミュニティカードはJ♠ 9♠ 2♥ 4♣です。あなたの手札とコミュニティカードを組み合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣となり、ストレート（連続した数字）やフラッシュ（同じスート）は成立していません。しかし、A♠ J♠ 9♠ のカードがあり、フラッシュの可能性（同じスートが5枚揃うこと）が残っています。相手（Player 4）は210をベットしました。あなたはコール（相手のベット額と同じ額を払うこと）することで、次のリバー（River）のカードを見て、より強い役（例えばフラッシュ）を完成させる可能性があります。フォールド（相手のベット額を払わずに勝負を降りること）すると、それまでにつぎ込んだチップが無駄になります。レイズ（相手のベット額よりもさらに多くベットすること）は、現時点ではより強い役が完成していないため、リスクが高いと判断しました。したがって、コールが最善の選択です。"\n}\n```'
2025-10-31 18:52:23,238 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:52:23,238 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 210,\n  "reasoning": "現在のターン（Turn）の状況で、あなたの手札はA♠ 10♥、コミュニティカードはJ♠ 9♠ 2♥ 4♣です。あなたの手札とコミュニティカードを組み合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣となり、ストレート（連続した数字）やフラッシュ（同じスート）は成立していません。しかし、A♠ J♠ 9♠ のカードがあり、フラッシュの可能性（同じスートが5枚揃うこと）が残っています。相手（Player 4）は210をベットしました。あなたはコール（相手のベット額と同じ額を払うこと）することで、次のリバー（River）のカードを見て、より強い役（例えばフラッシュ）を完成させる可能性があります。フォールド（相手のベット額を払わずに勝負を降りること）すると、それまでにつぎ込んだチップが無駄になります。レイズ（相手のベット額よりもさらに多くベットすること）は、現時点ではより強い役が完成していないため、リスクが高いと判断しました。したがって、コールが最善の選択です。"\n}'
2025-10-31 18:52:23,238 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 210,
  "reasoning": "現在のターン（Turn）の状況で、あなたの手札はA♠ 10♥、コミュニティカードはJ♠ 9♠ 2♥ 4♣です。あなたの手札とコミュニティカードを組み合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣となり、ストレート（連続した数字）やフラッシュ（同じスート）は成立していません。しかし、A♠ J♠ 9♠ のカードがあり、フラッシュの可能性（同じスートが5枚揃うこと）が残っています。相手（Player 4）は210をベットしました。あなたはコール（相手のベット額と同じ額を払うこと）することで、次のリバー（River）のカードを見て、より強い役（例えばフラッシュ）を完成させる可能性があります。フォールド（相手のベット額を払わずに勝負を降りること）すると、それまでにつぎ込んだチップが無駄になります。レイズ（相手のベット額よりもさらに多くベットすること）は、現時点ではより強い役が完成していないため、リスクが高いと判断しました。したがって、コールが最善の選択です。"
}
2025-10-31 18:52:23,238 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 210, 'reasoning': '現在のターン（Turn）の状況で、あなたの手札はA♠ 10♥、コミュニティカードはJ♠ 9♠ 2♥ 4♣です。あなたの手札とコミュニティカードを組み合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣となり、ストレート（連続した数字）やフラッシュ（同じスート）は成立していません。しかし、A♠ J♠ 9♠ のカードがあり、フラッシュの可能性（同じスートが5枚揃うこと）が残っています。相手（Player 4）は210をベットしました。あなたはコール（相手のベット額と同じ額を払うこと）することで、次のリバー（River）のカードを見て、より強い役（例えばフラッシュ）を完成させる可能性があります。フォールド（相手のベット額を払わずに勝負を降りること）すると、それまでにつぎ込んだチップが無駄になります。レイズ（相手のベット額よりもさらに多くベットすること）は、現時点ではより強い役が完成していないため、リスクが高いと判断しました。したがって、コールが最善の選択です。'}
2025-10-31 18:52:23,238 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 210
2025-10-31 18:52:23,239 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (210)', 'raise (min 230)', 'all-in (2898)']
2025-10-31 18:52:23,239 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (210)': 210
2025-10-31 18:52:23,239 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 210}
2025-10-31 18:52:23,239 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 210, 現在のターン（Turn）の状況で、あなたの手札はA♠ 10♥、コミュニティカードはJ♠ 9♠ 2♥ 4♣です。あなたの手札とコミュニティカードを組み合わせると、A♠ J♠ 10♥ 9♠ 2♥ 4♣となり、ストレート（連続した数字）やフラッシュ（同じスート）は成立していません。しかし、A♠ J♠ 9♠ のカードがあり、フラッシュの可能性（同じスートが5枚揃うこと）が残っています。相手（Player 4）は210をベットしました。あなたはコール（相手のベット額と同じ額を払うこと）することで、次のリバー（River）のカードを見て、より強い役（例えばフラッシュ）を完成させる可能性があります。フォールド（相手のベット額を払わずに勝負を降りること）すると、それまでにつぎ込んだチップが無駄になります。レイズ（相手のベット額よりもさらに多くベットすること）は、現時点ではより強い役が完成していないため、リスクが高いと判断しました。したがって、コールが最善の選択です。
2025-10-31 18:52:23,240 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 210
2025-10-31 18:52:23,240 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:52:23,240 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:23,240 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:23,240 - poker_game - INFO - Pot: 630, Current bet: 210
2025-10-31 18:52:23,241 - poker_game - INFO - Last raiser: 4
2025-10-31 18:52:23,241 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:23,241 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:23,241 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:23,241 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:23,241 - poker_game - INFO -   P1(Agent1): chips=2898, bet=0, status=active
2025-10-31 18:52:23,241 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:23,241 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:23,241 - poker_game - INFO -   P4(Agent4): chips=4631, bet=210, status=active
2025-10-31 18:52:23,241 - poker_game - INFO - ==================================================
2025-10-31 18:52:23,242 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 210
2025-10-31 18:52:23,254 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:52:23,254 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:23,254 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:23,255 - poker_game - INFO - Pot: 840, Current bet: 210
2025-10-31 18:52:23,255 - poker_game - INFO - Last raiser: 4
2025-10-31 18:52:23,255 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:23,255 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:23,256 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:23,256 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:23,256 - poker_game - INFO -   P1(Agent1): chips=2688, bet=210, status=active
2025-10-31 18:52:23,256 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:23,256 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:23,256 - poker_game - INFO -   P4(Agent4): chips=4631, bet=210, status=active
2025-10-31 18:52:23,257 - poker_game - INFO - Extra: Action: Player 1 called 210
2025-10-31 18:52:23,257 - poker_game - INFO - ==================================================
2025-10-31 18:52:23,257 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:52:23,257 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:52:23,257 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:52:23,257 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:52:23,257 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:52:23,258 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:52:23,258 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:52:23,258 - poker_game - DEBUG - Player bets: [210, 210], Current bet: 210, All same: True
2025-10-31 18:52:23,258 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:52:23,258 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:52:23,258 - poker_game - INFO - Hand #10, Phase: turn
2025-10-31 18:52:23,258 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:52:23,259 - poker_game - INFO - Pot: 840, Current bet: 210
2025-10-31 18:52:23,259 - poker_game - INFO - Last raiser: 4
2025-10-31 18:52:23,259 - poker_game - INFO - Betting round complete: True
2025-10-31 18:52:23,259 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:23,259 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣']
2025-10-31 18:52:23,259 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:23,260 - poker_game - INFO -   P1(Agent1): chips=2688, bet=210, status=active
2025-10-31 18:52:23,260 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:23,260 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:23,260 - poker_game - INFO -   P4(Agent4): chips=4631, bet=210, status=active
2025-10-31 18:52:23,260 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:52:23,260 - poker_game - INFO - ==================================================
2025-10-31 18:52:23,361 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:52:23,361 - poker_game - INFO - Betting round complete: True
2025-10-31 18:52:23,362 - poker_game - INFO - Remaining players: 2
2025-10-31 18:52:23,362 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:52:23,363 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:52:23,363 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:52:23,372 - poker_game - INFO - Starting new betting round
2025-10-31 18:52:23,372 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:52:23,373 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:52:23,373 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 18:52:23,373 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:52:23,373 - poker_game - INFO - First actor: Player 1 (by phase rule), was 4
2025-10-31 18:52:23,374 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:52:23,374 - poker_game - INFO - Hand #10, Phase: river
2025-10-31 18:52:23,375 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:23,375 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:52:23,375 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:23,376 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:23,376 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:23,377 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:52:23,377 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:23,377 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:52:23,378 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:23,378 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:23,379 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=active
2025-10-31 18:52:23,379 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:52:23,380 - poker_game - INFO - ==================================================
2025-10-31 18:52:23,381 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "A♠",
    "10♥"
  ],
  "community": [
    "J♠",
    "9♠",
    "2♥",
    "4♣",
    "5♠"
  ],
  "your_chips": 2688,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 410,
  "pot": 840,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1841,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4631,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (2688)"
  ],
  "history": [
    "Flop dealt: A♠, 5♠, 7♠",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠"
  ]
}
2025-10-31 18:52:23,390 - poker_game - DEBUG - Create Session: {'id': '49da0d1f-4301-4244-9f64-b1140048724d', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904343.3882253}
2025-10-31 18:52:25,494 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ストリート）で、コミュニティカード（場に開かれたカード）は「J♠」「9♠」「2♥」「4♣」「5♠」です。手札は「A♠」「10♥」なので、ストレート（連続した数字の役）やフラッシュ（同じスートの役）は完成しません。しかし、「A♠」と「J♠」「9♠」「5♠」でフラッシュの可能性が僅かにありますが、相手のAハイフラッシュを上回ることはできません。相手のベット額が不明なため、チェックして相手の出方を見るのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 165, 'promptTokenCount': 805, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 805}], 'totalTokenCount': 970}, 'invocationId': 'e-48473de5-c31a-4f3c-afdb-7a2779b8135d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'BianXhKf', 'timestamp': 1761904343.400043}]
2025-10-31 18:52:25,495 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:52:25,495 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ストリート）で、コミュニティカード（場に開かれたカード）は「J♠」「9♠」「2♥」「4♣」「5♠」です。手札は「A♠」「10♥」なので、ストレート（連続した数字の役）やフラッシュ（同じスートの役）は完成しません。しかし、「A♠」と「J♠」「9♠」「5♠」でフラッシュの可能性が僅かにありますが、相手のAハイフラッシュを上回ることはできません。相手のベット額が不明なため、チェックして相手の出方を見るのが最善です。"
}
```
2025-10-31 18:52:25,495 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:52:25,495 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ストリート）で、コミュニティカード（場に開かれたカード）は「J♠」「9♠」「2♥」「4♣」「5♠」です。手札は「A♠」「10♥」なので、ストレート（連続した数字の役）やフラッシュ（同じスートの役）は完成しません。しかし、「A♠」と「J♠」「9♠」「5♠」でフラッシュの可能性が僅かにありますが、相手のAハイフラッシュを上回ることはできません。相手のベット額が不明なため、チェックして相手の出方を見るのが最善です。"\n}\n```'
2025-10-31 18:52:25,495 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:52:25,496 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ストリート）で、コミュニティカード（場に開かれたカード）は「J♠」「9♠」「2♥」「4♣」「5♠」です。手札は「A♠」「10♥」なので、ストレート（連続した数字の役）やフラッシュ（同じスートの役）は完成しません。しかし、「A♠」と「J♠」「9♠」「5♠」でフラッシュの可能性が僅かにありますが、相手のAハイフラッシュを上回ることはできません。相手のベット額が不明なため、チェックして相手の出方を見るのが最善です。"\n}'
2025-10-31 18:52:25,496 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ストリート）で、コミュニティカード（場に開かれたカード）は「J♠」「9♠」「2♥」「4♣」「5♠」です。手札は「A♠」「10♥」なので、ストレート（連続した数字の役）やフラッシュ（同じスートの役）は完成しません。しかし、「A♠」と「J♠」「9♠」「5♠」でフラッシュの可能性が僅かにありますが、相手のAハイフラッシュを上回ることはできません。相手のベット額が不明なため、チェックして相手の出方を見るのが最善です。"
}
2025-10-31 18:52:25,496 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最終ストリート）で、コミュニティカード（場に開かれたカード）は「J♠」「9♠」「2♥」「4♣」「5♠」です。手札は「A♠」「10♥」なので、ストレート（連続した数字の役）やフラッシュ（同じスートの役）は完成しません。しかし、「A♠」と「J♠」「9♠」「5♠」でフラッシュの可能性が僅かにありますが、相手のAハイフラッシュを上回ることはできません。相手のベット額が不明なため、チェックして相手の出方を見るのが最善です。'}
2025-10-31 18:52:25,496 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 18:52:25,496 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 18:52:25,496 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:52:25,496 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, リバー（最終ストリート）で、コミュニティカード（場に開かれたカード）は「J♠」「9♠」「2♥」「4♣」「5♠」です。手札は「A♠」「10♥」なので、ストレート（連続した数字の役）やフラッシュ（同じスートの役）は完成しません。しかし、「A♠」と「J♠」「9♠」「5♠」でフラッシュの可能性が僅かにありますが、相手のAハイフラッシュを上回ることはできません。相手のベット額が不明なため、チェックして相手の出方を見るのが最善です。
2025-10-31 18:52:25,499 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 18:52:25,499 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:52:25,499 - poker_game - INFO - Hand #10, Phase: river
2025-10-31 18:52:25,499 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:25,500 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:52:25,500 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:25,500 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:25,500 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:25,501 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:52:25,501 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:25,501 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:52:25,501 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:25,501 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:25,501 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=active
2025-10-31 18:52:25,502 - poker_game - INFO - ==================================================
2025-10-31 18:52:25,502 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:52:25,515 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:52:25,515 - poker_game - INFO - Hand #10, Phase: river
2025-10-31 18:52:25,516 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:52:25,516 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:52:25,516 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:25,516 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:25,516 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:25,517 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:52:25,517 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:25,517 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:52:25,517 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:25,518 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:25,518 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=active
2025-10-31 18:52:25,518 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:52:25,518 - poker_game - INFO - ==================================================
2025-10-31 18:52:25,518 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:52:25,519 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:52:25,519 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:52:25,519 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:52:25,519 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:52:25,519 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:52:25,519 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:52:25,519 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:52:25,519 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:52:25,519 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:52:25,519 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:52:25,519 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:52:25,520 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 1
2025-10-31 18:52:25,520 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:52:25,520 - poker_game - INFO - Hand #10, Phase: river
2025-10-31 18:52:25,520 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:52:25,520 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:52:25,520 - poker_game - INFO - Last raiser: None
2025-10-31 18:52:25,520 - poker_game - INFO - Betting round complete: False
2025-10-31 18:52:25,521 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:52:25,521 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:52:25,521 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:52:25,521 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:52:25,521 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:52:25,521 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:52:25,522 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=active
2025-10-31 18:52:25,522 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:52:25,522 - poker_game - INFO - ==================================================
2025-10-31 18:52:25,623 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "6♦",
    "6♣"
  ],
  "community": [
    "J♠",
    "9♠",
    "2♥",
    "4♣",
    "5♠"
  ],
  "your_chips": 4631,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 410,
  "pot": 840,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2688,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1841,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4631)"
  ],
  "history": [
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 10♠",
    "Player 4 folded",
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked"
  ]
}
2025-10-31 18:52:25,632 - poker_game - DEBUG - Create Session: {'id': 'fee58684-b5e5-429b-9817-c5bf7c11ecd7', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904345.630417}
2025-10-31 18:52:37,673 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:52:45,820 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 18:52:55,823 - poker_game - INFO - Waiting for LLM API response for Agent4... 30 seconds elapsed
2025-10-31 18:53:01,226 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_79W3RgABEBOqMREUp5UaL8PV', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1112, 'totalTokenCount': 1129}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IC2W6gzs', 'timestamp': 1761904345.64187}, {'content': {'parts': [{'functionResponse': {'id': 'call_79W3RgABEBOqMREUp5UaL8PV', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'XqKs5c26', 'timestamp': 1761904346.839694}, {'content': {'parts': [{'functionCall': {'id': 'call_YDc0eXsFdBATzRkXxvLeq9RZ', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1636, 'totalTokenCount': 1656}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '0ZPpOQCN', 'timestamp': 1761904346.843347}, {'content': {'parts': [{'functionResponse': {'id': 'call_YDc0eXsFdBATzRkXxvLeq9RZ', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '3JZJHfiC', 'timestamp': 1761904348.384573}, {'content': {'parts': [{'functionCall': {'id': 'call_RBEMYorrtVIBwnA89yQCwOfV', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1198, 'totalTokenCount': 1215}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ucauE6zp', 'timestamp': 1761904348.385991}, {'content': {'parts': [{'functionResponse': {'id': 'call_RBEMYorrtVIBwnA89yQCwOfV', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Hp7RhOp5', 'timestamp': 1761904349.513625}, {'content': {'parts': [{'functionCall': {'id': 'call_iZIyPSh0ndeRFdKo4u06Y3XK', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1728, 'totalTokenCount': 1748}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'QYVY1fNF', 'timestamp': 1761904349.515648}, {'content': {'parts': [{'functionResponse': {'id': 'call_iZIyPSh0ndeRFdKo4u06Y3XK', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'fUFZBkKE', 'timestamp': 1761904350.808443}, {'content': {'parts': [{'functionCall': {'id': 'call_eakmV1ms3lPpHmcC7J2qbYwi', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1284, 'totalTokenCount': 1301}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'KPmBYKD5', 'timestamp': 1761904350.813227}, {'content': {'parts': [{'functionResponse': {'id': 'call_eakmV1ms3lPpHmcC7J2qbYwi', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'aCvyg8Y6', 'timestamp': 1761904351.873002}, {'content': {'parts': [{'functionCall': {'id': 'call_0d4DPFPFei3LXRFGEbk6RbH7', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1820, 'totalTokenCount': 1840}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'kRnq5QKy', 'timestamp': 1761904351.876294}, {'content': {'parts': [{'functionResponse': {'id': 'call_0d4DPFPFei3LXRFGEbk6RbH7', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'Hc8WGQ7u', 'timestamp': 1761904352.921353}, {'content': {'parts': [{'functionCall': {'id': 'call_EE0MycwrSc1ttOCJhfhhgVxk', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1370, 'totalTokenCount': 1387}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'dEClNA57', 'timestamp': 1761904352.923619}, {'content': {'parts': [{'functionResponse': {'id': 'call_EE0MycwrSc1ttOCJhfhhgVxk', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'UrgxJXPu', 'timestamp': 1761904353.7739}, {'content': {'parts': [{'functionCall': {'id': 'call_ALWTUKxFOf2L7sY1ukPLB9w9', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1912, 'totalTokenCount': 1932}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Izoxvw1Y', 'timestamp': 1761904353.783653}, {'content': {'parts': [{'functionResponse': {'id': 'call_ALWTUKxFOf2L7sY1ukPLB9w9', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '387DjDpn', 'timestamp': 1761904354.894534}, {'content': {'parts': [{'functionCall': {'id': 'call_JLvoLchAPHZd3b1FQDQTRD9X', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1456, 'totalTokenCount': 1473}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'L4XpYqRV', 'timestamp': 1761904354.899837}, {'content': {'parts': [{'functionResponse': {'id': 'call_JLvoLchAPHZd3b1FQDQTRD9X', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Up1n4jRC', 'timestamp': 1761904353.277763}, {'content': {'parts': [{'functionCall': {'id': 'call_o8ac0wIQMHCjtN9VrhmWAUnH', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2004, 'totalTokenCount': 2024}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'a1ZxbUuo', 'timestamp': 1761904353.281043}, {'content': {'parts': [{'functionResponse': {'id': 'call_o8ac0wIQMHCjtN9VrhmWAUnH', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '1DIfnfcU', 'timestamp': 1761904355.098853}, {'content': {'parts': [{'functionCall': {'id': 'call_7XPtx2Aa8efoj64QQYbC8oN2', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1542, 'totalTokenCount': 1559}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'WHOdoWBT', 'timestamp': 1761904355.101474}, {'content': {'parts': [{'functionResponse': {'id': 'call_7XPtx2Aa8efoj64QQYbC8oN2', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '1SyPLI9j', 'timestamp': 1761904356.072542}, {'content': {'parts': [{'functionCall': {'id': 'call_1J1xBqhKZpc0AmoTlKgWXv90', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2096, 'totalTokenCount': 2116}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '92OnaweN', 'timestamp': 1761904356.075736}, {'content': {'parts': [{'functionResponse': {'id': 'call_1J1xBqhKZpc0AmoTlKgWXv90', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '5E4e1MW3', 'timestamp': 1761904357.499637}, {'content': {'parts': [{'functionCall': {'id': 'call_xGhBrtiseliafewdDqUEqKWv', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1628, 'totalTokenCount': 1645}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '4xg79imy', 'timestamp': 1761904357.506231}, {'content': {'parts': [{'functionResponse': {'id': 'call_xGhBrtiseliafewdDqUEqKWv', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '8DvzWKjW', 'timestamp': 1761904358.527515}, {'content': {'parts': [{'functionCall': {'id': 'call_mEzqMAv52TzTDTRXRkyHUCov', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2188, 'totalTokenCount': 2208}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'aheeSCHr', 'timestamp': 1761904358.535185}, {'content': {'parts': [{'functionResponse': {'id': 'call_mEzqMAv52TzTDTRXRkyHUCov', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'vPvhACZA', 'timestamp': 1761904360.403629}, {'content': {'parts': [{'functionCall': {'id': 'call_cGW5WChwH7AsfrNc2wtR6bim', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1714, 'totalTokenCount': 1731}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ZATPvUGB', 'timestamp': 1761904360.413411}, {'content': {'parts': [{'functionResponse': {'id': 'call_cGW5WChwH7AsfrNc2wtR6bim', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'BgR3NQ7a', 'timestamp': 1761904361.7938}, {'content': {'parts': [{'functionCall': {'id': 'call_usXIfIKBtD3fzZ7vEaLZ9POE', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2280, 'totalTokenCount': 2300}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'RxHFjDNl', 'timestamp': 1761904361.802089}, {'content': {'parts': [{'functionResponse': {'id': 'call_usXIfIKBtD3fzZ7vEaLZ9POE', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'TWXmYmoV', 'timestamp': 1761904363.648326}, {'content': {'parts': [{'functionCall': {'id': 'call_RvccFJVqON70dhwBB6HbpACD', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1800, 'totalTokenCount': 1817}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'zWf4dLYF', 'timestamp': 1761904363.65528}, {'content': {'parts': [{'functionResponse': {'id': 'call_RvccFJVqON70dhwBB6HbpACD', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'HSfmC3kS', 'timestamp': 1761904364.606319}, {'content': {'parts': [{'functionCall': {'id': 'call_VFPHYQ95pIChP6GexRMJieUX', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2372, 'totalTokenCount': 2392}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'VICzxgOh', 'timestamp': 1761904364.621343}, {'content': {'parts': [{'functionResponse': {'id': 'call_VFPHYQ95pIChP6GexRMJieUX', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'TjFW18AH', 'timestamp': 1761904366.060608}, {'content': {'parts': [{'functionCall': {'id': 'call_po3cocQKIXJfIprgpF4YRtYd', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1886, 'totalTokenCount': 1903}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'AIn4ZL12', 'timestamp': 1761904366.065207}, {'content': {'parts': [{'functionResponse': {'id': 'call_po3cocQKIXJfIprgpF4YRtYd', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'xI8ToTmP', 'timestamp': 1761904367.106602}, {'content': {'parts': [{'functionCall': {'id': 'call_KKLP4L47yX1vWNfyM0zrQGix', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2464, 'totalTokenCount': 2484}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'N6VGMCSP', 'timestamp': 1761904367.118347}, {'content': {'parts': [{'functionResponse': {'id': 'call_KKLP4L47yX1vWNfyM0zrQGix', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'H1K4y3Lq', 'timestamp': 1761904368.535267}, {'content': {'parts': [{'functionCall': {'id': 'call_91zvcVAlCEgLVBZ8hHhvJaHY', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1972, 'totalTokenCount': 1989}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'L5ZmHuNe', 'timestamp': 1761904368.539647}, {'content': {'parts': [{'functionResponse': {'id': 'call_91zvcVAlCEgLVBZ8hHhvJaHY', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'hCtQwJMi', 'timestamp': 1761904369.74301}, {'content': {'parts': [{'functionCall': {'id': 'call_mzPlake6DBlnXiKbEx4AYeGp', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2556, 'totalTokenCount': 2576}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ifo2X4P8', 'timestamp': 1761904369.76093}, {'content': {'parts': [{'functionResponse': {'id': 'call_mzPlake6DBlnXiKbEx4AYeGp', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'iWuNNtF1', 'timestamp': 1761904371.822}, {'content': {'parts': [{'functionCall': {'id': 'call_zP0E0V4s1QFbUTBfO2sFINOc', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 2058, 'totalTokenCount': 2075}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'PGHhxKKV', 'timestamp': 1761904371.831726}, {'content': {'parts': [{'functionResponse': {'id': 'call_zP0E0V4s1QFbUTBfO2sFINOc', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'vq5fUBuy', 'timestamp': 1761904373.090842}, {'content': {'parts': [{'functionCall': {'id': 'call_FNpvvP8zBSXZcHQXNgI4hZXd', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2648, 'totalTokenCount': 2668}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Rw4xsVyQ', 'timestamp': 1761904373.109401}, {'content': {'parts': [{'functionResponse': {'id': 'call_FNpvvP8zBSXZcHQXNgI4hZXd', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'QYmS4HBj', 'timestamp': 1761904374.284362}, {'content': {'parts': [{'functionCall': {'id': 'call_FVNQBpJYXbM9Xxf3bu7yCxWn', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 2144, 'totalTokenCount': 2161}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'syyhm1JX', 'timestamp': 1761904374.303021}, {'content': {'parts': [{'functionResponse': {'id': 'call_FVNQBpJYXbM9Xxf3bu7yCxWn', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'jRkw5aF0', 'timestamp': 1761904375.507151}, {'content': {'parts': [{'functionCall': {'id': 'call_CFTEdvhIQRNcqA15WIzmONbJ', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2740, 'totalTokenCount': 2760}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '06dDEYb1', 'timestamp': 1761904375.519491}, {'content': {'parts': [{'functionResponse': {'id': 'call_CFTEdvhIQRNcqA15WIzmONbJ', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'FuqYZ1Ne', 'timestamp': 1761904377.27092}, {'content': {'parts': [{'text': '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "相手がチェックし、リバーでの私の手札はペアの6のみで、ボード上のカードからはストレートやフラッシュの可能性が高いため、勝てる見込みが低いと判断しました。"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 80, 'promptTokenCount': 2230, 'totalTokenCount': 2310}, 'invocationId': 'e-e5ac7ad6-802a-4dce-9ddd-5dbc6764d41c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'PQJxMr9L', 'timestamp': 1761904377.294782}]
2025-10-31 18:53:01,228 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:53:01,230 - poker_game - DEBUG - {
  "action": "fold",
  "amount": 0,
  "reasoning": "相手がチェックし、リバーでの私の手札はペアの6のみで、ボード上のカードからはストレートやフラッシュの可能性が高いため、勝てる見込みが低いと判断しました。"
}
2025-10-31 18:53:01,231 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:53:01,232 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "相手がチェックし、リバーでの私の手札はペアの6のみで、ボード上のカードからはストレートやフラッシュの可能性が高いため、勝てる見込みが低いと判断しました。"\n}'
2025-10-31 18:53:01,232 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:53:01,232 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "相手がチェックし、リバーでの私の手札はペアの6のみで、ボード上のカードからはストレートやフラッシュの可能性が高いため、勝てる見込みが低いと判断しました。"
}
2025-10-31 18:53:01,233 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '相手がチェックし、リバーでの私の手札はペアの6のみで、ボード上のカードからはストレートやフラッシュの可能性が高いため、勝てる見込みが低いと判断しました。'}
2025-10-31 18:53:01,233 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:53:01,233 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:53:01,233 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:53:01,233 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 相手がチェックし、リバーでの私の手札はペアの6のみで、ボード上のカードからはストレートやフラッシュの可能性が高いため、勝てる見込みが低いと判断しました。
2025-10-31 18:53:01,235 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:53:01,236 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:01,236 - poker_game - INFO - Hand #10, Phase: river
2025-10-31 18:53:01,237 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:53:01,237 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:53:01,238 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:01,238 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:01,238 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:01,239 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:53:01,239 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:01,240 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:53:01,240 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:01,241 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:53:01,241 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=active
2025-10-31 18:53:01,241 - poker_game - INFO - ==================================================
2025-10-31 18:53:01,242 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:53:01,254 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:01,255 - poker_game - INFO - Hand #10, Phase: river
2025-10-31 18:53:01,255 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:53:01,255 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:53:01,256 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:01,256 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:01,256 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:53:01,257 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:53:01,257 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:01,258 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:53:01,258 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:01,258 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:53:01,259 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:53:01,259 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:53:01,260 - poker_game - INFO - ==================================================
2025-10-31 18:53:01,260 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:01,261 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:01,261 - poker_game - DEBUG - Active players: [1]
2025-10-31 18:53:01,261 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:53:01,262 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:01,262 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:01,262 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:53:01,262 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:53:01,263 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:01,263 - poker_game - INFO - Hand #10, Phase: river
2025-10-31 18:53:01,264 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:53:01,264 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:53:01,265 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:01,265 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:01,265 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:53:01,265 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:53:01,265 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:01,266 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:53:01,266 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:01,266 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:53:01,266 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:53:01,267 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:53:01,267 - poker_game - INFO - ==================================================
2025-10-31 18:53:01,368 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:53:01,368 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:01,369 - poker_game - INFO - Remaining players: 1
2025-10-31 18:53:01,369 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:53:01,370 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:53:01,370 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:53:01,370 - poker_game - INFO - Hand #10, Phase: showdown
2025-10-31 18:53:01,371 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:53:01,371 - poker_game - INFO - Pot: 840, Current bet: 0
2025-10-31 18:53:01,371 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:01,371 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:01,372 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:53:01,372 - poker_game - INFO - Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:53:01,373 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:01,373 - poker_game - INFO -   P1(Agent1): chips=2688, bet=0, status=active
2025-10-31 18:53:01,374 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:01,374 - poker_game - INFO -   P3(Agent3): chips=1841, bet=0, status=folded
2025-10-31 18:53:01,374 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:53:01,375 - poker_game - INFO - ==================================================
2025-10-31 18:53:01,375 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:53:01,376 - poker_game - INFO - Pot: 840, Community cards: ['J♠', '9♠', '2♥', '4♣', '5♠']
2025-10-31 18:53:01,376 - poker_game - INFO -   Player 1 status=active cards=['A♠', '10♥']
2025-10-31 18:53:01,377 - poker_game - INFO - Showdown winner by default: Player 1 awarded 840
2025-10-31 18:53:01,377 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:53:01,377 - poker_game - INFO - === STARTING NEW HAND #11 ===
2025-10-31 18:53:01,378 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:53:01,378 - poker_game - INFO - Moving dealer button
2025-10-31 18:53:01,379 - poker_game - INFO - Posting blinds
2025-10-31 18:53:01,405 - poker_game - INFO - Dealing hole cards
2025-10-31 18:53:01,406 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:53:01,417 - poker_game - INFO - Started new hand in database: hand_id=11
2025-10-31 18:53:01,418 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:53:01,418 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:01,419 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:53:01,419 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:01,419 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:01,420 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:01,420 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:53:01,421 - poker_game - INFO - Community cards: []
2025-10-31 18:53:01,421 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:01,422 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=active
2025-10-31 18:53:01,422 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:01,422 - poker_game - INFO -   P3(Agent3): chips=1831, bet=10, status=active
2025-10-31 18:53:01,423 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:01,423 - poker_game - INFO - ==================================================
2025-10-31 18:53:01,424 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "A♣",
    "7♣"
  ],
  "community": [],
  "your_chips": 3528,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1831,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (3528)"
  ],
  "history": [
    "Showdown: Player 1 won 40",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:53:01,435 - poker_game - DEBUG - Create Session: {'id': '59243af4-0880-444e-9e42-9ac079c45a50', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904381.4324682}
2025-10-31 18:53:05,320 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで、A7オフスート（異なるスートのAと7）は、特にレイズが入っている状況では弱いハンドです。コールするには20必要ですが、ポットのサイズ（30）と相手のレイズ（40）を考えると、勝てる確率が低いです。フォールドして、より良いハンドを待つのが賢明です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 111, 'promptTokenCount': 779, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 779}], 'totalTokenCount': 890}, 'invocationId': 'e-b36c3ac2-a518-41b9-a032-0667aa976a28', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'WJKXkSZ7', 'timestamp': 1761904381.449137}]
2025-10-31 18:53:05,321 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:53:05,321 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで、A7オフスート（異なるスートのAと7）は、特にレイズが入っている状況では弱いハンドです。コールするには20必要ですが、ポットのサイズ（30）と相手のレイズ（40）を考えると、勝てる確率が低いです。フォールドして、より良いハンドを待つのが賢明です。"
}
```
2025-10-31 18:53:05,322 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:53:05,322 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで、A7オフスート（異なるスートのAと7）は、特にレイズが入っている状況では弱いハンドです。コールするには20必要ですが、ポットのサイズ（30）と相手のレイズ（40）を考えると、勝てる確率が低いです。フォールドして、より良いハンドを待つのが賢明です。"\n}\n```'
2025-10-31 18:53:05,322 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:53:05,322 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで、A7オフスート（異なるスートのAと7）は、特にレイズが入っている状況では弱いハンドです。コールするには20必要ですが、ポットのサイズ（30）と相手のレイズ（40）を考えると、勝てる確率が低いです。フォールドして、より良いハンドを待つのが賢明です。"\n}'
2025-10-31 18:53:05,322 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで、A7オフスート（異なるスートのAと7）は、特にレイズが入っている状況では弱いハンドです。コールするには20必要ですが、ポットのサイズ（30）と相手のレイズ（40）を考えると、勝てる確率が低いです。フォールドして、より良いハンドを待つのが賢明です。"
}
2025-10-31 18:53:05,323 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップで、A7オフスート（異なるスートのAと7）は、特にレイズが入っている状況では弱いハンドです。コールするには20必要ですが、ポットのサイズ（30）と相手のレイズ（40）を考えると、勝てる確率が低いです。フォールドして、より良いハンドを待つのが賢明です。'}
2025-10-31 18:53:05,323 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:53:05,323 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:53:05,324 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:53:05,324 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップで、A7オフスート（異なるスートのAと7）は、特にレイズが入っている状況では弱いハンドです。コールするには20必要ですが、ポットのサイズ（30）と相手のレイズ（40）を考えると、勝てる確率が低いです。フォールドして、より良いハンドを待つのが賢明です。
2025-10-31 18:53:05,325 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:53:05,326 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:05,326 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:05,326 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:53:05,327 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:05,327 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:05,327 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:05,328 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:53:05,328 - poker_game - INFO - Community cards: []
2025-10-31 18:53:05,329 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:05,330 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=active
2025-10-31 18:53:05,330 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:05,331 - poker_game - INFO -   P3(Agent3): chips=1831, bet=10, status=active
2025-10-31 18:53:05,331 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:05,332 - poker_game - INFO - ==================================================
2025-10-31 18:53:05,333 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:53:05,353 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:05,353 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:05,354 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:53:05,354 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:05,355 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:05,355 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:05,355 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:05,356 - poker_game - INFO - Community cards: []
2025-10-31 18:53:05,356 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:05,356 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:05,356 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:05,357 - poker_game - INFO -   P3(Agent3): chips=1831, bet=10, status=active
2025-10-31 18:53:05,357 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:05,357 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:53:05,358 - poker_game - INFO - ==================================================
2025-10-31 18:53:05,358 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:05,359 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:05,359 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:53:05,359 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:53:05,359 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:05,360 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:05,360 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:53:05,360 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 18:53:05,360 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:53:05,360 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:05,361 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:05,361 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:05,362 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:05,362 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:05,362 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:05,363 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:05,363 - poker_game - INFO - Community cards: []
2025-10-31 18:53:05,364 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:05,364 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:05,364 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:05,365 - poker_game - INFO -   P3(Agent3): chips=1831, bet=10, status=active
2025-10-31 18:53:05,366 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:05,366 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:53:05,366 - poker_game - INFO - ==================================================
2025-10-31 18:53:00,338 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "7♥",
    "Q♦"
  ],
  "community": [],
  "your_chips": 1831,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3528,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1831)"
  ],
  "history": [
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded"
  ]
}
2025-10-31 18:53:00,352 - poker_game - DEBUG - Create Session: {'id': '67cab2b4-adce-4ff8-a46e-4dd288cf90ed', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904380.349422}
2025-10-31 18:53:02,489 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（カードが配られた直後）の状況です。手札は7♥Q♦で、これは「クイーン・セブンオフスーツ」と呼ばれ、標準的な強さの手札です。ポットには30チップあり、コールするには10チップが必要です。対戦相手は2人いますが、すでに1人はフォールドしています。残りの対戦相手（プレイヤー4）は20チップをベットしており、コールには10チップが必要です。この状況では、手札の潜在能力を考慮してコールするのが合理的です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 147, 'promptTokenCount': 774, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 774}], 'totalTokenCount': 921}, 'invocationId': 'e-3a06435d-8197-4c1d-89c2-09b2589d2731', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '1YPd5pSR', 'timestamp': 1761904380.369292}]
2025-10-31 18:53:02,490 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:53:02,490 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップ（カードが配られた直後）の状況です。手札は7♥Q♦で、これは「クイーン・セブンオフスーツ」と呼ばれ、標準的な強さの手札です。ポットには30チップあり、コールするには10チップが必要です。対戦相手は2人いますが、すでに1人はフォールドしています。残りの対戦相手（プレイヤー4）は20チップをベットしており、コールには10チップが必要です。この状況では、手札の潜在能力を考慮してコールするのが合理的です。"
}
```
2025-10-31 18:53:02,491 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:53:02,491 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（カードが配られた直後）の状況です。手札は7♥Q♦で、これは「クイーン・セブンオフスーツ」と呼ばれ、標準的な強さの手札です。ポットには30チップあり、コールするには10チップが必要です。対戦相手は2人いますが、すでに1人はフォールドしています。残りの対戦相手（プレイヤー4）は20チップをベットしており、コールには10チップが必要です。この状況では、手札の潜在能力を考慮してコールするのが合理的です。"\n}\n```'
2025-10-31 18:53:02,492 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:53:02,492 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（カードが配られた直後）の状況です。手札は7♥Q♦で、これは「クイーン・セブンオフスーツ」と呼ばれ、標準的な強さの手札です。ポットには30チップあり、コールするには10チップが必要です。対戦相手は2人いますが、すでに1人はフォールドしています。残りの対戦相手（プレイヤー4）は20チップをベットしており、コールには10チップが必要です。この状況では、手札の潜在能力を考慮してコールするのが合理的です。"\n}'
2025-10-31 18:53:02,492 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップ（カードが配られた直後）の状況です。手札は7♥Q♦で、これは「クイーン・セブンオフスーツ」と呼ばれ、標準的な強さの手札です。ポットには30チップあり、コールするには10チップが必要です。対戦相手は2人いますが、すでに1人はフォールドしています。残りの対戦相手（プレイヤー4）は20チップをベットしており、コールには10チップが必要です。この状況では、手札の潜在能力を考慮してコールするのが合理的です。"
}
2025-10-31 18:53:02,492 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップ（カードが配られた直後）の状況です。手札は7♥Q♦で、これは「クイーン・セブンオフスーツ」と呼ばれ、標準的な強さの手札です。ポットには30チップあり、コールするには10チップが必要です。対戦相手は2人いますが、すでに1人はフォールドしています。残りの対戦相手（プレイヤー4）は20チップをベットしており、コールには10チップが必要です。この状況では、手札の潜在能力を考慮してコールするのが合理的です。'}
2025-10-31 18:53:02,493 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 10
2025-10-31 18:53:02,493 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (1831)']
2025-10-31 18:53:02,493 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (10)': 10
2025-10-31 18:53:02,493 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:53:02,494 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 10, プリフロップ（カードが配られた直後）の状況です。手札は7♥Q♦で、これは「クイーン・セブンオフスーツ」と呼ばれ、標準的な強さの手札です。ポットには30チップあり、コールするには10チップが必要です。対戦相手は2人いますが、すでに1人はフォールドしています。残りの対戦相手（プレイヤー4）は20チップをベットしており、コールには10チップが必要です。この状況では、手札の潜在能力を考慮してコールするのが合理的です。
2025-10-31 18:53:02,495 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 10
2025-10-31 18:53:02,496 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:02,497 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:02,498 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:02,498 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:02,499 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:02,499 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:02,500 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:02,501 - poker_game - INFO - Community cards: []
2025-10-31 18:53:02,501 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:02,501 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:02,502 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:02,502 - poker_game - INFO -   P3(Agent3): chips=1831, bet=10, status=active
2025-10-31 18:53:02,503 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:02,504 - poker_game - INFO - ==================================================
2025-10-31 18:53:02,504 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 10
2025-10-31 18:53:02,517 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:02,518 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:02,518 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:02,519 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:53:02,519 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:02,519 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:02,520 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:02,520 - poker_game - INFO - Community cards: []
2025-10-31 18:53:02,520 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:02,521 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:02,521 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:02,521 - poker_game - INFO -   P3(Agent3): chips=1821, bet=20, status=active
2025-10-31 18:53:02,522 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:02,522 - poker_game - INFO - Extra: Action: Player 3 called 10
2025-10-31 18:53:02,522 - poker_game - INFO - ==================================================
2025-10-31 18:53:02,522 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:02,523 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:02,523 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:53:02,523 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:53:02,523 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:02,523 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:02,524 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:53:02,524 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:53:02,524 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:53:02,524 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:53:02,524 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:53:02,524 - poker_game - DEBUG - Next after last raiser 4: 3
2025-10-31 18:53:02,525 - poker_game - DEBUG - Betting continues: Current player 4 != next after raiser 3
2025-10-31 18:53:02,525 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:02,525 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:02,525 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:02,526 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:53:02,526 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:02,526 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:02,527 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:02,527 - poker_game - INFO - Community cards: []
2025-10-31 18:53:02,528 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:02,528 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:02,529 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:02,529 - poker_game - INFO -   P3(Agent3): chips=1821, bet=20, status=active
2025-10-31 18:53:02,529 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:02,530 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:53:02,530 - poker_game - INFO - ==================================================
2025-10-31 18:53:02,632 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "8♣",
    "2♣"
  ],
  "community": [],
  "your_chips": 4611,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3528,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1821,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (4611)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 called 20",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10"
  ]
}
2025-10-31 18:53:02,645 - poker_game - DEBUG - Create Session: {'id': '56485d97-6fe2-4b9b-869e-1344c70cd424', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904382.6424766}
2025-10-31 18:53:12,702 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:53:22,754 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 18:53:23,283 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_Ifmjcbf926dXSxdCr7yAL7R8', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1087, 'totalTokenCount': 1104}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'gosVPzw3', 'timestamp': 1761904382.659258}, {'content': {'parts': [{'functionResponse': {'id': 'call_Ifmjcbf926dXSxdCr7yAL7R8', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'x9MiOOdG', 'timestamp': 1761904383.657242}, {'content': {'parts': [{'functionCall': {'id': 'call_Y8zkzIOsUCzVu0u1M2A8wBuK', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['8♣', '2♣'], 'community': [], 'your_chips': 4611, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3528, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1821, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (4611)],', 'history']}}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_2UuBwXoOSVXufiOxYH64yhJB', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['8♣', '2♣'], 'community': [], 'your_chips': 4611, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3528, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1821, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (4611)'], 'history': ['Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 raised to 60', 'Player 3 folded', 'Player 4 called 40', 'Flop dealt: J♠, 9♠, 2♥', 'Player 1 raised to 140', 'Player 4 called 140', 'Turn dealt: 4♣', 'Player 1 checked', 'Player 4 raised to 210', 'Player 1 called 210', 'River dealt: 5♠', 'Player 1 checked', 'Player 4 folded', 'Showdown: Player 1 won 840', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10']}}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 466, 'promptTokenCount': 1611, 'totalTokenCount': 2077}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'NYWRSUIt', 'timestamp': 1761904383.662282}, {'content': {'parts': [{'functionResponse': {'id': 'call_Y8zkzIOsUCzVu0u1M2A8wBuK', 'name': 'action_decision', 'response': {'error': 'Invoking `action_decision()` failed as the following mandatory input parameters are not present:\ncall_amount\npot_after_call\nequity\nYou could retry calling this tool, but it is IMPORTANT for you to provide all the mandatory parameters.'}}}, {'functionResponse': {'id': 'call_2UuBwXoOSVXufiOxYH64yhJB', 'name': 'action_decision', 'response': {'error': 'Invoking `action_decision()` failed as the following mandatory input parameters are not present:\ncall_amount\npot_after_call\nequity\nYou could retry calling this tool, but it is IMPORTANT for you to provide all the mandatory parameters.'}}}], 'role': 'user'}, 'invocationId': 'lAXAhPTD', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'bBEEOP6u', 'timestamp': 1761904394.01191}, {'content': {'parts': [{'functionCall': {'id': 'call_F9x5gcBk3s8I80uk1vlih540', 'args': {'call_amount': 0, 'pot_after_call': 40, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 29, 'promptTokenCount': 2194, 'totalTokenCount': 2223}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'GKnfrcTt', 'timestamp': 1761904394.018272}, {'content': {'parts': [{'functionResponse': {'id': 'call_F9x5gcBk3s8I80uk1vlih540', 'name': 'action_decision', 'response': {'error': 'Invoking `action_decision()` failed as the following mandatory input parameters are not present:\ngame_state\nYou could retry calling this tool, but it is IMPORTANT for you to provide all the mandatory parameters.'}}}], 'role': 'user'}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'rlxReSYP', 'timestamp': 1761904395.301915}, {'content': {'parts': [{'functionCall': {'id': 'call_LBxYQpqgQOYGvex2DLBLFGwx', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['8♣', '2♣'], 'community': [], 'your_chips': 4611, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3528, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1821, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (4611)'], 'history': ['Player 3 posted big blind 20', 'Player 4 called 20', 'Player 1 raised to 60', 'Player 3 folded', 'Player 4 called 40', 'Flop dealt: J♠, 9♠, 2♥', 'Player 1 raised to 140', 'Player 4 called 140', 'Turn dealt: 4♣', 'Player 1 checked', 'Player 4 raised to 210', 'Player 1 called 210', 'River dealt: 5♠', 'Player 1 checked', 'Player 4 folded', 'Showdown: Player 1 won 840', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 318, 'promptTokenCount': 2279, 'totalTokenCount': 2597}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '7p4s9TSR', 'timestamp': 1761904395.304458}, {'content': {'parts': [{'functionResponse': {'id': 'call_LBxYQpqgQOYGvex2DLBLFGwx', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（8.00(ポットに対して20.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'pKvE6iK6', 'timestamp': 1761904401.872372}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2648, 'totalTokenCount': 2686}, 'invocationId': 'e-47d289f4-face-4914-8d43-51bef30171c4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '3xvtA48T', 'timestamp': 1761904401.874737}]
2025-10-31 18:53:23,283 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:53:23,284 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 18:53:23,285 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:53:23,285 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}'
2025-10-31 18:53:23,285 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:53:23,285 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 18:53:23,286 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（8.00(ポットに対して20.00%）ため、チェックします'}
2025-10-31 18:53:23,286 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:53:23,286 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:53:23,286 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:53:23,286 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（8.00(ポットに対して20.00%）ため、チェックします
2025-10-31 18:53:23,288 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:53:23,289 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:23,289 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:23,289 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:23,289 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:53:23,290 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:23,290 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:23,290 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:23,291 - poker_game - INFO - Community cards: []
2025-10-31 18:53:23,291 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:23,291 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:23,292 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:23,292 - poker_game - INFO -   P3(Agent3): chips=1821, bet=20, status=active
2025-10-31 18:53:23,292 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:23,293 - poker_game - INFO - ==================================================
2025-10-31 18:53:23,293 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:53:23,305 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:23,306 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:23,307 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:23,307 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:53:23,307 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:23,308 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:23,308 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:23,309 - poker_game - INFO - Community cards: []
2025-10-31 18:53:23,309 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:23,309 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:23,310 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:23,310 - poker_game - INFO -   P3(Agent3): chips=1821, bet=20, status=active
2025-10-31 18:53:23,310 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:23,311 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:53:23,311 - poker_game - INFO - ==================================================
2025-10-31 18:53:23,311 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:23,312 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:23,312 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:53:23,312 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:53:23,313 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:23,313 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:23,313 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:53:23,313 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:53:23,313 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:53:23,313 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:53:23,314 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:53:23,314 - poker_game - DEBUG - Next after last raiser 4: 3
2025-10-31 18:53:23,314 - poker_game - INFO - Betting complete: Back to player 3 after last raiser 4
2025-10-31 18:53:23,314 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:23,315 - poker_game - INFO - Hand #11, Phase: preflop
2025-10-31 18:53:23,316 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:23,317 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:53:23,318 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:23,319 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:23,320 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:23,320 - poker_game - INFO - Community cards: []
2025-10-31 18:53:23,320 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:23,321 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:23,321 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:23,321 - poker_game - INFO -   P3(Agent3): chips=1821, bet=20, status=active
2025-10-31 18:53:23,322 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:53:23,322 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:53:23,322 - poker_game - INFO - ==================================================
2025-10-31 18:53:23,423 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:53:23,424 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:23,425 - poker_game - INFO - Remaining players: 2
2025-10-31 18:53:23,426 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:53:23,426 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:53:23,426 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:53:23,438 - poker_game - INFO - Starting new betting round
2025-10-31 18:53:23,439 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:53:23,439 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:53:23,441 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:53:23,441 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:53:23,441 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 18:53:23,442 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:53:23,442 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:23,443 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:23,443 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:53:23,443 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:23,444 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:23,444 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:23,445 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:23,445 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:23,446 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:23,446 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:23,446 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:23,447 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:53:23,447 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:53:23,448 - poker_game - INFO - ==================================================
2025-10-31 18:53:23,449 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "7♥",
    "Q♦"
  ],
  "community": [
    "10♠",
    "4♠",
    "2♠"
  ],
  "your_chips": 1821,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3528,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1821)"
  ],
  "history": [
    "Player 1 raised to 60",
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠"
  ]
}
2025-10-31 18:53:23,459 - poker_game - DEBUG - Create Session: {'id': '92f9a6ab-ee4a-4747-a290-2b30f4a03380', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904403.4564068}
2025-10-31 18:53:25,349 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）は10♠ 4♠ 2♠で、スート（マーク）が3枚揃ったフラッシュ（同じマークが5枚揃うこと）のドロー（完成させる可能性）があります。私の手札は7♥ Q♦で、このフロップとは全く繋がりません。相手のプレイヤーはまだアクションを起こしていないため、相手が強い手を持っている可能性を考慮し、まずはチェック（ベットせずに次のプレイヤーにアクションを回すこと）をして様子を見ます。もし相手がベットしてきたら、私の手札の強さを考えるとフォールド（降りること）が最善でしょう。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 168, 'promptTokenCount': 791, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 791}], 'totalTokenCount': 959}, 'invocationId': 'e-2599d8fe-45f1-4291-b480-b5eb019e1982', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '7ExQT0yA', 'timestamp': 1761904403.46902}]
2025-10-31 18:53:25,350 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:53:25,350 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）は10♠ 4♠ 2♠で、スート（マーク）が3枚揃ったフラッシュ（同じマークが5枚揃うこと）のドロー（完成させる可能性）があります。私の手札は7♥ Q♦で、このフロップとは全く繋がりません。相手のプレイヤーはまだアクションを起こしていないため、相手が強い手を持っている可能性を考慮し、まずはチェック（ベットせずに次のプレイヤーにアクションを回すこと）をして様子を見ます。もし相手がベットしてきたら、私の手札の強さを考えるとフォールド（降りること）が最善でしょう。"
}
```
2025-10-31 18:53:25,350 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:53:25,351 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）は10♠ 4♠ 2♠で、スート（マーク）が3枚揃ったフラッシュ（同じマークが5枚揃うこと）のドロー（完成させる可能性）があります。私の手札は7♥ Q♦で、このフロップとは全く繋がりません。相手のプレイヤーはまだアクションを起こしていないため、相手が強い手を持っている可能性を考慮し、まずはチェック（ベットせずに次のプレイヤーにアクションを回すこと）をして様子を見ます。もし相手がベットしてきたら、私の手札の強さを考えるとフォールド（降りること）が最善でしょう。"\n}\n```'
2025-10-31 18:53:25,351 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:53:25,351 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）は10♠ 4♠ 2♠で、スート（マーク）が3枚揃ったフラッシュ（同じマークが5枚揃うこと）のドロー（完成させる可能性）があります。私の手札は7♥ Q♦で、このフロップとは全く繋がりません。相手のプレイヤーはまだアクションを起こしていないため、相手が強い手を持っている可能性を考慮し、まずはチェック（ベットせずに次のプレイヤーにアクションを回すこと）をして様子を見ます。もし相手がベットしてきたら、私の手札の強さを考えるとフォールド（降りること）が最善でしょう。"\n}'
2025-10-31 18:53:25,351 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）は10♠ 4♠ 2♠で、スート（マーク）が3枚揃ったフラッシュ（同じマークが5枚揃うこと）のドロー（完成させる可能性）があります。私の手札は7♥ Q♦で、このフロップとは全く繋がりません。相手のプレイヤーはまだアクションを起こしていないため、相手が強い手を持っている可能性を考慮し、まずはチェック（ベットせずに次のプレイヤーにアクションを回すこと）をして様子を見ます。もし相手がベットしてきたら、私の手札の強さを考えるとフォールド（降りること）が最善でしょう。"
}
2025-10-31 18:53:25,352 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）は10♠ 4♠ 2♠で、スート（マーク）が3枚揃ったフラッシュ（同じマークが5枚揃うこと）のドロー（完成させる可能性）があります。私の手札は7♥ Q♦で、このフロップとは全く繋がりません。相手のプレイヤーはまだアクションを起こしていないため、相手が強い手を持っている可能性を考慮し、まずはチェック（ベットせずに次のプレイヤーにアクションを回すこと）をして様子を見ます。もし相手がベットしてきたら、私の手札の強さを考えるとフォールド（降りること）が最善でしょう。'}
2025-10-31 18:53:25,352 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:53:25,352 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:53:25,352 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:53:25,352 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, フロップ（最初の3枚のコミュニティカード）は10♠ 4♠ 2♠で、スート（マーク）が3枚揃ったフラッシュ（同じマークが5枚揃うこと）のドロー（完成させる可能性）があります。私の手札は7♥ Q♦で、このフロップとは全く繋がりません。相手のプレイヤーはまだアクションを起こしていないため、相手が強い手を持っている可能性を考慮し、まずはチェック（ベットせずに次のプレイヤーにアクションを回すこと）をして様子を見ます。もし相手がベットしてきたら、私の手札の強さを考えるとフォールド（降りること）が最善でしょう。
2025-10-31 18:53:25,354 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:53:25,354 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:25,354 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:25,355 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:25,355 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:53:25,355 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:25,356 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:25,356 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:25,356 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:25,357 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:25,357 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:25,358 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:25,359 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:25,360 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:53:25,361 - poker_game - INFO - ==================================================
2025-10-31 18:53:25,361 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:53:25,376 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:25,377 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:25,377 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:25,378 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:53:25,378 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:25,379 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:25,379 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:25,379 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:25,380 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:25,380 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:25,380 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:25,381 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:25,381 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:53:25,382 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:53:25,382 - poker_game - INFO - ==================================================
2025-10-31 18:53:25,383 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:25,383 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:25,383 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:53:25,383 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:53:25,386 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:25,386 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:25,386 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:53:25,387 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:53:25,387 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:53:25,387 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:53:25,387 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:53:25,387 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:53:25,387 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:53:25,387 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:25,388 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:25,388 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:25,388 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:53:25,388 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:25,389 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:25,389 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:25,390 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:25,390 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:25,391 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:25,391 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:25,391 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:25,392 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:53:25,392 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:53:25,393 - poker_game - INFO - ==================================================
2025-10-31 18:53:25,494 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "8♣",
    "2♣"
  ],
  "community": [
    "10♠",
    "4♠",
    "2♠"
  ],
  "your_chips": 4611,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3528,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1821,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4611)"
  ],
  "history": [
    "Player 3 folded",
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked"
  ]
}
2025-10-31 18:53:25,561 - poker_game - DEBUG - Create Session: {'id': 'b4b51b59-d19c-4b57-bdd4-93c724c97678', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904405.557053}
2025-10-31 18:53:33,456 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_xoJqkWriqOoGVR9sendxDSZS', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1111, 'totalTokenCount': 1128}, 'invocationId': 'e-f8d800ce-05ab-445b-a145-adba611cc576', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '0twioz5X', 'timestamp': 1761904405.579747}, {'content': {'parts': [{'functionResponse': {'id': 'call_xoJqkWriqOoGVR9sendxDSZS', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f8d800ce-05ab-445b-a145-adba611cc576', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '8laIn3e8', 'timestamp': 1761904406.857263}, {'content': {'parts': [{'functionCall': {'id': 'call_jZzcng7LQtgRF3Uhx7PU2G3T', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['8♣', '2♣'], 'community': ['10♠', '4♠', '2♠'], 'your_chips': 4611, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3528, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1821, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4611)'], 'history': ['Player 3 folded', 'Player 4 called 40', 'Flop dealt: J♠, 9♠, 2♥', 'Player 1 raised to 140', 'Player 4 called 140', 'Turn dealt: 4♣', 'Player 1 checked', 'Player 4 raised to 210', 'Player 1 called 210', 'River dealt: 5♠', 'Player 1 checked', 'Player 4 folded', 'Showdown: Player 1 won 840', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 10♠, 4♠, 2♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.6}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 350, 'promptTokenCount': 1635, 'totalTokenCount': 1985}, 'invocationId': 'e-f8d800ce-05ab-445b-a145-adba611cc576', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'dwtNXmpe', 'timestamp': 1761904406.869495}, {'content': {'parts': [{'functionResponse': {'id': 'call_jZzcng7LQtgRF3Uhx7PU2G3T', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 20, 'reasoning': '期待値が見込める（24.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 20'}}}], 'role': 'user'}, 'invocationId': 'e-f8d800ce-05ab-445b-a145-adba611cc576', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '755XoH6T', 'timestamp': 1761904411.323861}, {'content': {'parts': [{'text': '{"action":"raise","amount":20,"reasoning":"期待値が見込める（24.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 20"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2038, 'totalTokenCount': 2094}, 'invocationId': 'e-f8d800ce-05ab-445b-a145-adba611cc576', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '5VQ0VlDe', 'timestamp': 1761904411.325641}]
2025-10-31 18:53:33,457 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:53:33,457 - poker_game - DEBUG - {"action":"raise","amount":20,"reasoning":"期待値が見込める（24.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 20"}
2025-10-31 18:53:33,457 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":20,"reasoning":"期待値が見込める（24.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 20"}'
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":20,"reasoning":"期待値が見込める（24.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 20"}
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 20, 'reasoning': '期待値が見込める（24.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 20'}
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 20
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (4611)']
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] Raise amount 20 is valid (min: 20)
2025-10-31 18:53:33,458 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 20}
2025-10-31 18:53:33,458 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 20, 期待値が見込める（24.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 20
2025-10-31 18:53:33,459 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 20
2025-10-31 18:53:33,460 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:33,460 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:33,460 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:33,460 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:53:33,461 - poker_game - INFO - Last raiser: None
2025-10-31 18:53:33,461 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:33,461 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:33,461 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:33,462 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:33,462 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:33,462 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:33,462 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:33,462 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:53:33,463 - poker_game - INFO - ==================================================
2025-10-31 18:53:33,463 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 20
2025-10-31 18:53:33,472 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:33,472 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:33,472 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:33,472 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:53:33,473 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:33,473 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:33,473 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:33,473 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:33,474 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:33,474 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:33,474 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:33,474 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:33,474 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:53:33,475 - poker_game - INFO - Extra: Action: Player 4 raised to 20
2025-10-31 18:53:33,475 - poker_game - INFO - ==================================================
2025-10-31 18:53:33,475 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:33,475 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:33,475 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:53:33,475 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:53:33,475 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:33,476 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:33,476 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:53:33,476 - poker_game - DEBUG - Player bets: [0, 20], Current bet: 20, All same: False
2025-10-31 18:53:33,476 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:53:33,476 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:33,476 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:33,476 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:33,476 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:53:33,477 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:33,477 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:33,477 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:33,477 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:33,477 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:33,479 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:33,479 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:33,480 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:33,480 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:53:33,480 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:53:33,480 - poker_game - INFO - ==================================================
2025-10-31 18:53:33,583 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "7♥",
    "Q♦"
  ],
  "community": [
    "10♠",
    "4♠",
    "2♠"
  ],
  "your_chips": 1821,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3528,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4591,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1821)"
  ],
  "history": [
    "Player 4 called 40",
    "Flop dealt: J♠, 9♠, 2♥",
    "Player 1 raised to 140",
    "Player 4 called 140",
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20"
  ]
}
2025-10-31 18:53:33,593 - poker_game - DEBUG - Create Session: {'id': '9754e7d0-2079-47d7-b401-b676a27c6874', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904413.59091}
2025-10-31 18:53:35,277 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フロップでフラッシュドロー（同じスートのカードが3枚揃っている状態）の可能性がありましたが、自分の手札（7♥ Q♦）とコミュニティカード（10♠ 4♠ 2♠）では、フラッシュは完成していません。相手（Player 4）がレイズしてきたため、このままコールしてゲームを続けるのはリスクが高いと判断しました。ポット（場にあるチップの総額）は60ですが、コールには20必要で、相手のレイズ額によってはさらに多くのチップが必要になる可能性があります。現状、勝てる見込みが低いと判断し、フォールド（戦線離脱）を選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 172, 'promptTokenCount': 796, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 796}], 'totalTokenCount': 968}, 'invocationId': 'e-5f28dd8f-e632-4b0a-8673-700f6704dbd2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'HOp9faIn', 'timestamp': 1761904413.604323}]
2025-10-31 18:53:35,277 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:53:35,277 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "フロップでフラッシュドロー（同じスートのカードが3枚揃っている状態）の可能性がありましたが、自分の手札（7♥ Q♦）とコミュニティカード（10♠ 4♠ 2♠）では、フラッシュは完成していません。相手（Player 4）がレイズしてきたため、このままコールしてゲームを続けるのはリスクが高いと判断しました。ポット（場にあるチップの総額）は60ですが、コールには20必要で、相手のレイズ額によってはさらに多くのチップが必要になる可能性があります。現状、勝てる見込みが低いと判断し、フォールド（戦線離脱）を選択します。"
}
```
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フロップでフラッシュドロー（同じスートのカードが3枚揃っている状態）の可能性がありましたが、自分の手札（7♥ Q♦）とコミュニティカード（10♠ 4♠ 2♠）では、フラッシュは完成していません。相手（Player 4）がレイズしてきたため、このままコールしてゲームを続けるのはリスクが高いと判断しました。ポット（場にあるチップの総額）は60ですが、コールには20必要で、相手のレイズ額によってはさらに多くのチップが必要になる可能性があります。現状、勝てる見込みが低いと判断し、フォールド（戦線離脱）を選択します。"\n}\n```'
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フロップでフラッシュドロー（同じスートのカードが3枚揃っている状態）の可能性がありましたが、自分の手札（7♥ Q♦）とコミュニティカード（10♠ 4♠ 2♠）では、フラッシュは完成していません。相手（Player 4）がレイズしてきたため、このままコールしてゲームを続けるのはリスクが高いと判断しました。ポット（場にあるチップの総額）は60ですが、コールには20必要で、相手のレイズ額によってはさらに多くのチップが必要になる可能性があります。現状、勝てる見込みが低いと判断し、フォールド（戦線離脱）を選択します。"\n}'
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "フロップでフラッシュドロー（同じスートのカードが3枚揃っている状態）の可能性がありましたが、自分の手札（7♥ Q♦）とコミュニティカード（10♠ 4♠ 2♠）では、フラッシュは完成していません。相手（Player 4）がレイズしてきたため、このままコールしてゲームを続けるのはリスクが高いと判断しました。ポット（場にあるチップの総額）は60ですが、コールには20必要で、相手のレイズ額によってはさらに多くのチップが必要になる可能性があります。現状、勝てる見込みが低いと判断し、フォールド（戦線離脱）を選択します。"
}
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'フロップでフラッシュドロー（同じスートのカードが3枚揃っている状態）の可能性がありましたが、自分の手札（7♥ Q♦）とコミュニティカード（10♠ 4♠ 2♠）では、フラッシュは完成していません。相手（Player 4）がレイズしてきたため、このままコールしてゲームを続けるのはリスクが高いと判断しました。ポット（場にあるチップの総額）は60ですが、コールには20必要で、相手のレイズ額によってはさらに多くのチップが必要になる可能性があります。現状、勝てる見込みが低いと判断し、フォールド（戦線離脱）を選択します。'}
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:53:35,278 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:53:35,278 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, フロップでフラッシュドロー（同じスートのカードが3枚揃っている状態）の可能性がありましたが、自分の手札（7♥ Q♦）とコミュニティカード（10♠ 4♠ 2♠）では、フラッシュは完成していません。相手（Player 4）がレイズしてきたため、このままコールしてゲームを続けるのはリスクが高いと判断しました。ポット（場にあるチップの総額）は60ですが、コールには20必要で、相手のレイズ額によってはさらに多くのチップが必要になる可能性があります。現状、勝てる見込みが低いと判断し、フォールド（戦線離脱）を選択します。
2025-10-31 18:53:35,279 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:53:35,279 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:35,279 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:35,280 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:35,280 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:53:35,280 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:35,280 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:35,281 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:35,281 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:35,281 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:35,281 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:35,281 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:35,282 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:35,282 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:53:35,282 - poker_game - INFO - ==================================================
2025-10-31 18:53:35,282 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:53:35,290 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:35,290 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:35,291 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:53:35,291 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:53:35,291 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:35,291 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:35,292 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:53:35,292 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:35,292 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:35,293 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:35,293 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:35,294 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:35,294 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:53:35,295 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:53:35,295 - poker_game - INFO - ==================================================
2025-10-31 18:53:35,296 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:35,296 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:35,296 - poker_game - DEBUG - Active players: [4]
2025-10-31 18:53:35,296 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:53:35,297 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:35,297 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:35,297 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:53:35,298 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:53:35,298 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:35,299 - poker_game - INFO - Hand #11, Phase: flop
2025-10-31 18:53:35,299 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:35,299 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:53:35,300 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:35,300 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:35,301 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:53:35,301 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:35,301 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:35,302 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:35,302 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:35,302 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:35,303 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:53:35,303 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:53:35,303 - poker_game - INFO - ==================================================
2025-10-31 18:53:35,404 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:53:35,405 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:35,405 - poker_game - INFO - Remaining players: 1
2025-10-31 18:53:35,406 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:53:35,406 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:53:35,406 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:53:35,407 - poker_game - INFO - Hand #11, Phase: showdown
2025-10-31 18:53:35,407 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:53:35,408 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:53:35,408 - poker_game - INFO - Last raiser: 4
2025-10-31 18:53:35,409 - poker_game - INFO - Betting round complete: True
2025-10-31 18:53:35,409 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:53:35,409 - poker_game - INFO - Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:35,410 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:35,410 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=folded
2025-10-31 18:53:35,411 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:35,411 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:35,411 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:53:35,412 - poker_game - INFO - ==================================================
2025-10-31 18:53:35,412 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:53:35,413 - poker_game - INFO - Pot: 60, Community cards: ['10♠', '4♠', '2♠']
2025-10-31 18:53:35,413 - poker_game - INFO -   Player 4 status=active cards=['8♣', '2♣']
2025-10-31 18:53:35,414 - poker_game - INFO - Showdown winner by default: Player 4 awarded 60
2025-10-31 18:53:35,414 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:53:35,414 - poker_game - INFO - === STARTING NEW HAND #12 ===
2025-10-31 18:53:35,415 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:53:35,416 - poker_game - INFO - Moving dealer button
2025-10-31 18:53:35,416 - poker_game - INFO - Posting blinds
2025-10-31 18:53:35,437 - poker_game - INFO - Dealing hole cards
2025-10-31 18:53:35,438 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:53:35,447 - poker_game - INFO - Started new hand in database: hand_id=12
2025-10-31 18:53:35,448 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:53:35,448 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:53:35,449 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:53:35,449 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:35,450 - poker_game - INFO - Last raiser: 1
2025-10-31 18:53:35,450 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:35,451 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:53:35,451 - poker_game - INFO - Community cards: []
2025-10-31 18:53:35,451 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:35,452 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:53:35,452 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:35,453 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:35,453 - poker_game - INFO -   P4(Agent4): chips=4641, bet=10, status=active
2025-10-31 18:53:35,453 - poker_game - INFO - ==================================================
2025-10-31 18:53:35,454 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "10♦",
    "4♦"
  ],
  "community": [],
  "your_chips": 1821,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3508,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4641,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1821)"
  ],
  "history": [
    "Turn dealt: 4♣",
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 18:53:35,464 - poker_game - DEBUG - Create Session: {'id': 'a6861d18-675a-43c6-9ad3-1abcb56466b7', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904415.4620647}
2025-10-31 18:53:37,528 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フラッシュドロー（同じスートのカードが揃う可能性）とストレートドロー（連続した数字のカードが揃う可能性）がありますが、私の手札（10♦, 4♦）はまだ何も成立していません。フロップでフラッシュまたはストレートが完成する可能性はありますが、現時点ではこれ以上ベットする価値は低いと判断しました。相手のベット額（20）はコール可能ですが、ポットのサイズ（30）に対してリスクが高いと考え、フォールドを選択しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 142, 'promptTokenCount': 770, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 770}], 'totalTokenCount': 912}, 'invocationId': 'e-cf671848-f87f-45e7-99f2-fb3b0b8fe65b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'oh0OeXOT', 'timestamp': 1761904415.475341}]
2025-10-31 18:53:37,529 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:53:37,529 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "フラッシュドロー（同じスートのカードが揃う可能性）とストレートドロー（連続した数字のカードが揃う可能性）がありますが、私の手札（10♦, 4♦）はまだ何も成立していません。フロップでフラッシュまたはストレートが完成する可能性はありますが、現時点ではこれ以上ベットする価値は低いと判断しました。相手のベット額（20）はコール可能ですが、ポットのサイズ（30）に対してリスクが高いと考え、フォールドを選択しました。"
}
```
2025-10-31 18:53:37,530 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:53:37,530 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フラッシュドロー（同じスートのカードが揃う可能性）とストレートドロー（連続した数字のカードが揃う可能性）がありますが、私の手札（10♦, 4♦）はまだ何も成立していません。フロップでフラッシュまたはストレートが完成する可能性はありますが、現時点ではこれ以上ベットする価値は低いと判断しました。相手のベット額（20）はコール可能ですが、ポットのサイズ（30）に対してリスクが高いと考え、フォールドを選択しました。"\n}\n```'
2025-10-31 18:53:37,530 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:53:37,530 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フラッシュドロー（同じスートのカードが揃う可能性）とストレートドロー（連続した数字のカードが揃う可能性）がありますが、私の手札（10♦, 4♦）はまだ何も成立していません。フロップでフラッシュまたはストレートが完成する可能性はありますが、現時点ではこれ以上ベットする価値は低いと判断しました。相手のベット額（20）はコール可能ですが、ポットのサイズ（30）に対してリスクが高いと考え、フォールドを選択しました。"\n}'
2025-10-31 18:53:37,531 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "フラッシュドロー（同じスートのカードが揃う可能性）とストレートドロー（連続した数字のカードが揃う可能性）がありますが、私の手札（10♦, 4♦）はまだ何も成立していません。フロップでフラッシュまたはストレートが完成する可能性はありますが、現時点ではこれ以上ベットする価値は低いと判断しました。相手のベット額（20）はコール可能ですが、ポットのサイズ（30）に対してリスクが高いと考え、フォールドを選択しました。"
}
2025-10-31 18:53:37,531 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'フラッシュドロー（同じスートのカードが揃う可能性）とストレートドロー（連続した数字のカードが揃う可能性）がありますが、私の手札（10♦, 4♦）はまだ何も成立していません。フロップでフラッシュまたはストレートが完成する可能性はありますが、現時点ではこれ以上ベットする価値は低いと判断しました。相手のベット額（20）はコール可能ですが、ポットのサイズ（30）に対してリスクが高いと考え、フォールドを選択しました。'}
2025-10-31 18:53:37,531 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:53:37,531 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:53:37,532 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:53:37,532 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, フラッシュドロー（同じスートのカードが揃う可能性）とストレートドロー（連続した数字のカードが揃う可能性）がありますが、私の手札（10♦, 4♦）はまだ何も成立していません。フロップでフラッシュまたはストレートが完成する可能性はありますが、現時点ではこれ以上ベットする価値は低いと判断しました。相手のベット額（20）はコール可能ですが、ポットのサイズ（30）に対してリスクが高いと考え、フォールドを選択しました。
2025-10-31 18:53:37,533 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:53:37,534 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:37,534 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:53:37,534 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:53:37,535 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:37,535 - poker_game - INFO - Last raiser: 1
2025-10-31 18:53:37,536 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:37,536 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:53:37,536 - poker_game - INFO - Community cards: []
2025-10-31 18:53:37,537 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:37,537 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:53:37,538 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:37,538 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:53:37,539 - poker_game - INFO -   P4(Agent4): chips=4641, bet=10, status=active
2025-10-31 18:53:37,539 - poker_game - INFO - ==================================================
2025-10-31 18:53:37,540 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:53:37,554 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:37,554 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:53:37,555 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:53:37,555 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:37,556 - poker_game - INFO - Last raiser: 1
2025-10-31 18:53:37,556 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:37,556 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:37,557 - poker_game - INFO - Community cards: []
2025-10-31 18:53:37,557 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:37,558 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:53:37,558 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:37,559 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:37,559 - poker_game - INFO -   P4(Agent4): chips=4641, bet=10, status=active
2025-10-31 18:53:37,560 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:53:37,560 - poker_game - INFO - ==================================================
2025-10-31 18:53:37,560 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:37,561 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:37,561 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:53:37,561 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:53:37,561 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:37,562 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:37,562 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:53:37,562 - poker_game - DEBUG - Player bets: [20, 10], Current bet: 20, All same: False
2025-10-31 18:53:37,563 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:53:37,565 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:37,568 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:53:37,570 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:53:37,571 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:37,572 - poker_game - INFO - Last raiser: 1
2025-10-31 18:53:37,573 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:37,574 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:37,574 - poker_game - INFO - Community cards: []
2025-10-31 18:53:37,575 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:37,575 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:53:37,575 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:37,576 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:37,576 - poker_game - INFO -   P4(Agent4): chips=4641, bet=10, status=active
2025-10-31 18:53:37,576 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:53:37,577 - poker_game - INFO - ==================================================
2025-10-31 18:53:37,679 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "J♥",
    "9♠"
  ],
  "community": [],
  "your_chips": 4641,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3508,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1821,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (4641)"
  ],
  "history": [
    "Player 1 checked",
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded"
  ]
}
2025-10-31 18:53:37,692 - poker_game - DEBUG - Create Session: {'id': '34f0c58d-91e2-4dba-b623-9decc368300c', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904417.6888306}
2025-10-31 18:53:47,698 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:53:55,622 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_UPdC1eH65EGhAxMX4bZ5X28u', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1087, 'totalTokenCount': 1104}, 'invocationId': 'e-65bb4b73-58c0-4703-8f2d-37e7480fb9d3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'QqnjDxJd', 'timestamp': 1761904417.711931}, {'content': {'parts': [{'functionResponse': {'id': 'call_UPdC1eH65EGhAxMX4bZ5X28u', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-65bb4b73-58c0-4703-8f2d-37e7480fb9d3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '1V0PkCtS', 'timestamp': 1761904418.757108}, {'content': {'parts': [{'functionCall': {'id': 'call_8UinPvOI43FahzjOS0gk5MUp', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♥', '9♠'], 'community': [], 'your_chips': 4641, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3508, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1821, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (4641)'], 'history': ['Player 1 checked', 'Player 4 raised to 210', 'Player 1 called 210', 'River dealt: 5♠', 'Player 1 checked', 'Player 4 folded', 'Showdown: Player 1 won 840', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 10♠, 4♠, 2♠', 'Player 3 checked', 'Player 4 raised to 20', 'Player 3 folded', 'Showdown: Player 4 won 60', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.4}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_3NUU0bbV2uvVTO0Ei3TlbYcO', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♥', '9♠'], 'community': [], 'your_chips': 4641, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3508, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1821, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (4641)'], 'history': ['Player 1 checked', 'Player 4 raised to 210', 'Player 1 called 210', 'River dealt: 5♠', 'Player 1 checked', 'Player 4 folded', 'Showdown: Player 1 won 840', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 10♠, 4♠, 2♠', 'Player 3 checked', 'Player 4 raised to 20', 'Player 3 folded', 'Showdown: Player 4 won 60', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 654, 'promptTokenCount': 1611, 'totalTokenCount': 2265}, 'invocationId': 'e-65bb4b73-58c0-4703-8f2d-37e7480fb9d3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'HM9uIXRs', 'timestamp': 1761904418.762567}, {'content': {'parts': [{'functionResponse': {'id': 'call_8UinPvOI43FahzjOS0gk5MUp', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10'}}}, {'functionResponse': {'id': 'call_3NUU0bbV2uvVTO0Ei3TlbYcO', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（15.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 10'}}}], 'role': 'user'}, 'invocationId': 'au7EVupr', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'kx2df8xe', 'timestamp': 1761904433.238085}, {'content': {'parts': [{'text': '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "ポットを満たしており(10.00(ポットに対して33.33%)、コールが妥当と判断。コール額: 10"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 62, 'promptTokenCount': 2573, 'totalTokenCount': 2635}, 'invocationId': 'e-65bb4b73-58c0-4703-8f2d-37e7480fb9d3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'qUENuwH4', 'timestamp': 1761904433.244895}]
2025-10-31 18:53:55,623 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:53:55,624 - poker_game - DEBUG - {
  "action": "call",
  "amount": 10,
  "reasoning": "ポットを満たしており(10.00(ポットに対して33.33%)、コールが妥当と判断。コール額: 10"
}
2025-10-31 18:53:55,624 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:53:55,625 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "ポットを満たしており(10.00(ポットに対して33.33%)、コールが妥当と判断。コール額: 10"\n}'
2025-10-31 18:53:55,625 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:53:55,625 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "ポットを満たしており(10.00(ポットに対して33.33%)、コールが妥当と判断。コール額: 10"
}
2025-10-31 18:53:55,625 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'ポットを満たしており(10.00(ポットに対して33.33%)、コールが妥当と判断。コール額: 10'}
2025-10-31 18:53:55,625 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 10
2025-10-31 18:53:55,625 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (4641)']
2025-10-31 18:53:55,626 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (10)': 10
2025-10-31 18:53:55,626 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:53:55,626 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 10, ポットを満たしており(10.00(ポットに対して33.33%)、コールが妥当と判断。コール額: 10
2025-10-31 18:53:55,627 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 10
2025-10-31 18:53:55,628 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:53:55,628 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:53:55,629 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:53:55,629 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:53:55,629 - poker_game - INFO - Last raiser: 1
2025-10-31 18:53:55,630 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:55,630 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:55,630 - poker_game - INFO - Community cards: []
2025-10-31 18:53:55,631 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:55,631 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:53:55,632 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:55,632 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:55,633 - poker_game - INFO -   P4(Agent4): chips=4641, bet=10, status=active
2025-10-31 18:53:55,635 - poker_game - INFO - ==================================================
2025-10-31 18:53:55,636 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 10
2025-10-31 18:53:55,663 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:53:55,664 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:53:55,665 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:53:55,665 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:53:55,665 - poker_game - INFO - Last raiser: 1
2025-10-31 18:53:55,665 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:55,666 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:55,666 - poker_game - INFO - Community cards: []
2025-10-31 18:53:55,666 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:55,666 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:53:55,666 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:55,666 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:55,667 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=active
2025-10-31 18:53:55,667 - poker_game - INFO - Extra: Action: Player 4 called 10
2025-10-31 18:53:55,667 - poker_game - INFO - ==================================================
2025-10-31 18:53:55,667 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:53:55,667 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:53:55,668 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:53:55,668 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:53:55,668 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:53:55,668 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:53:55,668 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:53:55,668 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:53:55,668 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 18:53:55,668 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:53:55,669 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:53:55,669 - poker_game - DEBUG - Next after last raiser 1: 4
2025-10-31 18:53:55,669 - poker_game - DEBUG - Betting continues: Current player 1 != next after raiser 4
2025-10-31 18:53:55,669 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:53:55,669 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:53:55,670 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:53:55,670 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:53:55,670 - poker_game - INFO - Last raiser: 1
2025-10-31 18:53:55,670 - poker_game - INFO - Betting round complete: False
2025-10-31 18:53:55,671 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:53:55,672 - poker_game - INFO - Community cards: []
2025-10-31 18:53:55,673 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:53:55,674 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:53:55,675 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:53:55,677 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:53:55,678 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=active
2025-10-31 18:53:55,679 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:53:55,681 - poker_game - INFO - ==================================================
2025-10-31 18:53:55,784 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "Q♥",
    "J♦"
  ],
  "community": [],
  "your_chips": 3508,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1821,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4631,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (3508)"
  ],
  "history": [
    "Player 4 raised to 210",
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10"
  ]
}
2025-10-31 18:53:55,800 - poker_game - DEBUG - Create Session: {'id': 'aaf5943c-cd7f-4ecb-80a1-3b4f3a0d791e', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904435.7974863}
2025-10-31 18:54:00,359 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 420,\n  "reasoning": "Preflopでは、QJオフスーツは標準的なレイズハンドです。相手がビッグブラインドからコールし、以前のラウンドでレイズをしているため、ポットを大きくしたいです。レイズ額は、相手のポストされたビッグブラインド（20）の2倍以上（40）、そして相手の以前のレイズ（20）を考慮した、420（20の10倍＋ビッグブラインドの2倍）に設定しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 134, 'promptTokenCount': 767, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 767}], 'totalTokenCount': 901}, 'invocationId': 'e-823e8b79-2e2e-444f-8612-33a5a00153fe', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ehsUHDia', 'timestamp': 1761904435.822657}]
2025-10-31 18:54:00,359 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:54:00,360 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 420,
  "reasoning": "Preflopでは、QJオフスーツは標準的なレイズハンドです。相手がビッグブラインドからコールし、以前のラウンドでレイズをしているため、ポットを大きくしたいです。レイズ額は、相手のポストされたビッグブラインド（20）の2倍以上（40）、そして相手の以前のレイズ（20）を考慮した、420（20の10倍＋ビッグブラインドの2倍）に設定しました。"
}
```
2025-10-31 18:54:00,360 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:54:00,360 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 420,\n  "reasoning": "Preflopでは、QJオフスーツは標準的なレイズハンドです。相手がビッグブラインドからコールし、以前のラウンドでレイズをしているため、ポットを大きくしたいです。レイズ額は、相手のポストされたビッグブラインド（20）の2倍以上（40）、そして相手の以前のレイズ（20）を考慮した、420（20の10倍＋ビッグブラインドの2倍）に設定しました。"\n}\n```'
2025-10-31 18:54:00,361 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:54:00,361 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 420,\n  "reasoning": "Preflopでは、QJオフスーツは標準的なレイズハンドです。相手がビッグブラインドからコールし、以前のラウンドでレイズをしているため、ポットを大きくしたいです。レイズ額は、相手のポストされたビッグブラインド（20）の2倍以上（40）、そして相手の以前のレイズ（20）を考慮した、420（20の10倍＋ビッグブラインドの2倍）に設定しました。"\n}'
2025-10-31 18:54:00,361 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 420,
  "reasoning": "Preflopでは、QJオフスーツは標準的なレイズハンドです。相手がビッグブラインドからコールし、以前のラウンドでレイズをしているため、ポットを大きくしたいです。レイズ額は、相手のポストされたビッグブラインド（20）の2倍以上（40）、そして相手の以前のレイズ（20）を考慮した、420（20の10倍＋ビッグブラインドの2倍）に設定しました。"
}
2025-10-31 18:54:00,361 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 420, 'reasoning': 'Preflopでは、QJオフスーツは標準的なレイズハンドです。相手がビッグブラインドからコールし、以前のラウンドでレイズをしているため、ポットを大きくしたいです。レイズ額は、相手のポストされたビッグブラインド（20）の2倍以上（40）、そして相手の以前のレイズ（20）を考慮した、420（20の10倍＋ビッグブラインドの2倍）に設定しました。'}
2025-10-31 18:54:00,361 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 420
2025-10-31 18:54:00,362 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (3508)']
2025-10-31 18:54:00,362 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 18:54:00,362 - poker_game - DEBUG - [Agent1] Raise amount 420 is valid (min: 40)
2025-10-31 18:54:00,362 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 420}
2025-10-31 18:54:00,362 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 420, Preflopでは、QJオフスーツは標準的なレイズハンドです。相手がビッグブラインドからコールし、以前のラウンドでレイズをしているため、ポットを大きくしたいです。レイズ額は、相手のポストされたビッグブラインド（20）の2倍以上（40）、そして相手の以前のレイズ（20）を考慮した、420（20の10倍＋ビッグブラインドの2倍）に設定しました。
2025-10-31 18:54:00,363 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 420
2025-10-31 18:54:00,364 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:00,364 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:54:00,365 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:54:00,366 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:00,366 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:00,367 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:00,367 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:00,368 - poker_game - INFO - Community cards: []
2025-10-31 18:54:00,368 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:00,368 - poker_game - INFO -   P1(Agent1): chips=3508, bet=20, status=active
2025-10-31 18:54:00,369 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:00,371 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:54:00,371 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=active
2025-10-31 18:54:00,371 - poker_game - INFO - ==================================================
2025-10-31 18:54:00,371 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 440
2025-10-31 18:54:00,388 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:00,389 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:54:00,389 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:54:00,389 - poker_game - INFO - Pot: 460, Current bet: 440
2025-10-31 18:54:00,389 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:00,390 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:00,390 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:00,390 - poker_game - INFO - Community cards: []
2025-10-31 18:54:00,391 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:00,392 - poker_game - INFO -   P1(Agent1): chips=3088, bet=440, status=active
2025-10-31 18:54:00,392 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:00,393 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:54:00,393 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=active
2025-10-31 18:54:00,395 - poker_game - INFO - Extra: Action: Player 1 raised to 440
2025-10-31 18:54:00,396 - poker_game - INFO - ==================================================
2025-10-31 18:54:00,396 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:00,397 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:00,397 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:54:00,397 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 18:54:00,397 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:00,398 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:00,398 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:00,398 - poker_game - DEBUG - Player bets: [440, 20], Current bet: 440, All same: False
2025-10-31 18:54:00,399 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:54:00,399 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:00,399 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:54:00,400 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:54:00,400 - poker_game - INFO - Pot: 460, Current bet: 440
2025-10-31 18:54:00,400 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:00,401 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:00,401 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:00,401 - poker_game - INFO - Community cards: []
2025-10-31 18:54:00,402 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:00,403 - poker_game - INFO -   P1(Agent1): chips=3088, bet=440, status=active
2025-10-31 18:54:00,404 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:00,404 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:54:00,405 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=active
2025-10-31 18:54:00,406 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:54:00,406 - poker_game - INFO - ==================================================
2025-10-31 18:54:00,509 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "J♥",
    "9♠"
  ],
  "community": [],
  "your_chips": 4631,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 460,
  "to_call": 420,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3088,
      "bet": 440,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1821,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (420)",
    "raise (min 460)",
    "all-in (4631)"
  ],
  "history": [
    "Player 1 called 210",
    "River dealt: 5♠",
    "Player 1 checked",
    "Player 4 folded",
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440"
  ]
}
2025-10-31 18:54:00,522 - poker_game - DEBUG - Create Session: {'id': '8407d495-8841-4682-bceb-8e5d7a94812e', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904440.5190372}
2025-10-31 18:54:10,569 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:54:10,731 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_QsYfafgB5zImN01el9UIFQUY', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1089, 'totalTokenCount': 1106}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'RVwbbUXO', 'timestamp': 1761904440.530521}, {'content': {'parts': [{'functionResponse': {'id': 'call_QsYfafgB5zImN01el9UIFQUY', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'eGmgqFQz', 'timestamp': 1761904436.279922}, {'content': {'parts': [{'functionCall': {'id': 'call_CWP0yc1MxzLk6UpJHFCAN8g4', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1613, 'totalTokenCount': 1633}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'cz8yzghr', 'timestamp': 1761904436.285331}, {'content': {'parts': [{'functionResponse': {'id': 'call_CWP0yc1MxzLk6UpJHFCAN8g4', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'n7cHec6Q', 'timestamp': 1761904437.451275}, {'content': {'parts': [{'functionCall': {'id': 'call_u3wvbmjjQLj9xjUgdsX6f2DQ', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1175, 'totalTokenCount': 1192}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'nxRKq1qR', 'timestamp': 1761904437.453553}, {'content': {'parts': [{'functionResponse': {'id': 'call_u3wvbmjjQLj9xjUgdsX6f2DQ', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'H72DzpBQ', 'timestamp': 1761904438.574288}, {'content': {'parts': [{'functionCall': {'id': 'call_gVRSKWkowt7LEAXJxehScZYq', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1705, 'totalTokenCount': 1725}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'woxKiCpV', 'timestamp': 1761904438.578418}, {'content': {'parts': [{'functionResponse': {'id': 'call_gVRSKWkowt7LEAXJxehScZYq', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'C19ydru7', 'timestamp': 1761904439.561903}, {'content': {'parts': [{'functionCall': {'id': 'call_80Cd1I2f0jCfec9BTWO1QoOM', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1261, 'totalTokenCount': 1278}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'if3EHNct', 'timestamp': 1761904439.563974}, {'content': {'parts': [{'functionResponse': {'id': 'call_80Cd1I2f0jCfec9BTWO1QoOM', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'sEdMgUA0', 'timestamp': 1761904440.751312}, {'content': {'parts': [{'functionCall': {'id': 'call_yxbDw0p2MfsAen7TUhcgcdPT', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♥', '9♠'], 'community': [], 'your_chips': 4631, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 460, 'to_call': 420, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3088, 'bet': 440, 'status': 'active'}, {'id': 3, 'chips': 1821, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (420)', 'raise (min 460)', 'all-in (4631)'], 'history': ['Player 1 called 210', 'River dealt: 5♠', 'Player 1 checked', 'Player 4 folded', 'Showdown: Player 1 won 840', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 10♠, 4♠, 2♠', 'Player 3 checked', 'Player 4 raised to 20', 'Player 3 folded', 'Showdown: Player 4 won 60', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 440']}, 'call_amount': 420, 'pot_after_call': 880, 'equity': 0.38}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 337, 'promptTokenCount': 1797, 'totalTokenCount': 2134}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IfIkWr3o', 'timestamp': 1761904440.753547}, {'content': {'parts': [{'functionResponse': {'id': 'call_yxbDw0p2MfsAen7TUhcgcdPT', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が74.00(ポットに対して16.09%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'kUBC9jla', 'timestamp': 1761904448.819292}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が74.00(ポットに対して16.09%で、マイナスなのでフォールド"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 39, 'promptTokenCount': 2170, 'totalTokenCount': 2209}, 'invocationId': 'e-610c23e8-5582-482d-9672-3d1aaea624eb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'vUvBgWPy', 'timestamp': 1761904448.822993}]
2025-10-31 18:54:10,732 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:54:10,733 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が74.00(ポットに対して16.09%で、マイナスなのでフォールド"}
2025-10-31 18:54:10,734 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:54:10,734 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が74.00(ポットに対して16.09%で、マイナスなのでフォールド"}'
2025-10-31 18:54:10,734 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:54:10,734 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が74.00(ポットに対して16.09%で、マイナスなのでフォールド"}
2025-10-31 18:54:10,735 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が74.00(ポットに対して16.09%で、マイナスなのでフォールド'}
2025-10-31 18:54:10,735 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:54:10,735 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:54:10,735 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:54:10,735 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が74.00(ポットに対して16.09%で、マイナスなのでフォールド
2025-10-31 18:54:10,739 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:54:10,740 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:10,740 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:54:10,741 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:54:10,741 - poker_game - INFO - Pot: 460, Current bet: 440
2025-10-31 18:54:10,741 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:10,742 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:10,742 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:10,743 - poker_game - INFO - Community cards: []
2025-10-31 18:54:10,744 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:10,744 - poker_game - INFO -   P1(Agent1): chips=3088, bet=440, status=active
2025-10-31 18:54:10,744 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:10,745 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:54:10,745 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=active
2025-10-31 18:54:10,745 - poker_game - INFO - ==================================================
2025-10-31 18:54:10,746 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:54:10,769 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:10,770 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:54:10,770 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:54:10,771 - poker_game - INFO - Pot: 460, Current bet: 440
2025-10-31 18:54:10,771 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:10,771 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:10,772 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:54:10,772 - poker_game - INFO - Community cards: []
2025-10-31 18:54:10,772 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:10,773 - poker_game - INFO -   P1(Agent1): chips=3088, bet=440, status=active
2025-10-31 18:54:10,773 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:10,773 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:54:10,774 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=folded
2025-10-31 18:54:10,774 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:54:10,774 - poker_game - INFO - ==================================================
2025-10-31 18:54:10,775 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:10,775 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:10,775 - poker_game - DEBUG - Active players: [1]
2025-10-31 18:54:10,776 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:54:10,776 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:10,776 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:10,776 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:54:10,776 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:54:10,777 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:10,777 - poker_game - INFO - Hand #12, Phase: preflop
2025-10-31 18:54:10,777 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:54:10,777 - poker_game - INFO - Pot: 460, Current bet: 440
2025-10-31 18:54:10,777 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:10,778 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:10,778 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:54:10,778 - poker_game - INFO - Community cards: []
2025-10-31 18:54:10,778 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:10,778 - poker_game - INFO -   P1(Agent1): chips=3088, bet=440, status=active
2025-10-31 18:54:10,779 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:10,779 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:54:10,779 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=folded
2025-10-31 18:54:10,779 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:54:10,779 - poker_game - INFO - ==================================================
2025-10-31 18:54:10,883 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:54:10,883 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:10,884 - poker_game - INFO - Remaining players: 1
2025-10-31 18:54:10,884 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:54:10,885 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:54:10,885 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:54:10,885 - poker_game - INFO - Hand #12, Phase: showdown
2025-10-31 18:54:10,886 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:54:10,886 - poker_game - INFO - Pot: 460, Current bet: 440
2025-10-31 18:54:10,886 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:10,887 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:10,887 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:54:10,887 - poker_game - INFO - Community cards: []
2025-10-31 18:54:10,890 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:10,890 - poker_game - INFO -   P1(Agent1): chips=3088, bet=440, status=active
2025-10-31 18:54:10,890 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:10,891 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=folded
2025-10-31 18:54:10,891 - poker_game - INFO -   P4(Agent4): chips=4631, bet=20, status=folded
2025-10-31 18:54:10,892 - poker_game - INFO - ==================================================
2025-10-31 18:54:10,892 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:54:10,893 - poker_game - INFO - Pot: 460, Community cards: []
2025-10-31 18:54:10,893 - poker_game - INFO -   Player 1 status=active cards=['Q♥', 'J♦']
2025-10-31 18:54:10,894 - poker_game - INFO - Showdown winner by default: Player 1 awarded 460
2025-10-31 18:54:10,895 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:54:10,897 - poker_game - INFO - === STARTING NEW HAND #13 ===
2025-10-31 18:54:10,899 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:54:10,900 - poker_game - INFO - Moving dealer button
2025-10-31 18:54:10,900 - poker_game - INFO - Posting blinds
2025-10-31 18:54:10,927 - poker_game - INFO - Dealing hole cards
2025-10-31 18:54:10,928 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:54:10,938 - poker_game - INFO - Started new hand in database: hand_id=13
2025-10-31 18:54:10,939 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:54:10,939 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:10,940 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:54:10,940 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:10,940 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:10,941 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:10,941 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:54:10,942 - poker_game - INFO - Community cards: []
2025-10-31 18:54:10,942 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:10,943 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:54:10,943 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:10,943 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:10,944 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=active
2025-10-31 18:54:10,945 - poker_game - INFO - ==================================================
2025-10-31 18:54:10,947 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "5♠",
    "J♥"
  ],
  "community": [],
  "your_chips": 4631,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3538,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1801,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (4631)"
  ],
  "history": [
    "Showdown: Player 1 won 840",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 18:54:11,050 - poker_game - DEBUG - Create Session: {'id': 'd8a75979-1445-491e-9e8f-18a0b7975dc8', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904451.0451372}
2025-10-31 18:54:21,181 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:54:22,465 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_notIAeTNLGrizciV57iKPqbl', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1096, 'totalTokenCount': 1113}, 'invocationId': 'e-da3f1e31-9360-4503-861b-a156ec347a9c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'NLna02vn', 'timestamp': 1761904451.066329}, {'content': {'parts': [{'functionResponse': {'id': 'call_notIAeTNLGrizciV57iKPqbl', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-da3f1e31-9360-4503-861b-a156ec347a9c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Lqo5SY6h', 'timestamp': 1761904452.664966}, {'content': {'parts': [{'functionCall': {'id': 'call_7fDmocqlAeJpBPypIsBnSIkc', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1620, 'totalTokenCount': 1637}, 'invocationId': 'e-da3f1e31-9360-4503-861b-a156ec347a9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'emBZwYiP', 'timestamp': 1761904452.670962}, {'content': {'parts': [{'functionResponse': {'id': 'call_7fDmocqlAeJpBPypIsBnSIkc', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-da3f1e31-9360-4503-861b-a156ec347a9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'dhEbwmaU', 'timestamp': 1761904453.795042}, {'content': {'parts': [{'functionCall': {'id': 'call_ItOZA5JvpmIPlKFMF1Cp9PBB', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['5♠', 'J♥'], 'community': [], 'your_chips': 4631, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3538, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 1801, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (4631)'], 'history': ['Showdown: Player 1 won 840', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 10♠, 4♠, 2♠', 'Player 3 checked', 'Player 4 raised to 20', 'Player 3 folded', 'Showdown: Player 4 won 60', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 440', 'Player 4 folded', 'Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.18}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 344, 'promptTokenCount': 1651, 'totalTokenCount': 1995}, 'invocationId': 'e-da3f1e31-9360-4503-861b-a156ec347a9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'fjr40epr', 'timestamp': 1761904453.800282}, {'content': {'parts': [{'functionResponse': {'id': 'call_ItOZA5JvpmIPlKFMF1Cp9PBB', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-7.40(ポットに対して-24.67%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'e-da3f1e31-9360-4503-861b-a156ec347a9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'n88zVOPA', 'timestamp': 1761904460.94153}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が-7.40(ポットに対して-24.67%で、マイナスなのでフォールド"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 41, 'promptTokenCount': 2033, 'totalTokenCount': 2074}, 'invocationId': 'e-da3f1e31-9360-4503-861b-a156ec347a9c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'HsQLivd9', 'timestamp': 1761904460.947583}]
2025-10-31 18:54:22,466 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:54:22,466 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が-7.40(ポットに対して-24.67%で、マイナスなのでフォールド"}
2025-10-31 18:54:22,466 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:54:22,467 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が-7.40(ポットに対して-24.67%で、マイナスなのでフォールド"}'
2025-10-31 18:54:22,467 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:54:22,467 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が-7.40(ポットに対して-24.67%で、マイナスなのでフォールド"}
2025-10-31 18:54:22,467 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-7.40(ポットに対して-24.67%で、マイナスなのでフォールド'}
2025-10-31 18:54:22,467 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:54:22,467 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:54:22,467 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:54:22,467 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が-7.40(ポットに対して-24.67%で、マイナスなのでフォールド
2025-10-31 18:54:22,468 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:54:22,468 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:22,469 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:22,469 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:54:22,469 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:22,469 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:22,469 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:22,470 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:54:22,470 - poker_game - INFO - Community cards: []
2025-10-31 18:54:22,470 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:22,470 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:54:22,470 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:22,471 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:22,471 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=active
2025-10-31 18:54:22,471 - poker_game - INFO - ==================================================
2025-10-31 18:54:22,471 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:54:22,489 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:22,489 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:22,490 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:54:22,490 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:22,491 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:22,491 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:22,491 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:22,491 - poker_game - INFO - Community cards: []
2025-10-31 18:54:22,492 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:22,492 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:54:22,492 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:22,492 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:22,492 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:22,492 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:54:22,492 - poker_game - INFO - ==================================================
2025-10-31 18:54:22,493 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:22,493 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:22,493 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:54:22,493 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:54:22,493 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:22,493 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:22,494 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:22,494 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 18:54:22,494 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:54:22,494 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:22,494 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:22,494 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:22,495 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:22,495 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:22,495 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:22,495 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:22,496 - poker_game - INFO - Community cards: []
2025-10-31 18:54:22,496 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:22,496 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:54:22,496 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:22,496 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:22,497 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:22,497 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:54:22,497 - poker_game - INFO - ==================================================
2025-10-31 18:54:22,599 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "3♠",
    "3♣"
  ],
  "community": [],
  "your_chips": 3538,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1801,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4631,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (3538)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded"
  ]
}
2025-10-31 18:54:22,608 - poker_game - DEBUG - Create Session: {'id': 'c6db5e1c-a993-4601-af6e-1039e67c5837', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904462.6065006}
2025-10-31 18:54:23,995 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップでポケットスリー（3-3）というハンドは、ペアであり、十分にプレイできるハンドです。現在のベット額は10で、コールするのに必要な額も10です。ポットサイズ（30）に対してコールするコストは比較的小さいため、フロップを見て、より良いハンドになる可能性を探る価値があります。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 105, 'promptTokenCount': 775, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 775}], 'totalTokenCount': 880}, 'invocationId': 'e-6e35fc1e-d79e-4a11-9377-c7816faa2c7d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'GmVGW13z', 'timestamp': 1761904462.617723}]
2025-10-31 18:54:23,996 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:54:23,996 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップでポケットスリー（3-3）というハンドは、ペアであり、十分にプレイできるハンドです。現在のベット額は10で、コールするのに必要な額も10です。ポットサイズ（30）に対してコールするコストは比較的小さいため、フロップを見て、より良いハンドになる可能性を探る価値があります。"
}
```
2025-10-31 18:54:23,997 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:54:23,997 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップでポケットスリー（3-3）というハンドは、ペアであり、十分にプレイできるハンドです。現在のベット額は10で、コールするのに必要な額も10です。ポットサイズ（30）に対してコールするコストは比較的小さいため、フロップを見て、より良いハンドになる可能性を探る価値があります。"\n}\n```'
2025-10-31 18:54:23,997 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:54:23,997 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップでポケットスリー（3-3）というハンドは、ペアであり、十分にプレイできるハンドです。現在のベット額は10で、コールするのに必要な額も10です。ポットサイズ（30）に対してコールするコストは比較的小さいため、フロップを見て、より良いハンドになる可能性を探る価値があります。"\n}'
2025-10-31 18:54:23,998 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップでポケットスリー（3-3）というハンドは、ペアであり、十分にプレイできるハンドです。現在のベット額は10で、コールするのに必要な額も10です。ポットサイズ（30）に対してコールするコストは比較的小さいため、フロップを見て、より良いハンドになる可能性を探る価値があります。"
}
2025-10-31 18:54:23,998 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップでポケットスリー（3-3）というハンドは、ペアであり、十分にプレイできるハンドです。現在のベット額は10で、コールするのに必要な額も10です。ポットサイズ（30）に対してコールするコストは比較的小さいため、フロップを見て、より良いハンドになる可能性を探る価値があります。'}
2025-10-31 18:54:23,998 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 10
2025-10-31 18:54:23,998 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (3538)']
2025-10-31 18:54:23,998 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (10)': 10
2025-10-31 18:54:23,998 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:54:23,999 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 10, プリフロップでポケットスリー（3-3）というハンドは、ペアであり、十分にプレイできるハンドです。現在のベット額は10で、コールするのに必要な額も10です。ポットサイズ（30）に対してコールするコストは比較的小さいため、フロップを見て、より良いハンドになる可能性を探る価値があります。
2025-10-31 18:54:24,000 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 10
2025-10-31 18:54:24,000 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:24,001 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:24,001 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:24,001 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:24,001 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:24,002 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:24,002 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:24,003 - poker_game - INFO - Community cards: []
2025-10-31 18:54:24,003 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:24,004 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:54:24,005 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:24,013 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:24,014 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:24,014 - poker_game - INFO - ==================================================
2025-10-31 18:54:24,015 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 10
2025-10-31 18:54:24,029 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:24,029 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:24,030 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:24,030 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:24,031 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:24,031 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:24,032 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:24,032 - poker_game - INFO - Community cards: []
2025-10-31 18:54:24,032 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:24,033 - poker_game - INFO -   P1(Agent1): chips=3528, bet=20, status=active
2025-10-31 18:54:24,033 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:24,034 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:24,034 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:24,035 - poker_game - INFO - Extra: Action: Player 1 called 10
2025-10-31 18:54:24,035 - poker_game - INFO - ==================================================
2025-10-31 18:54:24,035 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:24,036 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:24,036 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:54:24,036 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:54:24,037 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:24,037 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:24,037 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:24,037 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:54:24,038 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:54:24,038 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 18:54:24,038 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:54:24,038 - poker_game - DEBUG - Next after last raiser 3: 1
2025-10-31 18:54:24,038 - poker_game - DEBUG - Betting continues: Current player 3 != next after raiser 1
2025-10-31 18:54:24,039 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:24,039 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:24,040 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:54:24,040 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:24,041 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:24,042 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:24,042 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:24,043 - poker_game - INFO - Community cards: []
2025-10-31 18:54:24,044 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:24,044 - poker_game - INFO -   P1(Agent1): chips=3528, bet=20, status=active
2025-10-31 18:54:24,045 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:24,046 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:24,047 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:24,047 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:54:24,048 - poker_game - INFO - ==================================================
2025-10-31 18:54:24,153 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "2♦",
    "8♥"
  ],
  "community": [],
  "your_chips": 1801,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3528,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4631,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (1801)"
  ],
  "history": [
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10"
  ]
}
2025-10-31 18:54:24,182 - poker_game - DEBUG - Create Session: {'id': 'a3d79c2d-522f-480b-a965-5dc71c100201', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904464.178264}
2025-10-31 18:54:23,642 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップ（カードが配られた直後の最初のラウンド）では、あなたの手札（2♦, 8♥）はそれほど強くありません。しかし、ポットにはすでに40があり、コールに必要な金額は20です。これは「ポットオッズ」（ポットのサイズに対してコールに必要な金額の比率）が良い状況であり、フロップ（コミュニティカード）を見て、より良いハンド（役）ができる可能性を追求する価値があります。相手（Player 1）がプリフロップで大きなレイズ（賭け金を上げる行為）をしていないため、コールは合理的な選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 157, 'promptTokenCount': 769, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 769}], 'totalTokenCount': 926}, 'invocationId': 'e-784fc274-b2f6-43aa-8243-d16036886ad6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'GAo4DeYr', 'timestamp': 1761904464.192814}]
2025-10-31 18:54:23,643 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:54:23,643 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップ（カードが配られた直後の最初のラウンド）では、あなたの手札（2♦, 8♥）はそれほど強くありません。しかし、ポットにはすでに40があり、コールに必要な金額は20です。これは「ポットオッズ」（ポットのサイズに対してコールに必要な金額の比率）が良い状況であり、フロップ（コミュニティカード）を見て、より良いハンド（役）ができる可能性を追求する価値があります。相手（Player 1）がプリフロップで大きなレイズ（賭け金を上げる行為）をしていないため、コールは合理的な選択です。"
}
```
2025-10-31 18:54:23,643 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:54:23,643 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップ（カードが配られた直後の最初のラウンド）では、あなたの手札（2♦, 8♥）はそれほど強くありません。しかし、ポットにはすでに40があり、コールに必要な金額は20です。これは「ポットオッズ」（ポットのサイズに対してコールに必要な金額の比率）が良い状況であり、フロップ（コミュニティカード）を見て、より良いハンド（役）ができる可能性を追求する価値があります。相手（Player 1）がプリフロップで大きなレイズ（賭け金を上げる行為）をしていないため、コールは合理的な選択です。"\n}\n```'
2025-10-31 18:54:23,643 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:54:23,644 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップ（カードが配られた直後の最初のラウンド）では、あなたの手札（2♦, 8♥）はそれほど強くありません。しかし、ポットにはすでに40があり、コールに必要な金額は20です。これは「ポットオッズ」（ポットのサイズに対してコールに必要な金額の比率）が良い状況であり、フロップ（コミュニティカード）を見て、より良いハンド（役）ができる可能性を追求する価値があります。相手（Player 1）がプリフロップで大きなレイズ（賭け金を上げる行為）をしていないため、コールは合理的な選択です。"\n}'
2025-10-31 18:54:23,644 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップ（カードが配られた直後の最初のラウンド）では、あなたの手札（2♦, 8♥）はそれほど強くありません。しかし、ポットにはすでに40があり、コールに必要な金額は20です。これは「ポットオッズ」（ポットのサイズに対してコールに必要な金額の比率）が良い状況であり、フロップ（コミュニティカード）を見て、より良いハンド（役）ができる可能性を追求する価値があります。相手（Player 1）がプリフロップで大きなレイズ（賭け金を上げる行為）をしていないため、コールは合理的な選択です。"
}
2025-10-31 18:54:23,644 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップ（カードが配られた直後の最初のラウンド）では、あなたの手札（2♦, 8♥）はそれほど強くありません。しかし、ポットにはすでに40があり、コールに必要な金額は20です。これは「ポットオッズ」（ポットのサイズに対してコールに必要な金額の比率）が良い状況であり、フロップ（コミュニティカード）を見て、より良いハンド（役）ができる可能性を追求する価値があります。相手（Player 1）がプリフロップで大きなレイズ（賭け金を上げる行為）をしていないため、コールは合理的な選択です。'}
2025-10-31 18:54:23,644 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 20
2025-10-31 18:54:23,644 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (1801)']
2025-10-31 18:54:23,644 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:54:23,644 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 20, プリフロップ（カードが配られた直後の最初のラウンド）では、あなたの手札（2♦, 8♥）はそれほど強くありません。しかし、ポットにはすでに40があり、コールに必要な金額は20です。これは「ポットオッズ」（ポットのサイズに対してコールに必要な金額の比率）が良い状況であり、フロップ（コミュニティカード）を見て、より良いハンド（役）ができる可能性を追求する価値があります。相手（Player 1）がプリフロップで大きなレイズ（賭け金を上げる行為）をしていないため、コールは合理的な選択です。
2025-10-31 18:54:23,645 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 20
2025-10-31 18:54:23,645 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:23,645 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:23,645 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:54:23,646 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:23,646 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:23,646 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:23,646 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:23,646 - poker_game - INFO - Community cards: []
2025-10-31 18:54:23,646 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:23,647 - poker_game - INFO -   P1(Agent1): chips=3528, bet=20, status=active
2025-10-31 18:54:23,647 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:23,647 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:23,647 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:23,647 - poker_game - INFO - ==================================================
2025-10-31 18:54:23,648 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:54:23,667 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:23,667 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:23,667 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:54:23,667 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:23,667 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:23,668 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:23,668 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:23,668 - poker_game - INFO - Community cards: []
2025-10-31 18:54:23,668 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:23,668 - poker_game - INFO -   P1(Agent1): chips=3528, bet=20, status=active
2025-10-31 18:54:23,668 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:23,668 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:23,669 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:23,669 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:54:23,669 - poker_game - INFO - ==================================================
2025-10-31 18:54:23,669 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:23,669 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:23,669 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:54:23,669 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 18:54:23,669 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:23,669 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:23,669 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:23,669 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:54:23,669 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:54:23,670 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 18:54:23,670 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:54:23,670 - poker_game - DEBUG - Next after last raiser 3: 1
2025-10-31 18:54:23,670 - poker_game - INFO - Betting complete: Back to player 1 after last raiser 3
2025-10-31 18:54:23,670 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:23,670 - poker_game - INFO - Hand #13, Phase: preflop
2025-10-31 18:54:23,670 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:23,670 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:23,670 - poker_game - INFO - Last raiser: 3
2025-10-31 18:54:23,671 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:23,671 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:23,671 - poker_game - INFO - Community cards: []
2025-10-31 18:54:23,671 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:23,671 - poker_game - INFO -   P1(Agent1): chips=3528, bet=20, status=active
2025-10-31 18:54:23,671 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:23,671 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:54:23,671 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:23,672 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:54:23,672 - poker_game - INFO - ==================================================
2025-10-31 18:54:23,773 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:54:23,774 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:23,774 - poker_game - INFO - Remaining players: 2
2025-10-31 18:54:23,775 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:54:23,775 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:54:23,775 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:54:23,786 - poker_game - INFO - Starting new betting round
2025-10-31 18:54:23,786 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:54:23,787 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:54:23,787 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 18:54:23,787 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:54:23,787 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 18:54:23,788 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:54:23,788 - poker_game - INFO - Hand #13, Phase: flop
2025-10-31 18:54:23,789 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:23,789 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:54:23,790 - poker_game - INFO - Last raiser: None
2025-10-31 18:54:23,790 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:23,790 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:23,791 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:23,791 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:23,791 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=active
2025-10-31 18:54:23,792 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:23,792 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:54:23,792 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:23,795 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:54:23,796 - poker_game - INFO - ==================================================
2025-10-31 18:54:23,799 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "3♠",
    "3♣"
  ],
  "community": [
    "9♦",
    "10♥",
    "9♣"
  ],
  "your_chips": 3528,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1801,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4631,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3528)"
  ],
  "history": [
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣"
  ]
}
2025-10-31 18:54:23,814 - poker_game - DEBUG - Create Session: {'id': 'e4aff9b7-e126-43af-a753-d943879a04ad', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904463.811532}
2025-10-31 18:54:25,464 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 100,\n  "reasoning": "フロップでツーペア（9のペアと3のペア）が完成しました。これは非常に強いハンドなので、ベットしてポットを大きくし、相手を降ろさせるか、あるいはポットを大きくしたいです。相手のベット額が0なので、強気なレイズが適切です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 95, 'promptTokenCount': 795, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 795}], 'totalTokenCount': 890}, 'invocationId': 'e-a1cd0e14-595c-48da-9f63-9687c3abaef3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'N8Cd9zEX', 'timestamp': 1761904463.825381}]
2025-10-31 18:54:25,464 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:54:25,464 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 100,
  "reasoning": "フロップでツーペア（9のペアと3のペア）が完成しました。これは非常に強いハンドなので、ベットしてポットを大きくし、相手を降ろさせるか、あるいはポットを大きくしたいです。相手のベット額が0なので、強気なレイズが適切です。"
}
```
2025-10-31 18:54:25,465 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:54:25,465 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 100,\n  "reasoning": "フロップでツーペア（9のペアと3のペア）が完成しました。これは非常に強いハンドなので、ベットしてポットを大きくし、相手を降ろさせるか、あるいはポットを大きくしたいです。相手のベット額が0なので、強気なレイズが適切です。"\n}\n```'
2025-10-31 18:54:25,465 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:54:25,465 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 100,\n  "reasoning": "フロップでツーペア（9のペアと3のペア）が完成しました。これは非常に強いハンドなので、ベットしてポットを大きくし、相手を降ろさせるか、あるいはポットを大きくしたいです。相手のベット額が0なので、強気なレイズが適切です。"\n}'
2025-10-31 18:54:25,465 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 100,
  "reasoning": "フロップでツーペア（9のペアと3のペア）が完成しました。これは非常に強いハンドなので、ベットしてポットを大きくし、相手を降ろさせるか、あるいはポットを大きくしたいです。相手のベット額が0なので、強気なレイズが適切です。"
}
2025-10-31 18:54:25,465 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 100, 'reasoning': 'フロップでツーペア（9のペアと3のペア）が完成しました。これは非常に強いハンドなので、ベットしてポットを大きくし、相手を降ろさせるか、あるいはポットを大きくしたいです。相手のベット額が0なので、強気なレイズが適切です。'}
2025-10-31 18:54:25,465 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 100
2025-10-31 18:54:25,466 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (3528)']
2025-10-31 18:54:25,466 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:54:25,466 - poker_game - DEBUG - [Agent1] Raise amount 100 is valid (min: 20)
2025-10-31 18:54:25,466 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 100}
2025-10-31 18:54:25,466 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 100, フロップでツーペア（9のペアと3のペア）が完成しました。これは非常に強いハンドなので、ベットしてポットを大きくし、相手を降ろさせるか、あるいはポットを大きくしたいです。相手のベット額が0なので、強気なレイズが適切です。
2025-10-31 18:54:25,470 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 100
2025-10-31 18:54:25,470 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:25,471 - poker_game - INFO - Hand #13, Phase: flop
2025-10-31 18:54:25,474 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:25,475 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:54:25,475 - poker_game - INFO - Last raiser: None
2025-10-31 18:54:25,476 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:25,476 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:25,476 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:25,476 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:25,476 - poker_game - INFO -   P1(Agent1): chips=3528, bet=0, status=active
2025-10-31 18:54:25,476 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:25,476 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:54:25,477 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:25,477 - poker_game - INFO - ==================================================
2025-10-31 18:54:25,477 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 100
2025-10-31 18:54:25,490 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:25,491 - poker_game - INFO - Hand #13, Phase: flop
2025-10-31 18:54:25,491 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:25,491 - poker_game - INFO - Pot: 140, Current bet: 100
2025-10-31 18:54:25,491 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:25,492 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:25,492 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:25,492 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:25,492 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:25,492 - poker_game - INFO -   P1(Agent1): chips=3428, bet=100, status=active
2025-10-31 18:54:25,492 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:25,492 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:54:25,493 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:25,493 - poker_game - INFO - Extra: Action: Player 1 raised to 100
2025-10-31 18:54:25,493 - poker_game - INFO - ==================================================
2025-10-31 18:54:25,493 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:25,493 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:25,493 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:54:25,493 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:54:25,493 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:25,493 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:25,493 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:25,494 - poker_game - DEBUG - Player bets: [100, 0], Current bet: 100, All same: False
2025-10-31 18:54:25,494 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:54:25,494 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:25,494 - poker_game - INFO - Hand #13, Phase: flop
2025-10-31 18:54:25,494 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:54:25,494 - poker_game - INFO - Pot: 140, Current bet: 100
2025-10-31 18:54:25,494 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:25,495 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:25,495 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:25,495 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:25,496 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:25,496 - poker_game - INFO -   P1(Agent1): chips=3428, bet=100, status=active
2025-10-31 18:54:25,496 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:25,496 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:54:25,496 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:25,497 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:54:25,497 - poker_game - INFO - ==================================================
2025-10-31 18:54:25,599 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "2♦",
    "8♥"
  ],
  "community": [
    "9♦",
    "10♥",
    "9♣"
  ],
  "your_chips": 1801,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 140,
  "to_call": 100,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3428,
      "bet": 100,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4631,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (100)",
    "raise (min 120)",
    "all-in (1801)"
  ],
  "history": [
    "Player 4 checked",
    "Flop dealt: 10♠, 4♠, 2♠",
    "Player 3 checked",
    "Player 4 raised to 20",
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100"
  ]
}
2025-10-31 18:54:25,615 - poker_game - DEBUG - Create Session: {'id': '3041a10d-e373-4a87-820b-11fe08e05c76', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904465.6122847}
2025-10-31 18:54:27,362 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フロップ（ボードの最初の3枚のカード）で「9♦」「10♥」「9♣」が出ています。私の手札は「2♦」「8♥」なので、ペアもストレート（連続した数字の組み合わせ）もフラッシュ（同じマークのカードの組み合わせ）もありません。ボードには「9」が2枚あるので、対戦相手が「9」を持っている可能性が高いです。コールするには100チップ必要ですが、現状では勝てる見込みが低いため、フォールド（降りる）を選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 146, 'promptTokenCount': 807, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 807}], 'totalTokenCount': 953}, 'invocationId': 'e-5fcbf18e-5caf-45ea-92c9-f858441c9fe7', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'S5kyjYIQ', 'timestamp': 1761904465.626564}]
2025-10-31 18:54:27,363 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:54:27,363 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "フロップ（ボードの最初の3枚のカード）で「9♦」「10♥」「9♣」が出ています。私の手札は「2♦」「8♥」なので、ペアもストレート（連続した数字の組み合わせ）もフラッシュ（同じマークのカードの組み合わせ）もありません。ボードには「9」が2枚あるので、対戦相手が「9」を持っている可能性が高いです。コールするには100チップ必要ですが、現状では勝てる見込みが低いため、フォールド（降りる）を選択します。"
}
```
2025-10-31 18:54:27,363 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:54:27,363 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フロップ（ボードの最初の3枚のカード）で「9♦」「10♥」「9♣」が出ています。私の手札は「2♦」「8♥」なので、ペアもストレート（連続した数字の組み合わせ）もフラッシュ（同じマークのカードの組み合わせ）もありません。ボードには「9」が2枚あるので、対戦相手が「9」を持っている可能性が高いです。コールするには100チップ必要ですが、現状では勝てる見込みが低いため、フォールド（降りる）を選択します。"\n}\n```'
2025-10-31 18:54:27,363 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:54:27,363 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "フロップ（ボードの最初の3枚のカード）で「9♦」「10♥」「9♣」が出ています。私の手札は「2♦」「8♥」なので、ペアもストレート（連続した数字の組み合わせ）もフラッシュ（同じマークのカードの組み合わせ）もありません。ボードには「9」が2枚あるので、対戦相手が「9」を持っている可能性が高いです。コールするには100チップ必要ですが、現状では勝てる見込みが低いため、フォールド（降りる）を選択します。"\n}'
2025-10-31 18:54:27,363 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "フロップ（ボードの最初の3枚のカード）で「9♦」「10♥」「9♣」が出ています。私の手札は「2♦」「8♥」なので、ペアもストレート（連続した数字の組み合わせ）もフラッシュ（同じマークのカードの組み合わせ）もありません。ボードには「9」が2枚あるので、対戦相手が「9」を持っている可能性が高いです。コールするには100チップ必要ですが、現状では勝てる見込みが低いため、フォールド（降りる）を選択します。"
}
2025-10-31 18:54:27,364 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'フロップ（ボードの最初の3枚のカード）で「9♦」「10♥」「9♣」が出ています。私の手札は「2♦」「8♥」なので、ペアもストレート（連続した数字の組み合わせ）もフラッシュ（同じマークのカードの組み合わせ）もありません。ボードには「9」が2枚あるので、対戦相手が「9」を持っている可能性が高いです。コールするには100チップ必要ですが、現状では勝てる見込みが低いため、フォールド（降りる）を選択します。'}
2025-10-31 18:54:27,364 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:54:27,364 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:54:27,364 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:54:27,364 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, フロップ（ボードの最初の3枚のカード）で「9♦」「10♥」「9♣」が出ています。私の手札は「2♦」「8♥」なので、ペアもストレート（連続した数字の組み合わせ）もフラッシュ（同じマークのカードの組み合わせ）もありません。ボードには「9」が2枚あるので、対戦相手が「9」を持っている可能性が高いです。コールするには100チップ必要ですが、現状では勝てる見込みが低いため、フォールド（降りる）を選択します。
2025-10-31 18:54:27,365 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:54:27,365 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:27,365 - poker_game - INFO - Hand #13, Phase: flop
2025-10-31 18:54:27,365 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:54:27,365 - poker_game - INFO - Pot: 140, Current bet: 100
2025-10-31 18:54:27,365 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:27,366 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:27,366 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:27,366 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:27,366 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:27,366 - poker_game - INFO -   P1(Agent1): chips=3428, bet=100, status=active
2025-10-31 18:54:27,366 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:27,367 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:54:27,367 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:27,367 - poker_game - INFO - ==================================================
2025-10-31 18:54:27,367 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:54:27,376 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:27,377 - poker_game - INFO - Hand #13, Phase: flop
2025-10-31 18:54:27,377 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:54:27,377 - poker_game - INFO - Pot: 140, Current bet: 100
2025-10-31 18:54:27,377 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:27,377 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:27,378 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:54:27,378 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:27,378 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:27,378 - poker_game - INFO -   P1(Agent1): chips=3428, bet=100, status=active
2025-10-31 18:54:27,379 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:27,379 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=folded
2025-10-31 18:54:27,379 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:27,379 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:54:27,379 - poker_game - INFO - ==================================================
2025-10-31 18:54:27,379 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:27,380 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:27,380 - poker_game - DEBUG - Active players: [1]
2025-10-31 18:54:27,380 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 18:54:27,380 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:27,380 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:27,380 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:54:27,381 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:54:27,381 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:27,381 - poker_game - INFO - Hand #13, Phase: flop
2025-10-31 18:54:27,381 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:27,381 - poker_game - INFO - Pot: 140, Current bet: 100
2025-10-31 18:54:27,382 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:27,382 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:27,382 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:54:27,383 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:27,384 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:27,384 - poker_game - INFO -   P1(Agent1): chips=3428, bet=100, status=active
2025-10-31 18:54:27,384 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:27,384 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=folded
2025-10-31 18:54:27,385 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:27,385 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:54:27,385 - poker_game - INFO - ==================================================
2025-10-31 18:54:27,485 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:54:27,486 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:27,487 - poker_game - INFO - Remaining players: 1
2025-10-31 18:54:27,487 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:54:27,487 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:54:27,488 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:54:27,488 - poker_game - INFO - Hand #13, Phase: showdown
2025-10-31 18:54:27,489 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:54:27,489 - poker_game - INFO - Pot: 140, Current bet: 100
2025-10-31 18:54:27,490 - poker_game - INFO - Last raiser: 1
2025-10-31 18:54:27,490 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:27,490 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:54:27,491 - poker_game - INFO - Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:27,491 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:27,491 - poker_game - INFO -   P1(Agent1): chips=3428, bet=100, status=active
2025-10-31 18:54:27,492 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:27,492 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=folded
2025-10-31 18:54:27,492 - poker_game - INFO -   P4(Agent4): chips=4631, bet=0, status=folded
2025-10-31 18:54:27,492 - poker_game - INFO - ==================================================
2025-10-31 18:54:27,492 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:54:27,493 - poker_game - INFO - Pot: 140, Community cards: ['9♦', '10♥', '9♣']
2025-10-31 18:54:27,493 - poker_game - INFO -   Player 1 status=active cards=['3♠', '3♣']
2025-10-31 18:54:27,494 - poker_game - INFO - Showdown winner by default: Player 1 awarded 140
2025-10-31 18:54:27,494 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:54:27,495 - poker_game - INFO - === STARTING NEW HAND #14 ===
2025-10-31 18:54:27,496 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:54:27,497 - poker_game - INFO - Moving dealer button
2025-10-31 18:54:27,499 - poker_game - INFO - Posting blinds
2025-10-31 18:54:27,525 - poker_game - INFO - Dealing hole cards
2025-10-31 18:54:27,526 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:54:27,536 - poker_game - INFO - Started new hand in database: hand_id=14
2025-10-31 18:54:27,537 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:54:27,538 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:27,538 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:54:27,539 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:27,539 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:27,540 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:27,540 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:54:27,540 - poker_game - INFO - Community cards: []
2025-10-31 18:54:27,541 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:27,541 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=active
2025-10-31 18:54:27,542 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:27,542 - poker_game - INFO -   P3(Agent3): chips=1791, bet=10, status=active
2025-10-31 18:54:27,543 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:27,543 - poker_game - INFO - ==================================================
2025-10-31 18:54:27,544 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "2♣",
    "3♦"
  ],
  "community": [],
  "your_chips": 3568,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1791,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (3568)"
  ],
  "history": [
    "Player 3 folded",
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:54:27,562 - poker_game - DEBUG - Create Session: {'id': 'f180d5a9-4c0b-4efa-99b3-75702ab8968a', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904467.559636}
2025-10-31 18:54:29,391 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Preflopで2と3のオフスート（同じスートではない）は非常に弱いハンドであり、コールするにはリスクが高すぎます。ポットサイズとベット額を考慮すると、このハンドでプレイし続けるのは適切ではありません。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 79, 'promptTokenCount': 782, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 782}], 'totalTokenCount': 861}, 'invocationId': 'e-8c4764be-0e44-4eb9-b5d0-f2c4df09dec6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'c02bGwlp', 'timestamp': 1761904467.576277}]
2025-10-31 18:54:29,391 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:54:29,391 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "Preflopで2と3のオフスート（同じスートではない）は非常に弱いハンドであり、コールするにはリスクが高すぎます。ポットサイズとベット額を考慮すると、このハンドでプレイし続けるのは適切ではありません。"
}
```
2025-10-31 18:54:29,391 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Preflopで2と3のオフスート（同じスートではない）は非常に弱いハンドであり、コールするにはリスクが高すぎます。ポットサイズとベット額を考慮すると、このハンドでプレイし続けるのは適切ではありません。"\n}\n```'
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Preflopで2と3のオフスート（同じスートではない）は非常に弱いハンドであり、コールするにはリスクが高すぎます。ポットサイズとベット額を考慮すると、このハンドでプレイし続けるのは適切ではありません。"\n}'
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "Preflopで2と3のオフスート（同じスートではない）は非常に弱いハンドであり、コールするにはリスクが高すぎます。ポットサイズとベット額を考慮すると、このハンドでプレイし続けるのは適切ではありません。"
}
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'Preflopで2と3のオフスート（同じスートではない）は非常に弱いハンドであり、コールするにはリスクが高すぎます。ポットサイズとベット額を考慮すると、このハンドでプレイし続けるのは適切ではありません。'}
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:54:29,392 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:54:29,392 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, Preflopで2と3のオフスート（同じスートではない）は非常に弱いハンドであり、コールするにはリスクが高すぎます。ポットサイズとベット額を考慮すると、このハンドでプレイし続けるのは適切ではありません。
2025-10-31 18:54:29,393 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:54:29,393 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:29,393 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:29,394 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:54:29,394 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:29,394 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:29,394 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:29,394 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:54:29,394 - poker_game - INFO - Community cards: []
2025-10-31 18:54:29,394 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:29,394 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=active
2025-10-31 18:54:29,395 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:29,395 - poker_game - INFO -   P3(Agent3): chips=1791, bet=10, status=active
2025-10-31 18:54:29,395 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:29,395 - poker_game - INFO - ==================================================
2025-10-31 18:54:29,395 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:54:29,403 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:29,404 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:29,404 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:54:29,404 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:29,404 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:29,405 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:29,405 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:29,405 - poker_game - INFO - Community cards: []
2025-10-31 18:54:29,405 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:29,405 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:29,406 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:29,406 - poker_game - INFO -   P3(Agent3): chips=1791, bet=10, status=active
2025-10-31 18:54:29,406 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:29,406 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:54:29,406 - poker_game - INFO - ==================================================
2025-10-31 18:54:29,407 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:29,407 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:29,407 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:54:29,407 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:54:29,407 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:29,407 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:29,408 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:29,408 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 18:54:29,408 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:54:29,408 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:29,408 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:29,408 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:54:29,409 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:29,409 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:29,409 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:29,409 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:29,409 - poker_game - INFO - Community cards: []
2025-10-31 18:54:29,410 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:29,410 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:29,410 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:29,410 - poker_game - INFO -   P3(Agent3): chips=1791, bet=10, status=active
2025-10-31 18:54:29,411 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:29,411 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:54:29,411 - poker_game - INFO - ==================================================
2025-10-31 18:54:29,513 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "9♠",
    "8♥"
  ],
  "community": [],
  "your_chips": 1791,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1791)"
  ],
  "history": [
    "Showdown: Player 4 won 60",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded"
  ]
}
2025-10-31 18:54:29,531 - poker_game - DEBUG - Create Session: {'id': '3a9d85c1-7d09-49bf-a485-28aa9e0dc723', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904469.5276902}
2025-10-31 18:54:31,721 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、98s（9と8のスーテッド、つまり同じスーツ）は、ポジションと相手のアクション次第でプレイできるハンドです。今回は、ポットが30で、コールに必要なのは10、つまりポットオッズ（コールに必要な額に対するポットの大きさの比率）は3:1です。これは、このハンドで勝つ確率が25%以上あればコールが利益的になることを意味します。相手のプレイヤーが1人だけアクティブで、そのプレイヤーがすでに20ベットしている状況を考慮すると、98sは十分にプレイできるハンドと判断しました。レイズも選択肢ですが、相手のレンジ（相手が持っている可能性のあるハンドの範囲）が不明なため、まずはコールでフロップを見て、その後の展開を判断するのが安全策です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 204, 'promptTokenCount': 783, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 783}], 'totalTokenCount': 987}, 'invocationId': 'e-06f33782-9b9f-4a0e-bf99-c66f698f2fcc', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'xOCQYsuM', 'timestamp': 1761904469.546233}]
2025-10-31 18:54:31,721 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:54:31,721 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで、98s（9と8のスーテッド、つまり同じスーツ）は、ポジションと相手のアクション次第でプレイできるハンドです。今回は、ポットが30で、コールに必要なのは10、つまりポットオッズ（コールに必要な額に対するポットの大きさの比率）は3:1です。これは、このハンドで勝つ確率が25%以上あればコールが利益的になることを意味します。相手のプレイヤーが1人だけアクティブで、そのプレイヤーがすでに20ベットしている状況を考慮すると、98sは十分にプレイできるハンドと判断しました。レイズも選択肢ですが、相手のレンジ（相手が持っている可能性のあるハンドの範囲）が不明なため、まずはコールでフロップを見て、その後の展開を判断するのが安全策です。"
}
```
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、98s（9と8のスーテッド、つまり同じスーツ）は、ポジションと相手のアクション次第でプレイできるハンドです。今回は、ポットが30で、コールに必要なのは10、つまりポットオッズ（コールに必要な額に対するポットの大きさの比率）は3:1です。これは、このハンドで勝つ確率が25%以上あればコールが利益的になることを意味します。相手のプレイヤーが1人だけアクティブで、そのプレイヤーがすでに20ベットしている状況を考慮すると、98sは十分にプレイできるハンドと判断しました。レイズも選択肢ですが、相手のレンジ（相手が持っている可能性のあるハンドの範囲）が不明なため、まずはコールでフロップを見て、その後の展開を判断するのが安全策です。"\n}\n```'
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、98s（9と8のスーテッド、つまり同じスーツ）は、ポジションと相手のアクション次第でプレイできるハンドです。今回は、ポットが30で、コールに必要なのは10、つまりポットオッズ（コールに必要な額に対するポットの大きさの比率）は3:1です。これは、このハンドで勝つ確率が25%以上あればコールが利益的になることを意味します。相手のプレイヤーが1人だけアクティブで、そのプレイヤーがすでに20ベットしている状況を考慮すると、98sは十分にプレイできるハンドと判断しました。レイズも選択肢ですが、相手のレンジ（相手が持っている可能性のあるハンドの範囲）が不明なため、まずはコールでフロップを見て、その後の展開を判断するのが安全策です。"\n}'
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで、98s（9と8のスーテッド、つまり同じスーツ）は、ポジションと相手のアクション次第でプレイできるハンドです。今回は、ポットが30で、コールに必要なのは10、つまりポットオッズ（コールに必要な額に対するポットの大きさの比率）は3:1です。これは、このハンドで勝つ確率が25%以上あればコールが利益的になることを意味します。相手のプレイヤーが1人だけアクティブで、そのプレイヤーがすでに20ベットしている状況を考慮すると、98sは十分にプレイできるハンドと判断しました。レイズも選択肢ですが、相手のレンジ（相手が持っている可能性のあるハンドの範囲）が不明なため、まずはコールでフロップを見て、その後の展開を判断するのが安全策です。"
}
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップで、98s（9と8のスーテッド、つまり同じスーツ）は、ポジションと相手のアクション次第でプレイできるハンドです。今回は、ポットが30で、コールに必要なのは10、つまりポットオッズ（コールに必要な額に対するポットの大きさの比率）は3:1です。これは、このハンドで勝つ確率が25%以上あればコールが利益的になることを意味します。相手のプレイヤーが1人だけアクティブで、そのプレイヤーがすでに20ベットしている状況を考慮すると、98sは十分にプレイできるハンドと判断しました。レイズも選択肢ですが、相手のレンジ（相手が持っている可能性のあるハンドの範囲）が不明なため、まずはコールでフロップを見て、その後の展開を判断するのが安全策です。'}
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 10
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (1791)']
2025-10-31 18:54:31,722 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (10)': 10
2025-10-31 18:54:31,723 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:54:31,723 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 10, プリフロップで、98s（9と8のスーテッド、つまり同じスーツ）は、ポジションと相手のアクション次第でプレイできるハンドです。今回は、ポットが30で、コールに必要なのは10、つまりポットオッズ（コールに必要な額に対するポットの大きさの比率）は3:1です。これは、このハンドで勝つ確率が25%以上あればコールが利益的になることを意味します。相手のプレイヤーが1人だけアクティブで、そのプレイヤーがすでに20ベットしている状況を考慮すると、98sは十分にプレイできるハンドと判断しました。レイズも選択肢ですが、相手のレンジ（相手が持っている可能性のあるハンドの範囲）が不明なため、まずはコールでフロップを見て、その後の展開を判断するのが安全策です。
2025-10-31 18:54:31,723 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 10
2025-10-31 18:54:31,724 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:31,724 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:31,724 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:54:31,724 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:54:31,724 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:31,724 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:31,725 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:31,725 - poker_game - INFO - Community cards: []
2025-10-31 18:54:31,725 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:31,725 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:31,725 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:31,726 - poker_game - INFO -   P3(Agent3): chips=1791, bet=10, status=active
2025-10-31 18:54:31,726 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:31,726 - poker_game - INFO - ==================================================
2025-10-31 18:54:31,726 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 10
2025-10-31 18:54:31,738 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:31,738 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:31,738 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:54:31,738 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:31,738 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:31,738 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:31,739 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:31,739 - poker_game - INFO - Community cards: []
2025-10-31 18:54:31,739 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:31,739 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:31,739 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:31,739 - poker_game - INFO -   P3(Agent3): chips=1781, bet=20, status=active
2025-10-31 18:54:31,739 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:31,739 - poker_game - INFO - Extra: Action: Player 3 called 10
2025-10-31 18:54:31,739 - poker_game - INFO - ==================================================
2025-10-31 18:54:31,739 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:31,740 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:31,740 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:54:31,740 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:54:31,740 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:31,740 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:31,740 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:31,740 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:54:31,740 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:54:31,740 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:54:31,740 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:54:31,740 - poker_game - DEBUG - Next after last raiser 4: 3
2025-10-31 18:54:31,741 - poker_game - DEBUG - Betting continues: Current player 4 != next after raiser 3
2025-10-31 18:54:31,741 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:31,741 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:31,741 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:54:31,741 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:31,741 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:31,741 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:31,742 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:31,742 - poker_game - INFO - Community cards: []
2025-10-31 18:54:31,742 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:31,742 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:31,742 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:31,743 - poker_game - INFO -   P3(Agent3): chips=1781, bet=20, status=active
2025-10-31 18:54:31,743 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:31,743 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:54:31,743 - poker_game - INFO - ==================================================
2025-10-31 18:54:31,845 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "K♦",
    "5♦"
  ],
  "community": [],
  "your_chips": 4611,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1781,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (4611)"
  ],
  "history": [
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10"
  ]
}
2025-10-31 18:54:31,859 - poker_game - DEBUG - Create Session: {'id': '77774ff4-b625-4a69-93a4-6e789ab74997', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904471.8567164}
2025-10-31 18:54:41,914 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:54:54,069 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_augo7eJYt9D08nHlrEC3cOgk', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1089, 'totalTokenCount': 1106}, 'invocationId': 'e-59220927-e808-4171-8397-2029264534cc', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'XyxcSVd0', 'timestamp': 1761904471.869758}, {'content': {'parts': [{'functionResponse': {'id': 'call_augo7eJYt9D08nHlrEC3cOgk', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-59220927-e808-4171-8397-2029264534cc', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'kFL3yZbu', 'timestamp': 1761904472.876953}, {'content': {'parts': [{'functionCall': {'id': 'call_XCAWUrgGm4Qhc6xAtTy7oZYL', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['K♦', '5♦'], 'community': [], 'your_chips': 4611, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (4611)'], 'history': ['Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 440', 'Player 4 folded', 'Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.35}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_BTJHONE8qEntpAZKRnDvihw1', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['K♦', '5♦'], 'community': [], 'your_chips': 4611, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (4611)'], 'history': ['Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 440', 'Player 4 folded', 'Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.35}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 656, 'promptTokenCount': 1613, 'totalTokenCount': 2269}, 'invocationId': 'e-59220927-e808-4171-8397-2029264534cc', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'H2LxzVin', 'timestamp': 1761904472.881242}, {'content': {'parts': [{'functionResponse': {'id': 'call_XCAWUrgGm4Qhc6xAtTy7oZYL', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（14.00(ポットに対して35.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_BTJHONE8qEntpAZKRnDvihw1', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（14.00(ポットに対して35.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'CDtjkPZA', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'CTyNr2aZ', 'timestamp': 1761904489.887441}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い(14.00(ポットに対して35.00%)ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 37, 'promptTokenCount': 2495, 'totalTokenCount': 2532}, 'invocationId': 'e-59220927-e808-4171-8397-2029264534cc', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'WkHZhzDZ', 'timestamp': 1761904489.890321}]
2025-10-31 18:54:54,069 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:54:54,069 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い(14.00(ポットに対して35.00%)ため、チェックします"}
2025-10-31 18:54:54,070 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:54:54,070 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い(14.00(ポットに対して35.00%)ため、チェックします"}'
2025-10-31 18:54:54,070 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:54:54,070 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い(14.00(ポットに対して35.00%)ため、チェックします"}
2025-10-31 18:54:54,070 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い(14.00(ポットに対して35.00%)ため、チェックします'}
2025-10-31 18:54:54,070 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:54:54,071 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:54:54,071 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:54:54,071 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い(14.00(ポットに対して35.00%)ため、チェックします
2025-10-31 18:54:54,072 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:54:54,073 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:54,073 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:54,073 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:54:54,073 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:54,074 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:54,074 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:54,074 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:54,074 - poker_game - INFO - Community cards: []
2025-10-31 18:54:54,074 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:54,074 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:54,075 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:54,075 - poker_game - INFO -   P3(Agent3): chips=1781, bet=20, status=active
2025-10-31 18:54:54,075 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:54,075 - poker_game - INFO - ==================================================
2025-10-31 18:54:54,075 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:54:54,087 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:54,087 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:54,088 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:54:54,088 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:54,088 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:54,088 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:54,088 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:54,088 - poker_game - INFO - Community cards: []
2025-10-31 18:54:54,088 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:54,089 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:54,089 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:54,089 - poker_game - INFO -   P3(Agent3): chips=1781, bet=20, status=active
2025-10-31 18:54:54,089 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:54,089 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:54:54,089 - poker_game - INFO - ==================================================
2025-10-31 18:54:54,089 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:54,089 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:54,089 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:54:54,089 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:54:54,089 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:54,090 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:54,090 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:54,090 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:54:54,090 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:54:54,090 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:54:54,090 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:54:54,090 - poker_game - DEBUG - Next after last raiser 4: 3
2025-10-31 18:54:54,090 - poker_game - INFO - Betting complete: Back to player 3 after last raiser 4
2025-10-31 18:54:54,090 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:54,090 - poker_game - INFO - Hand #14, Phase: preflop
2025-10-31 18:54:54,090 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:54:54,091 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:54:54,091 - poker_game - INFO - Last raiser: 4
2025-10-31 18:54:54,091 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:54,091 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:54,091 - poker_game - INFO - Community cards: []
2025-10-31 18:54:54,091 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:54,091 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:54,091 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:54,091 - poker_game - INFO -   P3(Agent3): chips=1781, bet=20, status=active
2025-10-31 18:54:54,091 - poker_game - INFO -   P4(Agent4): chips=4611, bet=20, status=active
2025-10-31 18:54:54,092 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:54:54,092 - poker_game - INFO - ==================================================
2025-10-31 18:54:54,193 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:54:54,194 - poker_game - INFO - Betting round complete: True
2025-10-31 18:54:54,195 - poker_game - INFO - Remaining players: 2
2025-10-31 18:54:54,195 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:54:54,195 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:54:54,196 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:54:54,205 - poker_game - INFO - Starting new betting round
2025-10-31 18:54:54,205 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:54:54,206 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:54:54,206 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:54:54,206 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:54:54,206 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 18:54:54,206 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:54:54,207 - poker_game - INFO - Hand #14, Phase: flop
2025-10-31 18:54:54,207 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:54:54,207 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:54:54,208 - poker_game - INFO - Last raiser: None
2025-10-31 18:54:54,208 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:54,208 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:54,209 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠']
2025-10-31 18:54:54,209 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:54,210 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:54,210 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:54,211 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:54:54,211 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:54:54,212 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:54:54,212 - poker_game - INFO - ==================================================
2025-10-31 18:54:54,213 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "9♠",
    "8♥"
  ],
  "community": [
    "4♣",
    "Q♠",
    "10♠"
  ],
  "your_chips": 1781,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1781)"
  ],
  "history": [
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠"
  ]
}
2025-10-31 18:54:54,221 - poker_game - DEBUG - Create Session: {'id': 'c7b91a67-2d18-44e0-90d5-ab70e710fbf5', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904494.2195458}
2025-10-31 18:54:52,219 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札は9♠ 8♥、コミュニティカードは4♣ Q♠ 10♠です。これは、ストレート（5枚のカードを連続した数字で揃えること）のドロー（完成させるためのカードがまだ出る可能性があること）の状況です。具体的には、6かJが出ればストレートが完成します。また、フロップにQと10があり、あなたの手札に9があるため、2ペア（同じ数字のカードを2組揃えること）の可能性もあります。さらに、コミュニティカードにスペードが2枚あるため、フラッシュ（同じスートのカードを5枚揃えること）のドローの可能性も考慮する必要があります。現在のポットは40で、コール（相手のベット額と同じ額を支払ってゲームを続けること）に必要な額は0です。これは、前のプレイヤーがチェック（ベットせずに次のプレイヤーに順番を回すこと）したためです。対戦相手は1人（プレイヤー4）で、彼のアクションはまだ不明です。しかし、相手がチェックをしたということは、彼も強い手を持っていないか、あるいはブラフ（虚勢を張ること）の可能性があります。あなたの手札はそれほど強くありませんが、ストレートや2ペアの可能性があり、相手がチェックをしたため、ローリスクで次のカード（ターン）を見ることができます。したがって、コールを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 336, 'promptTokenCount': 796, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 796}], 'totalTokenCount': 1132}, 'invocationId': 'e-8bee3420-a68f-4cf8-8f68-bd5b1b44ce99', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QW519tms', 'timestamp': 1761904494.231363}]
2025-10-31 18:54:52,220 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:54:52,220 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札は9♠ 8♥、コミュニティカードは4♣ Q♠ 10♠です。これは、ストレート（5枚のカードを連続した数字で揃えること）のドロー（完成させるためのカードがまだ出る可能性があること）の状況です。具体的には、6かJが出ればストレートが完成します。また、フロップにQと10があり、あなたの手札に9があるため、2ペア（同じ数字のカードを2組揃えること）の可能性もあります。さらに、コミュニティカードにスペードが2枚あるため、フラッシュ（同じスートのカードを5枚揃えること）のドローの可能性も考慮する必要があります。現在のポットは40で、コール（相手のベット額と同じ額を支払ってゲームを続けること）に必要な額は0です。これは、前のプレイヤーがチェック（ベットせずに次のプレイヤーに順番を回すこと）したためです。対戦相手は1人（プレイヤー4）で、彼のアクションはまだ不明です。しかし、相手がチェックをしたということは、彼も強い手を持っていないか、あるいはブラフ（虚勢を張ること）の可能性があります。あなたの手札はそれほど強くありませんが、ストレートや2ペアの可能性があり、相手がチェックをしたため、ローリスクで次のカード（ターン）を見ることができます。したがって、コールを選択します。"
}
```
2025-10-31 18:54:52,220 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:54:52,220 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札は9♠ 8♥、コミュニティカードは4♣ Q♠ 10♠です。これは、ストレート（5枚のカードを連続した数字で揃えること）のドロー（完成させるためのカードがまだ出る可能性があること）の状況です。具体的には、6かJが出ればストレートが完成します。また、フロップにQと10があり、あなたの手札に9があるため、2ペア（同じ数字のカードを2組揃えること）の可能性もあります。さらに、コミュニティカードにスペードが2枚あるため、フラッシュ（同じスートのカードを5枚揃えること）のドローの可能性も考慮する必要があります。現在のポットは40で、コール（相手のベット額と同じ額を支払ってゲームを続けること）に必要な額は0です。これは、前のプレイヤーがチェック（ベットせずに次のプレイヤーに順番を回すこと）したためです。対戦相手は1人（プレイヤー4）で、彼のアクションはまだ不明です。しかし、相手がチェックをしたということは、彼も強い手を持っていないか、あるいはブラフ（虚勢を張ること）の可能性があります。あなたの手札はそれほど強くありませんが、ストレートや2ペアの可能性があり、相手がチェックをしたため、ローリスクで次のカード（ターン）を見ることができます。したがって、コールを選択します。"\n}\n```'
2025-10-31 18:54:52,220 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:54:52,220 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札は9♠ 8♥、コミュニティカードは4♣ Q♠ 10♠です。これは、ストレート（5枚のカードを連続した数字で揃えること）のドロー（完成させるためのカードがまだ出る可能性があること）の状況です。具体的には、6かJが出ればストレートが完成します。また、フロップにQと10があり、あなたの手札に9があるため、2ペア（同じ数字のカードを2組揃えること）の可能性もあります。さらに、コミュニティカードにスペードが2枚あるため、フラッシュ（同じスートのカードを5枚揃えること）のドローの可能性も考慮する必要があります。現在のポットは40で、コール（相手のベット額と同じ額を支払ってゲームを続けること）に必要な額は0です。これは、前のプレイヤーがチェック（ベットせずに次のプレイヤーに順番を回すこと）したためです。対戦相手は1人（プレイヤー4）で、彼のアクションはまだ不明です。しかし、相手がチェックをしたということは、彼も強い手を持っていないか、あるいはブラフ（虚勢を張ること）の可能性があります。あなたの手札はそれほど強くありませんが、ストレートや2ペアの可能性があり、相手がチェックをしたため、ローリスクで次のカード（ターン）を見ることができます。したがって、コールを選択します。"\n}'
2025-10-31 18:54:52,220 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札は9♠ 8♥、コミュニティカードは4♣ Q♠ 10♠です。これは、ストレート（5枚のカードを連続した数字で揃えること）のドロー（完成させるためのカードがまだ出る可能性があること）の状況です。具体的には、6かJが出ればストレートが完成します。また、フロップにQと10があり、あなたの手札に9があるため、2ペア（同じ数字のカードを2組揃えること）の可能性もあります。さらに、コミュニティカードにスペードが2枚あるため、フラッシュ（同じスートのカードを5枚揃えること）のドローの可能性も考慮する必要があります。現在のポットは40で、コール（相手のベット額と同じ額を支払ってゲームを続けること）に必要な額は0です。これは、前のプレイヤーがチェック（ベットせずに次のプレイヤーに順番を回すこと）したためです。対戦相手は1人（プレイヤー4）で、彼のアクションはまだ不明です。しかし、相手がチェックをしたということは、彼も強い手を持っていないか、あるいはブラフ（虚勢を張ること）の可能性があります。あなたの手札はそれほど強くありませんが、ストレートや2ペアの可能性があり、相手がチェックをしたため、ローリスクで次のカード（ターン）を見ることができます。したがって、コールを選択します。"
}
2025-10-31 18:54:52,220 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': 'フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札は9♠ 8♥、コミュニティカードは4♣ Q♠ 10♠です。これは、ストレート（5枚のカードを連続した数字で揃えること）のドロー（完成させるためのカードがまだ出る可能性があること）の状況です。具体的には、6かJが出ればストレートが完成します。また、フロップにQと10があり、あなたの手札に9があるため、2ペア（同じ数字のカードを2組揃えること）の可能性もあります。さらに、コミュニティカードにスペードが2枚あるため、フラッシュ（同じスートのカードを5枚揃えること）のドローの可能性も考慮する必要があります。現在のポットは40で、コール（相手のベット額と同じ額を支払ってゲームを続けること）に必要な額は0です。これは、前のプレイヤーがチェック（ベットせずに次のプレイヤーに順番を回すこと）したためです。対戦相手は1人（プレイヤー4）で、彼のアクションはまだ不明です。しかし、相手がチェックをしたということは、彼も強い手を持っていないか、あるいはブラフ（虚勢を張ること）の可能性があります。あなたの手札はそれほど強くありませんが、ストレートや2ペアの可能性があり、相手がチェックをしたため、ローリスクで次のカード（ターン）を見ることができます。したがって、コールを選択します。'}
2025-10-31 18:54:52,221 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 0
2025-10-31 18:54:52,221 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1781)']
2025-10-31 18:54:52,221 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:54:52,221 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 0, フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札は9♠ 8♥、コミュニティカードは4♣ Q♠ 10♠です。これは、ストレート（5枚のカードを連続した数字で揃えること）のドロー（完成させるためのカードがまだ出る可能性があること）の状況です。具体的には、6かJが出ればストレートが完成します。また、フロップにQと10があり、あなたの手札に9があるため、2ペア（同じ数字のカードを2組揃えること）の可能性もあります。さらに、コミュニティカードにスペードが2枚あるため、フラッシュ（同じスートのカードを5枚揃えること）のドローの可能性も考慮する必要があります。現在のポットは40で、コール（相手のベット額と同じ額を支払ってゲームを続けること）に必要な額は0です。これは、前のプレイヤーがチェック（ベットせずに次のプレイヤーに順番を回すこと）したためです。対戦相手は1人（プレイヤー4）で、彼のアクションはまだ不明です。しかし、相手がチェックをしたということは、彼も強い手を持っていないか、あるいはブラフ（虚勢を張ること）の可能性があります。あなたの手札はそれほど強くありませんが、ストレートや2ペアの可能性があり、相手がチェックをしたため、ローリスクで次のカード（ターン）を見ることができます。したがって、コールを選択します。
2025-10-31 18:54:52,221 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 0
2025-10-31 18:54:52,222 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:54:52,222 - poker_game - INFO - Hand #14, Phase: flop
2025-10-31 18:54:52,222 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:54:52,222 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:54:52,223 - poker_game - INFO - Last raiser: None
2025-10-31 18:54:52,223 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:52,223 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:52,223 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠']
2025-10-31 18:54:52,223 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:52,224 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:52,224 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:52,224 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:54:52,224 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:54:52,224 - poker_game - INFO - ==================================================
2025-10-31 18:54:52,225 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:54:52,243 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:54:52,243 - poker_game - INFO - Hand #14, Phase: flop
2025-10-31 18:54:52,244 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:54:52,244 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:54:52,244 - poker_game - INFO - Last raiser: None
2025-10-31 18:54:52,244 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:52,244 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:52,245 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠']
2025-10-31 18:54:52,245 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:52,245 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:52,245 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:52,245 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:54:52,245 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:54:52,246 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:54:52,246 - poker_game - INFO - ==================================================
2025-10-31 18:54:52,246 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:54:52,246 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:54:52,246 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:54:52,247 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:54:52,247 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:54:52,247 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:54:52,247 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:54:52,247 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:54:52,247 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:54:52,248 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:54:52,248 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:54:52,248 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:54:52,249 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:54:52,249 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:54:52,249 - poker_game - INFO - Hand #14, Phase: flop
2025-10-31 18:54:52,249 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:54:52,249 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:54:52,249 - poker_game - INFO - Last raiser: None
2025-10-31 18:54:52,250 - poker_game - INFO - Betting round complete: False
2025-10-31 18:54:52,250 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:54:52,250 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠']
2025-10-31 18:54:52,250 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:54:52,250 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:54:52,250 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:54:52,250 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:54:52,250 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:54:52,250 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:54:52,251 - poker_game - INFO - ==================================================
2025-10-31 18:54:52,351 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "K♦",
    "5♦"
  ],
  "community": [
    "4♣",
    "Q♠",
    "10♠"
  ],
  "your_chips": 4611,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1781,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4611)"
  ],
  "history": [
    "Player 4 called 10",
    "Player 1 raised to 440",
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked"
  ]
}
2025-10-31 18:54:52,367 - poker_game - DEBUG - Create Session: {'id': 'a9701ce1-ba45-4349-bc17-6e67a784d443', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904492.3647087}
2025-10-31 18:55:02,393 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:55:09,963 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_cqJu2D1oxEKbnGDoQVXaGxjW', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1113, 'totalTokenCount': 1130}, 'invocationId': 'e-a77190b2-aa75-46d9-8043-73520bd8f956', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'nPveTG9e', 'timestamp': 1761904492.378385}, {'content': {'parts': [{'functionResponse': {'id': 'call_cqJu2D1oxEKbnGDoQVXaGxjW', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a77190b2-aa75-46d9-8043-73520bd8f956', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'H3G5yRmh', 'timestamp': 1761904493.726885}, {'content': {'parts': [{'functionCall': {'id': 'call_RBsZNG7sIbZzVaw5PsvpaQp8', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['K♦', '5♦'], 'community': ['4♣', 'Q♠', '10♠'], 'your_chips': 4611, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4611)'], 'history': ['Player 4 called 10', 'Player 1 raised to 440', 'Player 4 folded', 'Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.25}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_kFCzXQ5mtwn8ya4LxiAyr3JX', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['K♦', '5♦'], 'community': ['4♣', 'Q♠', '10♠'], 'your_chips': 4611, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4611)'], 'history': ['Player 4 called 10', 'Player 1 raised to 440', 'Player 4 folded', 'Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.25}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 688, 'promptTokenCount': 1637, 'totalTokenCount': 2325}, 'invocationId': 'e-a77190b2-aa75-46d9-8043-73520bd8f956', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Ortr6Xre', 'timestamp': 1761904493.728834}, {'content': {'parts': [{'functionResponse': {'id': 'call_RBsZNG7sIbZzVaw5PsvpaQp8', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（10.00(ポットに対して25.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_kFCzXQ5mtwn8ya4LxiAyr3JX', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（10.00(ポットに対して25.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'SLRkrUBl', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ekXuPkQ3', 'timestamp': 1761904507.840261}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い(10.00(ポットに対して25.00%)ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 37, 'promptTokenCount': 2551, 'totalTokenCount': 2588}, 'invocationId': 'e-a77190b2-aa75-46d9-8043-73520bd8f956', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'uQZJGEZn', 'timestamp': 1761904507.848532}]
2025-10-31 18:55:09,964 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:55:09,964 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い(10.00(ポットに対して25.00%)ため、チェックします"}
2025-10-31 18:55:09,965 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:55:09,965 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い(10.00(ポットに対して25.00%)ため、チェックします"}'
2025-10-31 18:55:09,965 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:55:09,965 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い(10.00(ポットに対して25.00%)ため、チェックします"}
2025-10-31 18:55:09,965 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い(10.00(ポットに対して25.00%)ため、チェックします'}
2025-10-31 18:55:09,965 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:55:09,966 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:55:09,966 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:55:09,966 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い(10.00(ポットに対して25.00%)ため、チェックします
2025-10-31 18:55:09,966 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:55:09,967 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:55:09,967 - poker_game - INFO - Hand #14, Phase: flop
2025-10-31 18:55:09,967 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:09,967 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:09,968 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:09,968 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:09,968 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:09,968 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠']
2025-10-31 18:55:09,968 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:09,969 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:09,969 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:09,969 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:09,969 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:09,969 - poker_game - INFO - ==================================================
2025-10-31 18:55:09,970 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:55:09,981 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:55:09,981 - poker_game - INFO - Hand #14, Phase: flop
2025-10-31 18:55:09,981 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:09,982 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:09,982 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:09,982 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:09,982 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:09,982 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠']
2025-10-31 18:55:09,983 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:09,983 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:09,983 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:09,983 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:09,983 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:09,983 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:55:09,984 - poker_game - INFO - ==================================================
2025-10-31 18:55:09,984 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:55:09,984 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:55:09,984 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:55:09,984 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:55:09,984 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:55:09,985 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:55:09,985 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:55:09,985 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:55:09,985 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:55:09,985 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:55:09,985 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:55:09,985 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:55:09,985 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 18:55:09,985 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:55:09,985 - poker_game - INFO - Hand #14, Phase: flop
2025-10-31 18:55:09,985 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:09,986 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:09,986 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:09,986 - poker_game - INFO - Betting round complete: True
2025-10-31 18:55:09,986 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:09,986 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠']
2025-10-31 18:55:09,986 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:09,986 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:09,986 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:09,986 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:09,986 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:09,986 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:55:09,986 - poker_game - INFO - ==================================================
2025-10-31 18:55:10,088 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:55:10,088 - poker_game - INFO - Betting round complete: True
2025-10-31 18:55:10,089 - poker_game - INFO - Remaining players: 2
2025-10-31 18:55:10,089 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:55:10,089 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:55:10,089 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:55:10,108 - poker_game - INFO - Starting new betting round
2025-10-31 18:55:10,109 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:55:10,109 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:55:10,109 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:55:10,110 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:55:10,110 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 18:55:10,110 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:55:10,111 - poker_game - INFO - Hand #14, Phase: turn
2025-10-31 18:55:10,111 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:10,112 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:10,113 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:10,113 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:10,113 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:10,114 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣']
2025-10-31 18:55:10,114 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:10,115 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:10,115 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:10,116 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:10,116 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:10,117 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:55:10,117 - poker_game - INFO - ==================================================
2025-10-31 18:55:10,119 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "9♠",
    "8♥"
  ],
  "community": [
    "4♣",
    "Q♠",
    "10♠",
    "9♣"
  ],
  "your_chips": 1781,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1781)"
  ],
  "history": [
    "Player 4 folded",
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣"
  ]
}
2025-10-31 18:55:10,133 - poker_game - DEBUG - Create Session: {'id': '6d04b0f6-4b89-40a3-bd90-ac57530568fc', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904510.1301284}
2025-10-31 18:55:12,087 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（4♣, Q♠, 10♠, 9♣）では、あなたの手札（9♠, 8♥）で2ペア（9のペアとQのキッカー）ができています。これは良いハンドですが、相手がより強いハンド（例えば、フルハウスやストレート）を持っている可能性も考慮する必要があります。相手（Player 4）はまだアクションを起こしておらず、ベット額も0なので、チェックをして相手のアクションを見るのが最善です。もし相手がベットしてきたら、その額を見てコールするかフォールドするかを判断します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 153, 'promptTokenCount': 796, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 796}], 'totalTokenCount': 949}, 'invocationId': 'e-444b7944-f207-4fcd-861d-74a2538a9c9e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'bVNe1iFa', 'timestamp': 1761904510.141646}]
2025-10-31 18:55:12,088 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:55:12,088 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "現在のボード（4♣, Q♠, 10♠, 9♣）では、あなたの手札（9♠, 8♥）で2ペア（9のペアとQのキッカー）ができています。これは良いハンドですが、相手がより強いハンド（例えば、フルハウスやストレート）を持っている可能性も考慮する必要があります。相手（Player 4）はまだアクションを起こしておらず、ベット額も0なので、チェックをして相手のアクションを見るのが最善です。もし相手がベットしてきたら、その額を見てコールするかフォールドするかを判断します。"
}
```
2025-10-31 18:55:12,089 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:55:12,089 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（4♣, Q♠, 10♠, 9♣）では、あなたの手札（9♠, 8♥）で2ペア（9のペアとQのキッカー）ができています。これは良いハンドですが、相手がより強いハンド（例えば、フルハウスやストレート）を持っている可能性も考慮する必要があります。相手（Player 4）はまだアクションを起こしておらず、ベット額も0なので、チェックをして相手のアクションを見るのが最善です。もし相手がベットしてきたら、その額を見てコールするかフォールドするかを判断します。"\n}\n```'
2025-10-31 18:55:12,089 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:55:12,089 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（4♣, Q♠, 10♠, 9♣）では、あなたの手札（9♠, 8♥）で2ペア（9のペアとQのキッカー）ができています。これは良いハンドですが、相手がより強いハンド（例えば、フルハウスやストレート）を持っている可能性も考慮する必要があります。相手（Player 4）はまだアクションを起こしておらず、ベット額も0なので、チェックをして相手のアクションを見るのが最善です。もし相手がベットしてきたら、その額を見てコールするかフォールドするかを判断します。"\n}'
2025-10-31 18:55:12,090 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "現在のボード（4♣, Q♠, 10♠, 9♣）では、あなたの手札（9♠, 8♥）で2ペア（9のペアとQのキッカー）ができています。これは良いハンドですが、相手がより強いハンド（例えば、フルハウスやストレート）を持っている可能性も考慮する必要があります。相手（Player 4）はまだアクションを起こしておらず、ベット額も0なので、チェックをして相手のアクションを見るのが最善です。もし相手がベットしてきたら、その額を見てコールするかフォールドするかを判断します。"
}
2025-10-31 18:55:12,090 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '現在のボード（4♣, Q♠, 10♠, 9♣）では、あなたの手札（9♠, 8♥）で2ペア（9のペアとQのキッカー）ができています。これは良いハンドですが、相手がより強いハンド（例えば、フルハウスやストレート）を持っている可能性も考慮する必要があります。相手（Player 4）はまだアクションを起こしておらず、ベット額も0なので、チェックをして相手のアクションを見るのが最善です。もし相手がベットしてきたら、その額を見てコールするかフォールドするかを判断します。'}
2025-10-31 18:55:12,090 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:55:12,090 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:55:12,090 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:55:12,090 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, 現在のボード（4♣, Q♠, 10♠, 9♣）では、あなたの手札（9♠, 8♥）で2ペア（9のペアとQのキッカー）ができています。これは良いハンドですが、相手がより強いハンド（例えば、フルハウスやストレート）を持っている可能性も考慮する必要があります。相手（Player 4）はまだアクションを起こしておらず、ベット額も0なので、チェックをして相手のアクションを見るのが最善です。もし相手がベットしてきたら、その額を見てコールするかフォールドするかを判断します。
2025-10-31 18:55:12,092 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:55:12,092 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:55:12,093 - poker_game - INFO - Hand #14, Phase: turn
2025-10-31 18:55:12,093 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:12,093 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:12,093 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:12,094 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:12,094 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:12,094 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣']
2025-10-31 18:55:12,095 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:12,095 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:12,095 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:12,096 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:12,096 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:12,096 - poker_game - INFO - ==================================================
2025-10-31 18:55:12,097 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:55:12,120 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:55:12,120 - poker_game - INFO - Hand #14, Phase: turn
2025-10-31 18:55:12,121 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:12,121 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:12,122 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:12,122 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:12,123 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:12,123 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣']
2025-10-31 18:55:12,124 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:12,124 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:12,124 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:12,125 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:12,125 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:12,126 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:55:12,126 - poker_game - INFO - ==================================================
2025-10-31 18:55:12,126 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:55:12,127 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:55:12,128 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:55:12,128 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:55:12,129 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:55:12,129 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:55:12,130 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:55:12,130 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:55:12,131 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:55:12,131 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:55:12,131 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:55:12,131 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:55:12,131 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:55:12,132 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:55:12,132 - poker_game - INFO - Hand #14, Phase: turn
2025-10-31 18:55:12,133 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:12,133 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:12,134 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:12,134 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:12,135 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:12,136 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣']
2025-10-31 18:55:12,137 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:12,137 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:12,138 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:12,138 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:12,138 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:12,139 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:55:12,139 - poker_game - INFO - ==================================================
2025-10-31 18:55:12,240 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "K♦",
    "5♦"
  ],
  "community": [
    "4♣",
    "Q♠",
    "10♠",
    "9♣"
  ],
  "your_chips": 4611,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1781,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4611)"
  ],
  "history": [
    "Showdown: Player 1 won 460",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked"
  ]
}
2025-10-31 18:55:12,256 - poker_game - DEBUG - Create Session: {'id': '5ac25b4b-b602-4682-85aa-76e495ee0d03', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904512.2534552}
2025-10-31 18:55:22,451 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:55:32,298 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 18:55:36,933 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_SdrVXPDo8usvWdUcgjotywR9', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1116, 'totalTokenCount': 1133}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'uSJSiQQG', 'timestamp': 1761904512.269083}, {'content': {'parts': [{'functionResponse': {'id': 'call_SdrVXPDo8usvWdUcgjotywR9', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'qM6iVi81', 'timestamp': 1761904513.314923}, {'content': {'parts': [{'functionCall': {'id': 'call_i0CEfTJ2XGPjZAGwUV4TxnYa', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1640, 'totalTokenCount': 1657}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'tSKJVRSt', 'timestamp': 1761904513.318823}, {'content': {'parts': [{'functionResponse': {'id': 'call_i0CEfTJ2XGPjZAGwUV4TxnYa', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'sfMNYDdD', 'timestamp': 1761904514.377567}, {'content': {'parts': [{'functionCall': {'id': 'call_hfrq8AEl6egML5gUalmWjuk3', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♦', '5♦'], 'community': ['4♣', 'Q♠', '10♠', '9♣'], 'your_chips': 4611, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4611)'], 'history': ['Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.2}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_3a0Y8UgPSaHPRccRX8rKUW5e', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♦', '5♦'], 'community': ['4♣', 'Q♠', '10♠', '9♣'], 'your_chips': 4611, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4611)'], 'history': ['Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 690, 'promptTokenCount': 1671, 'totalTokenCount': 2361}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '4qC6Fps5', 'timestamp': 1761904514.386122}, {'content': {'parts': [{'functionResponse': {'id': 'call_hfrq8AEl6egML5gUalmWjuk3', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（8.00(ポットに対して20.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_3a0Y8UgPSaHPRccRX8rKUW5e', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（8.00(ポットに対して20.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'QTwWMg7A', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '3iNBRtak', 'timestamp': 1761904528.337128}, {'content': {'parts': [{'functionCall': {'id': 'call_xtfDN31UzeVYD8yhbOrFZh1n', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♦', '5♦'], 'community': ['4♣', 'Q♠', '10♠', '9♣'], 'your_chips': 4611, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4611)'], 'history': ['Showdown: Player 1 won 460', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 337, 'promptTokenCount': 2585, 'totalTokenCount': 2922}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'wmK2F51y', 'timestamp': 1761904528.340193}, {'content': {'parts': [{'functionResponse': {'id': 'call_xtfDN31UzeVYD8yhbOrFZh1n', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（8.00(ポットに対して20.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Lkqo0brA', 'timestamp': 1761904535.44743}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2973, 'totalTokenCount': 3011}, 'invocationId': 'e-a34338c1-9677-4891-bbfa-da071cd6e2d8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '6arTjTrU', 'timestamp': 1761904535.455821}]
2025-10-31 18:55:36,934 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:55:36,935 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 18:55:36,936 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:55:36,936 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}'
2025-10-31 18:55:36,936 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:55:36,937 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（8.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 18:55:36,937 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（8.00(ポットに対して20.00%）ため、チェックします'}
2025-10-31 18:55:36,938 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:55:36,938 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:55:36,938 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:55:36,938 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（8.00(ポットに対して20.00%）ため、チェックします
2025-10-31 18:55:36,940 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:55:36,941 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:55:36,941 - poker_game - INFO - Hand #14, Phase: turn
2025-10-31 18:55:36,942 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:36,943 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:36,943 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:36,944 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:36,944 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:36,945 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣']
2025-10-31 18:55:36,945 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:36,946 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:36,946 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:36,947 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:36,948 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:36,949 - poker_game - INFO - ==================================================
2025-10-31 18:55:36,950 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:55:36,964 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:55:36,965 - poker_game - INFO - Hand #14, Phase: turn
2025-10-31 18:55:36,966 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:36,966 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:36,967 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:36,967 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:36,968 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:36,968 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣']
2025-10-31 18:55:36,968 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:36,969 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:36,969 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:36,970 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:36,970 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:36,970 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:55:36,971 - poker_game - INFO - ==================================================
2025-10-31 18:55:36,972 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:55:36,973 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:55:36,974 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:55:36,975 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:55:36,976 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:55:36,976 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:55:36,977 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:55:36,977 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:55:36,977 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:55:36,977 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:55:36,977 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:55:36,977 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:55:36,978 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 18:55:36,978 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:55:36,978 - poker_game - INFO - Hand #14, Phase: turn
2025-10-31 18:55:36,978 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:36,979 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:36,979 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:36,979 - poker_game - INFO - Betting round complete: True
2025-10-31 18:55:36,980 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:36,980 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣']
2025-10-31 18:55:36,980 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:36,980 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:36,980 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:36,981 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:36,981 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:36,981 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:55:36,981 - poker_game - INFO - ==================================================
2025-10-31 18:55:37,082 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:55:37,083 - poker_game - INFO - Betting round complete: True
2025-10-31 18:55:37,083 - poker_game - INFO - Remaining players: 2
2025-10-31 18:55:37,084 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:55:37,084 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:55:37,084 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:55:37,097 - poker_game - INFO - Starting new betting round
2025-10-31 18:55:37,098 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:55:37,098 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:55:37,099 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:55:37,099 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:55:37,099 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 18:55:37,100 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:55:37,100 - poker_game - INFO - Hand #14, Phase: river
2025-10-31 18:55:37,101 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:37,101 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:37,101 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:37,101 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:37,101 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:37,102 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:37,102 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:37,103 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:37,103 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:37,103 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:37,103 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:37,103 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:55:37,103 - poker_game - INFO - ==================================================
2025-10-31 18:55:37,105 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "9♠",
    "8♥"
  ],
  "community": [
    "4♣",
    "Q♠",
    "10♠",
    "9♣",
    "6♠"
  ],
  "your_chips": 1781,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4611,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1781)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠"
  ]
}
2025-10-31 18:55:37,116 - poker_game - DEBUG - Create Session: {'id': '7e424851-3a38-4453-9154-33fadf03374a', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904537.1131132}
2025-10-31 18:55:39,089 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカードが配られた後）で、あなたの手札は9のペア（ボードの9と合わせてツーペア）ですが、ボードにはフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、相手がそれを持っている可能性があります。相手はベットしておらず、チェックしているので、あなたもチェックして、追加のベットをせずにショーダウン（役の強さを比べて勝者を決めること）に進みます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 126, 'promptTokenCount': 792, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 792}], 'totalTokenCount': 918}, 'invocationId': 'e-5daeac31-a546-4378-8fe3-36e06c619a2b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'J7VOBVOz', 'timestamp': 1761904537.126718}]
2025-10-31 18:55:39,089 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:55:39,090 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のコミュニティカードが配られた後）で、あなたの手札は9のペア（ボードの9と合わせてツーペア）ですが、ボードにはフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、相手がそれを持っている可能性があります。相手はベットしておらず、チェックしているので、あなたもチェックして、追加のベットをせずにショーダウン（役の強さを比べて勝者を決めること）に進みます。"
}
```
2025-10-31 18:55:39,091 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:55:39,091 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカードが配られた後）で、あなたの手札は9のペア（ボードの9と合わせてツーペア）ですが、ボードにはフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、相手がそれを持っている可能性があります。相手はベットしておらず、チェックしているので、あなたもチェックして、追加のベットをせずにショーダウン（役の強さを比べて勝者を決めること）に進みます。"\n}\n```'
2025-10-31 18:55:39,091 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:55:39,091 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカードが配られた後）で、あなたの手札は9のペア（ボードの9と合わせてツーペア）ですが、ボードにはフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、相手がそれを持っている可能性があります。相手はベットしておらず、チェックしているので、あなたもチェックして、追加のベットをせずにショーダウン（役の強さを比べて勝者を決めること）に進みます。"\n}'
2025-10-31 18:55:39,092 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のコミュニティカードが配られた後）で、あなたの手札は9のペア（ボードの9と合わせてツーペア）ですが、ボードにはフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、相手がそれを持っている可能性があります。相手はベットしておらず、チェックしているので、あなたもチェックして、追加のベットをせずにショーダウン（役の強さを比べて勝者を決めること）に進みます。"
}
2025-10-31 18:55:39,092 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最後のコミュニティカードが配られた後）で、あなたの手札は9のペア（ボードの9と合わせてツーペア）ですが、ボードにはフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、相手がそれを持っている可能性があります。相手はベットしておらず、チェックしているので、あなたもチェックして、追加のベットをせずにショーダウン（役の強さを比べて勝者を決めること）に進みます。'}
2025-10-31 18:55:39,092 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:55:39,092 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:55:39,092 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:55:39,092 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, リバー（最後のコミュニティカードが配られた後）で、あなたの手札は9のペア（ボードの9と合わせてツーペア）ですが、ボードにはフラッシュ（同じスートのカードが5枚揃うこと）の可能性があり、相手がそれを持っている可能性があります。相手はベットしておらず、チェックしているので、あなたもチェックして、追加のベットをせずにショーダウン（役の強さを比べて勝者を決めること）に進みます。
2025-10-31 18:55:39,094 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:55:39,094 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:55:39,095 - poker_game - INFO - Hand #14, Phase: river
2025-10-31 18:55:39,095 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:39,095 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:39,096 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:39,096 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:39,097 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:39,097 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:39,097 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:39,098 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:39,098 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:39,099 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:39,099 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:39,100 - poker_game - INFO - ==================================================
2025-10-31 18:55:39,100 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:55:39,111 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:55:39,111 - poker_game - INFO - Hand #14, Phase: river
2025-10-31 18:55:39,112 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:39,112 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:39,113 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:39,113 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:39,114 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:39,114 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:39,115 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:39,115 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:39,115 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:39,116 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:39,116 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:39,117 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:55:39,117 - poker_game - INFO - ==================================================
2025-10-31 18:55:39,117 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:55:39,118 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:55:39,118 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:55:39,118 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:55:39,119 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:55:39,119 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:55:39,119 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:55:39,120 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:55:39,120 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:55:39,120 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:55:39,120 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:55:39,121 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:55:39,121 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:55:39,121 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:55:39,121 - poker_game - INFO - Hand #14, Phase: river
2025-10-31 18:55:39,121 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:39,122 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:39,122 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:39,122 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:39,123 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:39,123 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:39,127 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:39,133 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:39,135 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:39,135 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:39,136 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:39,136 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:55:39,137 - poker_game - INFO - ==================================================
2025-10-31 18:55:39,240 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "K♦",
    "5♦"
  ],
  "community": [
    "4♣",
    "Q♠",
    "10♠",
    "9♣",
    "6♠"
  ],
  "your_chips": 4611,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3568,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1781,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4611)"
  ],
  "history": [
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 9♦, 10♥, 9♣",
    "Player 1 raised to 100",
    "Player 3 folded",
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked"
  ]
}
2025-10-31 18:55:39,253 - poker_game - DEBUG - Create Session: {'id': 'f3200449-aaca-409f-8acb-766d7eeceea0', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904539.2503314}
2025-10-31 18:55:47,944 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_2TjaZQXjOw88gVgltbgUlhZz', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1112, 'totalTokenCount': 1129}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'qOKXeQk9', 'timestamp': 1761904539.268625}, {'content': {'parts': [{'functionResponse': {'id': 'call_2TjaZQXjOw88gVgltbgUlhZz', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Zwtvi9yP', 'timestamp': 1761904540.465892}, {'content': {'parts': [{'functionCall': {'id': 'call_7BTnQGxeX8NJRxBuZ4ltBsel', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1636, 'totalTokenCount': 1656}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '0mzdWnqQ', 'timestamp': 1761904540.471159}, {'content': {'parts': [{'functionResponse': {'id': 'call_7BTnQGxeX8NJRxBuZ4ltBsel', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'VsyM6lWJ', 'timestamp': 1761904541.632145}, {'content': {'parts': [{'functionCall': {'id': 'call_G25omosfwNBtUKMP8sv19JxD', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1198, 'totalTokenCount': 1215}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'fFAyhufb', 'timestamp': 1761904541.635154}, {'content': {'parts': [{'functionResponse': {'id': 'call_G25omosfwNBtUKMP8sv19JxD', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '84uUk8xa', 'timestamp': 1761904542.749751}, {'content': {'parts': [{'functionCall': {'id': 'call_1vyyEDXOS7xmkXDY64imWkSm', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['K♦', '5♦'], 'community': ['4♣', 'Q♠', '10♠', '9♣', '6♠'], 'your_chips': 4611, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 40, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3568, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1781, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4611)'], 'history': ['Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 9♦, 10♥, 9♣', 'Player 1 raised to 100', 'Player 3 folded', 'Showdown: Player 1 won 140', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 6♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 40, 'equity': 0.1}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 331, 'promptTokenCount': 1728, 'totalTokenCount': 2059}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '5Zl296gr', 'timestamp': 1761904542.751894}, {'content': {'parts': [{'functionResponse': {'id': 'call_1vyyEDXOS7xmkXDY64imWkSm', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（4.00(ポットに対して10.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Jhu3gAZg', 'timestamp': 1761904546.57976}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（4.00(ポットに対して10.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2110, 'totalTokenCount': 2148}, 'invocationId': 'e-86ac8e7f-262d-42b0-8c47-c268d9ea8ea3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'xEtOqneU', 'timestamp': 1761904546.582034}]
2025-10-31 18:55:47,945 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:55:47,945 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（4.00(ポットに対して10.00%）ため、チェックします"}
2025-10-31 18:55:47,946 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:55:47,946 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（4.00(ポットに対して10.00%）ため、チェックします"}'
2025-10-31 18:55:47,946 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:55:47,946 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（4.00(ポットに対して10.00%）ため、チェックします"}
2025-10-31 18:55:47,946 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（4.00(ポットに対して10.00%）ため、チェックします'}
2025-10-31 18:55:47,946 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:55:47,947 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:55:47,947 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:55:47,947 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（4.00(ポットに対して10.00%）ため、チェックします
2025-10-31 18:55:47,948 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:55:47,948 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:55:47,948 - poker_game - INFO - Hand #14, Phase: river
2025-10-31 18:55:47,949 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:47,949 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:47,949 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:47,949 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:47,949 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:47,950 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:47,950 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:47,950 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:47,950 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:47,950 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:47,950 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:47,950 - poker_game - INFO - ==================================================
2025-10-31 18:55:47,951 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:55:47,994 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:55:47,994 - poker_game - INFO - Hand #14, Phase: river
2025-10-31 18:55:47,995 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:55:47,995 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:47,995 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:47,995 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:47,995 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:47,996 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:47,996 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:47,996 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:47,996 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:47,997 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:47,997 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:47,997 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:55:47,997 - poker_game - INFO - ==================================================
2025-10-31 18:55:47,997 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:55:47,998 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:55:47,998 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:55:47,998 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:55:47,998 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:55:47,998 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:55:47,999 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:55:47,999 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:55:47,999 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:55:47,999 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:55:47,999 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:55:47,999 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:55:47,999 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 18:55:47,999 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:55:48,000 - poker_game - INFO - Hand #14, Phase: river
2025-10-31 18:55:48,000 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:48,000 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:48,000 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:48,001 - poker_game - INFO - Betting round complete: True
2025-10-31 18:55:48,001 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:48,001 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:48,001 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:48,001 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:48,002 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:48,002 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:48,002 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:48,002 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:55:48,002 - poker_game - INFO - ==================================================
2025-10-31 18:55:48,104 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:55:48,104 - poker_game - INFO - Betting round complete: True
2025-10-31 18:55:48,105 - poker_game - INFO - Remaining players: 2
2025-10-31 18:55:48,105 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:55:48,106 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:55:48,106 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:55:48,106 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:55:48,107 - poker_game - INFO - Hand #14, Phase: showdown
2025-10-31 18:55:48,107 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:55:48,107 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:55:48,108 - poker_game - INFO - Last raiser: None
2025-10-31 18:55:48,108 - poker_game - INFO - Betting round complete: True
2025-10-31 18:55:48,108 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:55:48,109 - poker_game - INFO - Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:48,109 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:48,109 - poker_game - INFO -   P1(Agent1): chips=3568, bet=0, status=folded
2025-10-31 18:55:48,110 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:48,110 - poker_game - INFO -   P3(Agent3): chips=1781, bet=0, status=active
2025-10-31 18:55:48,111 - poker_game - INFO -   P4(Agent4): chips=4611, bet=0, status=active
2025-10-31 18:55:48,112 - poker_game - INFO - ==================================================
2025-10-31 18:55:48,113 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:55:48,114 - poker_game - INFO - Pot: 40, Community cards: ['4♣', 'Q♠', '10♠', '9♣', '6♠']
2025-10-31 18:55:48,114 - poker_game - INFO -   Player 3 status=active cards=['9♠', '8♥']
2025-10-31 18:55:48,116 - poker_game - INFO -   Player 4 status=active cards=['K♦', '5♦']
2025-10-31 18:55:48,119 - poker_game - INFO -   Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=['9♠', '8♥']
2025-10-31 18:55:48,120 - poker_game - INFO -   Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=['K♦', '5♦']
2025-10-31 18:55:48,121 - poker_game - INFO - Pot layer 0: amount=40, contributors=[3, 4]
2025-10-31 18:55:48,122 - poker_game - INFO - Showdown total awarded: 40 (game.pot=40)
2025-10-31 18:55:48,123 - poker_game - INFO - Showdown winners (aggregated): [3]
2025-10-31 18:55:48,123 - poker_game - INFO -   Awarded 40 to Player 3 (hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥)
2025-10-31 18:55:48,124 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:55:48,161 - poker_game - INFO - === STARTING NEW HAND #15 ===
2025-10-31 18:55:48,162 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:55:48,163 - poker_game - INFO - Moving dealer button
2025-10-31 18:55:48,163 - poker_game - INFO - Posting blinds
2025-10-31 18:55:48,183 - poker_game - INFO - Dealing hole cards
2025-10-31 18:55:48,184 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:55:48,195 - poker_game - INFO - Started new hand in database: hand_id=15
2025-10-31 18:55:48,196 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:55:48,197 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:55:48,197 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:55:48,198 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:55:48,198 - poker_game - INFO - Last raiser: 1
2025-10-31 18:55:48,198 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:48,199 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:55:48,199 - poker_game - INFO - Community cards: []
2025-10-31 18:55:48,200 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:48,200 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:55:48,201 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:48,201 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:55:48,202 - poker_game - INFO -   P4(Agent4): chips=4601, bet=10, status=active
2025-10-31 18:55:48,202 - poker_game - INFO - ==================================================
2025-10-31 18:55:48,203 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "Q♠",
    "K♠"
  ],
  "community": [],
  "your_chips": 1821,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4601,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1821)"
  ],
  "history": [
    "Showdown: Player 1 won 140",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 18:55:48,215 - poker_game - DEBUG - Create Session: {'id': 'ee184506-1db1-48fe-975f-cf37a142f549', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904548.2122235}
2025-10-31 18:55:50,071 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでQ♠ K♠は強力なハンドです。ポットが小さく、コールに必要な金額が20なので、コールしてフロップを見るのが最善です。フロップでフラッシュ（同じスートが3枚揃うこと）やストレート（数字が連続すること）の可能性も出てきます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 100, 'promptTokenCount': 863, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 863}], 'totalTokenCount': 963}, 'invocationId': 'e-e9284223-b314-41f4-93de-2725cf5c238a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'NKs4Ee32', 'timestamp': 1761904548.22809}]
2025-10-31 18:55:50,072 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:55:50,072 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップでQ♠ K♠は強力なハンドです。ポットが小さく、コールに必要な金額が20なので、コールしてフロップを見るのが最善です。フロップでフラッシュ（同じスートが3枚揃うこと）やストレート（数字が連続すること）の可能性も出てきます。"
}
```
2025-10-31 18:55:50,072 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:55:50,072 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでQ♠ K♠は強力なハンドです。ポットが小さく、コールに必要な金額が20なので、コールしてフロップを見るのが最善です。フロップでフラッシュ（同じスートが3枚揃うこと）やストレート（数字が連続すること）の可能性も出てきます。"\n}\n```'
2025-10-31 18:55:50,072 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:55:50,072 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでQ♠ K♠は強力なハンドです。ポットが小さく、コールに必要な金額が20なので、コールしてフロップを見るのが最善です。フロップでフラッシュ（同じスートが3枚揃うこと）やストレート（数字が連続すること）の可能性も出てきます。"\n}'
2025-10-31 18:55:50,073 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップでQ♠ K♠は強力なハンドです。ポットが小さく、コールに必要な金額が20なので、コールしてフロップを見るのが最善です。フロップでフラッシュ（同じスートが3枚揃うこと）やストレート（数字が連続すること）の可能性も出てきます。"
}
2025-10-31 18:55:50,073 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップでQ♠ K♠は強力なハンドです。ポットが小さく、コールに必要な金額が20なので、コールしてフロップを見るのが最善です。フロップでフラッシュ（同じスートが3枚揃うこと）やストレート（数字が連続すること）の可能性も出てきます。'}
2025-10-31 18:55:50,073 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 20
2025-10-31 18:55:50,073 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (1821)']
2025-10-31 18:55:50,073 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (20)': 20
2025-10-31 18:55:50,073 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:55:50,073 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 20, プリフロップでQ♠ K♠は強力なハンドです。ポットが小さく、コールに必要な金額が20なので、コールしてフロップを見るのが最善です。フロップでフラッシュ（同じスートが3枚揃うこと）やストレート（数字が連続すること）の可能性も出てきます。
2025-10-31 18:55:50,074 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 20
2025-10-31 18:55:50,074 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:55:50,075 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:55:50,075 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:55:50,075 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:55:50,075 - poker_game - INFO - Last raiser: 1
2025-10-31 18:55:50,075 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:50,076 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:55:50,076 - poker_game - INFO - Community cards: []
2025-10-31 18:55:50,076 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:50,076 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:55:50,076 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:50,077 - poker_game - INFO -   P3(Agent3): chips=1821, bet=0, status=active
2025-10-31 18:55:50,077 - poker_game - INFO -   P4(Agent4): chips=4601, bet=10, status=active
2025-10-31 18:55:50,077 - poker_game - INFO - ==================================================
2025-10-31 18:55:50,077 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 20
2025-10-31 18:55:50,089 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:55:50,090 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:55:50,090 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:55:50,090 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:55:50,091 - poker_game - INFO - Last raiser: 1
2025-10-31 18:55:50,091 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:50,091 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:55:50,091 - poker_game - INFO - Community cards: []
2025-10-31 18:55:50,091 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:50,092 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:55:50,092 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:50,092 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:55:50,092 - poker_game - INFO -   P4(Agent4): chips=4601, bet=10, status=active
2025-10-31 18:55:50,093 - poker_game - INFO - Extra: Action: Player 3 called 20
2025-10-31 18:55:50,093 - poker_game - INFO - ==================================================
2025-10-31 18:55:50,093 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:55:50,093 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:55:50,093 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:55:50,093 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:55:50,093 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:55:50,094 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:55:50,094 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:55:50,094 - poker_game - DEBUG - Player bets: [20, 20, 10], Current bet: 20, All same: False
2025-10-31 18:55:50,094 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:55:50,094 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:55:50,094 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:55:50,095 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:55:50,095 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:55:50,095 - poker_game - INFO - Last raiser: 1
2025-10-31 18:55:50,095 - poker_game - INFO - Betting round complete: False
2025-10-31 18:55:50,095 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:55:50,096 - poker_game - INFO - Community cards: []
2025-10-31 18:55:50,096 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:55:50,096 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:55:50,096 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:55:50,096 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:55:50,097 - poker_game - INFO -   P4(Agent4): chips=4601, bet=10, status=active
2025-10-31 18:55:50,097 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:55:50,098 - poker_game - INFO - ==================================================
2025-10-31 18:55:50,202 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "J♦",
    "9♦"
  ],
  "community": [],
  "your_chips": 4601,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1801,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (4601)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20"
  ]
}
2025-10-31 18:55:50,212 - poker_game - DEBUG - Create Session: {'id': '40159adf-48e4-468c-bc89-99719fd1f014', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904550.2099063}
2025-10-31 18:56:00,425 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:56:05,060 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_YPogTZt3qL5W0jMss55P9b8D', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1193, 'totalTokenCount': 1210}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'UUD4RgbH', 'timestamp': 1761904550.223529}, {'content': {'parts': [{'functionResponse': {'id': 'call_YPogTZt3qL5W0jMss55P9b8D', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'PAdF7zx8', 'timestamp': 1761904551.463764}, {'content': {'parts': [{'functionCall': {'id': 'call_zt8lMFWLwocPixr4qyL0Fk4y', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1717, 'totalTokenCount': 1737}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '23gPqVsJ', 'timestamp': 1761904551.465363}, {'content': {'parts': [{'functionResponse': {'id': 'call_zt8lMFWLwocPixr4qyL0Fk4y', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '6539o7YZ', 'timestamp': 1761904552.530471}, {'content': {'parts': [{'functionCall': {'id': 'call_JejxrdFpAG1jmaeVqx8WpcZn', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1279, 'totalTokenCount': 1296}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '2GBctVXV', 'timestamp': 1761904552.531776}, {'content': {'parts': [{'functionResponse': {'id': 'call_JejxrdFpAG1jmaeVqx8WpcZn', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'yitrsJ0x', 'timestamp': 1761904553.562285}, {'content': {'parts': [{'functionCall': {'id': 'call_krdYSfmrTkiALG23s51rAu2N', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♦', '9♦'], 'community': [], 'your_chips': 4601, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 50, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3548, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1801, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (4601)'], 'history': ['Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 6♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥', 'Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦', 'Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20']}, 'call_amount': 10, 'pot_after_call': 60, 'equity': 0.25}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 425, 'promptTokenCount': 1809, 'totalTokenCount': 2234}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'wjmPJ4vc', 'timestamp': 1761904553.564395}, {'content': {'parts': [{'functionResponse': {'id': 'call_krdYSfmrTkiALG23s51rAu2N', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（7.50(ポットに対して15.00%）、コールが妥当と判断。コール額: 10'}}}], 'role': 'user'}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'u5FeCNJf', 'timestamp': 1761904562.801351}, {'content': {'parts': [{'text': '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（7.50(ポットに対して15.00%）、コールが妥当と判断。コール額: 10"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2301, 'totalTokenCount': 2355}, 'invocationId': 'e-d0a2abb3-96a5-4b0b-8f40-9de6924f6157', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '5XWw5xd2', 'timestamp': 1761904562.806152}]
2025-10-31 18:56:05,061 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:56:05,061 - poker_game - DEBUG - {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（7.50(ポットに対して15.00%）、コールが妥当と判断。コール額: 10"}
2025-10-31 18:56:05,062 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:56:05,062 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（7.50(ポットに対して15.00%）、コールが妥当と判断。コール額: 10"}'
2025-10-31 18:56:05,062 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:56:05,063 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており（7.50(ポットに対して15.00%）、コールが妥当と判断。コール額: 10"}
2025-10-31 18:56:05,064 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（7.50(ポットに対して15.00%）、コールが妥当と判断。コール額: 10'}
2025-10-31 18:56:05,064 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 10
2025-10-31 18:56:05,064 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (4601)']
2025-10-31 18:56:05,064 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (10)': 10
2025-10-31 18:56:05,064 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:56:05,064 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 10, ポットオッズを満たしており（7.50(ポットに対して15.00%）、コールが妥当と判断。コール額: 10
2025-10-31 18:56:05,065 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 10
2025-10-31 18:56:05,066 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:05,066 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:56:05,066 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:05,066 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:56:05,067 - poker_game - INFO - Last raiser: 1
2025-10-31 18:56:05,067 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:05,067 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:56:05,067 - poker_game - INFO - Community cards: []
2025-10-31 18:56:05,068 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:05,068 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:56:05,068 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:05,069 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:56:05,069 - poker_game - INFO -   P4(Agent4): chips=4601, bet=10, status=active
2025-10-31 18:56:05,069 - poker_game - INFO - ==================================================
2025-10-31 18:56:05,070 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 10
2025-10-31 18:56:05,079 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:05,080 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:56:05,080 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:05,080 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:56:05,081 - poker_game - INFO - Last raiser: 1
2025-10-31 18:56:05,081 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:05,082 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:56:05,082 - poker_game - INFO - Community cards: []
2025-10-31 18:56:05,082 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:05,082 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:56:05,083 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:05,083 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:56:05,083 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:56:05,084 - poker_game - INFO - Extra: Action: Player 4 called 10
2025-10-31 18:56:05,084 - poker_game - INFO - ==================================================
2025-10-31 18:56:05,084 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:05,084 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:05,084 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:56:05,084 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:56:05,084 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:05,085 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:05,086 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:56:05,087 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:56:05,088 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:56:05,089 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:56:05,090 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:56:05,090 - poker_game - DEBUG - Next after last raiser 1: 3
2025-10-31 18:56:05,091 - poker_game - DEBUG - Betting continues: Current player 1 != next after raiser 3
2025-10-31 18:56:05,091 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:05,091 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:56:05,092 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:56:05,093 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:56:05,093 - poker_game - INFO - Last raiser: 1
2025-10-31 18:56:05,094 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:05,094 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:56:05,094 - poker_game - INFO - Community cards: []
2025-10-31 18:56:05,094 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:05,095 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:56:05,095 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:05,095 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:56:05,096 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:56:05,096 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:56:05,096 - poker_game - INFO - ==================================================
2025-10-31 18:56:05,197 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "4♠",
    "8♠"
  ],
  "community": [],
  "your_chips": 3548,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1801,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4591,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (3548)"
  ],
  "history": [
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10"
  ]
}
2025-10-31 18:56:05,209 - poker_game - DEBUG - Create Session: {'id': '2b6fee81-582b-4e01-8ecd-93fcae84feef', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904565.2063198}
2025-10-31 18:56:07,390 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードがまだない状態）で、私の手札は4♠8♠です。これは「スーテッドコネクター」（同じスートで数字が近いカード）ですが、数字が低いため、あまり強い手ではありません。相手はすでにベットしており、コールするには最低でも40（ビッグブラインドの2倍）必要です。この手札でコールするにはリスクが高すぎると判断しました。強い手札でない限り、プリフロップではフォールドするのが賢明です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 143, 'promptTokenCount': 855, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 855}], 'totalTokenCount': 998}, 'invocationId': 'e-76f71b69-be6a-4053-b0a5-124bab5a5c6f', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'itdH2Ylc', 'timestamp': 1761904565.22101}]
2025-10-31 18:56:07,391 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:56:07,391 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードがまだない状態）で、私の手札は4♠8♠です。これは「スーテッドコネクター」（同じスートで数字が近いカード）ですが、数字が低いため、あまり強い手ではありません。相手はすでにベットしており、コールするには最低でも40（ビッグブラインドの2倍）必要です。この手札でコールするにはリスクが高すぎると判断しました。強い手札でない限り、プリフロップではフォールドするのが賢明です。"
}
```
2025-10-31 18:56:07,392 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:56:07,392 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードがまだない状態）で、私の手札は4♠8♠です。これは「スーテッドコネクター」（同じスートで数字が近いカード）ですが、数字が低いため、あまり強い手ではありません。相手はすでにベットしており、コールするには最低でも40（ビッグブラインドの2倍）必要です。この手札でコールするにはリスクが高すぎると判断しました。強い手札でない限り、プリフロップではフォールドするのが賢明です。"\n}\n```'
2025-10-31 18:56:07,392 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:56:07,393 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードがまだない状態）で、私の手札は4♠8♠です。これは「スーテッドコネクター」（同じスートで数字が近いカード）ですが、数字が低いため、あまり強い手ではありません。相手はすでにベットしており、コールするには最低でも40（ビッグブラインドの2倍）必要です。この手札でコールするにはリスクが高すぎると判断しました。強い手札でない限り、プリフロップではフォールドするのが賢明です。"\n}'
2025-10-31 18:56:07,393 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードがまだない状態）で、私の手札は4♠8♠です。これは「スーテッドコネクター」（同じスートで数字が近いカード）ですが、数字が低いため、あまり強い手ではありません。相手はすでにベットしており、コールするには最低でも40（ビッグブラインドの2倍）必要です。この手札でコールするにはリスクが高すぎると判断しました。強い手札でない限り、プリフロップではフォールドするのが賢明です。"
}
2025-10-31 18:56:07,393 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（最初のカードが配られた後、コミュニティカードがまだない状態）で、私の手札は4♠8♠です。これは「スーテッドコネクター」（同じスートで数字が近いカード）ですが、数字が低いため、あまり強い手ではありません。相手はすでにベットしており、コールするには最低でも40（ビッグブラインドの2倍）必要です。この手札でコールするにはリスクが高すぎると判断しました。強い手札でない限り、プリフロップではフォールドするのが賢明です。'}
2025-10-31 18:56:07,394 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:56:07,394 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:56:07,394 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:56:07,394 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップ（最初のカードが配られた後、コミュニティカードがまだない状態）で、私の手札は4♠8♠です。これは「スーテッドコネクター」（同じスートで数字が近いカード）ですが、数字が低いため、あまり強い手ではありません。相手はすでにベットしており、コールするには最低でも40（ビッグブラインドの2倍）必要です。この手札でコールするにはリスクが高すぎると判断しました。強い手札でない限り、プリフロップではフォールドするのが賢明です。
2025-10-31 18:56:07,396 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:56:07,396 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:07,397 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:56:07,403 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:56:07,403 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:56:07,403 - poker_game - INFO - Last raiser: 1
2025-10-31 18:56:07,403 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:07,404 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:56:07,404 - poker_game - INFO - Community cards: []
2025-10-31 18:56:07,405 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:07,405 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=active
2025-10-31 18:56:07,405 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:07,406 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:56:07,407 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:56:07,408 - poker_game - INFO - ==================================================
2025-10-31 18:56:07,408 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:56:07,421 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:07,421 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:56:07,422 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:56:07,422 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:56:07,422 - poker_game - INFO - Last raiser: 1
2025-10-31 18:56:07,422 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:07,423 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:07,423 - poker_game - INFO - Community cards: []
2025-10-31 18:56:07,424 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:07,424 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=folded
2025-10-31 18:56:07,425 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:07,425 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:56:07,425 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:56:07,426 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:56:07,426 - poker_game - INFO - ==================================================
2025-10-31 18:56:07,427 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:07,428 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:07,428 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:56:07,428 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:56:07,429 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:07,429 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:07,430 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:56:07,430 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:56:07,430 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:56:07,430 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 18:56:07,430 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:56:07,430 - poker_game - INFO - Betting complete: Last raiser 1 is no longer active
2025-10-31 18:56:07,431 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:07,432 - poker_game - INFO - Hand #15, Phase: preflop
2025-10-31 18:56:07,433 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:07,433 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:56:07,434 - poker_game - INFO - Last raiser: 1
2025-10-31 18:56:07,434 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:07,434 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:07,435 - poker_game - INFO - Community cards: []
2025-10-31 18:56:07,435 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:07,436 - poker_game - INFO -   P1(Agent1): chips=3548, bet=20, status=folded
2025-10-31 18:56:07,436 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:07,437 - poker_game - INFO -   P3(Agent3): chips=1801, bet=20, status=active
2025-10-31 18:56:07,437 - poker_game - INFO -   P4(Agent4): chips=4591, bet=20, status=active
2025-10-31 18:56:07,437 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:56:07,438 - poker_game - INFO - ==================================================
2025-10-31 18:56:07,538 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:56:07,539 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:07,540 - poker_game - INFO - Remaining players: 2
2025-10-31 18:56:07,540 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:56:07,540 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:56:07,540 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:56:07,552 - poker_game - INFO - Starting new betting round
2025-10-31 18:56:07,553 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:56:07,553 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:56:07,554 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:56:07,554 - poker_game - DEBUG - Dealer button: 3
2025-10-31 18:56:07,554 - poker_game - INFO - First actor: Player 4 (by phase rule), was 3
2025-10-31 18:56:07,555 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:56:07,555 - poker_game - INFO - Hand #15, Phase: flop
2025-10-31 18:56:07,556 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:07,556 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:07,558 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:07,558 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:07,559 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:07,559 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦']
2025-10-31 18:56:07,560 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:07,560 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:07,561 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:07,561 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:07,561 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:07,562 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:56:07,562 - poker_game - INFO - ==================================================
2025-10-31 18:56:07,563 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "J♦",
    "9♦"
  ],
  "community": [
    "6♣",
    "6♠",
    "A♦"
  ],
  "your_chips": 4591,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1801,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4591)"
  ],
  "history": [
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦"
  ]
}
2025-10-31 18:56:07,580 - poker_game - DEBUG - Create Session: {'id': '9ceb82b0-48a9-4dfe-9582-41098c980e29', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904567.577071}
2025-10-31 18:56:17,600 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:56:24,479 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_kyMgdQmz0XdlRE7htN5EcFP1', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1216, 'totalTokenCount': 1233}, 'invocationId': 'e-f6495ae6-9c12-4539-b8a4-8cb1c29ac19d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'q4SLzflX', 'timestamp': 1761904567.592332}, {'content': {'parts': [{'functionResponse': {'id': 'call_kyMgdQmz0XdlRE7htN5EcFP1', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f6495ae6-9c12-4539-b8a4-8cb1c29ac19d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'mJzteFiq', 'timestamp': 1761904568.845194}, {'content': {'parts': [{'functionCall': {'id': 'call_Va4GHmUWaze4IEHnxqGQ8Iil', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['J♦', '9♦'], 'community': ['6♣', '6♠', 'A♦'], 'your_chips': 4591, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3548, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1801, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4591)'], 'history': ['Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 6♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥', 'Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦', 'Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: 6♣, 6♠, A♦']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.25}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_WzyV4zb8BiNA80RrDkxxr5ci', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['J♦', '9♦'], 'community': ['6♣', '6♠', 'A♦'], 'your_chips': 4591, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3548, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1801, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4591)'], 'history': ['Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♣, Q♠, 10♠', 'Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 6♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥', 'Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦', 'Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: 6♣, 6♠, A♦']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.25}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 894, 'promptTokenCount': 1740, 'totalTokenCount': 2634}, 'invocationId': 'e-f6495ae6-9c12-4539-b8a4-8cb1c29ac19d', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'kX4yJYrb', 'timestamp': 1761904568.847149}, {'content': {'parts': [{'functionResponse': {'id': 'call_Va4GHmUWaze4IEHnxqGQ8Iil', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（15.00(ポットに対して25.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_WzyV4zb8BiNA80RrDkxxr5ci', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（15.00(ポットに対して25.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'WYcJ0AO8', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '8KrZW944', 'timestamp': 1761904582.740992}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い(15.00(ポットに対して25.00%)ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 37, 'promptTokenCount': 2860, 'totalTokenCount': 2897}, 'invocationId': 'e-f6495ae6-9c12-4539-b8a4-8cb1c29ac19d', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'CzRsP43y', 'timestamp': 1761904582.747952}]
2025-10-31 18:56:24,479 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:56:24,480 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い(15.00(ポットに対して25.00%)ため、チェックします"}
2025-10-31 18:56:24,480 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:56:24,480 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い(15.00(ポットに対して25.00%)ため、チェックします"}'
2025-10-31 18:56:24,480 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:56:24,480 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い(15.00(ポットに対して25.00%)ため、チェックします"}
2025-10-31 18:56:24,480 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い(15.00(ポットに対して25.00%)ため、チェックします'}
2025-10-31 18:56:24,480 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:56:24,481 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:56:24,481 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:56:24,481 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い(15.00(ポットに対して25.00%)ため、チェックします
2025-10-31 18:56:24,481 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:56:24,482 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:24,482 - poker_game - INFO - Hand #15, Phase: flop
2025-10-31 18:56:24,482 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:24,482 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:24,482 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:24,482 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:24,483 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:24,483 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦']
2025-10-31 18:56:24,483 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:24,483 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:24,483 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:24,483 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:24,484 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:24,484 - poker_game - INFO - ==================================================
2025-10-31 18:56:24,484 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:56:24,492 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:24,493 - poker_game - INFO - Hand #15, Phase: flop
2025-10-31 18:56:24,493 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:24,493 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:24,493 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:24,493 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:24,494 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:24,494 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦']
2025-10-31 18:56:24,494 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:24,494 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:24,494 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:24,495 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:24,495 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:24,495 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:56:24,495 - poker_game - INFO - ==================================================
2025-10-31 18:56:24,495 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:24,496 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:24,496 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:56:24,496 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:56:24,496 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:24,496 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:24,496 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:56:24,496 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:56:24,496 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:56:24,496 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:56:24,497 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:56:24,497 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:56:24,497 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 4
2025-10-31 18:56:24,497 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:24,497 - poker_game - INFO - Hand #15, Phase: flop
2025-10-31 18:56:24,497 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:24,497 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:24,498 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:24,498 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:24,498 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:24,498 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦']
2025-10-31 18:56:24,498 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:24,498 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:24,499 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:24,501 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:24,501 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:24,501 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:56:24,501 - poker_game - INFO - ==================================================
2025-10-31 18:56:24,602 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "Q♠",
    "K♠"
  ],
  "community": [
    "6♣",
    "6♠",
    "A♦"
  ],
  "your_chips": 1801,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4591,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1801)"
  ],
  "history": [
    "Player 4 checked",
    "Flop dealt: 4♣, Q♠, 10♠",
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked"
  ]
}
2025-10-31 18:56:24,613 - poker_game - DEBUG - Create Session: {'id': 'a5d5a7f1-db31-4f3f-ac77-f9ce9b3c34d8', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904584.6106246}
2025-10-31 18:56:26,417 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦です。これは「ペア」ができていない状況で、フラッシュ（同じスートのカードが5枚揃うこと）の可能性もありません。相手（Player 4）がチェックしたため、こちらもチェックして次のカード（ターン）を見るのが最善です。ポットを大きくせず、より多くの情報（次のカード）を得ることを優先します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 139, 'promptTokenCount': 874, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 874}], 'totalTokenCount': 1013}, 'invocationId': 'e-90c2c115-77cc-4bb3-bb73-4bc599a6f4d3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '57eQNAeh', 'timestamp': 1761904584.625222}]
2025-10-31 18:56:26,417 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:56:26,418 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦です。これは「ペア」ができていない状況で、フラッシュ（同じスートのカードが5枚揃うこと）の可能性もありません。相手（Player 4）がチェックしたため、こちらもチェックして次のカード（ターン）を見るのが最善です。ポットを大きくせず、より多くの情報（次のカード）を得ることを優先します。"
}
```
2025-10-31 18:56:26,418 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:56:26,419 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦です。これは「ペア」ができていない状況で、フラッシュ（同じスートのカードが5枚揃うこと）の可能性もありません。相手（Player 4）がチェックしたため、こちらもチェックして次のカード（ターン）を見るのが最善です。ポットを大きくせず、より多くの情報（次のカード）を得ることを優先します。"\n}\n```'
2025-10-31 18:56:26,419 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:56:26,419 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦です。これは「ペア」ができていない状況で、フラッシュ（同じスートのカードが5枚揃うこと）の可能性もありません。相手（Player 4）がチェックしたため、こちらもチェックして次のカード（ターン）を見るのが最善です。ポットを大きくせず、より多くの情報（次のカード）を得ることを優先します。"\n}'
2025-10-31 18:56:26,419 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦です。これは「ペア」ができていない状況で、フラッシュ（同じスートのカードが5枚揃うこと）の可能性もありません。相手（Player 4）がチェックしたため、こちらもチェックして次のカード（ターン）を見るのが最善です。ポットを大きくせず、より多くの情報（次のカード）を得ることを優先します。"
}
2025-10-31 18:56:26,419 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）で、あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦です。これは「ペア」ができていない状況で、フラッシュ（同じスートのカードが5枚揃うこと）の可能性もありません。相手（Player 4）がチェックしたため、こちらもチェックして次のカード（ターン）を見るのが最善です。ポットを大きくせず、より多くの情報（次のカード）を得ることを優先します。'}
2025-10-31 18:56:26,420 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:56:26,420 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:56:26,420 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:56:26,420 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, フロップ（最初の3枚のコミュニティカード）で、あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦です。これは「ペア」ができていない状況で、フラッシュ（同じスートのカードが5枚揃うこと）の可能性もありません。相手（Player 4）がチェックしたため、こちらもチェックして次のカード（ターン）を見るのが最善です。ポットを大きくせず、より多くの情報（次のカード）を得ることを優先します。
2025-10-31 18:56:26,421 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:56:26,422 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:26,422 - poker_game - INFO - Hand #15, Phase: flop
2025-10-31 18:56:26,422 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:26,423 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:26,423 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:26,423 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:26,425 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:26,426 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦']
2025-10-31 18:56:26,426 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:26,427 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:26,427 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:26,428 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:26,428 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:26,428 - poker_game - INFO - ==================================================
2025-10-31 18:56:26,429 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:56:26,440 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:26,441 - poker_game - INFO - Hand #15, Phase: flop
2025-10-31 18:56:26,442 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:26,442 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:26,443 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:26,443 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:26,443 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:26,444 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦']
2025-10-31 18:56:26,444 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:26,445 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:26,445 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:26,445 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:26,446 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:26,446 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:56:26,446 - poker_game - INFO - ==================================================
2025-10-31 18:56:26,447 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:26,447 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:26,447 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:56:26,448 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:56:26,448 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:26,449 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:26,449 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:56:26,449 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:56:26,449 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:56:26,450 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:56:26,450 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:56:26,450 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:56:26,450 - poker_game - INFO - Betting complete: Back to first actor 4 (all players have acted)
2025-10-31 18:56:26,451 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:26,451 - poker_game - INFO - Hand #15, Phase: flop
2025-10-31 18:56:26,452 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:26,455 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:26,456 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:26,456 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:26,459 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:26,459 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦']
2025-10-31 18:56:26,460 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:26,460 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:26,460 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:26,460 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:26,461 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:26,461 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:56:26,462 - poker_game - INFO - ==================================================
2025-10-31 18:56:26,565 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:56:26,566 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:26,566 - poker_game - INFO - Remaining players: 2
2025-10-31 18:56:26,567 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:56:26,567 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:56:26,567 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:56:26,577 - poker_game - INFO - Starting new betting round
2025-10-31 18:56:26,578 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:56:26,578 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:56:26,579 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:56:26,579 - poker_game - DEBUG - Dealer button: 3
2025-10-31 18:56:26,579 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 18:56:26,579 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:56:26,580 - poker_game - INFO - Hand #15, Phase: turn
2025-10-31 18:56:26,581 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:26,582 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:26,584 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:26,584 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:26,585 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:26,585 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣']
2025-10-31 18:56:26,586 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:26,586 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:26,586 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:26,587 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:26,587 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:26,587 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:56:26,588 - poker_game - INFO - ==================================================
2025-10-31 18:56:26,589 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "J♦",
    "9♦"
  ],
  "community": [
    "6♣",
    "6♠",
    "A♦",
    "J♣"
  ],
  "your_chips": 4591,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1801,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4591)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣"
  ]
}
2025-10-31 18:56:26,601 - poker_game - DEBUG - Create Session: {'id': '219eded1-f47d-4be3-80ef-be2960f37c4b', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904586.5977561}
2025-10-31 18:56:36,679 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:56:38,310 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_NtDNHzZV1izzJ4MVDIoue8PO', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1208, 'totalTokenCount': 1225}, 'invocationId': 'e-586e77f0-0431-43d9-a005-d9bf69815286', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'X3rfetUs', 'timestamp': 1761904586.612844}, {'content': {'parts': [{'functionResponse': {'id': 'call_NtDNHzZV1izzJ4MVDIoue8PO', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-586e77f0-0431-43d9-a005-d9bf69815286', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'WXs4C689', 'timestamp': 1761904587.380522}, {'content': {'parts': [{'functionCall': {'id': 'call_dcjWHBuNPEyq4qjOjpBCpUmr', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['J♦', '9♦'], 'community': ['6♣', '6♠', 'A♦', 'J♣'], 'your_chips': 4591, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3548, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1801, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4591)'], 'history': ['Player 3 checked', 'Player 4 checked', 'Turn dealt: 9♣', 'Player 3 checked', 'Player 4 checked', 'River dealt: 6♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥', 'Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦', 'Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: 6♣, 6♠, A♦', 'Player 4 checked', 'Player 3 checked', 'Turn dealt: J♣']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 429, 'promptTokenCount': 1732, 'totalTokenCount': 2161}, 'invocationId': 'e-586e77f0-0431-43d9-a005-d9bf69815286', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'pDltC5t8', 'timestamp': 1761904587.385712}, {'content': {'parts': [{'functionResponse': {'id': 'call_dcjWHBuNPEyq4qjOjpBCpUmr', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 30, 'reasoning': '期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30'}}}], 'role': 'user'}, 'invocationId': 'e-586e77f0-0431-43d9-a005-d9bf69815286', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'DR6xjIDv', 'timestamp': 1761904596.470525}, {'content': {'parts': [{'text': '{"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2230, 'totalTokenCount': 2286}, 'invocationId': 'e-586e77f0-0431-43d9-a005-d9bf69815286', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'BhITaWMF', 'timestamp': 1761904596.473611}]
2025-10-31 18:56:38,311 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:56:38,312 - poker_game - DEBUG - {"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}
2025-10-31 18:56:38,312 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:56:38,312 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}'
2025-10-31 18:56:38,313 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:56:38,313 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":30,"reasoning":"期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}
2025-10-31 18:56:38,313 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 30, 'reasoning': '期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30'}
2025-10-31 18:56:38,313 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 30
2025-10-31 18:56:38,314 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (4591)']
2025-10-31 18:56:38,314 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:56:38,314 - poker_game - DEBUG - [Agent4] Raise amount 30 is valid (min: 20)
2025-10-31 18:56:38,314 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 30}
2025-10-31 18:56:38,314 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 30, 期待値が見込める（30.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 30
2025-10-31 18:56:38,315 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 30
2025-10-31 18:56:38,316 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:38,316 - poker_game - INFO - Hand #15, Phase: turn
2025-10-31 18:56:38,316 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:38,316 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:56:38,317 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:38,317 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:38,317 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:38,317 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣']
2025-10-31 18:56:38,318 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:38,318 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:38,318 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:38,319 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:38,320 - poker_game - INFO -   P4(Agent4): chips=4591, bet=0, status=active
2025-10-31 18:56:38,320 - poker_game - INFO - ==================================================
2025-10-31 18:56:38,321 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 30
2025-10-31 18:56:38,339 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:38,340 - poker_game - INFO - Hand #15, Phase: turn
2025-10-31 18:56:38,340 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:38,340 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:56:38,340 - poker_game - INFO - Last raiser: 4
2025-10-31 18:56:38,341 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:38,341 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:38,341 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣']
2025-10-31 18:56:38,342 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:38,342 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:38,342 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:38,342 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:38,343 - poker_game - INFO -   P4(Agent4): chips=4561, bet=30, status=active
2025-10-31 18:56:38,343 - poker_game - INFO - Extra: Action: Player 4 raised to 30
2025-10-31 18:56:38,344 - poker_game - INFO - ==================================================
2025-10-31 18:56:38,344 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:38,344 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:38,345 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:56:38,345 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:56:38,345 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:38,345 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:38,345 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:56:38,346 - poker_game - DEBUG - Player bets: [0, 30], Current bet: 30, All same: False
2025-10-31 18:56:38,346 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:56:38,346 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:38,346 - poker_game - INFO - Hand #15, Phase: turn
2025-10-31 18:56:38,347 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:38,347 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:56:38,347 - poker_game - INFO - Last raiser: 4
2025-10-31 18:56:38,347 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:38,347 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:38,348 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣']
2025-10-31 18:56:38,349 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:38,350 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:38,351 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:38,351 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:38,352 - poker_game - INFO -   P4(Agent4): chips=4561, bet=30, status=active
2025-10-31 18:56:38,352 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:56:38,352 - poker_game - INFO - ==================================================
2025-10-31 18:56:38,454 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "Q♠",
    "K♠"
  ],
  "community": [
    "6♣",
    "6♠",
    "A♦",
    "J♣"
  ],
  "your_chips": 1801,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 90,
  "to_call": 30,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4561,
      "bet": 30,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (30)",
    "raise (min 50)",
    "all-in (1801)"
  ],
  "history": [
    "Player 4 checked",
    "Turn dealt: 9♣",
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30"
  ]
}
2025-10-31 18:56:38,629 - poker_game - DEBUG - Create Session: {'id': 'f6c6dfe9-5e7a-4b20-97b4-d71d936b7cd2', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904598.6262546}
2025-10-31 18:56:38,925 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "あなたの手札はQ♠ K♠で、コミュニティカードは6♣ 6♠ A♦ J♣です。あなたはターン（Turn）の段階で、まだアクションをしていません。対戦相手（Player 4）は30をベットしました。あなたの手札は、A♦とJ♣でストレートの可能性（Q K J T 9）や、6♠でフラッシュの可能性（♠が4枚）もあります。しかし、A♦がボードにあるため、ストレートの完成は難しいです。フラッシュの可能性はありますが、完成するにはまだ2枚の♠が必要です。対戦相手のベット額（30）は、ポットサイズ（90）と比較してそこまで大きくありません。コールして、リバー（River）でのカードを見て、より良いハンド（例：トップペア、ツーペア、フラッシュ）ができるか、あるいは相手がブラフ（bluff - 強いハンドを持っていないのに強いベットをすること）をしている可能性を探るのが最善と考えられます。フォールド（fold - 諦める）するには、まだ十分な可能性があります。レイズ（raise - ベット額を上げる）するには、もう少し情報が欲しいところです。そのため、コールが最も堅実な選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 292, 'promptTokenCount': 879, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 879}], 'totalTokenCount': 1171}, 'invocationId': 'e-073a0717-a59e-4a4d-b8cb-ac5d6c3f65a9', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'rBzPnX2t', 'timestamp': 1761904598.642185}]
2025-10-31 18:56:38,926 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:56:38,926 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 30,
  "reasoning": "あなたの手札はQ♠ K♠で、コミュニティカードは6♣ 6♠ A♦ J♣です。あなたはターン（Turn）の段階で、まだアクションをしていません。対戦相手（Player 4）は30をベットしました。あなたの手札は、A♦とJ♣でストレートの可能性（Q K J T 9）や、6♠でフラッシュの可能性（♠が4枚）もあります。しかし、A♦がボードにあるため、ストレートの完成は難しいです。フラッシュの可能性はありますが、完成するにはまだ2枚の♠が必要です。対戦相手のベット額（30）は、ポットサイズ（90）と比較してそこまで大きくありません。コールして、リバー（River）でのカードを見て、より良いハンド（例：トップペア、ツーペア、フラッシュ）ができるか、あるいは相手がブラフ（bluff - 強いハンドを持っていないのに強いベットをすること）をしている可能性を探るのが最善と考えられます。フォールド（fold - 諦める）するには、まだ十分な可能性があります。レイズ（raise - ベット額を上げる）するには、もう少し情報が欲しいところです。そのため、コールが最も堅実な選択です。"
}
```
2025-10-31 18:56:38,927 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:56:38,927 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "あなたの手札はQ♠ K♠で、コミュニティカードは6♣ 6♠ A♦ J♣です。あなたはターン（Turn）の段階で、まだアクションをしていません。対戦相手（Player 4）は30をベットしました。あなたの手札は、A♦とJ♣でストレートの可能性（Q K J T 9）や、6♠でフラッシュの可能性（♠が4枚）もあります。しかし、A♦がボードにあるため、ストレートの完成は難しいです。フラッシュの可能性はありますが、完成するにはまだ2枚の♠が必要です。対戦相手のベット額（30）は、ポットサイズ（90）と比較してそこまで大きくありません。コールして、リバー（River）でのカードを見て、より良いハンド（例：トップペア、ツーペア、フラッシュ）ができるか、あるいは相手がブラフ（bluff - 強いハンドを持っていないのに強いベットをすること）をしている可能性を探るのが最善と考えられます。フォールド（fold - 諦める）するには、まだ十分な可能性があります。レイズ（raise - ベット額を上げる）するには、もう少し情報が欲しいところです。そのため、コールが最も堅実な選択です。"\n}\n```'
2025-10-31 18:56:38,927 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:56:38,927 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "あなたの手札はQ♠ K♠で、コミュニティカードは6♣ 6♠ A♦ J♣です。あなたはターン（Turn）の段階で、まだアクションをしていません。対戦相手（Player 4）は30をベットしました。あなたの手札は、A♦とJ♣でストレートの可能性（Q K J T 9）や、6♠でフラッシュの可能性（♠が4枚）もあります。しかし、A♦がボードにあるため、ストレートの完成は難しいです。フラッシュの可能性はありますが、完成するにはまだ2枚の♠が必要です。対戦相手のベット額（30）は、ポットサイズ（90）と比較してそこまで大きくありません。コールして、リバー（River）でのカードを見て、より良いハンド（例：トップペア、ツーペア、フラッシュ）ができるか、あるいは相手がブラフ（bluff - 強いハンドを持っていないのに強いベットをすること）をしている可能性を探るのが最善と考えられます。フォールド（fold - 諦める）するには、まだ十分な可能性があります。レイズ（raise - ベット額を上げる）するには、もう少し情報が欲しいところです。そのため、コールが最も堅実な選択です。"\n}'
2025-10-31 18:56:38,928 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 30,
  "reasoning": "あなたの手札はQ♠ K♠で、コミュニティカードは6♣ 6♠ A♦ J♣です。あなたはターン（Turn）の段階で、まだアクションをしていません。対戦相手（Player 4）は30をベットしました。あなたの手札は、A♦とJ♣でストレートの可能性（Q K J T 9）や、6♠でフラッシュの可能性（♠が4枚）もあります。しかし、A♦がボードにあるため、ストレートの完成は難しいです。フラッシュの可能性はありますが、完成するにはまだ2枚の♠が必要です。対戦相手のベット額（30）は、ポットサイズ（90）と比較してそこまで大きくありません。コールして、リバー（River）でのカードを見て、より良いハンド（例：トップペア、ツーペア、フラッシュ）ができるか、あるいは相手がブラフ（bluff - 強いハンドを持っていないのに強いベットをすること）をしている可能性を探るのが最善と考えられます。フォールド（fold - 諦める）するには、まだ十分な可能性があります。レイズ（raise - ベット額を上げる）するには、もう少し情報が欲しいところです。そのため、コールが最も堅実な選択です。"
}
2025-10-31 18:56:38,928 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 30, 'reasoning': 'あなたの手札はQ♠ K♠で、コミュニティカードは6♣ 6♠ A♦ J♣です。あなたはターン（Turn）の段階で、まだアクションをしていません。対戦相手（Player 4）は30をベットしました。あなたの手札は、A♦とJ♣でストレートの可能性（Q K J T 9）や、6♠でフラッシュの可能性（♠が4枚）もあります。しかし、A♦がボードにあるため、ストレートの完成は難しいです。フラッシュの可能性はありますが、完成するにはまだ2枚の♠が必要です。対戦相手のベット額（30）は、ポットサイズ（90）と比較してそこまで大きくありません。コールして、リバー（River）でのカードを見て、より良いハンド（例：トップペア、ツーペア、フラッシュ）ができるか、あるいは相手がブラフ（bluff - 強いハンドを持っていないのに強いベットをすること）をしている可能性を探るのが最善と考えられます。フォールド（fold - 諦める）するには、まだ十分な可能性があります。レイズ（raise - ベット額を上げる）するには、もう少し情報が欲しいところです。そのため、コールが最も堅実な選択です。'}
2025-10-31 18:56:38,928 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 30
2025-10-31 18:56:38,928 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (30)', 'raise (min 50)', 'all-in (1801)']
2025-10-31 18:56:38,928 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (30)': 30
2025-10-31 18:56:38,929 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 30}
2025-10-31 18:56:38,929 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 30, あなたの手札はQ♠ K♠で、コミュニティカードは6♣ 6♠ A♦ J♣です。あなたはターン（Turn）の段階で、まだアクションをしていません。対戦相手（Player 4）は30をベットしました。あなたの手札は、A♦とJ♣でストレートの可能性（Q K J T 9）や、6♠でフラッシュの可能性（♠が4枚）もあります。しかし、A♦がボードにあるため、ストレートの完成は難しいです。フラッシュの可能性はありますが、完成するにはまだ2枚の♠が必要です。対戦相手のベット額（30）は、ポットサイズ（90）と比較してそこまで大きくありません。コールして、リバー（River）でのカードを見て、より良いハンド（例：トップペア、ツーペア、フラッシュ）ができるか、あるいは相手がブラフ（bluff - 強いハンドを持っていないのに強いベットをすること）をしている可能性を探るのが最善と考えられます。フォールド（fold - 諦める）するには、まだ十分な可能性があります。レイズ（raise - ベット額を上げる）するには、もう少し情報が欲しいところです。そのため、コールが最も堅実な選択です。
2025-10-31 18:56:38,930 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 30
2025-10-31 18:56:38,930 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:38,931 - poker_game - INFO - Hand #15, Phase: turn
2025-10-31 18:56:38,931 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:38,932 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:56:38,932 - poker_game - INFO - Last raiser: 4
2025-10-31 18:56:38,932 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:38,933 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:38,934 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣']
2025-10-31 18:56:38,934 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:38,935 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:38,935 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:38,935 - poker_game - INFO -   P3(Agent3): chips=1801, bet=0, status=active
2025-10-31 18:56:38,936 - poker_game - INFO -   P4(Agent4): chips=4561, bet=30, status=active
2025-10-31 18:56:38,936 - poker_game - INFO - ==================================================
2025-10-31 18:56:38,936 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 30
2025-10-31 18:56:38,949 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:38,950 - poker_game - INFO - Hand #15, Phase: turn
2025-10-31 18:56:38,951 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:38,951 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:56:38,951 - poker_game - INFO - Last raiser: 4
2025-10-31 18:56:38,952 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:38,952 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:38,952 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣']
2025-10-31 18:56:38,953 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:38,953 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:38,954 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:38,954 - poker_game - INFO -   P3(Agent3): chips=1771, bet=30, status=active
2025-10-31 18:56:38,955 - poker_game - INFO -   P4(Agent4): chips=4561, bet=30, status=active
2025-10-31 18:56:38,955 - poker_game - INFO - Extra: Action: Player 3 called 30
2025-10-31 18:56:38,956 - poker_game - INFO - ==================================================
2025-10-31 18:56:38,956 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:38,957 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:38,957 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:56:38,957 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:56:38,957 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:38,958 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:38,958 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:56:38,958 - poker_game - DEBUG - Player bets: [30, 30], Current bet: 30, All same: True
2025-10-31 18:56:38,958 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:56:38,959 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:38,959 - poker_game - INFO - Hand #15, Phase: turn
2025-10-31 18:56:38,960 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:38,960 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:56:38,960 - poker_game - INFO - Last raiser: 4
2025-10-31 18:56:38,961 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:38,963 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:38,964 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣']
2025-10-31 18:56:38,964 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:38,965 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:38,965 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:38,966 - poker_game - INFO -   P3(Agent3): chips=1771, bet=30, status=active
2025-10-31 18:56:38,966 - poker_game - INFO -   P4(Agent4): chips=4561, bet=30, status=active
2025-10-31 18:56:38,967 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:56:38,967 - poker_game - INFO - ==================================================
2025-10-31 18:56:39,068 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:56:39,069 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:39,070 - poker_game - INFO - Remaining players: 2
2025-10-31 18:56:39,070 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:56:39,070 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:56:39,071 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:56:39,082 - poker_game - INFO - Starting new betting round
2025-10-31 18:56:39,083 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:56:39,083 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:56:39,083 - poker_game - DEBUG - Active players for new betting round: [3, 4]
2025-10-31 18:56:39,084 - poker_game - DEBUG - Dealer button: 3
2025-10-31 18:56:39,084 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 18:56:39,084 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:56:39,085 - poker_game - INFO - Hand #15, Phase: river
2025-10-31 18:56:39,085 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:39,086 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:39,086 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:39,087 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:39,087 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:39,088 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:39,088 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:39,089 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:39,089 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:39,089 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:39,090 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:39,090 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:56:39,091 - poker_game - INFO - ==================================================
2025-10-31 18:56:39,092 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "J♦",
    "9♦"
  ],
  "community": [
    "6♣",
    "6♠",
    "A♦",
    "J♣",
    "10♦"
  ],
  "your_chips": 4561,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 120,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 3,
      "chips": 1771,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4561)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦"
  ]
}
2025-10-31 18:56:39,108 - poker_game - DEBUG - Create Session: {'id': '38751232-fd67-42ff-9623-0eef264c063f', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904599.1059225}
2025-10-31 18:56:49,195 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:56:51,866 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_Jik6UkokwxCoAsM5VUhIt4uK', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1217, 'totalTokenCount': 1234}, 'invocationId': 'e-9a27e41e-2359-49ee-9961-e3a89b3bfbc3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'K5w84wAR', 'timestamp': 1761904599.122427}, {'content': {'parts': [{'functionResponse': {'id': 'call_Jik6UkokwxCoAsM5VUhIt4uK', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-9a27e41e-2359-49ee-9961-e3a89b3bfbc3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'IsNt8pmw', 'timestamp': 1761904600.062089}, {'content': {'parts': [{'functionCall': {'id': 'call_uRRJm53wjGAkuT1VOCwkR6Bv', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['J♦', '9♦'], 'community': ['6♣', '6♠', 'A♦', 'J♣', '10♦'], 'your_chips': 4561, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 50, 'pot': 120, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3548, 'bet': 0, 'status': 'folded'}, {'id': 3, 'chips': 1771, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4561)'], 'history': ['Player 3 checked', 'Player 4 checked', 'River dealt: 6♠', 'Player 3 checked', 'Player 4 checked', 'Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥', 'Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦', 'Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: 6♣, 6♠, A♦', 'Player 4 checked', 'Player 3 checked', 'Turn dealt: J♣', 'Player 4 raised to 30', 'Player 3 called 30', 'River dealt: 10♦']}, 'call_amount': 0, 'pot_after_call': 120, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 452, 'promptTokenCount': 1741, 'totalTokenCount': 2193}, 'invocationId': 'e-9a27e41e-2359-49ee-9961-e3a89b3bfbc3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '4YQQFaXz', 'timestamp': 1761904600.066151}, {'content': {'parts': [{'functionResponse': {'id': 'call_uRRJm53wjGAkuT1VOCwkR6Bv', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（60.00(ポットに対して50.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-9a27e41e-2359-49ee-9961-e3a89b3bfbc3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'RZ3qPer1', 'timestamp': 1761904609.377774}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（60.00(ポットに対して50.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2228, 'totalTokenCount': 2266}, 'invocationId': 'e-9a27e41e-2359-49ee-9961-e3a89b3bfbc3', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ns1uf1Z1', 'timestamp': 1761904609.381138}]
2025-10-31 18:56:51,867 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:56:51,867 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（60.00(ポットに対して50.00%）ため、チェックします"}
2025-10-31 18:56:51,868 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:56:51,868 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（60.00(ポットに対して50.00%）ため、チェックします"}'
2025-10-31 18:56:51,869 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:56:51,869 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（60.00(ポットに対して50.00%）ため、チェックします"}
2025-10-31 18:56:51,869 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（60.00(ポットに対して50.00%）ため、チェックします'}
2025-10-31 18:56:51,869 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:56:51,870 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:56:51,870 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:56:51,870 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（60.00(ポットに対して50.00%）ため、チェックします
2025-10-31 18:56:51,872 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:56:51,872 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:51,873 - poker_game - INFO - Hand #15, Phase: river
2025-10-31 18:56:51,873 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:51,874 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:51,874 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:51,875 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:51,875 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:51,876 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:51,876 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:51,877 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:51,877 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:51,878 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:51,878 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:51,880 - poker_game - INFO - ==================================================
2025-10-31 18:56:51,881 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:56:51,896 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:51,897 - poker_game - INFO - Hand #15, Phase: river
2025-10-31 18:56:51,897 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:51,898 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:51,898 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:51,899 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:51,899 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:51,900 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:51,900 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:51,901 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:51,901 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:51,902 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:51,902 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:51,902 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:56:51,903 - poker_game - INFO - ==================================================
2025-10-31 18:56:51,904 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:51,904 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:51,905 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:56:51,905 - poker_game - INFO - Advanced from player 4 to player 3 (seat order)
2025-10-31 18:56:51,905 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:51,906 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:51,906 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:56:51,907 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:56:51,907 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:56:51,907 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:56:51,907 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:56:51,907 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:56:51,907 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 4
2025-10-31 18:56:51,907 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:51,908 - poker_game - INFO - Hand #15, Phase: river
2025-10-31 18:56:51,908 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:51,908 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:51,909 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:51,909 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:51,909 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:51,910 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:51,910 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:51,910 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:51,911 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:51,911 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:51,911 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:51,912 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:56:51,912 - poker_game - INFO - ==================================================
2025-10-31 18:56:52,013 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "Q♠",
    "K♠"
  ],
  "community": [
    "6♣",
    "6♠",
    "A♦",
    "J♣",
    "10♦"
  ],
  "your_chips": 1771,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 120,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3548,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 4561,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1771)"
  ],
  "history": [
    "Player 4 checked",
    "River dealt: 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Showdown: Player 3 hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥ cards=9♠, 8♥",
    "Showdown: Player 4 hand=High Card: K♦ - K♦, Q♠, 10♠, 9♣, 6♠ cards=K♦, 5♦",
    "Side pot layer 0: amount=40, winners=3 best_hand=One Pair: 9s - Q♠, 10♠, 9♠, 9♣, 8♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked"
  ]
}
2025-10-31 18:56:52,031 - poker_game - DEBUG - Create Session: {'id': '5595d412-9c80-43d4-990e-c2b71937bf4e', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904612.0283756}
2025-10-31 18:56:54,199 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）まで来たので、ショーダウン（カード公開）となります。あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦ J♣ 10♦です。これらを組み合わせると、あなたのベストハンドはA♦ 10♦ J♣ Q♠ K♠のストレート（連続した数字の役）です。対戦相手（Player 4）はチェックしました。ポットは120です。これで勝敗が決まるため、コールやレイズの必要はなく、チェックしてショーダウンに進みます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 151, 'promptTokenCount': 886, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 886}], 'totalTokenCount': 1037}, 'invocationId': 'e-01312b50-38d1-4ee6-9892-86e5f896d5ee', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'TqKmX2h9', 'timestamp': 1761904612.042434}]
2025-10-31 18:56:54,200 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:56:54,201 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカード）まで来たので、ショーダウン（カード公開）となります。あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦ J♣ 10♦です。これらを組み合わせると、あなたのベストハンドはA♦ 10♦ J♣ Q♠ K♠のストレート（連続した数字の役）です。対戦相手（Player 4）はチェックしました。ポットは120です。これで勝敗が決まるため、コールやレイズの必要はなく、チェックしてショーダウンに進みます。"
}
```
2025-10-31 18:56:54,201 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:56:54,201 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）まで来たので、ショーダウン（カード公開）となります。あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦ J♣ 10♦です。これらを組み合わせると、あなたのベストハンドはA♦ 10♦ J♣ Q♠ K♠のストレート（連続した数字の役）です。対戦相手（Player 4）はチェックしました。ポットは120です。これで勝敗が決まるため、コールやレイズの必要はなく、チェックしてショーダウンに進みます。"\n}\n```'
2025-10-31 18:56:54,202 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:56:54,202 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）まで来たので、ショーダウン（カード公開）となります。あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦ J♣ 10♦です。これらを組み合わせると、あなたのベストハンドはA♦ 10♦ J♣ Q♠ K♠のストレート（連続した数字の役）です。対戦相手（Player 4）はチェックしました。ポットは120です。これで勝敗が決まるため、コールやレイズの必要はなく、チェックしてショーダウンに進みます。"\n}'
2025-10-31 18:56:54,202 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカード）まで来たので、ショーダウン（カード公開）となります。あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦ J♣ 10♦です。これらを組み合わせると、あなたのベストハンドはA♦ 10♦ J♣ Q♠ K♠のストレート（連続した数字の役）です。対戦相手（Player 4）はチェックしました。ポットは120です。これで勝敗が決まるため、コールやレイズの必要はなく、チェックしてショーダウンに進みます。"
}
2025-10-31 18:56:54,202 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最後のカード）まで来たので、ショーダウン（カード公開）となります。あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦ J♣ 10♦です。これらを組み合わせると、あなたのベストハンドはA♦ 10♦ J♣ Q♠ K♠のストレート（連続した数字の役）です。対戦相手（Player 4）はチェックしました。ポットは120です。これで勝敗が決まるため、コールやレイズの必要はなく、チェックしてショーダウンに進みます。'}
2025-10-31 18:56:54,203 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:56:54,203 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:56:54,203 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:56:54,203 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, リバー（最後のカード）まで来たので、ショーダウン（カード公開）となります。あなたの手札はQ♠ K♠、コミュニティカードは6♣ 6♠ A♦ J♣ 10♦です。これらを組み合わせると、あなたのベストハンドはA♦ 10♦ J♣ Q♠ K♠のストレート（連続した数字の役）です。対戦相手（Player 4）はチェックしました。ポットは120です。これで勝敗が決まるため、コールやレイズの必要はなく、チェックしてショーダウンに進みます。
2025-10-31 18:56:54,205 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:56:54,205 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:56:54,205 - poker_game - INFO - Hand #15, Phase: river
2025-10-31 18:56:54,206 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:54,206 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:54,207 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:54,207 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:54,207 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:54,208 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:54,208 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:54,209 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:54,209 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:54,210 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:54,210 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:54,210 - poker_game - INFO - ==================================================
2025-10-31 18:56:54,211 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:56:54,223 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:56:54,224 - poker_game - INFO - Hand #15, Phase: river
2025-10-31 18:56:54,225 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:56:54,225 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:54,225 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:54,226 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:54,226 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:54,227 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:54,227 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:54,227 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:54,228 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:54,228 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:54,229 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:54,229 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:56:54,229 - poker_game - INFO - ==================================================
2025-10-31 18:56:54,230 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:56:54,230 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:56:54,231 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 18:56:54,231 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:56:54,231 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:56:54,232 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:56:54,232 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:56:54,232 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:56:54,232 - poker_game - DEBUG - Active player indices: [3, 4]
2025-10-31 18:56:54,232 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:56:54,233 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:56:54,233 - poker_game - DEBUG - First actor index: 4
2025-10-31 18:56:54,233 - poker_game - INFO - Betting complete: Back to first actor 4 (all players have acted)
2025-10-31 18:56:54,233 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:56:54,234 - poker_game - INFO - Hand #15, Phase: river
2025-10-31 18:56:54,234 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:54,235 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:54,235 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:54,236 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:54,236 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:54,236 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:54,237 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:54,237 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:54,238 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:54,238 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:54,239 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:54,239 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:56:54,239 - poker_game - INFO - ==================================================
2025-10-31 18:56:54,340 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:56:54,341 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:54,342 - poker_game - INFO - Remaining players: 2
2025-10-31 18:56:54,342 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:56:54,343 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:56:54,343 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:56:54,343 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:56:54,344 - poker_game - INFO - Hand #15, Phase: showdown
2025-10-31 18:56:54,344 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:56:54,345 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 18:56:54,345 - poker_game - INFO - Last raiser: None
2025-10-31 18:56:54,345 - poker_game - INFO - Betting round complete: True
2025-10-31 18:56:54,346 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:56:54,346 - poker_game - INFO - Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:54,347 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:54,347 - poker_game - INFO -   P1(Agent1): chips=3548, bet=0, status=folded
2025-10-31 18:56:54,348 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:54,348 - poker_game - INFO -   P3(Agent3): chips=1771, bet=0, status=active
2025-10-31 18:56:54,348 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:54,349 - poker_game - INFO - ==================================================
2025-10-31 18:56:54,349 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:56:54,349 - poker_game - INFO - Pot: 120, Community cards: ['6♣', '6♠', 'A♦', 'J♣', '10♦']
2025-10-31 18:56:54,350 - poker_game - INFO -   Player 3 status=active cards=['Q♠', 'K♠']
2025-10-31 18:56:54,350 - poker_game - INFO -   Player 4 status=active cards=['J♦', '9♦']
2025-10-31 18:56:54,353 - poker_game - INFO -   Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=['Q♠', 'K♠']
2025-10-31 18:56:54,353 - poker_game - INFO -   Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=['J♦', '9♦']
2025-10-31 18:56:54,354 - poker_game - INFO - Pot layer 0: amount=60, contributors=[1, 3, 4]
2025-10-31 18:56:54,354 - poker_game - INFO - Pot layer 1: amount=60, contributors=[3, 4]
2025-10-31 18:56:54,355 - poker_game - INFO - Showdown total awarded: 120 (game.pot=120)
2025-10-31 18:56:54,355 - poker_game - INFO - Showdown winners (aggregated): [3]
2025-10-31 18:56:54,356 - poker_game - INFO -   Awarded 120 to Player 3 (hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦)
2025-10-31 18:56:54,356 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:56:54,389 - poker_game - INFO - === STARTING NEW HAND #16 ===
2025-10-31 18:56:54,390 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:56:54,390 - poker_game - INFO - Moving dealer button
2025-10-31 18:56:54,390 - poker_game - INFO - Posting blinds
2025-10-31 18:56:54,412 - poker_game - INFO - Dealing hole cards
2025-10-31 18:56:54,413 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:56:54,428 - poker_game - INFO - Started new hand in database: hand_id=16
2025-10-31 18:56:54,429 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:56:54,429 - poker_game - INFO - Hand #16, Phase: preflop
2025-10-31 18:56:54,429 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:56:54,430 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:56:54,430 - poker_game - INFO - Last raiser: 3
2025-10-31 18:56:54,431 - poker_game - INFO - Betting round complete: False
2025-10-31 18:56:54,431 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:56:54,432 - poker_game - INFO - Community cards: []
2025-10-31 18:56:54,432 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:56:54,432 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:56:54,433 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:56:54,433 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:56:54,434 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:56:54,434 - poker_game - INFO - ==================================================
2025-10-31 18:56:54,435 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "8♣",
    "2♠"
  ],
  "community": [],
  "your_chips": 4561,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3538,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1871,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (4561)"
  ],
  "history": [
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 18:56:54,453 - poker_game - DEBUG - Create Session: {'id': 'a54609ae-8797-4f10-b482-6a6e54ce207e', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904614.4504101}
2025-10-31 18:57:04,582 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:57:07,957 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_G99ZhaG9VHO1KLrPeWu7ezjS', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1221, 'totalTokenCount': 1238}, 'invocationId': 'e-e6310238-9fe1-4744-8231-1698879f130a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'P04kEYOq', 'timestamp': 1761904614.46576}, {'content': {'parts': [{'functionResponse': {'id': 'call_G99ZhaG9VHO1KLrPeWu7ezjS', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e6310238-9fe1-4744-8231-1698879f130a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'P0QhEkr4', 'timestamp': 1761904615.568013}, {'content': {'parts': [{'functionCall': {'id': 'call_CEWQ3KuJuWzDvdyP28YNhLlf', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1745, 'totalTokenCount': 1762}, 'invocationId': 'e-e6310238-9fe1-4744-8231-1698879f130a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'uZTi5hpt', 'timestamp': 1761904615.573222}, {'content': {'parts': [{'functionResponse': {'id': 'call_CEWQ3KuJuWzDvdyP28YNhLlf', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e6310238-9fe1-4744-8231-1698879f130a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'TtSg0AkK', 'timestamp': 1761904616.6915}, {'content': {'parts': [{'functionCall': {'id': 'call_t63tT56WZIwp3oUhi8ynTsa7', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['8♣', '2♠'], 'community': [], 'your_chips': 4561, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3538, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 1871, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (4561)'], 'history': ['Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 called 20', 'Player 4 called 10', 'Player 1 folded', 'Flop dealt: 6♣, 6♠, A♦', 'Player 4 checked', 'Player 3 checked', 'Turn dealt: J♣', 'Player 4 raised to 30', 'Player 3 called 30', 'River dealt: 10♦', 'Player 4 checked', 'Player 3 checked', 'Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠', 'Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦', 'Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.04}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 453, 'promptTokenCount': 1776, 'totalTokenCount': 2229}, 'invocationId': 'e-e6310238-9fe1-4744-8231-1698879f130a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'tYp3h3u5', 'timestamp': 1761904616.695967}, {'content': {'parts': [{'functionResponse': {'id': 'call_t63tT56WZIwp3oUhi8ynTsa7', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-17.20(ポットに対して-57.33%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'e-e6310238-9fe1-4744-8231-1698879f130a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'FsRZmAo1', 'timestamp': 1761904626.492193}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が-17.20(ポットに対して-57.33%で、マイナスなのでフォールド"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 41, 'promptTokenCount': 2283, 'totalTokenCount': 2324}, 'invocationId': 'e-e6310238-9fe1-4744-8231-1698879f130a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'yJF5IViu', 'timestamp': 1761904626.494177}]
2025-10-31 18:57:07,958 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:57:07,958 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が-17.20(ポットに対して-57.33%で、マイナスなのでフォールド"}
2025-10-31 18:57:07,958 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:57:07,959 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が-17.20(ポットに対して-57.33%で、マイナスなのでフォールド"}'
2025-10-31 18:57:07,959 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:57:07,959 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が-17.20(ポットに対して-57.33%で、マイナスなのでフォールド"}
2025-10-31 18:57:07,959 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-17.20(ポットに対して-57.33%で、マイナスなのでフォールド'}
2025-10-31 18:57:07,960 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:57:07,960 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:57:07,960 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:57:07,960 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が-17.20(ポットに対して-57.33%で、マイナスなのでフォールド
2025-10-31 18:57:07,961 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:57:07,961 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:07,961 - poker_game - INFO - Hand #16, Phase: preflop
2025-10-31 18:57:07,961 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:57:07,962 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:07,962 - poker_game - INFO - Last raiser: 3
2025-10-31 18:57:07,962 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:07,962 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:07,962 - poker_game - INFO - Community cards: []
2025-10-31 18:57:07,962 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:07,963 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:57:07,963 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:07,963 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:57:07,963 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=active
2025-10-31 18:57:07,963 - poker_game - INFO - ==================================================
2025-10-31 18:57:07,963 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:57:07,975 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:07,976 - poker_game - INFO - Hand #16, Phase: preflop
2025-10-31 18:57:07,976 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:57:07,976 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:07,976 - poker_game - INFO - Last raiser: 3
2025-10-31 18:57:07,977 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:07,977 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:57:07,977 - poker_game - INFO - Community cards: []
2025-10-31 18:57:07,977 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:07,977 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:57:07,978 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:07,978 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:57:07,978 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=folded
2025-10-31 18:57:07,978 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:57:07,979 - poker_game - INFO - ==================================================
2025-10-31 18:57:07,979 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:07,979 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:07,979 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:57:07,979 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:57:07,979 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:07,980 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:07,980 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:57:07,980 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 18:57:07,980 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:57:07,980 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:07,980 - poker_game - INFO - Hand #16, Phase: preflop
2025-10-31 18:57:07,980 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:57:07,981 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:07,981 - poker_game - INFO - Last raiser: 3
2025-10-31 18:57:07,981 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:07,981 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:57:07,981 - poker_game - INFO - Community cards: []
2025-10-31 18:57:07,981 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:07,981 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:57:07,981 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:07,985 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:57:07,987 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=folded
2025-10-31 18:57:07,989 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:57:07,990 - poker_game - INFO - ==================================================
2025-10-31 18:57:10,520 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "7♦",
    "4♥"
  ],
  "community": [],
  "your_chips": 3538,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1871,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4561,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (3538)"
  ],
  "history": [
    "Player 1 posted big blind 20",
    "Player 3 called 20",
    "Player 4 called 10",
    "Player 1 folded",
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded"
  ]
}
2025-10-31 18:57:10,532 - poker_game - DEBUG - Create Session: {'id': '1d1aad10-41a7-45d9-9ca2-55638ed461c1', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904630.5286837}
2025-10-31 18:57:07,861 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は7♦4♥です。これは「コネクター」と呼ばれるカードの組み合わせですが、スートが揃っておらず（フラッシュ・ドローにならない）、ランクも低いため、強い役を作る可能性は低いです。ポットのサイズは30で、コールするには10必要ですが、相手のレイズ額（過去の履歴から推定）や、残りのチップ量、そして相手のプレイスタイルを考慮すると、この手札でコールするのはリスクが高いと判断しました。特に、過去の履歴を見ると、Player 3はAハイのストレートで勝っており、Player 4はJと6のツーペアで勝っています。これらの情報から、相手が強い手を持っている可能性が高いと考え、フォールドを選択します。"\n}'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 194, 'promptTokenCount': 889, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 889}], 'totalTokenCount': 1083}, 'invocationId': 'e-23f62bb0-e0bd-4537-97f3-aaea8cb61496', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'HEiywMEc', 'timestamp': 1761904630.542274}]
2025-10-31 18:57:07,861 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:57:07,862 - poker_game - DEBUG - {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は7♦4♥です。これは「コネクター」と呼ばれるカードの組み合わせですが、スートが揃っておらず（フラッシュ・ドローにならない）、ランクも低いため、強い役を作る可能性は低いです。ポットのサイズは30で、コールするには10必要ですが、相手のレイズ額（過去の履歴から推定）や、残りのチップ量、そして相手のプレイスタイルを考慮すると、この手札でコールするのはリスクが高いと判断しました。特に、過去の履歴を見ると、Player 3はAハイのストレートで勝っており、Player 4はJと6のツーペアで勝っています。これらの情報から、相手が強い手を持っている可能性が高いと考え、フォールドを選択します。"
}
2025-10-31 18:57:07,862 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:57:07,862 - poker_game - DEBUG - [Agent1] Raw response content: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は7♦4♥です。これは「コネクター」と呼ばれるカードの組み合わせですが、スートが揃っておらず（フラッシュ・ドローにならない）、ランクも低いため、強い役を作る可能性は低いです。ポットのサイズは30で、コールするには10必要ですが、相手のレイズ額（過去の履歴から推定）や、残りのチップ量、そして相手のプレイスタイルを考慮すると、この手札でコールするのはリスクが高いと判断しました。特に、過去の履歴を見ると、Player 3はAハイのストレートで勝っており、Player 4はJと6のツーペアで勝っています。これらの情報から、相手が強い手を持っている可能性が高いと考え、フォールドを選択します。"\n}'
2025-10-31 18:57:07,863 - poker_game - DEBUG - [Agent1] No markdown code block detected
2025-10-31 18:57:07,863 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は7♦4♥です。これは「コネクター」と呼ばれるカードの組み合わせですが、スートが揃っておらず（フラッシュ・ドローにならない）、ランクも低いため、強い役を作る可能性は低いです。ポットのサイズは30で、コールするには10必要ですが、相手のレイズ額（過去の履歴から推定）や、残りのチップ量、そして相手のプレイスタイルを考慮すると、この手札でコールするのはリスクが高いと判断しました。特に、過去の履歴を見ると、Player 3はAハイのストレートで勝っており、Player 4はJと6のツーペアで勝っています。これらの情報から、相手が強い手を持っている可能性が高いと考え、フォールドを選択します。"
}
2025-10-31 18:57:07,863 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（フロップが開く前）で、私の手札は7♦4♥です。これは「コネクター」と呼ばれるカードの組み合わせですが、スートが揃っておらず（フラッシュ・ドローにならない）、ランクも低いため、強い役を作る可能性は低いです。ポットのサイズは30で、コールするには10必要ですが、相手のレイズ額（過去の履歴から推定）や、残りのチップ量、そして相手のプレイスタイルを考慮すると、この手札でコールするのはリスクが高いと判断しました。特に、過去の履歴を見ると、Player 3はAハイのストレートで勝っており、Player 4はJと6のツーペアで勝っています。これらの情報から、相手が強い手を持っている可能性が高いと考え、フォールドを選択します。'}
2025-10-31 18:57:07,863 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 18:57:07,864 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 18:57:07,864 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:57:07,864 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップ（フロップが開く前）で、私の手札は7♦4♥です。これは「コネクター」と呼ばれるカードの組み合わせですが、スートが揃っておらず（フラッシュ・ドローにならない）、ランクも低いため、強い役を作る可能性は低いです。ポットのサイズは30で、コールするには10必要ですが、相手のレイズ額（過去の履歴から推定）や、残りのチップ量、そして相手のプレイスタイルを考慮すると、この手札でコールするのはリスクが高いと判断しました。特に、過去の履歴を見ると、Player 3はAハイのストレートで勝っており、Player 4はJと6のツーペアで勝っています。これらの情報から、相手が強い手を持っている可能性が高いと考え、フォールドを選択します。
2025-10-31 18:57:07,865 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 18:57:07,866 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:07,866 - poker_game - INFO - Hand #16, Phase: preflop
2025-10-31 18:57:07,866 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:57:07,867 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:07,867 - poker_game - INFO - Last raiser: 3
2025-10-31 18:57:07,868 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:07,868 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:57:07,869 - poker_game - INFO - Community cards: []
2025-10-31 18:57:07,869 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:07,869 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=active
2025-10-31 18:57:07,870 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:07,871 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:57:07,871 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=folded
2025-10-31 18:57:07,872 - poker_game - INFO - ==================================================
2025-10-31 18:57:07,873 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 18:57:07,885 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:07,885 - poker_game - INFO - Hand #16, Phase: preflop
2025-10-31 18:57:07,886 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:57:07,886 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:07,887 - poker_game - INFO - Last raiser: 3
2025-10-31 18:57:07,887 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:07,888 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:57:07,888 - poker_game - INFO - Community cards: []
2025-10-31 18:57:07,889 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:07,889 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=folded
2025-10-31 18:57:07,889 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:07,890 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:57:07,890 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=folded
2025-10-31 18:57:07,891 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 18:57:07,891 - poker_game - INFO - ==================================================
2025-10-31 18:57:07,891 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:07,892 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:07,892 - poker_game - DEBUG - Active players: [3]
2025-10-31 18:57:07,892 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:57:07,893 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:07,893 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:07,893 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:57:07,894 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:57:07,894 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:07,895 - poker_game - INFO - Hand #16, Phase: preflop
2025-10-31 18:57:07,895 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:57:07,896 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:07,896 - poker_game - INFO - Last raiser: 3
2025-10-31 18:57:07,896 - poker_game - INFO - Betting round complete: True
2025-10-31 18:57:07,897 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:57:07,897 - poker_game - INFO - Community cards: []
2025-10-31 18:57:07,898 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:07,898 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=folded
2025-10-31 18:57:07,898 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:07,899 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:57:07,899 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=folded
2025-10-31 18:57:07,899 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:57:07,899 - poker_game - INFO - ==================================================
2025-10-31 18:57:08,001 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:57:08,001 - poker_game - INFO - Betting round complete: True
2025-10-31 18:57:08,002 - poker_game - INFO - Remaining players: 1
2025-10-31 18:57:08,002 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:57:08,002 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:57:08,003 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:57:08,003 - poker_game - INFO - Hand #16, Phase: showdown
2025-10-31 18:57:08,003 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:57:08,004 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:08,004 - poker_game - INFO - Last raiser: 3
2025-10-31 18:57:08,005 - poker_game - INFO - Betting round complete: True
2025-10-31 18:57:08,005 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:57:08,005 - poker_game - INFO - Community cards: []
2025-10-31 18:57:08,006 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:08,006 - poker_game - INFO -   P1(Agent1): chips=3538, bet=10, status=folded
2025-10-31 18:57:08,006 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:08,007 - poker_game - INFO -   P3(Agent3): chips=1871, bet=20, status=active
2025-10-31 18:57:08,007 - poker_game - INFO -   P4(Agent4): chips=4561, bet=0, status=folded
2025-10-31 18:57:08,008 - poker_game - INFO - ==================================================
2025-10-31 18:57:08,008 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:57:08,009 - poker_game - INFO - Pot: 30, Community cards: []
2025-10-31 18:57:08,009 - poker_game - INFO -   Player 3 status=active cards=['Q♣', '6♦']
2025-10-31 18:57:08,009 - poker_game - INFO - Showdown winner by default: Player 3 awarded 30
2025-10-31 18:57:08,010 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:57:08,010 - poker_game - INFO - === STARTING NEW HAND #17 ===
2025-10-31 18:57:08,011 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:57:08,011 - poker_game - INFO - Moving dealer button
2025-10-31 18:57:08,012 - poker_game - INFO - Posting blinds
2025-10-31 18:57:08,037 - poker_game - INFO - Dealing hole cards
2025-10-31 18:57:08,037 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:57:08,049 - poker_game - INFO - Started new hand in database: hand_id=17
2025-10-31 18:57:08,050 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:57:08,050 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:08,051 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:57:08,051 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:08,051 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:08,052 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:08,052 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:08,053 - poker_game - INFO - Community cards: []
2025-10-31 18:57:08,053 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:08,054 - poker_game - INFO -   P1(Agent1): chips=3538, bet=0, status=active
2025-10-31 18:57:08,056 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:08,057 - poker_game - INFO -   P3(Agent3): chips=1891, bet=10, status=active
2025-10-31 18:57:08,057 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:08,058 - poker_game - INFO - ==================================================
2025-10-31 18:57:08,059 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "8♥",
    "9♦"
  ],
  "community": [],
  "your_chips": 3538,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1891,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4541,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (3538)"
  ],
  "history": [
    "Flop dealt: 6♣, 6♠, A♦",
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:57:08,079 - poker_game - DEBUG - Create Session: {'id': 'c00b18c4-f79c-47b2-9b96-b763f10162f3', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904628.0758529}
2025-10-31 18:57:09,989 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでは、8と9はコネクター（連続した数字）であり、スーテッド（同じスート）ではないものの、十分にプレイできるハンドです。現在、ポットには30あり、コールするには20必要です。これは、ポットオッズ（ポットのサイズに対するベット額の比率）が良いことを意味します。つまり、コールした後の利益が期待できる可能性が高いということです。相手のプレイスタイルや過去の履歴が不明なため、まずはコールしてフロップを見て、その後の展開を判断するのが最善策です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 147, 'promptTokenCount': 893, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 893}], 'totalTokenCount': 1040}, 'invocationId': 'e-9491e629-de25-48fe-9e87-e2be3537e081', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'teiCyc50', 'timestamp': 1761904628.089404}]
2025-10-31 18:57:09,990 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:57:09,990 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップでは、8と9はコネクター（連続した数字）であり、スーテッド（同じスート）ではないものの、十分にプレイできるハンドです。現在、ポットには30あり、コールするには20必要です。これは、ポットオッズ（ポットのサイズに対するベット額の比率）が良いことを意味します。つまり、コールした後の利益が期待できる可能性が高いということです。相手のプレイスタイルや過去の履歴が不明なため、まずはコールしてフロップを見て、その後の展開を判断するのが最善策です。"
}
```
2025-10-31 18:57:09,990 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:57:09,991 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでは、8と9はコネクター（連続した数字）であり、スーテッド（同じスート）ではないものの、十分にプレイできるハンドです。現在、ポットには30あり、コールするには20必要です。これは、ポットオッズ（ポットのサイズに対するベット額の比率）が良いことを意味します。つまり、コールした後の利益が期待できる可能性が高いということです。相手のプレイスタイルや過去の履歴が不明なため、まずはコールしてフロップを見て、その後の展開を判断するのが最善策です。"\n}\n```'
2025-10-31 18:57:09,991 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:57:09,991 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでは、8と9はコネクター（連続した数字）であり、スーテッド（同じスート）ではないものの、十分にプレイできるハンドです。現在、ポットには30あり、コールするには20必要です。これは、ポットオッズ（ポットのサイズに対するベット額の比率）が良いことを意味します。つまり、コールした後の利益が期待できる可能性が高いということです。相手のプレイスタイルや過去の履歴が不明なため、まずはコールしてフロップを見て、その後の展開を判断するのが最善策です。"\n}'
2025-10-31 18:57:09,991 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップでは、8と9はコネクター（連続した数字）であり、スーテッド（同じスート）ではないものの、十分にプレイできるハンドです。現在、ポットには30あり、コールするには20必要です。これは、ポットオッズ（ポットのサイズに対するベット額の比率）が良いことを意味します。つまり、コールした後の利益が期待できる可能性が高いということです。相手のプレイスタイルや過去の履歴が不明なため、まずはコールしてフロップを見て、その後の展開を判断するのが最善策です。"
}
2025-10-31 18:57:09,992 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップでは、8と9はコネクター（連続した数字）であり、スーテッド（同じスート）ではないものの、十分にプレイできるハンドです。現在、ポットには30あり、コールするには20必要です。これは、ポットオッズ（ポットのサイズに対するベット額の比率）が良いことを意味します。つまり、コールした後の利益が期待できる可能性が高いということです。相手のプレイスタイルや過去の履歴が不明なため、まずはコールしてフロップを見て、その後の展開を判断するのが最善策です。'}
2025-10-31 18:57:09,992 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 20
2025-10-31 18:57:09,992 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (3538)']
2025-10-31 18:57:09,992 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (20)': 20
2025-10-31 18:57:09,992 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:57:09,993 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 20, プリフロップでは、8と9はコネクター（連続した数字）であり、スーテッド（同じスート）ではないものの、十分にプレイできるハンドです。現在、ポットには30あり、コールするには20必要です。これは、ポットオッズ（ポットのサイズに対するベット額の比率）が良いことを意味します。つまり、コールした後の利益が期待できる可能性が高いということです。相手のプレイスタイルや過去の履歴が不明なため、まずはコールしてフロップを見て、その後の展開を判断するのが最善策です。
2025-10-31 18:57:09,994 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 20
2025-10-31 18:57:09,994 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:09,995 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:09,995 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:57:09,996 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:57:09,996 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:09,996 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:09,997 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:09,997 - poker_game - INFO - Community cards: []
2025-10-31 18:57:09,998 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:09,998 - poker_game - INFO -   P1(Agent1): chips=3538, bet=0, status=active
2025-10-31 18:57:09,999 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:10,001 - poker_game - INFO -   P3(Agent3): chips=1891, bet=10, status=active
2025-10-31 18:57:10,002 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:10,003 - poker_game - INFO - ==================================================
2025-10-31 18:57:10,003 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 20
2025-10-31 18:57:10,019 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:10,020 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:10,020 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:57:10,021 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:57:10,021 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:10,021 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:10,022 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:10,022 - poker_game - INFO - Community cards: []
2025-10-31 18:57:10,023 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:10,023 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:10,023 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:10,024 - poker_game - INFO -   P3(Agent3): chips=1891, bet=10, status=active
2025-10-31 18:57:10,024 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:10,025 - poker_game - INFO - Extra: Action: Player 1 called 20
2025-10-31 18:57:10,026 - poker_game - INFO - ==================================================
2025-10-31 18:57:10,030 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:10,032 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:10,035 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:10,035 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:57:10,036 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:10,036 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:10,036 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:10,037 - poker_game - DEBUG - Player bets: [20, 10, 20], Current bet: 20, All same: False
2025-10-31 18:57:10,037 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:57:10,037 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:10,037 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:10,038 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:10,038 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:57:10,039 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:10,039 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:10,040 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:10,040 - poker_game - INFO - Community cards: []
2025-10-31 18:57:10,041 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:10,041 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:10,042 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:10,042 - poker_game - INFO -   P3(Agent3): chips=1891, bet=10, status=active
2025-10-31 18:57:10,042 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:10,043 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:57:10,043 - poker_game - INFO - ==================================================
2025-10-31 18:57:10,145 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "A♦",
    "9♥"
  ],
  "community": [],
  "your_chips": 1891,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3518,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4541,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1891)"
  ],
  "history": [
    "Player 4 checked",
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20"
  ]
}
2025-10-31 18:57:10,167 - poker_game - DEBUG - Create Session: {'id': 'c91afcf7-59c4-4c32-afbf-2ccd2a37aa0c', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904630.1629212}
2025-10-31 18:57:12,190 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（Pre-flop）で、あなたはA♦9♥というハンドを持っています。これは一般的に良いハンド（プレミアムハンド）とは言えませんが、ポットのサイズ（50）と、コールするのに必要な金額（10）を考慮すると、コールしてフロップ（Flop）を見る価値はあります。相手のプレイヤーの情報が少ないため、様子を見ます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 113, 'promptTokenCount': 888, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 888}], 'totalTokenCount': 1001}, 'invocationId': 'e-23a31b2d-7435-4e56-b09d-7d6bab7b92b6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Ei9I8HTg', 'timestamp': 1761904630.180972}]
2025-10-31 18:57:12,191 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:57:12,191 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップ（Pre-flop）で、あなたはA♦9♥というハンドを持っています。これは一般的に良いハンド（プレミアムハンド）とは言えませんが、ポットのサイズ（50）と、コールするのに必要な金額（10）を考慮すると、コールしてフロップ（Flop）を見る価値はあります。相手のプレイヤーの情報が少ないため、様子を見ます。"
}
```
2025-10-31 18:57:12,192 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（Pre-flop）で、あなたはA♦9♥というハンドを持っています。これは一般的に良いハンド（プレミアムハンド）とは言えませんが、ポットのサイズ（50）と、コールするのに必要な金額（10）を考慮すると、コールしてフロップ（Flop）を見る価値はあります。相手のプレイヤーの情報が少ないため、様子を見ます。"\n}\n```'
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（Pre-flop）で、あなたはA♦9♥というハンドを持っています。これは一般的に良いハンド（プレミアムハンド）とは言えませんが、ポットのサイズ（50）と、コールするのに必要な金額（10）を考慮すると、コールしてフロップ（Flop）を見る価値はあります。相手のプレイヤーの情報が少ないため、様子を見ます。"\n}'
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップ（Pre-flop）で、あなたはA♦9♥というハンドを持っています。これは一般的に良いハンド（プレミアムハンド）とは言えませんが、ポットのサイズ（50）と、コールするのに必要な金額（10）を考慮すると、コールしてフロップ（Flop）を見る価値はあります。相手のプレイヤーの情報が少ないため、様子を見ます。"
}
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップ（Pre-flop）で、あなたはA♦9♥というハンドを持っています。これは一般的に良いハンド（プレミアムハンド）とは言えませんが、ポットのサイズ（50）と、コールするのに必要な金額（10）を考慮すると、コールしてフロップ（Flop）を見る価値はあります。相手のプレイヤーの情報が少ないため、様子を見ます。'}
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 10
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (1891)']
2025-10-31 18:57:12,193 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (10)': 10
2025-10-31 18:57:12,194 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:57:12,194 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 10, プリフロップ（Pre-flop）で、あなたはA♦9♥というハンドを持っています。これは一般的に良いハンド（プレミアムハンド）とは言えませんが、ポットのサイズ（50）と、コールするのに必要な金額（10）を考慮すると、コールしてフロップ（Flop）を見る価値はあります。相手のプレイヤーの情報が少ないため、様子を見ます。
2025-10-31 18:57:12,195 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 10
2025-10-31 18:57:12,196 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:12,196 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:12,196 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:12,197 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:57:12,197 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:12,197 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:12,198 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:12,198 - poker_game - INFO - Community cards: []
2025-10-31 18:57:12,199 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:12,199 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:12,200 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:12,200 - poker_game - INFO -   P3(Agent3): chips=1891, bet=10, status=active
2025-10-31 18:57:12,200 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:12,200 - poker_game - INFO - ==================================================
2025-10-31 18:57:12,201 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 10
2025-10-31 18:57:12,216 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:12,217 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:12,217 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:12,217 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:57:12,218 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:12,218 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:12,219 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:12,219 - poker_game - INFO - Community cards: []
2025-10-31 18:57:12,219 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:12,220 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:12,220 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:12,221 - poker_game - INFO -   P3(Agent3): chips=1881, bet=20, status=active
2025-10-31 18:57:12,221 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:12,221 - poker_game - INFO - Extra: Action: Player 3 called 10
2025-10-31 18:57:12,222 - poker_game - INFO - ==================================================
2025-10-31 18:57:12,222 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:12,223 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:12,223 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:12,223 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:57:12,223 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:12,224 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:12,224 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:12,224 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:57:12,224 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:57:12,225 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:57:12,227 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:57:12,227 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:57:12,227 - poker_game - DEBUG - Betting continues: Current player 4 != next after raiser 1
2025-10-31 18:57:12,228 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:12,230 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:12,232 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:12,234 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:57:12,236 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:12,236 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:12,236 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:12,237 - poker_game - INFO - Community cards: []
2025-10-31 18:57:12,237 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:12,237 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:12,237 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:12,238 - poker_game - INFO -   P3(Agent3): chips=1881, bet=20, status=active
2025-10-31 18:57:12,238 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:12,238 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:57:12,238 - poker_game - INFO - ==================================================
2025-10-31 18:57:12,340 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "7♥",
    "Q♠"
  ],
  "community": [],
  "your_chips": 4541,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3518,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1881,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (4541)"
  ],
  "history": [
    "Player 3 checked",
    "Turn dealt: J♣",
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10"
  ]
}
2025-10-31 18:57:12,518 - poker_game - DEBUG - Create Session: {'id': '84e67a78-ff60-45c8-8855-c129da1f9825', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904632.5094457}
2025-10-31 18:57:22,540 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:57:26,438 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_pRv2FfaWzhtWFxRCgU1FdyVs', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1211, 'totalTokenCount': 1228}, 'invocationId': 'e-9b07e062-bc2e-4caa-970e-51c632b44952', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'zoCMiJld', 'timestamp': 1761904632.533712}, {'content': {'parts': [{'functionResponse': {'id': 'call_pRv2FfaWzhtWFxRCgU1FdyVs', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-9b07e062-bc2e-4caa-970e-51c632b44952', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'NXYdHQ52', 'timestamp': 1761904633.644065}, {'content': {'parts': [{'functionCall': {'id': 'call_WlDV3e81dwLcWwdDVrW9TxmC', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['7♥', 'Q♠'], 'community': [], 'your_chips': 4541, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3518, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1881, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (4541)'], 'history': ['Player 3 checked', 'Turn dealt: J♣', 'Player 4 raised to 30', 'Player 3 called 30', 'River dealt: 10♦', 'Player 4 checked', 'Player 3 checked', 'Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠', 'Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦', 'Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 30', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 453, 'promptTokenCount': 1735, 'totalTokenCount': 2188}, 'invocationId': 'e-9b07e062-bc2e-4caa-970e-51c632b44952', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'z5YSz9mk', 'timestamp': 1761904633.648861}, {'content': {'parts': [{'functionResponse': {'id': 'call_WlDV3e81dwLcWwdDVrW9TxmC', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（24.00(ポットに対して40.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-9b07e062-bc2e-4caa-970e-51c632b44952', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Vslxp5Lr', 'timestamp': 1761904644.289776}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2228, 'totalTokenCount': 2266}, 'invocationId': 'e-9b07e062-bc2e-4caa-970e-51c632b44952', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'jWrZEUQv', 'timestamp': 1761904644.291847}]
2025-10-31 18:57:26,439 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:57:26,440 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}
2025-10-31 18:57:26,440 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:57:26,440 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}'
2025-10-31 18:57:26,441 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:57:26,441 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}
2025-10-31 18:57:26,441 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（24.00(ポットに対して40.00%）ため、チェックします'}
2025-10-31 18:57:26,442 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:57:26,442 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:57:26,443 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:57:26,443 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（24.00(ポットに対して40.00%）ため、チェックします
2025-10-31 18:57:26,445 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:57:26,446 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:26,446 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:26,446 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:26,447 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:57:26,447 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:26,447 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:26,447 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:26,448 - poker_game - INFO - Community cards: []
2025-10-31 18:57:26,450 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:26,451 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:26,451 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:26,452 - poker_game - INFO -   P3(Agent3): chips=1881, bet=20, status=active
2025-10-31 18:57:26,452 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:26,452 - poker_game - INFO - ==================================================
2025-10-31 18:57:26,453 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:57:26,475 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:26,475 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:26,476 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:26,476 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:57:26,476 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:26,477 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:26,478 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:26,478 - poker_game - INFO - Community cards: []
2025-10-31 18:57:26,478 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:26,479 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:26,479 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:26,480 - poker_game - INFO -   P3(Agent3): chips=1881, bet=20, status=active
2025-10-31 18:57:26,480 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:26,482 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:57:26,483 - poker_game - INFO - ==================================================
2025-10-31 18:57:26,483 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:26,484 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:26,484 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:26,484 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:57:26,485 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:26,486 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:26,486 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:26,491 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:57:26,492 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:57:26,492 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:57:26,492 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:57:26,492 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:57:26,493 - poker_game - INFO - Betting complete: Back to player 1 after last raiser 4
2025-10-31 18:57:26,493 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:26,493 - poker_game - INFO - Hand #17, Phase: preflop
2025-10-31 18:57:26,493 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:57:26,494 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:57:26,494 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:26,494 - poker_game - INFO - Betting round complete: True
2025-10-31 18:57:26,494 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:26,494 - poker_game - INFO - Community cards: []
2025-10-31 18:57:26,495 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:26,495 - poker_game - INFO -   P1(Agent1): chips=3518, bet=20, status=active
2025-10-31 18:57:26,495 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:26,495 - poker_game - INFO -   P3(Agent3): chips=1881, bet=20, status=active
2025-10-31 18:57:26,495 - poker_game - INFO -   P4(Agent4): chips=4541, bet=20, status=active
2025-10-31 18:57:26,496 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:57:26,496 - poker_game - INFO - ==================================================
2025-10-31 18:57:26,597 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:57:26,597 - poker_game - INFO - Betting round complete: True
2025-10-31 18:57:26,598 - poker_game - INFO - Remaining players: 3
2025-10-31 18:57:26,598 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:57:26,599 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:57:26,599 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:57:26,599 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:57:26,610 - poker_game - INFO - Starting new betting round
2025-10-31 18:57:26,610 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:57:26,611 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:57:26,611 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 18:57:26,611 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:57:26,611 - poker_game - INFO - First actor: Player 3 (by phase rule), was 1
2025-10-31 18:57:26,612 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:57:26,612 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:26,613 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:26,613 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:57:26,614 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:26,616 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:26,617 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:26,618 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:26,618 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:26,619 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:26,619 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:26,620 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:26,620 - poker_game - INFO -   P4(Agent4): chips=4541, bet=0, status=active
2025-10-31 18:57:26,620 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:57:26,621 - poker_game - INFO - ==================================================
2025-10-31 18:57:26,622 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "A♦",
    "9♥"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦"
  ],
  "your_chips": 1881,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3518,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4541,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1881)"
  ],
  "history": [
    "Player 4 raised to 30",
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦"
  ]
}
2025-10-31 18:57:26,633 - poker_game - DEBUG - Create Session: {'id': '2ef55332-e7a4-435d-817e-a569da4c15f9', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904646.6301563}
2025-10-31 18:57:28,916 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（Flop）のボード（Board）はQ♦ J♣ 8♦で、あなたの手札はA♦ 9♥です。これはストレート（Straight）のドロー（Draw）の可能性（A-K-Q-J-10）とフラッシュ（Flush）のドロー（Draw）の可能性（ダイヤ4枚）があります。しかし、現時点では何も完成していません。ポット（Pot）は60で、コール（Call）する必要があるのは0です。相手のベット（Bet）もなく、チェック（Check）して次のカード（コミュニティカードのターン（Turn））を見るのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 169, 'promptTokenCount': 912, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 912}], 'totalTokenCount': 1081}, 'invocationId': 'e-d5e2a0f0-4b7f-4769-9432-489a8fede42b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'GkMeJkai', 'timestamp': 1761904646.646265}]
2025-10-31 18:57:28,916 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:57:28,916 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（Flop）のボード（Board）はQ♦ J♣ 8♦で、あなたの手札はA♦ 9♥です。これはストレート（Straight）のドロー（Draw）の可能性（A-K-Q-J-10）とフラッシュ（Flush）のドロー（Draw）の可能性（ダイヤ4枚）があります。しかし、現時点では何も完成していません。ポット（Pot）は60で、コール（Call）する必要があるのは0です。相手のベット（Bet）もなく、チェック（Check）して次のカード（コミュニティカードのターン（Turn））を見るのが最善です。"
}
```
2025-10-31 18:57:28,916 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（Flop）のボード（Board）はQ♦ J♣ 8♦で、あなたの手札はA♦ 9♥です。これはストレート（Straight）のドロー（Draw）の可能性（A-K-Q-J-10）とフラッシュ（Flush）のドロー（Draw）の可能性（ダイヤ4枚）があります。しかし、現時点では何も完成していません。ポット（Pot）は60で、コール（Call）する必要があるのは0です。相手のベット（Bet）もなく、チェック（Check）して次のカード（コミュニティカードのターン（Turn））を見るのが最善です。"\n}\n```'
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（Flop）のボード（Board）はQ♦ J♣ 8♦で、あなたの手札はA♦ 9♥です。これはストレート（Straight）のドロー（Draw）の可能性（A-K-Q-J-10）とフラッシュ（Flush）のドロー（Draw）の可能性（ダイヤ4枚）があります。しかし、現時点では何も完成していません。ポット（Pot）は60で、コール（Call）する必要があるのは0です。相手のベット（Bet）もなく、チェック（Check）して次のカード（コミュニティカードのターン（Turn））を見るのが最善です。"\n}'
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（Flop）のボード（Board）はQ♦ J♣ 8♦で、あなたの手札はA♦ 9♥です。これはストレート（Straight）のドロー（Draw）の可能性（A-K-Q-J-10）とフラッシュ（Flush）のドロー（Draw）の可能性（ダイヤ4枚）があります。しかし、現時点では何も完成していません。ポット（Pot）は60で、コール（Call）する必要があるのは0です。相手のベット（Bet）もなく、チェック（Check）して次のカード（コミュニティカードのターン（Turn））を見るのが最善です。"
}
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（Flop）のボード（Board）はQ♦ J♣ 8♦で、あなたの手札はA♦ 9♥です。これはストレート（Straight）のドロー（Draw）の可能性（A-K-Q-J-10）とフラッシュ（Flush）のドロー（Draw）の可能性（ダイヤ4枚）があります。しかし、現時点では何も完成していません。ポット（Pot）は60で、コール（Call）する必要があるのは0です。相手のベット（Bet）もなく、チェック（Check）して次のカード（コミュニティカードのターン（Turn））を見るのが最善です。'}
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:57:28,917 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:57:28,918 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, フロップ（Flop）のボード（Board）はQ♦ J♣ 8♦で、あなたの手札はA♦ 9♥です。これはストレート（Straight）のドロー（Draw）の可能性（A-K-Q-J-10）とフラッシュ（Flush）のドロー（Draw）の可能性（ダイヤ4枚）があります。しかし、現時点では何も完成していません。ポット（Pot）は60で、コール（Call）する必要があるのは0です。相手のベット（Bet）もなく、チェック（Check）して次のカード（コミュニティカードのターン（Turn））を見るのが最善です。
2025-10-31 18:57:28,918 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:57:28,918 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:28,919 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:28,919 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:28,919 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:57:28,919 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:28,919 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:28,920 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:28,920 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:28,920 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:28,920 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:28,920 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:28,920 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:28,921 - poker_game - INFO -   P4(Agent4): chips=4541, bet=0, status=active
2025-10-31 18:57:28,921 - poker_game - INFO - ==================================================
2025-10-31 18:57:28,921 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:57:28,936 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:28,936 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:28,937 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:28,937 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:57:28,937 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:28,937 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:28,937 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:28,938 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:28,938 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:28,938 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:28,938 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:28,939 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:28,939 - poker_game - INFO -   P4(Agent4): chips=4541, bet=0, status=active
2025-10-31 18:57:28,939 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:57:28,939 - poker_game - INFO - ==================================================
2025-10-31 18:57:28,940 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:28,940 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:28,940 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:28,940 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:57:28,940 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:28,940 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:28,941 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:28,941 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 18:57:28,941 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:57:28,941 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:57:28,941 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:57:28,941 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:57:28,941 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:57:28,941 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:28,942 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:28,942 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:28,942 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:57:28,942 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:28,942 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:28,943 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:28,944 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:28,945 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:28,947 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:28,952 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:28,952 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:28,953 - poker_game - INFO -   P4(Agent4): chips=4541, bet=0, status=active
2025-10-31 18:57:28,953 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:57:28,953 - poker_game - INFO - ==================================================
2025-10-31 18:57:29,055 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "7♥",
    "Q♠"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦"
  ],
  "your_chips": 4541,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3518,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1881,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4541)"
  ],
  "history": [
    "Player 3 called 30",
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked"
  ]
}
2025-10-31 18:57:29,068 - poker_game - DEBUG - Create Session: {'id': '101bf065-8ff8-4e77-a78d-e90882c01917', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904649.0659022}
2025-10-31 18:57:39,243 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:57:42,715 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_75Cw8bIiYaFYbYFfAjewdcB9', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1233, 'totalTokenCount': 1250}, 'invocationId': 'e-c8520cd8-a750-4aa2-982f-a65d3645d930', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'jgpEJ5lS', 'timestamp': 1761904649.077984}, {'content': {'parts': [{'functionResponse': {'id': 'call_75Cw8bIiYaFYbYFfAjewdcB9', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-c8520cd8-a750-4aa2-982f-a65d3645d930', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'd22G09Jh', 'timestamp': 1761904650.371091}, {'content': {'parts': [{'functionCall': {'id': 'call_NjlqEN7l6tERSqwCse5SRVR0', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['7♥', 'Q♠'], 'community': ['Q♦', 'J♣', '8♦'], 'your_chips': 4541, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3518, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1881, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4541)'], 'history': ['Player 3 called 30', 'River dealt: 10♦', 'Player 4 checked', 'Player 3 checked', 'Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠', 'Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦', 'Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 30', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: Q♦, J♣, 8♦', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.6}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 472, 'promptTokenCount': 1757, 'totalTokenCount': 2229}, 'invocationId': 'e-c8520cd8-a750-4aa2-982f-a65d3645d930', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'oPDp1ZFb', 'timestamp': 1761904650.372597}, {'content': {'parts': [{'functionResponse': {'id': 'call_NjlqEN7l6tERSqwCse5SRVR0', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 30, 'reasoning': '期待値が見込める（36.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 30'}}}], 'role': 'user'}, 'invocationId': 'e-c8520cd8-a750-4aa2-982f-a65d3645d930', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'MKvj5Z8R', 'timestamp': 1761904660.043748}, {'content': {'parts': [{'text': '{"action":"raise","amount":30,"reasoning":"期待値が見込める（36.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2282, 'totalTokenCount': 2338}, 'invocationId': 'e-c8520cd8-a750-4aa2-982f-a65d3645d930', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'RVKBoLTq', 'timestamp': 1761904660.045445}]
2025-10-31 18:57:42,715 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:57:42,716 - poker_game - DEBUG - {"action":"raise","amount":30,"reasoning":"期待値が見込める（36.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}
2025-10-31 18:57:42,716 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:57:42,716 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":30,"reasoning":"期待値が見込める（36.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}'
2025-10-31 18:57:42,716 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:57:42,716 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":30,"reasoning":"期待値が見込める（36.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 30"}
2025-10-31 18:57:42,717 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 30, 'reasoning': '期待値が見込める（36.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 30'}
2025-10-31 18:57:42,717 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 30
2025-10-31 18:57:42,717 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (4541)']
2025-10-31 18:57:42,717 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:57:42,717 - poker_game - DEBUG - [Agent4] Raise amount 30 is valid (min: 20)
2025-10-31 18:57:42,717 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 30}
2025-10-31 18:57:42,717 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 30, 期待値が見込める（36.00(ポットに対して60.00%）ため、1/2ポットでセミブラフします。ベット額: 30
2025-10-31 18:57:42,718 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 30
2025-10-31 18:57:42,718 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:42,718 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:42,718 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:42,719 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:57:42,719 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:42,719 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:42,719 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:42,719 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:42,719 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:42,720 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:42,720 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:42,720 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:42,720 - poker_game - INFO -   P4(Agent4): chips=4541, bet=0, status=active
2025-10-31 18:57:42,720 - poker_game - INFO - ==================================================
2025-10-31 18:57:42,721 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 30
2025-10-31 18:57:42,734 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:42,734 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:42,735 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:42,735 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:57:42,735 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:42,735 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:42,736 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:42,736 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:42,736 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:42,736 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:42,737 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:42,737 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:42,737 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:42,737 - poker_game - INFO - Extra: Action: Player 4 raised to 30
2025-10-31 18:57:42,737 - poker_game - INFO - ==================================================
2025-10-31 18:57:42,738 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:42,738 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:42,738 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:42,738 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:57:42,738 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:42,738 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:42,738 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:42,738 - poker_game - DEBUG - Player bets: [0, 0, 30], Current bet: 30, All same: False
2025-10-31 18:57:42,738 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:57:42,739 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:42,739 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:42,739 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:57:42,739 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:57:42,739 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:42,739 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:42,740 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:42,740 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:42,740 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:42,740 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:42,741 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:42,741 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:42,741 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:42,741 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:57:42,741 - poker_game - INFO - ==================================================
2025-10-31 18:57:42,845 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "8♥",
    "9♦"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦"
  ],
  "your_chips": 3518,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 90,
  "to_call": 30,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1881,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4511,
      "bet": 30,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (30)",
    "raise (min 50)",
    "all-in (3518)"
  ],
  "history": [
    "River dealt: 10♦",
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30"
  ]
}
2025-10-31 18:57:42,856 - poker_game - DEBUG - Create Session: {'id': 'eea2319c-01a6-4f88-875a-28fd899a805a', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904662.8527658}
2025-10-31 18:57:44,595 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップでは、あなたの手札は8♥ 9♦で、コミュニティカードはQ♦ J♣ 8♦です。これは、あなたがペア（8のペア）を持っていることを意味します。また、ストレート（J-Q-K-A）やフラッシュ（ダイヤのフォーカード）の可能性もあります。プレイヤー4が30にレイズしましたが、ポットには90あり、コールに必要なのは30だけです。これは有利なオッズ（コールに30、ポットに90）であり、あなたのハンドは改善の可能性があります。したがって、コールして様子を見るのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 160, 'promptTokenCount': 914, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 914}], 'totalTokenCount': 1074}, 'invocationId': 'e-41131f5d-2d83-435e-93ba-23c2786930ac', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ER4iIH3J', 'timestamp': 1761904662.867519}]
2025-10-31 18:57:44,596 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:57:44,596 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 30,
  "reasoning": "フロップでは、あなたの手札は8♥ 9♦で、コミュニティカードはQ♦ J♣ 8♦です。これは、あなたがペア（8のペア）を持っていることを意味します。また、ストレート（J-Q-K-A）やフラッシュ（ダイヤのフォーカード）の可能性もあります。プレイヤー4が30にレイズしましたが、ポットには90あり、コールに必要なのは30だけです。これは有利なオッズ（コールに30、ポットに90）であり、あなたのハンドは改善の可能性があります。したがって、コールして様子を見るのが最善です。"
}
```
2025-10-31 18:57:44,596 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:57:44,597 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップでは、あなたの手札は8♥ 9♦で、コミュニティカードはQ♦ J♣ 8♦です。これは、あなたがペア（8のペア）を持っていることを意味します。また、ストレート（J-Q-K-A）やフラッシュ（ダイヤのフォーカード）の可能性もあります。プレイヤー4が30にレイズしましたが、ポットには90あり、コールに必要なのは30だけです。これは有利なオッズ（コールに30、ポットに90）であり、あなたのハンドは改善の可能性があります。したがって、コールして様子を見るのが最善です。"\n}\n```'
2025-10-31 18:57:44,597 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:57:44,597 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップでは、あなたの手札は8♥ 9♦で、コミュニティカードはQ♦ J♣ 8♦です。これは、あなたがペア（8のペア）を持っていることを意味します。また、ストレート（J-Q-K-A）やフラッシュ（ダイヤのフォーカード）の可能性もあります。プレイヤー4が30にレイズしましたが、ポットには90あり、コールに必要なのは30だけです。これは有利なオッズ（コールに30、ポットに90）であり、あなたのハンドは改善の可能性があります。したがって、コールして様子を見るのが最善です。"\n}'
2025-10-31 18:57:44,597 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 30,
  "reasoning": "フロップでは、あなたの手札は8♥ 9♦で、コミュニティカードはQ♦ J♣ 8♦です。これは、あなたがペア（8のペア）を持っていることを意味します。また、ストレート（J-Q-K-A）やフラッシュ（ダイヤのフォーカード）の可能性もあります。プレイヤー4が30にレイズしましたが、ポットには90あり、コールに必要なのは30だけです。これは有利なオッズ（コールに30、ポットに90）であり、あなたのハンドは改善の可能性があります。したがって、コールして様子を見るのが最善です。"
}
2025-10-31 18:57:44,598 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 30, 'reasoning': 'フロップでは、あなたの手札は8♥ 9♦で、コミュニティカードはQ♦ J♣ 8♦です。これは、あなたがペア（8のペア）を持っていることを意味します。また、ストレート（J-Q-K-A）やフラッシュ（ダイヤのフォーカード）の可能性もあります。プレイヤー4が30にレイズしましたが、ポットには90あり、コールに必要なのは30だけです。これは有利なオッズ（コールに30、ポットに90）であり、あなたのハンドは改善の可能性があります。したがって、コールして様子を見るのが最善です。'}
2025-10-31 18:57:44,598 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 30
2025-10-31 18:57:44,598 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (30)', 'raise (min 50)', 'all-in (3518)']
2025-10-31 18:57:44,598 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (30)': 30
2025-10-31 18:57:44,599 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 30}
2025-10-31 18:57:44,599 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 30, フロップでは、あなたの手札は8♥ 9♦で、コミュニティカードはQ♦ J♣ 8♦です。これは、あなたがペア（8のペア）を持っていることを意味します。また、ストレート（J-Q-K-A）やフラッシュ（ダイヤのフォーカード）の可能性もあります。プレイヤー4が30にレイズしましたが、ポットには90あり、コールに必要なのは30だけです。これは有利なオッズ（コールに30、ポットに90）であり、あなたのハンドは改善の可能性があります。したがって、コールして様子を見るのが最善です。
2025-10-31 18:57:44,600 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 30
2025-10-31 18:57:44,601 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:44,601 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:44,603 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:57:44,604 - poker_game - INFO - Pot: 90, Current bet: 30
2025-10-31 18:57:44,605 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:44,606 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:44,607 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:44,607 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:44,607 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:44,608 - poker_game - INFO -   P1(Agent1): chips=3518, bet=0, status=active
2025-10-31 18:57:44,609 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:44,610 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:44,610 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:44,610 - poker_game - INFO - ==================================================
2025-10-31 18:57:44,611 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 30
2025-10-31 18:57:44,624 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:44,624 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:44,625 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:57:44,625 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:57:44,626 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:44,626 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:44,627 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:44,627 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:44,628 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:44,628 - poker_game - INFO -   P1(Agent1): chips=3488, bet=30, status=active
2025-10-31 18:57:44,628 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:44,629 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:44,629 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:44,630 - poker_game - INFO - Extra: Action: Player 1 called 30
2025-10-31 18:57:44,630 - poker_game - INFO - ==================================================
2025-10-31 18:57:44,630 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:44,631 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:44,631 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:44,631 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:57:44,631 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:44,632 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:44,632 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:44,632 - poker_game - DEBUG - Player bets: [30, 0, 30], Current bet: 30, All same: False
2025-10-31 18:57:44,633 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:57:44,633 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:44,633 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:44,634 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:44,634 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:57:44,635 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:44,636 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:44,636 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:44,637 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:44,637 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:44,637 - poker_game - INFO -   P1(Agent1): chips=3488, bet=30, status=active
2025-10-31 18:57:44,638 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:44,639 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:44,640 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:44,642 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:57:44,643 - poker_game - INFO - ==================================================
2025-10-31 18:57:44,745 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "A♦",
    "9♥"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦"
  ],
  "your_chips": 1881,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 120,
  "to_call": 30,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3488,
      "bet": 30,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4511,
      "bet": 30,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (30)",
    "raise (min 50)",
    "all-in (1881)"
  ],
  "history": [
    "Player 4 checked",
    "Player 3 checked",
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30"
  ]
}
2025-10-31 18:57:44,757 - poker_game - DEBUG - Create Session: {'id': '14f5f33a-13e6-43e5-b6d1-7fe2877bbd3e', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904664.7540872}
2025-10-31 18:57:46,879 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札はA♦ 9♥、コミュニティカードはQ♦ J♣ 8♦です。あなたの手札はストレート（A-Q-J-10-8）またはフラッシュ（ダイヤ3枚）の可能性を秘めています。現在、ポットには120チップがあり、コールするには30チップが必要です。対戦相手は2人いますが、過去の履歴を見ると、過去のハンドではあなたとPlayer 4がショーダウンまで進み、最終的にあなたが勝利しています。このハンドでは、Player 4がレイズし、Player 1がコールしています。あなたの手札はまだ完成していませんが、ポットオッズ（コールに必要なチップ数に対するポットの大きさ）は良好であり、ストレートやフラッシュのドロー（完成すれば強い役になる可能性）があるので、コールして次のカード（ターン）を見るのが合理的です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 229, 'promptTokenCount': 916, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 916}], 'totalTokenCount': 1145}, 'invocationId': 'e-4b6a7fc2-2c9e-464e-8422-6c7d592e786a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '7d4JEIoX', 'timestamp': 1761904664.769931}]
2025-10-31 18:57:46,879 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:57:46,880 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 30,
  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札はA♦ 9♥、コミュニティカードはQ♦ J♣ 8♦です。あなたの手札はストレート（A-Q-J-10-8）またはフラッシュ（ダイヤ3枚）の可能性を秘めています。現在、ポットには120チップがあり、コールするには30チップが必要です。対戦相手は2人いますが、過去の履歴を見ると、過去のハンドではあなたとPlayer 4がショーダウンまで進み、最終的にあなたが勝利しています。このハンドでは、Player 4がレイズし、Player 1がコールしています。あなたの手札はまだ完成していませんが、ポットオッズ（コールに必要なチップ数に対するポットの大きさ）は良好であり、ストレートやフラッシュのドロー（完成すれば強い役になる可能性）があるので、コールして次のカード（ターン）を見るのが合理的です。"
}
```
2025-10-31 18:57:46,880 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:57:46,881 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札はA♦ 9♥、コミュニティカードはQ♦ J♣ 8♦です。あなたの手札はストレート（A-Q-J-10-8）またはフラッシュ（ダイヤ3枚）の可能性を秘めています。現在、ポットには120チップがあり、コールするには30チップが必要です。対戦相手は2人いますが、過去の履歴を見ると、過去のハンドではあなたとPlayer 4がショーダウンまで進み、最終的にあなたが勝利しています。このハンドでは、Player 4がレイズし、Player 1がコールしています。あなたの手札はまだ完成していませんが、ポットオッズ（コールに必要なチップ数に対するポットの大きさ）は良好であり、ストレートやフラッシュのドロー（完成すれば強い役になる可能性）があるので、コールして次のカード（ターン）を見るのが合理的です。"\n}\n```'
2025-10-31 18:57:46,881 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:57:46,881 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 30,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札はA♦ 9♥、コミュニティカードはQ♦ J♣ 8♦です。あなたの手札はストレート（A-Q-J-10-8）またはフラッシュ（ダイヤ3枚）の可能性を秘めています。現在、ポットには120チップがあり、コールするには30チップが必要です。対戦相手は2人いますが、過去の履歴を見ると、過去のハンドではあなたとPlayer 4がショーダウンまで進み、最終的にあなたが勝利しています。このハンドでは、Player 4がレイズし、Player 1がコールしています。あなたの手札はまだ完成していませんが、ポットオッズ（コールに必要なチップ数に対するポットの大きさ）は良好であり、ストレートやフラッシュのドロー（完成すれば強い役になる可能性）があるので、コールして次のカード（ターン）を見るのが合理的です。"\n}'
2025-10-31 18:57:46,881 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 30,
  "reasoning": "フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札はA♦ 9♥、コミュニティカードはQ♦ J♣ 8♦です。あなたの手札はストレート（A-Q-J-10-8）またはフラッシュ（ダイヤ3枚）の可能性を秘めています。現在、ポットには120チップがあり、コールするには30チップが必要です。対戦相手は2人いますが、過去の履歴を見ると、過去のハンドではあなたとPlayer 4がショーダウンまで進み、最終的にあなたが勝利しています。このハンドでは、Player 4がレイズし、Player 1がコールしています。あなたの手札はまだ完成していませんが、ポットオッズ（コールに必要なチップ数に対するポットの大きさ）は良好であり、ストレートやフラッシュのドロー（完成すれば強い役になる可能性）があるので、コールして次のカード（ターン）を見るのが合理的です。"
}
2025-10-31 18:57:46,881 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 30, 'reasoning': 'フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札はA♦ 9♥、コミュニティカードはQ♦ J♣ 8♦です。あなたの手札はストレート（A-Q-J-10-8）またはフラッシュ（ダイヤ3枚）の可能性を秘めています。現在、ポットには120チップがあり、コールするには30チップが必要です。対戦相手は2人いますが、過去の履歴を見ると、過去のハンドではあなたとPlayer 4がショーダウンまで進み、最終的にあなたが勝利しています。このハンドでは、Player 4がレイズし、Player 1がコールしています。あなたの手札はまだ完成していませんが、ポットオッズ（コールに必要なチップ数に対するポットの大きさ）は良好であり、ストレートやフラッシュのドロー（完成すれば強い役になる可能性）があるので、コールして次のカード（ターン）を見るのが合理的です。'}
2025-10-31 18:57:46,882 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 30
2025-10-31 18:57:46,882 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (30)', 'raise (min 50)', 'all-in (1881)']
2025-10-31 18:57:46,882 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (30)': 30
2025-10-31 18:57:46,882 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 30}
2025-10-31 18:57:46,883 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 30, フロップ（コミュニティカードが開かれた後）の段階で、あなたの手札はA♦ 9♥、コミュニティカードはQ♦ J♣ 8♦です。あなたの手札はストレート（A-Q-J-10-8）またはフラッシュ（ダイヤ3枚）の可能性を秘めています。現在、ポットには120チップがあり、コールするには30チップが必要です。対戦相手は2人いますが、過去の履歴を見ると、過去のハンドではあなたとPlayer 4がショーダウンまで進み、最終的にあなたが勝利しています。このハンドでは、Player 4がレイズし、Player 1がコールしています。あなたの手札はまだ完成していませんが、ポットオッズ（コールに必要なチップ数に対するポットの大きさ）は良好であり、ストレートやフラッシュのドロー（完成すれば強い役になる可能性）があるので、コールして次のカード（ターン）を見るのが合理的です。
2025-10-31 18:57:46,884 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 30
2025-10-31 18:57:46,885 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:46,885 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:46,886 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:46,886 - poker_game - INFO - Pot: 120, Current bet: 30
2025-10-31 18:57:46,886 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:46,887 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:46,887 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:46,888 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:46,888 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:46,889 - poker_game - INFO -   P1(Agent1): chips=3488, bet=30, status=active
2025-10-31 18:57:46,889 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:46,890 - poker_game - INFO -   P3(Agent3): chips=1881, bet=0, status=active
2025-10-31 18:57:46,890 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:46,891 - poker_game - INFO - ==================================================
2025-10-31 18:57:46,892 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 30
2025-10-31 18:57:46,907 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:46,908 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:46,908 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:46,908 - poker_game - INFO - Pot: 150, Current bet: 30
2025-10-31 18:57:46,909 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:46,909 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:46,909 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:46,910 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:46,910 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:46,910 - poker_game - INFO -   P1(Agent1): chips=3488, bet=30, status=active
2025-10-31 18:57:46,911 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:46,911 - poker_game - INFO -   P3(Agent3): chips=1851, bet=30, status=active
2025-10-31 18:57:46,912 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:46,912 - poker_game - INFO - Extra: Action: Player 3 called 30
2025-10-31 18:57:46,912 - poker_game - INFO - ==================================================
2025-10-31 18:57:46,913 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:46,913 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:46,914 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:46,914 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:57:46,914 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:46,914 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:46,915 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:46,916 - poker_game - DEBUG - Player bets: [30, 30, 30], Current bet: 30, All same: True
2025-10-31 18:57:46,917 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:57:46,917 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:46,918 - poker_game - INFO - Hand #17, Phase: flop
2025-10-31 18:57:46,919 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:46,920 - poker_game - INFO - Pot: 150, Current bet: 30
2025-10-31 18:57:46,920 - poker_game - INFO - Last raiser: 4
2025-10-31 18:57:46,921 - poker_game - INFO - Betting round complete: True
2025-10-31 18:57:46,922 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:46,922 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦']
2025-10-31 18:57:46,923 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:46,924 - poker_game - INFO -   P1(Agent1): chips=3488, bet=30, status=active
2025-10-31 18:57:46,925 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:46,925 - poker_game - INFO -   P3(Agent3): chips=1851, bet=30, status=active
2025-10-31 18:57:46,926 - poker_game - INFO -   P4(Agent4): chips=4511, bet=30, status=active
2025-10-31 18:57:46,926 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:57:46,927 - poker_game - INFO - ==================================================
2025-10-31 18:57:47,031 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:57:47,032 - poker_game - INFO - Betting round complete: True
2025-10-31 18:57:47,032 - poker_game - INFO - Remaining players: 3
2025-10-31 18:57:47,033 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:57:47,033 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:57:47,033 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:57:47,034 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:57:47,056 - poker_game - INFO - Starting new betting round
2025-10-31 18:57:47,057 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:57:47,057 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:57:47,057 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 18:57:47,058 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:57:47,058 - poker_game - INFO - First actor: Player 3 (by phase rule), was 4
2025-10-31 18:57:47,058 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:57:47,059 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:57:47,059 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:47,060 - poker_game - INFO - Pot: 150, Current bet: 0
2025-10-31 18:57:47,060 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:47,060 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:47,061 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:47,061 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:57:47,061 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:47,063 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:57:47,064 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:47,064 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:57:47,064 - poker_game - INFO -   P4(Agent4): chips=4511, bet=0, status=active
2025-10-31 18:57:47,066 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:57:47,068 - poker_game - INFO - ==================================================
2025-10-31 18:57:47,070 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "A♦",
    "9♥"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦"
  ],
  "your_chips": 1851,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 150,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3488,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4511,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1851)"
  ],
  "history": [
    "Showdown: Player 3 hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦ cards=Q♠, K♠",
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦"
  ]
}
2025-10-31 18:57:47,188 - poker_game - DEBUG - Create Session: {'id': '6f156761-2844-466f-831f-0be500b2cd15', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904667.1850312}
2025-10-31 18:57:49,155 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況では、フロップでフラッシュドロー（同じスートが4枚揃っている状態）があり、ターンでフラッシュが完成しました。A♦を持っているため、エースハイフラッシュ（A♦ Q♦ 8♦ 4♦ + 任意のスートのカード）が完成しており、これは非常に強いハンドです。相手のアクションはまだ不明ですが、この強いハンドでポットを大きくするチャンスです。ポットサイズと自分のチップ量、そして相手のチップ量も考慮して、コールを選択します。to_callが0なので、チェックと同じ扱いです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 152, 'promptTokenCount': 921, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 921}], 'totalTokenCount': 1073}, 'invocationId': 'e-5ce495f0-7036-4e67-bfb3-64a8652fc221', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'yMaAwnza', 'timestamp': 1761904667.218606}]
2025-10-31 18:57:49,155 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:57:49,155 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "現在の状況では、フロップでフラッシュドロー（同じスートが4枚揃っている状態）があり、ターンでフラッシュが完成しました。A♦を持っているため、エースハイフラッシュ（A♦ Q♦ 8♦ 4♦ + 任意のスートのカード）が完成しており、これは非常に強いハンドです。相手のアクションはまだ不明ですが、この強いハンドでポットを大きくするチャンスです。ポットサイズと自分のチップ量、そして相手のチップ量も考慮して、コールを選択します。to_callが0なので、チェックと同じ扱いです。"
}
```
2025-10-31 18:57:49,156 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:57:49,156 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況では、フロップでフラッシュドロー（同じスートが4枚揃っている状態）があり、ターンでフラッシュが完成しました。A♦を持っているため、エースハイフラッシュ（A♦ Q♦ 8♦ 4♦ + 任意のスートのカード）が完成しており、これは非常に強いハンドです。相手のアクションはまだ不明ですが、この強いハンドでポットを大きくするチャンスです。ポットサイズと自分のチップ量、そして相手のチップ量も考慮して、コールを選択します。to_callが0なので、チェックと同じ扱いです。"\n}\n```'
2025-10-31 18:57:49,156 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:57:49,156 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況では、フロップでフラッシュドロー（同じスートが4枚揃っている状態）があり、ターンでフラッシュが完成しました。A♦を持っているため、エースハイフラッシュ（A♦ Q♦ 8♦ 4♦ + 任意のスートのカード）が完成しており、これは非常に強いハンドです。相手のアクションはまだ不明ですが、この強いハンドでポットを大きくするチャンスです。ポットサイズと自分のチップ量、そして相手のチップ量も考慮して、コールを選択します。to_callが0なので、チェックと同じ扱いです。"\n}'
2025-10-31 18:57:49,156 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "現在の状況では、フロップでフラッシュドロー（同じスートが4枚揃っている状態）があり、ターンでフラッシュが完成しました。A♦を持っているため、エースハイフラッシュ（A♦ Q♦ 8♦ 4♦ + 任意のスートのカード）が完成しており、これは非常に強いハンドです。相手のアクションはまだ不明ですが、この強いハンドでポットを大きくするチャンスです。ポットサイズと自分のチップ量、そして相手のチップ量も考慮して、コールを選択します。to_callが0なので、チェックと同じ扱いです。"
}
2025-10-31 18:57:49,156 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': '現在の状況では、フロップでフラッシュドロー（同じスートが4枚揃っている状態）があり、ターンでフラッシュが完成しました。A♦を持っているため、エースハイフラッシュ（A♦ Q♦ 8♦ 4♦ + 任意のスートのカード）が完成しており、これは非常に強いハンドです。相手のアクションはまだ不明ですが、この強いハンドでポットを大きくするチャンスです。ポットサイズと自分のチップ量、そして相手のチップ量も考慮して、コールを選択します。to_callが0なので、チェックと同じ扱いです。'}
2025-10-31 18:57:49,156 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 0
2025-10-31 18:57:49,157 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1851)']
2025-10-31 18:57:49,157 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:57:49,157 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 0, 現在の状況では、フロップでフラッシュドロー（同じスートが4枚揃っている状態）があり、ターンでフラッシュが完成しました。A♦を持っているため、エースハイフラッシュ（A♦ Q♦ 8♦ 4♦ + 任意のスートのカード）が完成しており、これは非常に強いハンドです。相手のアクションはまだ不明ですが、この強いハンドでポットを大きくするチャンスです。ポットサイズと自分のチップ量、そして相手のチップ量も考慮して、コールを選択します。to_callが0なので、チェックと同じ扱いです。
2025-10-31 18:57:49,158 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 0
2025-10-31 18:57:49,158 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:57:49,158 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:57:49,158 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:49,159 - poker_game - INFO - Pot: 150, Current bet: 0
2025-10-31 18:57:49,159 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:49,159 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:49,159 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:49,159 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:57:49,160 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:49,160 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:57:49,160 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:49,160 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:57:49,160 - poker_game - INFO -   P4(Agent4): chips=4511, bet=0, status=active
2025-10-31 18:57:49,161 - poker_game - INFO - ==================================================
2025-10-31 18:57:49,161 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:57:49,170 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:57:49,170 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:57:49,171 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:57:49,171 - poker_game - INFO - Pot: 150, Current bet: 0
2025-10-31 18:57:49,171 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:49,171 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:49,172 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:49,172 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:57:49,172 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:49,173 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:57:49,173 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:49,173 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:57:49,173 - poker_game - INFO -   P4(Agent4): chips=4511, bet=0, status=active
2025-10-31 18:57:49,174 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:57:49,174 - poker_game - INFO - ==================================================
2025-10-31 18:57:49,174 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:57:49,174 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:57:49,175 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:57:49,175 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:57:49,175 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:57:49,176 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:57:49,176 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:57:49,176 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 18:57:49,176 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:57:49,177 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:57:49,177 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:57:49,177 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:57:49,177 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:57:49,177 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:57:49,178 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:57:49,178 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:57:49,178 - poker_game - INFO - Pot: 150, Current bet: 0
2025-10-31 18:57:49,179 - poker_game - INFO - Last raiser: None
2025-10-31 18:57:49,179 - poker_game - INFO - Betting round complete: False
2025-10-31 18:57:49,180 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:57:49,180 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:57:49,181 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:57:49,183 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:57:49,184 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:57:49,186 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:57:49,186 - poker_game - INFO -   P4(Agent4): chips=4511, bet=0, status=active
2025-10-31 18:57:49,186 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:57:49,187 - poker_game - INFO - ==================================================
2025-10-31 18:57:49,289 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "7♥",
    "Q♠"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦"
  ],
  "your_chips": 4511,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 150,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3488,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1851,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4511)"
  ],
  "history": [
    "Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦",
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked"
  ]
}
2025-10-31 18:57:49,304 - poker_game - DEBUG - Create Session: {'id': '4808fbd2-b58a-423d-9711-29d07229bee4', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904669.30138}
2025-10-31 18:57:59,429 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:58:01,748 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_PfhD6RuQ6FUUvoNOwycw8714', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1206, 'totalTokenCount': 1223}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'fRoh69mr', 'timestamp': 1761904669.315409}, {'content': {'parts': [{'functionResponse': {'id': 'call_PfhD6RuQ6FUUvoNOwycw8714', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'D9FWUSPd', 'timestamp': 1761904670.077873}, {'content': {'parts': [{'functionCall': {'id': 'call_Ci5oirGeCxMGxmAJGvFHqNek', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1730, 'totalTokenCount': 1750}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'bUCnSUDp', 'timestamp': 1761904670.079339}, {'content': {'parts': [{'functionResponse': {'id': 'call_Ci5oirGeCxMGxmAJGvFHqNek', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'HGxHtocr', 'timestamp': 1761904671.159767}, {'content': {'parts': [{'functionCall': {'id': 'call_SXzfh9yzp7XdNdxetfX2vO79', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1292, 'totalTokenCount': 1309}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IAHhise8', 'timestamp': 1761904671.161495}, {'content': {'parts': [{'functionResponse': {'id': 'call_SXzfh9yzp7XdNdxetfX2vO79', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'vyorPrHs', 'timestamp': 1761904671.883575}, {'content': {'parts': [{'functionCall': {'id': 'call_Csxn6vyOSxDXKt2NyCcuibIG', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['7♥', 'Q♠'], 'community': ['Q♦', 'J♣', '8♦', '4♦'], 'your_chips': 4511, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 50, 'pot': 150, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3488, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1851, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4511)'], 'history': ['Showdown: Player 4 hand=Two Pair: Js and 6s - A♦, J♦, J♣, 6♣, 6♠ cards=J♦, 9♦', 'Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 30', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: Q♦, J♣, 8♦', 'Player 3 checked', 'Player 4 raised to 30', 'Player 1 called 30', 'Player 3 called 30', 'Turn dealt: 4♦', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 150, 'equity': 0.7}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 427, 'promptTokenCount': 1822, 'totalTokenCount': 2249}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'y5gYL4Vv', 'timestamp': 1761904671.88534}, {'content': {'parts': [{'functionResponse': {'id': 'call_Csxn6vyOSxDXKt2NyCcuibIG', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 99, 'reasoning': '期待値が高い（105.00(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 99'}}}], 'role': 'user'}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'uCXJGuIl', 'timestamp': 1761904685.189643}, {'content': {'parts': [{'text': '{"action":"raise","amount":99,"reasoning":"期待値が高い（105.00(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 99"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 52, 'promptTokenCount': 2314, 'totalTokenCount': 2366}, 'invocationId': 'e-aaedd8a1-efe3-4773-afbd-8c0d8736d9b6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ADWCHlx2', 'timestamp': 1761904685.191631}]
2025-10-31 18:58:01,749 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:58:01,749 - poker_game - DEBUG - {"action":"raise","amount":99,"reasoning":"期待値が高い（105.00(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 99"}
2025-10-31 18:58:01,749 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:58:01,749 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":99,"reasoning":"期待値が高い（105.00(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 99"}'
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":99,"reasoning":"期待値が高い（105.00(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 99"}
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 99, 'reasoning': '期待値が高い（105.00(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 99'}
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 99
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (4511)']
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] Raise amount 99 is valid (min: 20)
2025-10-31 18:58:01,750 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 99}
2025-10-31 18:58:01,750 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 99, 期待値が高い（105.00(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 99
2025-10-31 18:58:01,751 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 99
2025-10-31 18:58:01,751 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:01,751 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:01,751 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:01,751 - poker_game - INFO - Pot: 150, Current bet: 0
2025-10-31 18:58:01,752 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:01,752 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:01,752 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:01,752 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:01,752 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:01,752 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:58:01,753 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:01,753 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:58:01,753 - poker_game - INFO -   P4(Agent4): chips=4511, bet=0, status=active
2025-10-31 18:58:01,753 - poker_game - INFO - ==================================================
2025-10-31 18:58:01,753 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 99
2025-10-31 18:58:01,768 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:01,769 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:01,769 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:01,769 - poker_game - INFO - Pot: 249, Current bet: 99
2025-10-31 18:58:01,769 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:01,769 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:01,770 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:01,770 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:01,770 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:01,770 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:58:01,770 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:01,770 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:58:01,770 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:01,771 - poker_game - INFO - Extra: Action: Player 4 raised to 99
2025-10-31 18:58:01,771 - poker_game - INFO - ==================================================
2025-10-31 18:58:01,771 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:01,771 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:01,771 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:58:01,772 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:58:01,772 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:01,772 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:01,772 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:58:01,772 - poker_game - DEBUG - Player bets: [0, 0, 99], Current bet: 99, All same: False
2025-10-31 18:58:01,772 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:58:01,772 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:01,773 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:01,773 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:58:01,773 - poker_game - INFO - Pot: 249, Current bet: 99
2025-10-31 18:58:01,773 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:01,773 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:01,773 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:01,773 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:01,774 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:01,774 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:58:01,774 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:01,774 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:58:01,775 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:01,775 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:01,775 - poker_game - INFO - ==================================================
2025-10-31 18:58:01,876 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "8♥",
    "9♦"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦"
  ],
  "your_chips": 3488,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 249,
  "to_call": 99,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1851,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4412,
      "bet": 99,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (99)",
    "raise (min 119)",
    "all-in (3488)"
  ],
  "history": [
    "Side pot layer 0: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99"
  ]
}
2025-10-31 18:58:01,886 - poker_game - DEBUG - Create Session: {'id': '719f5bb2-597a-4a7d-8f78-79171702941e', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904681.8828099}
2025-10-31 18:58:03,803 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 99,\n  "reasoning": "私の手札は8♥9♦で、コミュニティカードはQ♦J♣8♦4♦です。これにより、私は8のペア（ツーペア）とフラッシュドロー（ダイヤ4枚）を持っています。相手は99をベットしており、コールするには99が必要です。ポットには249があり、コールすることでポットの約1/3を賭けることになります。フラッシュ（同じ絵柄が5枚揃うこと）の可能性があり、勝てる可能性もあるため、コールを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 141, 'promptTokenCount': 861, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 861}], 'totalTokenCount': 1002}, 'invocationId': 'e-115d18a9-38ee-4f5e-841a-838959b5ff5c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'DPl9kgBh', 'timestamp': 1761904681.905885}]
2025-10-31 18:58:03,803 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:58:03,803 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 99,
  "reasoning": "私の手札は8♥9♦で、コミュニティカードはQ♦J♣8♦4♦です。これにより、私は8のペア（ツーペア）とフラッシュドロー（ダイヤ4枚）を持っています。相手は99をベットしており、コールするには99が必要です。ポットには249があり、コールすることでポットの約1/3を賭けることになります。フラッシュ（同じ絵柄が5枚揃うこと）の可能性があり、勝てる可能性もあるため、コールを選択します。"
}
```
2025-10-31 18:58:03,804 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:58:03,804 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 99,\n  "reasoning": "私の手札は8♥9♦で、コミュニティカードはQ♦J♣8♦4♦です。これにより、私は8のペア（ツーペア）とフラッシュドロー（ダイヤ4枚）を持っています。相手は99をベットしており、コールするには99が必要です。ポットには249があり、コールすることでポットの約1/3を賭けることになります。フラッシュ（同じ絵柄が5枚揃うこと）の可能性があり、勝てる可能性もあるため、コールを選択します。"\n}\n```'
2025-10-31 18:58:03,804 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:58:03,804 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 99,\n  "reasoning": "私の手札は8♥9♦で、コミュニティカードはQ♦J♣8♦4♦です。これにより、私は8のペア（ツーペア）とフラッシュドロー（ダイヤ4枚）を持っています。相手は99をベットしており、コールするには99が必要です。ポットには249があり、コールすることでポットの約1/3を賭けることになります。フラッシュ（同じ絵柄が5枚揃うこと）の可能性があり、勝てる可能性もあるため、コールを選択します。"\n}'
2025-10-31 18:58:03,804 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 99,
  "reasoning": "私の手札は8♥9♦で、コミュニティカードはQ♦J♣8♦4♦です。これにより、私は8のペア（ツーペア）とフラッシュドロー（ダイヤ4枚）を持っています。相手は99をベットしており、コールするには99が必要です。ポットには249があり、コールすることでポットの約1/3を賭けることになります。フラッシュ（同じ絵柄が5枚揃うこと）の可能性があり、勝てる可能性もあるため、コールを選択します。"
}
2025-10-31 18:58:03,804 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 99, 'reasoning': '私の手札は8♥9♦で、コミュニティカードはQ♦J♣8♦4♦です。これにより、私は8のペア（ツーペア）とフラッシュドロー（ダイヤ4枚）を持っています。相手は99をベットしており、コールするには99が必要です。ポットには249があり、コールすることでポットの約1/3を賭けることになります。フラッシュ（同じ絵柄が5枚揃うこと）の可能性があり、勝てる可能性もあるため、コールを選択します。'}
2025-10-31 18:58:03,804 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 99
2025-10-31 18:58:03,805 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (99)', 'raise (min 119)', 'all-in (3488)']
2025-10-31 18:58:03,805 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (99)': 99
2025-10-31 18:58:03,805 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 99}
2025-10-31 18:58:03,805 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 99, 私の手札は8♥9♦で、コミュニティカードはQ♦J♣8♦4♦です。これにより、私は8のペア（ツーペア）とフラッシュドロー（ダイヤ4枚）を持っています。相手は99をベットしており、コールするには99が必要です。ポットには249があり、コールすることでポットの約1/3を賭けることになります。フラッシュ（同じ絵柄が5枚揃うこと）の可能性があり、勝てる可能性もあるため、コールを選択します。
2025-10-31 18:58:03,806 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 99
2025-10-31 18:58:03,806 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:03,806 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:03,806 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:58:03,806 - poker_game - INFO - Pot: 249, Current bet: 99
2025-10-31 18:58:03,807 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:03,807 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:03,807 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:03,807 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:03,807 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:03,807 - poker_game - INFO -   P1(Agent1): chips=3488, bet=0, status=active
2025-10-31 18:58:03,809 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:03,810 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:58:03,810 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:03,810 - poker_game - INFO - ==================================================
2025-10-31 18:58:03,810 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 99
2025-10-31 18:58:03,818 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:03,818 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:03,818 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:58:03,819 - poker_game - INFO - Pot: 348, Current bet: 99
2025-10-31 18:58:03,819 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:03,819 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:03,820 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:03,820 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:03,820 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:03,820 - poker_game - INFO -   P1(Agent1): chips=3389, bet=99, status=active
2025-10-31 18:58:03,821 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:03,821 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:58:03,821 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:03,821 - poker_game - INFO - Extra: Action: Player 1 called 99
2025-10-31 18:58:03,822 - poker_game - INFO - ==================================================
2025-10-31 18:58:03,822 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:03,822 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:03,823 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:58:03,823 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:58:03,823 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:03,823 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:03,824 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:58:03,824 - poker_game - DEBUG - Player bets: [99, 0, 99], Current bet: 99, All same: False
2025-10-31 18:58:03,824 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:58:03,824 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:03,825 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:03,825 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:03,825 - poker_game - INFO - Pot: 348, Current bet: 99
2025-10-31 18:58:03,825 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:03,825 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:03,826 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:03,826 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:03,826 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:03,826 - poker_game - INFO -   P1(Agent1): chips=3389, bet=99, status=active
2025-10-31 18:58:03,827 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:03,827 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:58:03,827 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:03,827 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:03,827 - poker_game - INFO - ==================================================
2025-10-31 18:58:03,931 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "A♦",
    "9♥"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦"
  ],
  "your_chips": 1851,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 50,
  "pot": 348,
  "to_call": 99,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3389,
      "bet": 99,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4412,
      "bet": 99,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (99)",
    "raise (min 119)",
    "all-in (1851)"
  ],
  "history": [
    "Side pot layer 1: amount=60, winners=3 best_hand=Straight: A-high - A♦, K♠, Q♠, J♣, 10♦",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99"
  ]
}
2025-10-31 18:58:03,953 - poker_game - DEBUG - Create Session: {'id': '28268ee6-5231-4476-87a3-ca7792266bde', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904683.947408}
2025-10-31 18:58:06,548 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 99,\n  "reasoning": "あなたの手札にはA♦と9♥があり、コミュニティカードにはQ♦, J♣, 8♦, 4♦があります。これにより、フラッシュ（同じスートのカードが5枚揃うこと）が完成する可能性があります。現在、あなたの手札のA♦とコミュニティカードのQ♦, 8♦, 4♦で3枚のダイヤがあります。まだ誰かがフラッシュを完成させている可能性はありますが、あなたのAハイフラッシュ（A♦, Q♦, 8♦, 4♦にあと1枚ダイヤが揃う）は強力なハンドです。対戦相手がレイズしてきた金額（99）は、コールするのに妥当な範囲です。フォールド（降りる）するには、まだ勝てる可能性が十分にあります。レイズ（さらにベットを上げる）するには、相手の手札が不明なためリスクが高いです。そのため、コールして次のカード（リバー）を見て、フラッシュが完成するかどうかを確認するのが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 247, 'promptTokenCount': 829, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 829}], 'totalTokenCount': 1076}, 'invocationId': 'e-578e32da-9c0d-46a2-9038-04ff89b7e16c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'GrtiKuOR', 'timestamp': 1761904683.9683}]
2025-10-31 18:58:06,549 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:58:06,549 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 99,
  "reasoning": "あなたの手札にはA♦と9♥があり、コミュニティカードにはQ♦, J♣, 8♦, 4♦があります。これにより、フラッシュ（同じスートのカードが5枚揃うこと）が完成する可能性があります。現在、あなたの手札のA♦とコミュニティカードのQ♦, 8♦, 4♦で3枚のダイヤがあります。まだ誰かがフラッシュを完成させている可能性はありますが、あなたのAハイフラッシュ（A♦, Q♦, 8♦, 4♦にあと1枚ダイヤが揃う）は強力なハンドです。対戦相手がレイズしてきた金額（99）は、コールするのに妥当な範囲です。フォールド（降りる）するには、まだ勝てる可能性が十分にあります。レイズ（さらにベットを上げる）するには、相手の手札が不明なためリスクが高いです。そのため、コールして次のカード（リバー）を見て、フラッシュが完成するかどうかを確認するのが最善の選択です。"
}
```
2025-10-31 18:58:06,549 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:58:06,549 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 99,\n  "reasoning": "あなたの手札にはA♦と9♥があり、コミュニティカードにはQ♦, J♣, 8♦, 4♦があります。これにより、フラッシュ（同じスートのカードが5枚揃うこと）が完成する可能性があります。現在、あなたの手札のA♦とコミュニティカードのQ♦, 8♦, 4♦で3枚のダイヤがあります。まだ誰かがフラッシュを完成させている可能性はありますが、あなたのAハイフラッシュ（A♦, Q♦, 8♦, 4♦にあと1枚ダイヤが揃う）は強力なハンドです。対戦相手がレイズしてきた金額（99）は、コールするのに妥当な範囲です。フォールド（降りる）するには、まだ勝てる可能性が十分にあります。レイズ（さらにベットを上げる）するには、相手の手札が不明なためリスクが高いです。そのため、コールして次のカード（リバー）を見て、フラッシュが完成するかどうかを確認するのが最善の選択です。"\n}\n```'
2025-10-31 18:58:06,549 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:58:06,550 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 99,\n  "reasoning": "あなたの手札にはA♦と9♥があり、コミュニティカードにはQ♦, J♣, 8♦, 4♦があります。これにより、フラッシュ（同じスートのカードが5枚揃うこと）が完成する可能性があります。現在、あなたの手札のA♦とコミュニティカードのQ♦, 8♦, 4♦で3枚のダイヤがあります。まだ誰かがフラッシュを完成させている可能性はありますが、あなたのAハイフラッシュ（A♦, Q♦, 8♦, 4♦にあと1枚ダイヤが揃う）は強力なハンドです。対戦相手がレイズしてきた金額（99）は、コールするのに妥当な範囲です。フォールド（降りる）するには、まだ勝てる可能性が十分にあります。レイズ（さらにベットを上げる）するには、相手の手札が不明なためリスクが高いです。そのため、コールして次のカード（リバー）を見て、フラッシュが完成するかどうかを確認するのが最善の選択です。"\n}'
2025-10-31 18:58:06,550 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 99,
  "reasoning": "あなたの手札にはA♦と9♥があり、コミュニティカードにはQ♦, J♣, 8♦, 4♦があります。これにより、フラッシュ（同じスートのカードが5枚揃うこと）が完成する可能性があります。現在、あなたの手札のA♦とコミュニティカードのQ♦, 8♦, 4♦で3枚のダイヤがあります。まだ誰かがフラッシュを完成させている可能性はありますが、あなたのAハイフラッシュ（A♦, Q♦, 8♦, 4♦にあと1枚ダイヤが揃う）は強力なハンドです。対戦相手がレイズしてきた金額（99）は、コールするのに妥当な範囲です。フォールド（降りる）するには、まだ勝てる可能性が十分にあります。レイズ（さらにベットを上げる）するには、相手の手札が不明なためリスクが高いです。そのため、コールして次のカード（リバー）を見て、フラッシュが完成するかどうかを確認するのが最善の選択です。"
}
2025-10-31 18:58:06,550 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 99, 'reasoning': 'あなたの手札にはA♦と9♥があり、コミュニティカードにはQ♦, J♣, 8♦, 4♦があります。これにより、フラッシュ（同じスートのカードが5枚揃うこと）が完成する可能性があります。現在、あなたの手札のA♦とコミュニティカードのQ♦, 8♦, 4♦で3枚のダイヤがあります。まだ誰かがフラッシュを完成させている可能性はありますが、あなたのAハイフラッシュ（A♦, Q♦, 8♦, 4♦にあと1枚ダイヤが揃う）は強力なハンドです。対戦相手がレイズしてきた金額（99）は、コールするのに妥当な範囲です。フォールド（降りる）するには、まだ勝てる可能性が十分にあります。レイズ（さらにベットを上げる）するには、相手の手札が不明なためリスクが高いです。そのため、コールして次のカード（リバー）を見て、フラッシュが完成するかどうかを確認するのが最善の選択です。'}
2025-10-31 18:58:06,550 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 99
2025-10-31 18:58:06,550 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (99)', 'raise (min 119)', 'all-in (1851)']
2025-10-31 18:58:06,550 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (99)': 99
2025-10-31 18:58:06,550 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 99}
2025-10-31 18:58:06,550 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 99, あなたの手札にはA♦と9♥があり、コミュニティカードにはQ♦, J♣, 8♦, 4♦があります。これにより、フラッシュ（同じスートのカードが5枚揃うこと）が完成する可能性があります。現在、あなたの手札のA♦とコミュニティカードのQ♦, 8♦, 4♦で3枚のダイヤがあります。まだ誰かがフラッシュを完成させている可能性はありますが、あなたのAハイフラッシュ（A♦, Q♦, 8♦, 4♦にあと1枚ダイヤが揃う）は強力なハンドです。対戦相手がレイズしてきた金額（99）は、コールするのに妥当な範囲です。フォールド（降りる）するには、まだ勝てる可能性が十分にあります。レイズ（さらにベットを上げる）するには、相手の手札が不明なためリスクが高いです。そのため、コールして次のカード（リバー）を見て、フラッシュが完成するかどうかを確認するのが最善の選択です。
2025-10-31 18:58:06,551 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 99
2025-10-31 18:58:06,551 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:06,551 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:06,552 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:06,552 - poker_game - INFO - Pot: 348, Current bet: 99
2025-10-31 18:58:06,552 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:06,552 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:06,552 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:06,552 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:06,552 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:06,553 - poker_game - INFO -   P1(Agent1): chips=3389, bet=99, status=active
2025-10-31 18:58:06,553 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:06,553 - poker_game - INFO -   P3(Agent3): chips=1851, bet=0, status=active
2025-10-31 18:58:06,553 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:06,553 - poker_game - INFO - ==================================================
2025-10-31 18:58:06,553 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 99
2025-10-31 18:58:06,563 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:06,564 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:06,564 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:06,564 - poker_game - INFO - Pot: 447, Current bet: 99
2025-10-31 18:58:06,565 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:06,565 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:06,565 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:06,565 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:06,565 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:06,566 - poker_game - INFO -   P1(Agent1): chips=3389, bet=99, status=active
2025-10-31 18:58:06,566 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:06,566 - poker_game - INFO -   P3(Agent3): chips=1752, bet=99, status=active
2025-10-31 18:58:06,566 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:06,566 - poker_game - INFO - Extra: Action: Player 3 called 99
2025-10-31 18:58:06,566 - poker_game - INFO - ==================================================
2025-10-31 18:58:06,567 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:06,567 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:06,567 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:58:06,567 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:58:06,567 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:06,567 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:06,568 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:58:06,568 - poker_game - DEBUG - Player bets: [99, 99, 99], Current bet: 99, All same: True
2025-10-31 18:58:06,568 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:58:06,568 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:06,568 - poker_game - INFO - Hand #17, Phase: turn
2025-10-31 18:58:06,568 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:06,568 - poker_game - INFO - Pot: 447, Current bet: 99
2025-10-31 18:58:06,569 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:06,569 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:06,569 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:06,569 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦']
2025-10-31 18:58:06,569 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:06,569 - poker_game - INFO -   P1(Agent1): chips=3389, bet=99, status=active
2025-10-31 18:58:06,569 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:06,569 - poker_game - INFO -   P3(Agent3): chips=1752, bet=99, status=active
2025-10-31 18:58:06,569 - poker_game - INFO -   P4(Agent4): chips=4412, bet=99, status=active
2025-10-31 18:58:06,570 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:58:06,570 - poker_game - INFO - ==================================================
2025-10-31 18:58:06,671 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:58:06,671 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:06,671 - poker_game - INFO - Remaining players: 3
2025-10-31 18:58:06,672 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:58:06,672 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:58:06,672 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:58:06,672 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:58:06,683 - poker_game - INFO - Starting new betting round
2025-10-31 18:58:06,685 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:58:06,685 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:58:06,686 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 18:58:06,686 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:58:06,686 - poker_game - INFO - First actor: Player 3 (by phase rule), was 4
2025-10-31 18:58:06,686 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:58:06,687 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:06,687 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:06,687 - poker_game - INFO - Pot: 447, Current bet: 0
2025-10-31 18:58:06,688 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:06,689 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:06,690 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:06,691 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:06,691 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:06,691 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:06,692 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:06,692 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:06,692 - poker_game - INFO -   P4(Agent4): chips=4412, bet=0, status=active
2025-10-31 18:58:06,693 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:58:06,693 - poker_game - INFO - ==================================================
2025-10-31 18:58:06,694 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "A♦",
    "9♥"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦",
    "5♠"
  ],
  "your_chips": 1752,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 149,
  "pot": 447,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3389,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4412,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1752)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠"
  ]
}
2025-10-31 18:58:06,711 - poker_game - DEBUG - Create Session: {'id': '2e9d1a5a-ddc2-4012-b186-a91c15e81ab7', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904686.7082987}
2025-10-31 18:58:09,315 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）で、あなたの手札（A♦, 9♥）とコミュニティカード（Q♦, J♣, 8♦, 4♦, 5♠）を合わせると、ダイヤモンドのフラッシュ（同じスートのカードが5枚揃うこと）が完成しています。これは強い役です。対戦相手（Player 4）はチェックしており、アクションの選択肢は「fold（降りる）」、「check（チェック）」、「raise（レイズ）」、「all-in（オールイン）」です。コール（call）は、相手のベット額と同額を支払ってゲームを続行することですが、この状況では相手がベットしていないため、コールは必要ありません。チェック（check）は、相手にベットを譲ることで、この状況では最も安全で合理的な選択です。相手がベットしてきた場合、あなたのフラッシュは非常に強いので、コールやレイズも検討できますが、相手がベットしていないため、チェックが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 243, 'promptTokenCount': 793, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 793}], 'totalTokenCount': 1036}, 'invocationId': 'e-15195b84-aeb8-403c-865d-925fbdccde16', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '5n5gRCqf', 'timestamp': 1761904686.723401}]
2025-10-31 18:58:09,315 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:58:09,316 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "リバー（最後のカード）で、あなたの手札（A♦, 9♥）とコミュニティカード（Q♦, J♣, 8♦, 4♦, 5♠）を合わせると、ダイヤモンドのフラッシュ（同じスートのカードが5枚揃うこと）が完成しています。これは強い役です。対戦相手（Player 4）はチェックしており、アクションの選択肢は「fold（降りる）」、「check（チェック）」、「raise（レイズ）」、「all-in（オールイン）」です。コール（call）は、相手のベット額と同額を支払ってゲームを続行することですが、この状況では相手がベットしていないため、コールは必要ありません。チェック（check）は、相手にベットを譲ることで、この状況では最も安全で合理的な選択です。相手がベットしてきた場合、あなたのフラッシュは非常に強いので、コールやレイズも検討できますが、相手がベットしていないため、チェックが最善です。"
}
```
2025-10-31 18:58:09,316 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:58:09,316 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）で、あなたの手札（A♦, 9♥）とコミュニティカード（Q♦, J♣, 8♦, 4♦, 5♠）を合わせると、ダイヤモンドのフラッシュ（同じスートのカードが5枚揃うこと）が完成しています。これは強い役です。対戦相手（Player 4）はチェックしており、アクションの選択肢は「fold（降りる）」、「check（チェック）」、「raise（レイズ）」、「all-in（オールイン）」です。コール（call）は、相手のベット額と同額を支払ってゲームを続行することですが、この状況では相手がベットしていないため、コールは必要ありません。チェック（check）は、相手にベットを譲ることで、この状況では最も安全で合理的な選択です。相手がベットしてきた場合、あなたのフラッシュは非常に強いので、コールやレイズも検討できますが、相手がベットしていないため、チェックが最善です。"\n}\n```'
2025-10-31 18:58:09,316 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:58:09,319 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "リバー（最後のカード）で、あなたの手札（A♦, 9♥）とコミュニティカード（Q♦, J♣, 8♦, 4♦, 5♠）を合わせると、ダイヤモンドのフラッシュ（同じスートのカードが5枚揃うこと）が完成しています。これは強い役です。対戦相手（Player 4）はチェックしており、アクションの選択肢は「fold（降りる）」、「check（チェック）」、「raise（レイズ）」、「all-in（オールイン）」です。コール（call）は、相手のベット額と同額を支払ってゲームを続行することですが、この状況では相手がベットしていないため、コールは必要ありません。チェック（check）は、相手にベットを譲ることで、この状況では最も安全で合理的な選択です。相手がベットしてきた場合、あなたのフラッシュは非常に強いので、コールやレイズも検討できますが、相手がベットしていないため、チェックが最善です。"\n}'
2025-10-31 18:58:09,319 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "リバー（最後のカード）で、あなたの手札（A♦, 9♥）とコミュニティカード（Q♦, J♣, 8♦, 4♦, 5♠）を合わせると、ダイヤモンドのフラッシュ（同じスートのカードが5枚揃うこと）が完成しています。これは強い役です。対戦相手（Player 4）はチェックしており、アクションの選択肢は「fold（降りる）」、「check（チェック）」、「raise（レイズ）」、「all-in（オールイン）」です。コール（call）は、相手のベット額と同額を支払ってゲームを続行することですが、この状況では相手がベットしていないため、コールは必要ありません。チェック（check）は、相手にベットを譲ることで、この状況では最も安全で合理的な選択です。相手がベットしてきた場合、あなたのフラッシュは非常に強いので、コールやレイズも検討できますが、相手がベットしていないため、チェックが最善です。"
}
2025-10-31 18:58:09,320 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': 'リバー（最後のカード）で、あなたの手札（A♦, 9♥）とコミュニティカード（Q♦, J♣, 8♦, 4♦, 5♠）を合わせると、ダイヤモンドのフラッシュ（同じスートのカードが5枚揃うこと）が完成しています。これは強い役です。対戦相手（Player 4）はチェックしており、アクションの選択肢は「fold（降りる）」、「check（チェック）」、「raise（レイズ）」、「all-in（オールイン）」です。コール（call）は、相手のベット額と同額を支払ってゲームを続行することですが、この状況では相手がベットしていないため、コールは必要ありません。チェック（check）は、相手にベットを譲ることで、この状況では最も安全で合理的な選択です。相手がベットしてきた場合、あなたのフラッシュは非常に強いので、コールやレイズも検討できますが、相手がベットしていないため、チェックが最善です。'}
2025-10-31 18:58:09,320 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 0
2025-10-31 18:58:09,320 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1752)']
2025-10-31 18:58:09,320 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:58:09,321 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 0, リバー（最後のカード）で、あなたの手札（A♦, 9♥）とコミュニティカード（Q♦, J♣, 8♦, 4♦, 5♠）を合わせると、ダイヤモンドのフラッシュ（同じスートのカードが5枚揃うこと）が完成しています。これは強い役です。対戦相手（Player 4）はチェックしており、アクションの選択肢は「fold（降りる）」、「check（チェック）」、「raise（レイズ）」、「all-in（オールイン）」です。コール（call）は、相手のベット額と同額を支払ってゲームを続行することですが、この状況では相手がベットしていないため、コールは必要ありません。チェック（check）は、相手にベットを譲ることで、この状況では最も安全で合理的な選択です。相手がベットしてきた場合、あなたのフラッシュは非常に強いので、コールやレイズも検討できますが、相手がベットしていないため、チェックが最善です。
2025-10-31 18:58:09,322 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 0
2025-10-31 18:58:09,322 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:09,323 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:09,323 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:09,323 - poker_game - INFO - Pot: 447, Current bet: 0
2025-10-31 18:58:09,323 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:09,324 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:09,324 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:09,324 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:09,325 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:09,325 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:09,325 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:09,325 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:09,325 - poker_game - INFO -   P4(Agent4): chips=4412, bet=0, status=active
2025-10-31 18:58:09,326 - poker_game - INFO - ==================================================
2025-10-31 18:58:09,326 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:58:09,339 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:09,340 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:09,340 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:09,340 - poker_game - INFO - Pot: 447, Current bet: 0
2025-10-31 18:58:09,341 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:09,341 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:09,342 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:09,342 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:09,342 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:09,343 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:09,343 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:09,344 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:09,344 - poker_game - INFO -   P4(Agent4): chips=4412, bet=0, status=active
2025-10-31 18:58:09,344 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:58:09,345 - poker_game - INFO - ==================================================
2025-10-31 18:58:09,345 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:09,345 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:09,345 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:58:09,346 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:58:09,346 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:09,346 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:09,346 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:58:09,346 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 18:58:09,347 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:58:09,347 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:58:09,347 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:58:09,347 - poker_game - DEBUG - First actor index: 3
2025-10-31 18:58:09,347 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 18:58:09,347 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:09,348 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:09,348 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:09,348 - poker_game - INFO - Pot: 447, Current bet: 0
2025-10-31 18:58:09,348 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:09,348 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:09,349 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:09,349 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:09,350 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:09,350 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:09,350 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:09,350 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:09,351 - poker_game - INFO -   P4(Agent4): chips=4412, bet=0, status=active
2025-10-31 18:58:09,351 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:09,351 - poker_game - INFO - ==================================================
2025-10-31 18:58:09,454 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "7♥",
    "Q♠"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦",
    "5♠"
  ],
  "your_chips": 4412,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 149,
  "pot": 447,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3389,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1752,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (4412)"
  ],
  "history": [
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked"
  ]
}
2025-10-31 18:58:09,465 - poker_game - DEBUG - Create Session: {'id': '06519d91-9e39-4526-98be-3c9de801c640', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904689.4619517}
2025-10-31 18:58:19,656 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:58:24,057 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_MpMhgF8tuVZs9rf0D5KXX4c2', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1104, 'totalTokenCount': 1121}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '1JBU8NtY', 'timestamp': 1761904689.479577}, {'content': {'parts': [{'functionResponse': {'id': 'call_MpMhgF8tuVZs9rf0D5KXX4c2', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '3LFnNJkW', 'timestamp': 1761904690.991917}, {'content': {'parts': [{'functionCall': {'id': 'call_E1zcDks2uTL7abirsFc5JmuW', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1628, 'totalTokenCount': 1648}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'p7YOAhid', 'timestamp': 1761904691.000018}, {'content': {'parts': [{'functionResponse': {'id': 'call_E1zcDks2uTL7abirsFc5JmuW', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'yvrWnGjQ', 'timestamp': 1761904692.110507}, {'content': {'parts': [{'functionCall': {'id': 'call_JN9AB25yp9mp0aUcp9JBcf0m', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1190, 'totalTokenCount': 1207}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'AToHS3ru', 'timestamp': 1761904692.112085}, {'content': {'parts': [{'functionResponse': {'id': 'call_JN9AB25yp9mp0aUcp9JBcf0m', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'pN5qXFZX', 'timestamp': 1761904693.34331}, {'content': {'parts': [{'functionCall': {'id': 'call_gYPM1nxyHx6qZH6ZkzkaYBO1', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['7♥', 'Q♠'], 'community': ['Q♦', 'J♣', '8♦', '4♦', '5♠'], 'your_chips': 4412, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 149, 'pot': 447, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3389, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1752, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (4412)'], 'history': ['Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 30', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: Q♦, J♣, 8♦', 'Player 3 checked', 'Player 4 raised to 30', 'Player 1 called 30', 'Player 3 called 30', 'Turn dealt: 4♦', 'Player 3 checked', 'Player 4 raised to 99', 'Player 1 called 99', 'Player 3 called 99', 'River dealt: 5♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 447, 'equity': 0.7}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 339, 'promptTokenCount': 1720, 'totalTokenCount': 2059}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'iQJAQrQh', 'timestamp': 1761904693.347792}, {'content': {'parts': [{'functionResponse': {'id': 'call_gYPM1nxyHx6qZH6ZkzkaYBO1', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 295, 'reasoning': '期待値が高い（312.90(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 295'}}}], 'role': 'user'}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '63H0Gmh9', 'timestamp': 1761904701.803902}, {'content': {'parts': [{'text': '{\n  "action": "raise",\n  "amount": 295,\n  "reasoning": "期待値が高い（312.90(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 295"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 62, 'promptTokenCount': 2108, 'totalTokenCount': 2170}, 'invocationId': 'e-f54be5fa-de06-4f23-a54f-070203cc908a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '3HUp5u7i', 'timestamp': 1761904701.806706}]
2025-10-31 18:58:24,057 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:58:24,058 - poker_game - DEBUG - {
  "action": "raise",
  "amount": 295,
  "reasoning": "期待値が高い（312.90(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 295"
}
2025-10-31 18:58:24,058 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:58:24,058 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "raise",\n  "amount": 295,\n  "reasoning": "期待値が高い（312.90(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 295"\n}'
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "raise",
  "amount": 295,
  "reasoning": "期待値が高い（312.90(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 295"
}
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 295, 'reasoning': '期待値が高い（312.90(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 295'}
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 295
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (4412)']
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] Raise amount 295 is valid (min: 20)
2025-10-31 18:58:24,059 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 295}
2025-10-31 18:58:24,059 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 295, 期待値が高い（312.90(ポットに対して70.00%）ため、2/3ポットでベットします。ベット額: 295
2025-10-31 18:58:24,060 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 295
2025-10-31 18:58:24,060 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:24,060 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:24,060 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:24,061 - poker_game - INFO - Pot: 447, Current bet: 0
2025-10-31 18:58:24,061 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:24,061 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:24,061 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:24,061 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:24,062 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:24,062 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:24,062 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:24,062 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:24,062 - poker_game - INFO -   P4(Agent4): chips=4412, bet=0, status=active
2025-10-31 18:58:24,062 - poker_game - INFO - ==================================================
2025-10-31 18:58:24,063 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 295
2025-10-31 18:58:24,074 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:24,075 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:24,075 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:24,075 - poker_game - INFO - Pot: 742, Current bet: 295
2025-10-31 18:58:24,075 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:24,075 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:24,076 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:24,076 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:24,076 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:24,076 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:24,076 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:24,076 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:24,076 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:24,077 - poker_game - INFO - Extra: Action: Player 4 raised to 295
2025-10-31 18:58:24,077 - poker_game - INFO - ==================================================
2025-10-31 18:58:24,077 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:24,077 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:24,077 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:58:24,077 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:58:24,077 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:24,077 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:24,078 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:58:24,078 - poker_game - DEBUG - Player bets: [0, 0, 295], Current bet: 295, All same: False
2025-10-31 18:58:24,078 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:58:24,078 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:24,078 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:24,078 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:58:24,079 - poker_game - INFO - Pot: 742, Current bet: 295
2025-10-31 18:58:24,079 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:24,079 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:24,079 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:24,079 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:24,080 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:24,080 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:24,080 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:24,081 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:24,081 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:24,081 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:24,081 - poker_game - INFO - ==================================================
2025-10-31 18:58:24,182 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "8♥",
    "9♦"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦",
    "5♠"
  ],
  "your_chips": 3389,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 149,
  "pot": 742,
  "to_call": 295,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1752,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4117,
      "bet": 295,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (295)",
    "raise (min 315)",
    "all-in (3389)"
  ],
  "history": [
    "Player 1 folded",
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295"
  ]
}
2025-10-31 18:58:24,193 - poker_game - DEBUG - Create Session: {'id': 'db57b30d-02f9-4642-9eaf-08d707125898', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904704.1895325}
2025-10-31 18:58:26,200 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 295,\n  "reasoning": "リバー（最後のカード）が配られ、あなたの手札は8♥9♦、コミュニティカードはQ♦J♣8♦4♦5♠です。これにより、あなたの手札は8♦Q♦J♦5♠4♦のフラッシュ（同じスートが5枚揃うこと）が完成します。対戦相手（Player 4）が295をベットしましたが、あなたのフラッシュは非常に強いハンドです。コール（相手のベット額と同じ額を支払うこと）して、勝てる可能性が高いと判断しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 150, 'promptTokenCount': 802, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 802}], 'totalTokenCount': 952}, 'invocationId': 'e-8c47483a-bc75-4d59-bbb5-288548e8b460', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'vaM8qclI', 'timestamp': 1761904704.204856}]
2025-10-31 18:58:26,200 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:58:26,200 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 295,
  "reasoning": "リバー（最後のカード）が配られ、あなたの手札は8♥9♦、コミュニティカードはQ♦J♣8♦4♦5♠です。これにより、あなたの手札は8♦Q♦J♦5♠4♦のフラッシュ（同じスートが5枚揃うこと）が完成します。対戦相手（Player 4）が295をベットしましたが、あなたのフラッシュは非常に強いハンドです。コール（相手のベット額と同じ額を支払うこと）して、勝てる可能性が高いと判断しました。"
}
```
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 295,\n  "reasoning": "リバー（最後のカード）が配られ、あなたの手札は8♥9♦、コミュニティカードはQ♦J♣8♦4♦5♠です。これにより、あなたの手札は8♦Q♦J♦5♠4♦のフラッシュ（同じスートが5枚揃うこと）が完成します。対戦相手（Player 4）が295をベットしましたが、あなたのフラッシュは非常に強いハンドです。コール（相手のベット額と同じ額を支払うこと）して、勝てる可能性が高いと判断しました。"\n}\n```'
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 295,\n  "reasoning": "リバー（最後のカード）が配られ、あなたの手札は8♥9♦、コミュニティカードはQ♦J♣8♦4♦5♠です。これにより、あなたの手札は8♦Q♦J♦5♠4♦のフラッシュ（同じスートが5枚揃うこと）が完成します。対戦相手（Player 4）が295をベットしましたが、あなたのフラッシュは非常に強いハンドです。コール（相手のベット額と同じ額を支払うこと）して、勝てる可能性が高いと判断しました。"\n}'
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 295,
  "reasoning": "リバー（最後のカード）が配られ、あなたの手札は8♥9♦、コミュニティカードはQ♦J♣8♦4♦5♠です。これにより、あなたの手札は8♦Q♦J♦5♠4♦のフラッシュ（同じスートが5枚揃うこと）が完成します。対戦相手（Player 4）が295をベットしましたが、あなたのフラッシュは非常に強いハンドです。コール（相手のベット額と同じ額を支払うこと）して、勝てる可能性が高いと判断しました。"
}
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 295, 'reasoning': 'リバー（最後のカード）が配られ、あなたの手札は8♥9♦、コミュニティカードはQ♦J♣8♦4♦5♠です。これにより、あなたの手札は8♦Q♦J♦5♠4♦のフラッシュ（同じスートが5枚揃うこと）が完成します。対戦相手（Player 4）が295をベットしましたが、あなたのフラッシュは非常に強いハンドです。コール（相手のベット額と同じ額を支払うこと）して、勝てる可能性が高いと判断しました。'}
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 295
2025-10-31 18:58:26,201 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (295)', 'raise (min 315)', 'all-in (3389)']
2025-10-31 18:58:26,202 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (295)': 295
2025-10-31 18:58:26,202 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 295}
2025-10-31 18:58:26,202 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 295, リバー（最後のカード）が配られ、あなたの手札は8♥9♦、コミュニティカードはQ♦J♣8♦4♦5♠です。これにより、あなたの手札は8♦Q♦J♦5♠4♦のフラッシュ（同じスートが5枚揃うこと）が完成します。対戦相手（Player 4）が295をベットしましたが、あなたのフラッシュは非常に強いハンドです。コール（相手のベット額と同じ額を支払うこと）して、勝てる可能性が高いと判断しました。
2025-10-31 18:58:26,202 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 295
2025-10-31 18:58:26,202 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:26,203 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:26,203 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:58:26,203 - poker_game - INFO - Pot: 742, Current bet: 295
2025-10-31 18:58:26,203 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:26,203 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:26,203 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:26,204 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:26,204 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:26,204 - poker_game - INFO -   P1(Agent1): chips=3389, bet=0, status=active
2025-10-31 18:58:26,204 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:26,204 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:26,205 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:26,205 - poker_game - INFO - ==================================================
2025-10-31 18:58:26,205 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 295
2025-10-31 18:58:26,215 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:26,216 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:26,216 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:58:26,217 - poker_game - INFO - Pot: 1037, Current bet: 295
2025-10-31 18:58:26,217 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:26,218 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:26,218 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:26,218 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:26,218 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:26,218 - poker_game - INFO -   P1(Agent1): chips=3094, bet=295, status=active
2025-10-31 18:58:26,218 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:26,218 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:26,219 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:26,219 - poker_game - INFO - Extra: Action: Player 1 called 295
2025-10-31 18:58:26,219 - poker_game - INFO - ==================================================
2025-10-31 18:58:26,219 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:26,220 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:26,220 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:58:26,220 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:58:26,220 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:26,220 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:26,220 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:58:26,220 - poker_game - DEBUG - Player bets: [295, 0, 295], Current bet: 295, All same: False
2025-10-31 18:58:26,221 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:58:26,221 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:26,221 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:26,221 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:26,221 - poker_game - INFO - Pot: 1037, Current bet: 295
2025-10-31 18:58:26,221 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:26,222 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:26,222 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:26,222 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:26,222 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:26,223 - poker_game - INFO -   P1(Agent1): chips=3094, bet=295, status=active
2025-10-31 18:58:26,223 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:26,223 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:26,224 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:26,224 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:26,224 - poker_game - INFO - ==================================================
2025-10-31 18:58:26,326 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "A♦",
    "9♥"
  ],
  "community": [
    "Q♦",
    "J♣",
    "8♦",
    "4♦",
    "5♠"
  ],
  "your_chips": 1752,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 149,
  "pot": 1037,
  "to_call": 295,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3094,
      "bet": 295,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 4117,
      "bet": 295,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (295)",
    "raise (min 315)",
    "all-in (1752)"
  ],
  "history": [
    "Showdown: Player 3 won 30",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: Q♦, J♣, 8♦",
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295"
  ]
}
2025-10-31 18:58:26,343 - poker_game - DEBUG - Create Session: {'id': '93c208e6-3c44-4025-b297-fdf1127d1d22', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904706.3399339}
2025-10-31 18:58:29,031 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 295,\n  "reasoning": "リバー（最終ストリート）で、あなたの手札はA♦9♥、コミュニティカードはQ♦J♣8♦4♦5♠です。コミュニティカードにはダイヤが3枚（Q♦, 8♦, 4♦）あり、フラッシュ（同じスートのカードが5枚揃うこと）の可能性があります。あなたの手札のA♦は、ダイヤの中でも最も強いカードです。プレイヤー4が295をベットしてきましたが、あなたにはフラッシュの可能性があり、A♦はフラッシュのトップキッカー（フラッシュが完成した場合の、そのフラッシュを構成するカード以外の最も強いカード）となり得ます。コールすることで、相手の手札次第では勝つ可能性があります。レイズするには情報が不足しており、フォールドするには惜しいハンドです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 202, 'promptTokenCount': 809, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 809}], 'totalTokenCount': 1011}, 'invocationId': 'e-e47bc43d-7013-47f8-ae50-ade3a7f9daea', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'VLyQrJrn', 'timestamp': 1761904706.353269}]
2025-10-31 18:58:29,032 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:58:29,032 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 295,
  "reasoning": "リバー（最終ストリート）で、あなたの手札はA♦9♥、コミュニティカードはQ♦J♣8♦4♦5♠です。コミュニティカードにはダイヤが3枚（Q♦, 8♦, 4♦）あり、フラッシュ（同じスートのカードが5枚揃うこと）の可能性があります。あなたの手札のA♦は、ダイヤの中でも最も強いカードです。プレイヤー4が295をベットしてきましたが、あなたにはフラッシュの可能性があり、A♦はフラッシュのトップキッカー（フラッシュが完成した場合の、そのフラッシュを構成するカード以外の最も強いカード）となり得ます。コールすることで、相手の手札次第では勝つ可能性があります。レイズするには情報が不足しており、フォールドするには惜しいハンドです。"
}
```
2025-10-31 18:58:29,033 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:58:29,033 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 295,\n  "reasoning": "リバー（最終ストリート）で、あなたの手札はA♦9♥、コミュニティカードはQ♦J♣8♦4♦5♠です。コミュニティカードにはダイヤが3枚（Q♦, 8♦, 4♦）あり、フラッシュ（同じスートのカードが5枚揃うこと）の可能性があります。あなたの手札のA♦は、ダイヤの中でも最も強いカードです。プレイヤー4が295をベットしてきましたが、あなたにはフラッシュの可能性があり、A♦はフラッシュのトップキッカー（フラッシュが完成した場合の、そのフラッシュを構成するカード以外の最も強いカード）となり得ます。コールすることで、相手の手札次第では勝つ可能性があります。レイズするには情報が不足しており、フォールドするには惜しいハンドです。"\n}\n```'
2025-10-31 18:58:29,033 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:58:29,034 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 295,\n  "reasoning": "リバー（最終ストリート）で、あなたの手札はA♦9♥、コミュニティカードはQ♦J♣8♦4♦5♠です。コミュニティカードにはダイヤが3枚（Q♦, 8♦, 4♦）あり、フラッシュ（同じスートのカードが5枚揃うこと）の可能性があります。あなたの手札のA♦は、ダイヤの中でも最も強いカードです。プレイヤー4が295をベットしてきましたが、あなたにはフラッシュの可能性があり、A♦はフラッシュのトップキッカー（フラッシュが完成した場合の、そのフラッシュを構成するカード以外の最も強いカード）となり得ます。コールすることで、相手の手札次第では勝つ可能性があります。レイズするには情報が不足しており、フォールドするには惜しいハンドです。"\n}'
2025-10-31 18:58:29,034 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 295,
  "reasoning": "リバー（最終ストリート）で、あなたの手札はA♦9♥、コミュニティカードはQ♦J♣8♦4♦5♠です。コミュニティカードにはダイヤが3枚（Q♦, 8♦, 4♦）あり、フラッシュ（同じスートのカードが5枚揃うこと）の可能性があります。あなたの手札のA♦は、ダイヤの中でも最も強いカードです。プレイヤー4が295をベットしてきましたが、あなたにはフラッシュの可能性があり、A♦はフラッシュのトップキッカー（フラッシュが完成した場合の、そのフラッシュを構成するカード以外の最も強いカード）となり得ます。コールすることで、相手の手札次第では勝つ可能性があります。レイズするには情報が不足しており、フォールドするには惜しいハンドです。"
}
2025-10-31 18:58:29,034 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 295, 'reasoning': 'リバー（最終ストリート）で、あなたの手札はA♦9♥、コミュニティカードはQ♦J♣8♦4♦5♠です。コミュニティカードにはダイヤが3枚（Q♦, 8♦, 4♦）あり、フラッシュ（同じスートのカードが5枚揃うこと）の可能性があります。あなたの手札のA♦は、ダイヤの中でも最も強いカードです。プレイヤー4が295をベットしてきましたが、あなたにはフラッシュの可能性があり、A♦はフラッシュのトップキッカー（フラッシュが完成した場合の、そのフラッシュを構成するカード以外の最も強いカード）となり得ます。コールすることで、相手の手札次第では勝つ可能性があります。レイズするには情報が不足しており、フォールドするには惜しいハンドです。'}
2025-10-31 18:58:29,035 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 295
2025-10-31 18:58:29,035 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (295)', 'raise (min 315)', 'all-in (1752)']
2025-10-31 18:58:29,035 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (295)': 295
2025-10-31 18:58:29,035 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 295}
2025-10-31 18:58:29,035 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 295, リバー（最終ストリート）で、あなたの手札はA♦9♥、コミュニティカードはQ♦J♣8♦4♦5♠です。コミュニティカードにはダイヤが3枚（Q♦, 8♦, 4♦）あり、フラッシュ（同じスートのカードが5枚揃うこと）の可能性があります。あなたの手札のA♦は、ダイヤの中でも最も強いカードです。プレイヤー4が295をベットしてきましたが、あなたにはフラッシュの可能性があり、A♦はフラッシュのトップキッカー（フラッシュが完成した場合の、そのフラッシュを構成するカード以外の最も強いカード）となり得ます。コールすることで、相手の手札次第では勝つ可能性があります。レイズするには情報が不足しており、フォールドするには惜しいハンドです。
2025-10-31 18:58:29,037 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 295
2025-10-31 18:58:29,037 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:29,038 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:29,038 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:29,038 - poker_game - INFO - Pot: 1037, Current bet: 295
2025-10-31 18:58:29,039 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:29,039 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:29,039 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:29,040 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:29,041 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:29,042 - poker_game - INFO -   P1(Agent1): chips=3094, bet=295, status=active
2025-10-31 18:58:29,042 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:29,043 - poker_game - INFO -   P3(Agent3): chips=1752, bet=0, status=active
2025-10-31 18:58:29,043 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:29,044 - poker_game - INFO - ==================================================
2025-10-31 18:58:29,044 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 295
2025-10-31 18:58:29,060 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:29,061 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:29,061 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:58:29,061 - poker_game - INFO - Pot: 1332, Current bet: 295
2025-10-31 18:58:29,061 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:29,062 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:29,062 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:29,063 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:29,063 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:29,063 - poker_game - INFO -   P1(Agent1): chips=3094, bet=295, status=active
2025-10-31 18:58:29,063 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:29,064 - poker_game - INFO -   P3(Agent3): chips=1457, bet=295, status=active
2025-10-31 18:58:29,064 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:29,064 - poker_game - INFO - Extra: Action: Player 3 called 295
2025-10-31 18:58:29,064 - poker_game - INFO - ==================================================
2025-10-31 18:58:29,065 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:29,065 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:29,066 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:58:29,066 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:58:29,067 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:29,067 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:29,068 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:58:29,068 - poker_game - DEBUG - Player bets: [295, 295, 295], Current bet: 295, All same: True
2025-10-31 18:58:29,068 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 18:58:29,069 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:29,070 - poker_game - INFO - Hand #17, Phase: river
2025-10-31 18:58:29,070 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:29,071 - poker_game - INFO - Pot: 1332, Current bet: 295
2025-10-31 18:58:29,072 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:29,073 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:29,075 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:29,075 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:29,076 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:29,076 - poker_game - INFO -   P1(Agent1): chips=3094, bet=295, status=active
2025-10-31 18:58:29,077 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:29,077 - poker_game - INFO -   P3(Agent3): chips=1457, bet=295, status=active
2025-10-31 18:58:29,078 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:29,078 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:58:29,078 - poker_game - INFO - ==================================================
2025-10-31 18:58:29,179 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:58:29,180 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:29,180 - poker_game - INFO - Remaining players: 3
2025-10-31 18:58:29,181 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:58:29,181 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:58:29,181 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:58:29,181 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:58:29,182 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:58:29,182 - poker_game - INFO - Hand #17, Phase: showdown
2025-10-31 18:58:29,183 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:58:29,183 - poker_game - INFO - Pot: 1332, Current bet: 295
2025-10-31 18:58:29,183 - poker_game - INFO - Last raiser: 4
2025-10-31 18:58:29,183 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:29,184 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:29,184 - poker_game - INFO - Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:29,185 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:29,185 - poker_game - INFO -   P1(Agent1): chips=3094, bet=295, status=active
2025-10-31 18:58:29,185 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:29,186 - poker_game - INFO -   P3(Agent3): chips=1457, bet=295, status=active
2025-10-31 18:58:29,186 - poker_game - INFO -   P4(Agent4): chips=4117, bet=295, status=active
2025-10-31 18:58:29,187 - poker_game - INFO - ==================================================
2025-10-31 18:58:29,187 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:58:29,187 - poker_game - INFO - Pot: 1332, Community cards: ['Q♦', 'J♣', '8♦', '4♦', '5♠']
2025-10-31 18:58:29,188 - poker_game - INFO -   Player 1 status=active cards=['8♥', '9♦']
2025-10-31 18:58:29,188 - poker_game - INFO -   Player 3 status=active cards=['A♦', '9♥']
2025-10-31 18:58:29,188 - poker_game - INFO -   Player 4 status=active cards=['7♥', 'Q♠']
2025-10-31 18:58:29,205 - poker_game - INFO -   Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=['8♥', '9♦']
2025-10-31 18:58:29,206 - poker_game - INFO -   Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=['A♦', '9♥']
2025-10-31 18:58:29,206 - poker_game - INFO -   Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=['7♥', 'Q♠']
2025-10-31 18:58:29,207 - poker_game - INFO - Pot layer 0: amount=1332, contributors=[1, 3, 4]
2025-10-31 18:58:29,208 - poker_game - INFO - Showdown total awarded: 1332 (game.pot=1332)
2025-10-31 18:58:29,208 - poker_game - INFO - Showdown winners (aggregated): [4]
2025-10-31 18:58:29,209 - poker_game - INFO -   Awarded 1332 to Player 4 (hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥)
2025-10-31 18:58:29,209 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:58:29,257 - poker_game - INFO - === STARTING NEW HAND #18 ===
2025-10-31 18:58:29,257 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:58:29,258 - poker_game - INFO - Moving dealer button
2025-10-31 18:58:29,259 - poker_game - INFO - Posting blinds
2025-10-31 18:58:29,281 - poker_game - INFO - Dealing hole cards
2025-10-31 18:58:29,281 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:58:29,292 - poker_game - INFO - Started new hand in database: hand_id=18
2025-10-31 18:58:29,293 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:58:29,294 - poker_game - INFO - Hand #18, Phase: preflop
2025-10-31 18:58:29,294 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:58:29,294 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:29,295 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:29,295 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:29,295 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:29,296 - poker_game - INFO - Community cards: []
2025-10-31 18:58:29,296 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:29,296 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:29,297 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:29,298 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 18:58:29,298 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 18:58:29,299 - poker_game - INFO - ==================================================
2025-10-31 18:58:29,300 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "9♦",
    "2♥"
  ],
  "community": [],
  "your_chips": 1457,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3074,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1457)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 18:58:29,310 - poker_game - DEBUG - Create Session: {'id': '7f78a291-b0c3-43e2-941a-a86af467fbc1', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904709.3085413}
2025-10-31 18:58:28,122 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで、私の手札は9♦2♥と非常に弱いです。コールするには20、レイズするには最低40必要です。この状況でコールするのは、期待値が低く、ポテンシャルがほとんどないため、フォールドが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 92, 'promptTokenCount': 892, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 892}], 'totalTokenCount': 984}, 'invocationId': 'e-fcce589a-c973-44e2-ba7d-16ffef388a0b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'pIMuQ0se', 'timestamp': 1761904709.324166}]
2025-10-31 18:58:28,123 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:58:28,123 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで、私の手札は9♦2♥と非常に弱いです。コールするには20、レイズするには最低40必要です。この状況でコールするのは、期待値が低く、ポテンシャルがほとんどないため、フォールドが最善の選択です。"
}
```
2025-10-31 18:58:28,124 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:58:28,124 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで、私の手札は9♦2♥と非常に弱いです。コールするには20、レイズするには最低40必要です。この状況でコールするのは、期待値が低く、ポテンシャルがほとんどないため、フォールドが最善の選択です。"\n}\n```'
2025-10-31 18:58:28,124 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:58:28,124 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで、私の手札は9♦2♥と非常に弱いです。コールするには20、レイズするには最低40必要です。この状況でコールするのは、期待値が低く、ポテンシャルがほとんどないため、フォールドが最善の選択です。"\n}'
2025-10-31 18:58:28,124 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで、私の手札は9♦2♥と非常に弱いです。コールするには20、レイズするには最低40必要です。この状況でコールするのは、期待値が低く、ポテンシャルがほとんどないため、フォールドが最善の選択です。"
}
2025-10-31 18:58:28,125 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップで、私の手札は9♦2♥と非常に弱いです。コールするには20、レイズするには最低40必要です。この状況でコールするのは、期待値が低く、ポテンシャルがほとんどないため、フォールドが最善の選択です。'}
2025-10-31 18:58:28,125 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 18:58:28,125 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 18:58:28,125 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:58:28,125 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップで、私の手札は9♦2♥と非常に弱いです。コールするには20、レイズするには最低40必要です。この状況でコールするのは、期待値が低く、ポテンシャルがほとんどないため、フォールドが最善の選択です。
2025-10-31 18:58:28,126 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 18:58:28,126 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:28,126 - poker_game - INFO - Hand #18, Phase: preflop
2025-10-31 18:58:28,126 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:58:28,127 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:28,127 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:28,128 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:28,128 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:28,128 - poker_game - INFO - Community cards: []
2025-10-31 18:58:28,128 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:28,129 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:28,129 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:28,129 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 18:58:28,130 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 18:58:28,130 - poker_game - INFO - ==================================================
2025-10-31 18:58:28,130 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 18:58:28,142 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:28,143 - poker_game - INFO - Hand #18, Phase: preflop
2025-10-31 18:58:28,143 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 18:58:28,144 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:28,145 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:28,145 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:28,146 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:28,146 - poker_game - INFO - Community cards: []
2025-10-31 18:58:28,146 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:28,147 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:28,147 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:28,148 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=folded
2025-10-31 18:58:28,148 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 18:58:28,149 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 18:58:28,149 - poker_game - INFO - ==================================================
2025-10-31 18:58:28,150 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:28,155 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:28,157 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 18:58:28,157 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:58:28,160 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:28,160 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:28,161 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:28,161 - poker_game - DEBUG - Player bets: [20, 10], Current bet: 20, All same: False
2025-10-31 18:58:28,161 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:58:28,162 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:28,162 - poker_game - INFO - Hand #18, Phase: preflop
2025-10-31 18:58:28,163 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:58:28,163 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:28,163 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:28,164 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:28,164 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:28,165 - poker_game - INFO - Community cards: []
2025-10-31 18:58:28,165 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:28,165 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:28,166 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:28,167 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=folded
2025-10-31 18:58:28,167 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 18:58:28,167 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:28,168 - poker_game - INFO - ==================================================
2025-10-31 18:58:28,270 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "8♦",
    "4♥"
  ],
  "community": [],
  "your_chips": 5439,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3074,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1457,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (5439)"
  ],
  "history": [
    "Player 4 raised to 30",
    "Player 1 called 30",
    "Player 3 called 30",
    "Turn dealt: 4♦",
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded"
  ]
}
2025-10-31 18:58:28,285 - poker_game - DEBUG - Create Session: {'id': 'a2667fe6-1ffe-4b44-a406-e5780244e91f', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904708.2817018}
2025-10-31 18:58:33,297 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_adFEYcWPW5zjhANWKhduNasz', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1211, 'totalTokenCount': 1228}, 'invocationId': 'e-a9a2deef-3dd2-4b19-85d0-95e4c73ea8fc', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'bZZUK969', 'timestamp': 1761904708.300321}, {'content': {'parts': [{'functionResponse': {'id': 'call_adFEYcWPW5zjhANWKhduNasz', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a9a2deef-3dd2-4b19-85d0-95e4c73ea8fc', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'cA0AKeJU', 'timestamp': 1761904709.466024}, {'content': {'parts': [{'functionCall': {'id': 'call_nCe5qzdFCM2O1rB5VdvX9QRo', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1735, 'totalTokenCount': 1755}, 'invocationId': 'e-a9a2deef-3dd2-4b19-85d0-95e4c73ea8fc', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'fjFHNlwU', 'timestamp': 1761904709.47125}, {'content': {'parts': [{'functionResponse': {'id': 'call_nCe5qzdFCM2O1rB5VdvX9QRo', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a9a2deef-3dd2-4b19-85d0-95e4c73ea8fc', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'AnpMcvIS', 'timestamp': 1761904710.774042}, {'content': {'parts': [{'text': '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "手札が8♦と4♥であり、強いハンドではないため、リスクを避けてフォールドすることが最良の選択です。"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 61, 'promptTokenCount': 1297, 'totalTokenCount': 1358}, 'invocationId': 'e-a9a2deef-3dd2-4b19-85d0-95e4c73ea8fc', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'qfjH05M5', 'timestamp': 1761904710.786191}]
2025-10-31 18:58:33,297 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:58:33,297 - poker_game - DEBUG - {
  "action": "fold",
  "amount": 0,
  "reasoning": "手札が8♦と4♥であり、強いハンドではないため、リスクを避けてフォールドすることが最良の選択です。"
}
2025-10-31 18:58:33,298 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:58:33,298 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "手札が8♦と4♥であり、強いハンドではないため、リスクを避けてフォールドすることが最良の選択です。"\n}'
2025-10-31 18:58:33,298 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:58:33,298 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "手札が8♦と4♥であり、強いハンドではないため、リスクを避けてフォールドすることが最良の選択です。"
}
2025-10-31 18:58:33,299 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '手札が8♦と4♥であり、強いハンドではないため、リスクを避けてフォールドすることが最良の選択です。'}
2025-10-31 18:58:33,299 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:58:33,299 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:58:33,299 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:58:33,299 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 手札が8♦と4♥であり、強いハンドではないため、リスクを避けてフォールドすることが最良の選択です。
2025-10-31 18:58:33,300 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:58:33,300 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:33,301 - poker_game - INFO - Hand #18, Phase: preflop
2025-10-31 18:58:33,301 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:58:33,301 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:33,301 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:33,301 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:33,301 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:33,302 - poker_game - INFO - Community cards: []
2025-10-31 18:58:33,302 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:33,302 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:33,302 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:33,302 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=folded
2025-10-31 18:58:33,303 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 18:58:33,303 - poker_game - INFO - ==================================================
2025-10-31 18:58:33,303 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:58:33,311 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:33,312 - poker_game - INFO - Hand #18, Phase: preflop
2025-10-31 18:58:33,312 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 18:58:33,312 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:33,312 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:33,312 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:33,312 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:58:33,313 - poker_game - INFO - Community cards: []
2025-10-31 18:58:33,313 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:33,313 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:33,313 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:33,313 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=folded
2025-10-31 18:58:33,313 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=folded
2025-10-31 18:58:33,313 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:58:33,313 - poker_game - INFO - ==================================================
2025-10-31 18:58:33,313 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:33,314 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:33,314 - poker_game - DEBUG - Active players: [1]
2025-10-31 18:58:33,314 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:58:33,314 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:33,314 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:33,314 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 18:58:33,314 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 18:58:33,314 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:33,314 - poker_game - INFO - Hand #18, Phase: preflop
2025-10-31 18:58:33,314 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:58:33,315 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:33,317 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:33,317 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:33,318 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:58:33,318 - poker_game - INFO - Community cards: []
2025-10-31 18:58:33,318 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:33,318 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:33,318 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:33,318 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=folded
2025-10-31 18:58:33,318 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=folded
2025-10-31 18:58:33,318 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:58:33,319 - poker_game - INFO - ==================================================
2025-10-31 18:58:33,424 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:58:33,425 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:33,426 - poker_game - INFO - Remaining players: 1
2025-10-31 18:58:33,426 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:58:33,427 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 18:58:33,427 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:58:33,428 - poker_game - INFO - Hand #18, Phase: showdown
2025-10-31 18:58:33,428 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 18:58:33,428 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:33,429 - poker_game - INFO - Last raiser: 1
2025-10-31 18:58:33,429 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:33,429 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 18:58:33,430 - poker_game - INFO - Community cards: []
2025-10-31 18:58:33,430 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:33,430 - poker_game - INFO -   P1(Agent1): chips=3074, bet=20, status=active
2025-10-31 18:58:33,431 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:33,431 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=folded
2025-10-31 18:58:33,432 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=folded
2025-10-31 18:58:33,432 - poker_game - INFO - ==================================================
2025-10-31 18:58:33,432 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:58:33,433 - poker_game - INFO - Pot: 30, Community cards: []
2025-10-31 18:58:33,433 - poker_game - INFO -   Player 1 status=active cards=['4♠', 'K♥']
2025-10-31 18:58:33,433 - poker_game - INFO - Showdown winner by default: Player 1 awarded 30
2025-10-31 18:58:33,434 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:58:33,434 - poker_game - INFO - === STARTING NEW HAND #19 ===
2025-10-31 18:58:33,435 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:58:33,435 - poker_game - INFO - Moving dealer button
2025-10-31 18:58:33,435 - poker_game - INFO - Posting blinds
2025-10-31 18:58:33,464 - poker_game - INFO - Dealing hole cards
2025-10-31 18:58:33,465 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:58:33,475 - poker_game - INFO - Started new hand in database: hand_id=19
2025-10-31 18:58:33,476 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:58:33,476 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:33,477 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:58:33,479 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:33,480 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:33,480 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:33,481 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:33,481 - poker_game - INFO - Community cards: []
2025-10-31 18:58:33,481 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:33,481 - poker_game - INFO -   P1(Agent1): chips=3094, bet=10, status=active
2025-10-31 18:58:33,482 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:33,482 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:33,482 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=active
2025-10-31 18:58:33,483 - poker_game - INFO - ==================================================
2025-10-31 18:58:33,483 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "J♥",
    "4♣"
  ],
  "community": [],
  "your_chips": 5439,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3094,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (5439)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 18:58:33,496 - poker_game - DEBUG - Create Session: {'id': 'e6218692-eb0e-4c88-b17c-c7cd875bc737', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904713.4929698}
2025-10-31 18:58:43,524 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:58:47,576 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_oFl9xZP7Eo5zc5UzMSokQ3Bf', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1215, 'totalTokenCount': 1232}, 'invocationId': 'e-4afd61fc-9dbe-4fc7-8c2b-ebd2ec7c803c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'GevQD1cU', 'timestamp': 1761904713.508137}, {'content': {'parts': [{'functionResponse': {'id': 'call_oFl9xZP7Eo5zc5UzMSokQ3Bf', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-4afd61fc-9dbe-4fc7-8c2b-ebd2ec7c803c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'aH8G72BP', 'timestamp': 1761904714.498117}, {'content': {'parts': [{'functionCall': {'id': 'call_JC5gv1VRX5ogl56Ww9PWmO9u', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♥', '4♣'], 'community': [], 'your_chips': 5439, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3094, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (5439)'], 'history': ['Player 3 checked', 'Player 4 raised to 99', 'Player 1 called 99', 'Player 3 called 99', 'River dealt: 5♠', 'Player 3 checked', 'Player 4 raised to 295', 'Player 1 called 295', 'Player 3 called 295', 'Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦', 'Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥', 'Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠', 'Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 folded', 'Showdown: Player 1 won 30', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.3}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 463, 'promptTokenCount': 1739, 'totalTokenCount': 2202}, 'invocationId': 'e-4afd61fc-9dbe-4fc7-8c2b-ebd2ec7c803c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'cAgFUwYf', 'timestamp': 1761904714.499569}, {'content': {'parts': [{'functionResponse': {'id': 'call_JC5gv1VRX5ogl56Ww9PWmO9u', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が1.00(ポットに対して3.33%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'e-4afd61fc-9dbe-4fc7-8c2b-ebd2ec7c803c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'b0cREj5d', 'timestamp': 1761904725.774335}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が1.00(ポットに対して3.33%で、マイナスなのでフォールド"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 39, 'promptTokenCount': 2238, 'totalTokenCount': 2277}, 'invocationId': 'e-4afd61fc-9dbe-4fc7-8c2b-ebd2ec7c803c', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'yh0XDF54', 'timestamp': 1761904725.778188}]
2025-10-31 18:58:47,577 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:58:47,578 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が1.00(ポットに対して3.33%で、マイナスなのでフォールド"}
2025-10-31 18:58:47,579 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:58:47,579 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が1.00(ポットに対して3.33%で、マイナスなのでフォールド"}'
2025-10-31 18:58:47,579 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:58:47,580 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が1.00(ポットに対して3.33%で、マイナスなのでフォールド"}
2025-10-31 18:58:47,580 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が1.00(ポットに対して3.33%で、マイナスなのでフォールド'}
2025-10-31 18:58:47,580 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 18:58:47,580 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 18:58:47,581 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 18:58:47,581 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が1.00(ポットに対して3.33%で、マイナスなのでフォールド
2025-10-31 18:58:47,582 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 18:58:47,583 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:47,583 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:47,584 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:58:47,584 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:47,585 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:47,585 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:47,586 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:58:47,587 - poker_game - INFO - Community cards: []
2025-10-31 18:58:47,588 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:47,588 - poker_game - INFO -   P1(Agent1): chips=3094, bet=10, status=active
2025-10-31 18:58:47,589 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:47,589 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:47,590 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=active
2025-10-31 18:58:47,590 - poker_game - INFO - ==================================================
2025-10-31 18:58:47,590 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 18:58:47,605 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:47,606 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:47,606 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 18:58:47,606 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:47,607 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:47,607 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:47,607 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:47,608 - poker_game - INFO - Community cards: []
2025-10-31 18:58:47,608 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:47,608 - poker_game - INFO -   P1(Agent1): chips=3094, bet=10, status=active
2025-10-31 18:58:47,609 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:47,609 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:47,609 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:47,610 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 18:58:47,610 - poker_game - INFO - ==================================================
2025-10-31 18:58:47,610 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:47,611 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:47,611 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:58:47,611 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:58:47,612 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:47,612 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:47,612 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:47,613 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 18:58:47,613 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:58:47,613 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:47,613 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:47,613 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:47,613 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:47,618 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:47,621 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:47,623 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:47,624 - poker_game - INFO - Community cards: []
2025-10-31 18:58:47,625 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:47,625 - poker_game - INFO -   P1(Agent1): chips=3094, bet=10, status=active
2025-10-31 18:58:47,625 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:47,626 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:47,626 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:47,627 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:47,627 - poker_game - INFO - ==================================================
2025-10-31 18:58:47,729 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "Q♣",
    "9♥"
  ],
  "community": [],
  "your_chips": 3094,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (3094)"
  ],
  "history": [
    "Player 4 raised to 99",
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded"
  ]
}
2025-10-31 18:58:47,740 - poker_game - DEBUG - Create Session: {'id': '09ee424c-a79d-4c6d-b76d-3e8e0cbac149', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904727.7371528}
2025-10-31 18:58:49,954 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、Q9オフスーツは中程度のハンドです。ポットオッズ（コールに必要な金額に対するポットのサイズ）は良好です。相手のベット額はそれほど大きくなく、フロップ以降のプレーの可能性を残すためにコールするのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 89, 'promptTokenCount': 897, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 897}], 'totalTokenCount': 986}, 'invocationId': 'e-9defd9f3-06ce-4259-8696-7c30eed46469', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'iDVdevrN', 'timestamp': 1761904727.751415}]
2025-10-31 18:58:49,954 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:58:49,955 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで、Q9オフスーツは中程度のハンドです。ポットオッズ（コールに必要な金額に対するポットのサイズ）は良好です。相手のベット額はそれほど大きくなく、フロップ以降のプレーの可能性を残すためにコールするのが最善です。"
}
```
2025-10-31 18:58:49,955 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:58:49,955 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、Q9オフスーツは中程度のハンドです。ポットオッズ（コールに必要な金額に対するポットのサイズ）は良好です。相手のベット額はそれほど大きくなく、フロップ以降のプレーの可能性を残すためにコールするのが最善です。"\n}\n```'
2025-10-31 18:58:49,956 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:58:49,956 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、Q9オフスーツは中程度のハンドです。ポットオッズ（コールに必要な金額に対するポットのサイズ）は良好です。相手のベット額はそれほど大きくなく、フロップ以降のプレーの可能性を残すためにコールするのが最善です。"\n}'
2025-10-31 18:58:49,956 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで、Q9オフスーツは中程度のハンドです。ポットオッズ（コールに必要な金額に対するポットのサイズ）は良好です。相手のベット額はそれほど大きくなく、フロップ以降のプレーの可能性を残すためにコールするのが最善です。"
}
2025-10-31 18:58:49,956 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップで、Q9オフスーツは中程度のハンドです。ポットオッズ（コールに必要な金額に対するポットのサイズ）は良好です。相手のベット額はそれほど大きくなく、フロップ以降のプレーの可能性を残すためにコールするのが最善です。'}
2025-10-31 18:58:49,957 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 10
2025-10-31 18:58:49,957 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (3094)']
2025-10-31 18:58:49,957 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (10)': 10
2025-10-31 18:58:49,957 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:58:49,957 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 10, プリフロップで、Q9オフスーツは中程度のハンドです。ポットオッズ（コールに必要な金額に対するポットのサイズ）は良好です。相手のベット額はそれほど大きくなく、フロップ以降のプレーの可能性を残すためにコールするのが最善です。
2025-10-31 18:58:49,960 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 10
2025-10-31 18:58:49,961 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:49,962 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:49,962 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:49,963 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:58:49,963 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:49,963 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:49,963 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:49,964 - poker_game - INFO - Community cards: []
2025-10-31 18:58:49,964 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:49,964 - poker_game - INFO -   P1(Agent1): chips=3094, bet=10, status=active
2025-10-31 18:58:49,965 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:49,965 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:49,965 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:49,966 - poker_game - INFO - ==================================================
2025-10-31 18:58:49,966 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 10
2025-10-31 18:58:49,980 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:49,981 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:49,985 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:49,985 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:58:49,985 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:49,986 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:49,986 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:49,986 - poker_game - INFO - Community cards: []
2025-10-31 18:58:49,987 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:49,987 - poker_game - INFO -   P1(Agent1): chips=3084, bet=20, status=active
2025-10-31 18:58:49,988 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:49,988 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:49,988 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:49,989 - poker_game - INFO - Extra: Action: Player 1 called 10
2025-10-31 18:58:49,989 - poker_game - INFO - ==================================================
2025-10-31 18:58:49,990 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:49,990 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:49,990 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:58:49,990 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:58:49,991 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:49,991 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:49,991 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:49,991 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:58:49,991 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:58:49,992 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 18:58:49,992 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:58:49,992 - poker_game - DEBUG - Next after last raiser 3: 1
2025-10-31 18:58:49,992 - poker_game - DEBUG - Betting continues: Current player 3 != next after raiser 1
2025-10-31 18:58:49,992 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:49,993 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:49,993 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:49,993 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:58:49,994 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:49,994 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:49,994 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:49,994 - poker_game - INFO - Community cards: []
2025-10-31 18:58:49,995 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:49,995 - poker_game - INFO -   P1(Agent1): chips=3084, bet=20, status=active
2025-10-31 18:58:49,995 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:49,995 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:49,996 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:49,997 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:49,997 - poker_game - INFO - ==================================================
2025-10-31 18:58:50,100 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "8♥",
    "6♠"
  ],
  "community": [],
  "your_chips": 1437,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3084,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (1437)"
  ],
  "history": [
    "Player 1 called 99",
    "Player 3 called 99",
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10"
  ]
}
2025-10-31 18:58:50,112 - poker_game - DEBUG - Create Session: {'id': 'e563e348-8c07-457b-931c-20d494013e09', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904730.108981}
2025-10-31 18:58:52,532 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "Preflop（フロップが開かれる前の段階）で、あなたの手札は8♥6♠です。これは、フロップでストレート（連続した数字の組み合わせ）やフラッシュ（同じスートの組み合わせ）を作るのに役立つ可能性がありますが、現時点では強い役ではありません。ポットは40で、コールに必要な金額は0です。これは、あなたが既にビッグブラインド（BB）を支払っており、他のプレイヤーがレイズしていないためです。したがって、チェック（ベットせずに次のプレイヤーに番を回すこと）と同じ行動をとることができます。相手（Player 1）がレイズしていないので、コール（相手のベット額と同じ額を支払うこと）は0となります。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 176, 'promptTokenCount': 892, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 892}], 'totalTokenCount': 1068}, 'invocationId': 'e-ac3b647e-db2b-42c9-971e-9c42612680a5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QxUubnid', 'timestamp': 1761904730.12518}]
2025-10-31 18:58:52,533 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:58:52,533 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "Preflop（フロップが開かれる前の段階）で、あなたの手札は8♥6♠です。これは、フロップでストレート（連続した数字の組み合わせ）やフラッシュ（同じスートの組み合わせ）を作るのに役立つ可能性がありますが、現時点では強い役ではありません。ポットは40で、コールに必要な金額は0です。これは、あなたが既にビッグブラインド（BB）を支払っており、他のプレイヤーがレイズしていないためです。したがって、チェック（ベットせずに次のプレイヤーに番を回すこと）と同じ行動をとることができます。相手（Player 1）がレイズしていないので、コール（相手のベット額と同じ額を支払うこと）は0となります。"
}
```
2025-10-31 18:58:52,533 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:58:52,534 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "Preflop（フロップが開かれる前の段階）で、あなたの手札は8♥6♠です。これは、フロップでストレート（連続した数字の組み合わせ）やフラッシュ（同じスートの組み合わせ）を作るのに役立つ可能性がありますが、現時点では強い役ではありません。ポットは40で、コールに必要な金額は0です。これは、あなたが既にビッグブラインド（BB）を支払っており、他のプレイヤーがレイズしていないためです。したがって、チェック（ベットせずに次のプレイヤーに番を回すこと）と同じ行動をとることができます。相手（Player 1）がレイズしていないので、コール（相手のベット額と同じ額を支払うこと）は0となります。"\n}\n```'
2025-10-31 18:58:52,534 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:58:52,534 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "Preflop（フロップが開かれる前の段階）で、あなたの手札は8♥6♠です。これは、フロップでストレート（連続した数字の組み合わせ）やフラッシュ（同じスートの組み合わせ）を作るのに役立つ可能性がありますが、現時点では強い役ではありません。ポットは40で、コールに必要な金額は0です。これは、あなたが既にビッグブラインド（BB）を支払っており、他のプレイヤーがレイズしていないためです。したがって、チェック（ベットせずに次のプレイヤーに番を回すこと）と同じ行動をとることができます。相手（Player 1）がレイズしていないので、コール（相手のベット額と同じ額を支払うこと）は0となります。"\n}'
2025-10-31 18:58:52,534 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "Preflop（フロップが開かれる前の段階）で、あなたの手札は8♥6♠です。これは、フロップでストレート（連続した数字の組み合わせ）やフラッシュ（同じスートの組み合わせ）を作るのに役立つ可能性がありますが、現時点では強い役ではありません。ポットは40で、コールに必要な金額は0です。これは、あなたが既にビッグブラインド（BB）を支払っており、他のプレイヤーがレイズしていないためです。したがって、チェック（ベットせずに次のプレイヤーに番を回すこと）と同じ行動をとることができます。相手（Player 1）がレイズしていないので、コール（相手のベット額と同じ額を支払うこと）は0となります。"
}
2025-10-31 18:58:52,535 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': 'Preflop（フロップが開かれる前の段階）で、あなたの手札は8♥6♠です。これは、フロップでストレート（連続した数字の組み合わせ）やフラッシュ（同じスートの組み合わせ）を作るのに役立つ可能性がありますが、現時点では強い役ではありません。ポットは40で、コールに必要な金額は0です。これは、あなたが既にビッグブラインド（BB）を支払っており、他のプレイヤーがレイズしていないためです。したがって、チェック（ベットせずに次のプレイヤーに番を回すこと）と同じ行動をとることができます。相手（Player 1）がレイズしていないので、コール（相手のベット額と同じ額を支払うこと）は0となります。'}
2025-10-31 18:58:52,535 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 0
2025-10-31 18:58:52,535 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (1437)']
2025-10-31 18:58:52,535 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:58:52,536 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 0, Preflop（フロップが開かれる前の段階）で、あなたの手札は8♥6♠です。これは、フロップでストレート（連続した数字の組み合わせ）やフラッシュ（同じスートの組み合わせ）を作るのに役立つ可能性がありますが、現時点では強い役ではありません。ポットは40で、コールに必要な金額は0です。これは、あなたが既にビッグブラインド（BB）を支払っており、他のプレイヤーがレイズしていないためです。したがって、チェック（ベットせずに次のプレイヤーに番を回すこと）と同じ行動をとることができます。相手（Player 1）がレイズしていないので、コール（相手のベット額と同じ額を支払うこと）は0となります。
2025-10-31 18:58:52,537 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 0
2025-10-31 18:58:52,537 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:52,538 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:52,538 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:52,539 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:58:52,539 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:52,539 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:52,540 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:52,540 - poker_game - INFO - Community cards: []
2025-10-31 18:58:52,540 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:52,541 - poker_game - INFO -   P1(Agent1): chips=3084, bet=20, status=active
2025-10-31 18:58:52,541 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:52,541 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:52,542 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:52,542 - poker_game - INFO - ==================================================
2025-10-31 18:58:52,543 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:58:52,559 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:52,560 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:52,560 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:52,561 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:58:52,561 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:52,562 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:52,562 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:52,562 - poker_game - INFO - Community cards: []
2025-10-31 18:58:52,563 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:52,563 - poker_game - INFO -   P1(Agent1): chips=3084, bet=20, status=active
2025-10-31 18:58:52,563 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:52,564 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:52,564 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:52,564 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:58:52,565 - poker_game - INFO - ==================================================
2025-10-31 18:58:52,565 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:52,565 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:52,565 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:58:52,566 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 18:58:52,566 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:52,566 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:52,567 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:52,567 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 18:58:52,567 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:58:52,567 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 18:58:52,568 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:58:52,568 - poker_game - DEBUG - Next after last raiser 3: 1
2025-10-31 18:58:52,568 - poker_game - INFO - Betting complete: Back to player 1 after last raiser 3
2025-10-31 18:58:52,569 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:52,569 - poker_game - INFO - Hand #19, Phase: preflop
2025-10-31 18:58:52,569 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:52,570 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 18:58:52,570 - poker_game - INFO - Last raiser: 3
2025-10-31 18:58:52,571 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:52,573 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:52,573 - poker_game - INFO - Community cards: []
2025-10-31 18:58:52,574 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:52,574 - poker_game - INFO -   P1(Agent1): chips=3084, bet=20, status=active
2025-10-31 18:58:52,575 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:52,575 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 18:58:52,576 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:52,576 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:58:52,576 - poker_game - INFO - ==================================================
2025-10-31 18:58:52,678 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:58:52,679 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:52,679 - poker_game - INFO - Remaining players: 2
2025-10-31 18:58:52,680 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:58:52,680 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:58:52,680 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:58:52,694 - poker_game - INFO - Starting new betting round
2025-10-31 18:58:52,695 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:58:52,695 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:58:52,696 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 18:58:52,696 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:58:52,696 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 18:58:52,697 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:58:52,697 - poker_game - INFO - Hand #19, Phase: flop
2025-10-31 18:58:52,697 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:52,698 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:52,698 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:52,698 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:52,699 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:52,699 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠']
2025-10-31 18:58:52,699 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:52,700 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:52,700 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:52,700 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:52,701 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:52,703 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:58:52,704 - poker_game - INFO - ==================================================
2025-10-31 18:58:52,707 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "Q♣",
    "9♥"
  ],
  "community": [
    "5♥",
    "6♥",
    "9♠"
  ],
  "your_chips": 3084,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3084)"
  ],
  "history": [
    "River dealt: 5♠",
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠"
  ]
}
2025-10-31 18:58:52,726 - poker_game - DEBUG - Create Session: {'id': 'f6614faa-593e-475c-a987-9be66d9cf594', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904732.7230217}
2025-10-31 18:58:55,314 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ (Flop) は 5♥ 6♥ 9♠ で、あなたの手札は Q♣ 9♥ です。これにより、9 のワンペア (one pair) が完成しました。これは、現在のボードではそこそこ強いハンドですが、相手がより強いペアを持っている可能性もあります。ポット (Pot) は 40 で、コール (Call) する必要はありません (to_call: 0) 。相手のプレイヤー 3 のアクションがまだ不明なので、まずはチェック (check) して、相手のアクションを見てから判断するのが最善です。もし相手がベット (bet) してきたら、その額を見てコールするかフォールド (fold) するか、あるいはレイズ (raise) するかを考えます。相手のプレイヤー 4 はすでにフォールドしているので、考慮する必要はありません。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 201, 'promptTokenCount': 915, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 915}], 'totalTokenCount': 1116}, 'invocationId': 'e-0c29cea9-fb56-41ec-8fd7-fe193ce8510d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'KF2VEhku', 'timestamp': 1761904732.742567}]
2025-10-31 18:58:55,315 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:58:55,316 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ (Flop) は 5♥ 6♥ 9♠ で、あなたの手札は Q♣ 9♥ です。これにより、9 のワンペア (one pair) が完成しました。これは、現在のボードではそこそこ強いハンドですが、相手がより強いペアを持っている可能性もあります。ポット (Pot) は 40 で、コール (Call) する必要はありません (to_call: 0) 。相手のプレイヤー 3 のアクションがまだ不明なので、まずはチェック (check) して、相手のアクションを見てから判断するのが最善です。もし相手がベット (bet) してきたら、その額を見てコールするかフォールド (fold) するか、あるいはレイズ (raise) するかを考えます。相手のプレイヤー 4 はすでにフォールドしているので、考慮する必要はありません。"
}
```
2025-10-31 18:58:55,316 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:58:55,316 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ (Flop) は 5♥ 6♥ 9♠ で、あなたの手札は Q♣ 9♥ です。これにより、9 のワンペア (one pair) が完成しました。これは、現在のボードではそこそこ強いハンドですが、相手がより強いペアを持っている可能性もあります。ポット (Pot) は 40 で、コール (Call) する必要はありません (to_call: 0) 。相手のプレイヤー 3 のアクションがまだ不明なので、まずはチェック (check) して、相手のアクションを見てから判断するのが最善です。もし相手がベット (bet) してきたら、その額を見てコールするかフォールド (fold) するか、あるいはレイズ (raise) するかを考えます。相手のプレイヤー 4 はすでにフォールドしているので、考慮する必要はありません。"\n}\n```'
2025-10-31 18:58:55,316 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:58:55,317 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ (Flop) は 5♥ 6♥ 9♠ で、あなたの手札は Q♣ 9♥ です。これにより、9 のワンペア (one pair) が完成しました。これは、現在のボードではそこそこ強いハンドですが、相手がより強いペアを持っている可能性もあります。ポット (Pot) は 40 で、コール (Call) する必要はありません (to_call: 0) 。相手のプレイヤー 3 のアクションがまだ不明なので、まずはチェック (check) して、相手のアクションを見てから判断するのが最善です。もし相手がベット (bet) してきたら、その額を見てコールするかフォールド (fold) するか、あるいはレイズ (raise) するかを考えます。相手のプレイヤー 4 はすでにフォールドしているので、考慮する必要はありません。"\n}'
2025-10-31 18:58:55,317 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ (Flop) は 5♥ 6♥ 9♠ で、あなたの手札は Q♣ 9♥ です。これにより、9 のワンペア (one pair) が完成しました。これは、現在のボードではそこそこ強いハンドですが、相手がより強いペアを持っている可能性もあります。ポット (Pot) は 40 で、コール (Call) する必要はありません (to_call: 0) 。相手のプレイヤー 3 のアクションがまだ不明なので、まずはチェック (check) して、相手のアクションを見てから判断するのが最善です。もし相手がベット (bet) してきたら、その額を見てコールするかフォールド (fold) するか、あるいはレイズ (raise) するかを考えます。相手のプレイヤー 4 はすでにフォールドしているので、考慮する必要はありません。"
}
2025-10-31 18:58:55,317 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ (Flop) は 5♥ 6♥ 9♠ で、あなたの手札は Q♣ 9♥ です。これにより、9 のワンペア (one pair) が完成しました。これは、現在のボードではそこそこ強いハンドですが、相手がより強いペアを持っている可能性もあります。ポット (Pot) は 40 で、コール (Call) する必要はありません (to_call: 0) 。相手のプレイヤー 3 のアクションがまだ不明なので、まずはチェック (check) して、相手のアクションを見てから判断するのが最善です。もし相手がベット (bet) してきたら、その額を見てコールするかフォールド (fold) するか、あるいはレイズ (raise) するかを考えます。相手のプレイヤー 4 はすでにフォールドしているので、考慮する必要はありません。'}
2025-10-31 18:58:55,318 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 18:58:55,318 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 18:58:55,318 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:58:55,318 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, フロップ (Flop) は 5♥ 6♥ 9♠ で、あなたの手札は Q♣ 9♥ です。これにより、9 のワンペア (one pair) が完成しました。これは、現在のボードではそこそこ強いハンドですが、相手がより強いペアを持っている可能性もあります。ポット (Pot) は 40 で、コール (Call) する必要はありません (to_call: 0) 。相手のプレイヤー 3 のアクションがまだ不明なので、まずはチェック (check) して、相手のアクションを見てから判断するのが最善です。もし相手がベット (bet) してきたら、その額を見てコールするかフォールド (fold) するか、あるいはレイズ (raise) するかを考えます。相手のプレイヤー 4 はすでにフォールドしているので、考慮する必要はありません。
2025-10-31 18:58:55,319 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 18:58:55,320 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:55,320 - poker_game - INFO - Hand #19, Phase: flop
2025-10-31 18:58:55,320 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:55,321 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:55,321 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:55,322 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:55,322 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:55,322 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠']
2025-10-31 18:58:55,323 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:55,323 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:55,323 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:55,324 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:55,324 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:55,325 - poker_game - INFO - ==================================================
2025-10-31 18:58:55,325 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:58:55,338 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:55,339 - poker_game - INFO - Hand #19, Phase: flop
2025-10-31 18:58:55,339 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:55,339 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:55,340 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:55,340 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:55,340 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:55,341 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠']
2025-10-31 18:58:55,341 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:55,342 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:55,342 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:55,343 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:55,343 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:55,343 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:58:55,344 - poker_game - INFO - ==================================================
2025-10-31 18:58:55,344 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:55,345 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:55,345 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:58:55,345 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:58:55,346 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:55,346 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:55,346 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:55,347 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:58:55,347 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:58:55,347 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:58:55,347 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:58:55,348 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:58:55,348 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 1
2025-10-31 18:58:55,348 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:55,348 - poker_game - INFO - Hand #19, Phase: flop
2025-10-31 18:58:55,349 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:55,349 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:55,349 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:55,349 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:55,350 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:55,350 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠']
2025-10-31 18:58:55,351 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:55,351 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:55,351 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:55,351 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:55,352 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:55,353 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:55,353 - poker_game - INFO - ==================================================
2025-10-31 18:58:55,454 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "8♥",
    "6♠"
  ],
  "community": [
    "5♥",
    "6♥",
    "9♠"
  ],
  "your_chips": 1437,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3084,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1437)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 raised to 295",
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked"
  ]
}
2025-10-31 18:58:55,576 - poker_game - DEBUG - Create Session: {'id': 'e484e8c1-adda-459e-aaa3-5b3837fd4e75', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904735.5738266}
2025-10-31 18:58:55,276 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（コミュニティカードが開かれた段階）で、あなたの手札は8♥6♠、コミュニティカードは5♥6♥9♠です。これにより、あなたはワンペア（6のペア）ができています。これは比較的弱いハンドですが、まだ勝てる可能性もあります。ポットは40で、コール額は0なので、チェック（ベットせずに次のアクションを待つ）を選択するのが合理的です。対戦相手のうち、プレーヤー4はフォールドしており、プレーヤー1はチェックしているので、リスクを冒さずに次のカード（ターン）を見るのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 153, 'promptTokenCount': 913, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 913}], 'totalTokenCount': 1066}, 'invocationId': 'e-a7fce3ef-a3ed-4e93-8186-fea68085b722', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'cnh8n2GL', 'timestamp': 1761904735.587089}]
2025-10-31 18:58:55,277 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:58:55,277 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（コミュニティカードが開かれた段階）で、あなたの手札は8♥6♠、コミュニティカードは5♥6♥9♠です。これにより、あなたはワンペア（6のペア）ができています。これは比較的弱いハンドですが、まだ勝てる可能性もあります。ポットは40で、コール額は0なので、チェック（ベットせずに次のアクションを待つ）を選択するのが合理的です。対戦相手のうち、プレーヤー4はフォールドしており、プレーヤー1はチェックしているので、リスクを冒さずに次のカード（ターン）を見るのが最善です。"
}
```
2025-10-31 18:58:55,278 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:58:55,278 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（コミュニティカードが開かれた段階）で、あなたの手札は8♥6♠、コミュニティカードは5♥6♥9♠です。これにより、あなたはワンペア（6のペア）ができています。これは比較的弱いハンドですが、まだ勝てる可能性もあります。ポットは40で、コール額は0なので、チェック（ベットせずに次のアクションを待つ）を選択するのが合理的です。対戦相手のうち、プレーヤー4はフォールドしており、プレーヤー1はチェックしているので、リスクを冒さずに次のカード（ターン）を見るのが最善です。"\n}\n```'
2025-10-31 18:58:55,278 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:58:55,278 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（コミュニティカードが開かれた段階）で、あなたの手札は8♥6♠、コミュニティカードは5♥6♥9♠です。これにより、あなたはワンペア（6のペア）ができています。これは比較的弱いハンドですが、まだ勝てる可能性もあります。ポットは40で、コール額は0なので、チェック（ベットせずに次のアクションを待つ）を選択するのが合理的です。対戦相手のうち、プレーヤー4はフォールドしており、プレーヤー1はチェックしているので、リスクを冒さずに次のカード（ターン）を見るのが最善です。"\n}'
2025-10-31 18:58:55,279 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（コミュニティカードが開かれた段階）で、あなたの手札は8♥6♠、コミュニティカードは5♥6♥9♠です。これにより、あなたはワンペア（6のペア）ができています。これは比較的弱いハンドですが、まだ勝てる可能性もあります。ポットは40で、コール額は0なので、チェック（ベットせずに次のアクションを待つ）を選択するのが合理的です。対戦相手のうち、プレーヤー4はフォールドしており、プレーヤー1はチェックしているので、リスクを冒さずに次のカード（ターン）を見るのが最善です。"
}
2025-10-31 18:58:55,279 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（コミュニティカードが開かれた段階）で、あなたの手札は8♥6♠、コミュニティカードは5♥6♥9♠です。これにより、あなたはワンペア（6のペア）ができています。これは比較的弱いハンドですが、まだ勝てる可能性もあります。ポットは40で、コール額は0なので、チェック（ベットせずに次のアクションを待つ）を選択するのが合理的です。対戦相手のうち、プレーヤー4はフォールドしており、プレーヤー1はチェックしているので、リスクを冒さずに次のカード（ターン）を見るのが最善です。'}
2025-10-31 18:58:55,279 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:58:55,280 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:58:55,280 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:58:55,280 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, フロップ（コミュニティカードが開かれた段階）で、あなたの手札は8♥6♠、コミュニティカードは5♥6♥9♠です。これにより、あなたはワンペア（6のペア）ができています。これは比較的弱いハンドですが、まだ勝てる可能性もあります。ポットは40で、コール額は0なので、チェック（ベットせずに次のアクションを待つ）を選択するのが合理的です。対戦相手のうち、プレーヤー4はフォールドしており、プレーヤー1はチェックしているので、リスクを冒さずに次のカード（ターン）を見るのが最善です。
2025-10-31 18:58:55,281 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:58:55,282 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:55,282 - poker_game - INFO - Hand #19, Phase: flop
2025-10-31 18:58:55,283 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:55,283 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:55,284 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:55,284 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:55,285 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:55,285 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠']
2025-10-31 18:58:55,286 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:55,286 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:55,287 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:55,287 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:55,287 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:55,288 - poker_game - INFO - ==================================================
2025-10-31 18:58:55,288 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:58:55,301 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:55,301 - poker_game - INFO - Hand #19, Phase: flop
2025-10-31 18:58:55,302 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:55,302 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:55,303 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:55,303 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:55,304 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:55,304 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠']
2025-10-31 18:58:55,305 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:55,305 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:55,306 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:55,306 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:55,306 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:55,307 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:58:55,307 - poker_game - INFO - ==================================================
2025-10-31 18:58:55,308 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:55,308 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:55,308 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:58:55,309 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 18:58:55,309 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:55,309 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:55,310 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:55,310 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:58:55,310 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:58:55,310 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:58:55,310 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:58:55,310 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:58:55,311 - poker_game - INFO - Betting complete: Back to first actor 1 (all players have acted)
2025-10-31 18:58:55,311 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:55,312 - poker_game - INFO - Hand #19, Phase: flop
2025-10-31 18:58:55,312 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:55,312 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:55,313 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:55,313 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:55,313 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:55,314 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠']
2025-10-31 18:58:55,314 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:55,314 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:55,314 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:55,315 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:55,315 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:55,316 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:58:55,316 - poker_game - INFO - ==================================================
2025-10-31 18:58:55,417 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 18:58:55,418 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:55,418 - poker_game - INFO - Remaining players: 2
2025-10-31 18:58:55,419 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:58:55,419 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:58:55,419 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 18:58:55,431 - poker_game - INFO - Starting new betting round
2025-10-31 18:58:55,432 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:58:55,432 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:58:55,433 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 18:58:55,434 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:58:55,434 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 18:58:55,434 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:58:55,435 - poker_game - INFO - Hand #19, Phase: turn
2025-10-31 18:58:55,435 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:55,436 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:55,436 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:55,437 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:55,437 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:55,437 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦']
2025-10-31 18:58:55,438 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:55,438 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:55,439 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:55,439 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:55,439 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:55,440 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 18:58:55,440 - poker_game - INFO - ==================================================
2025-10-31 18:58:55,441 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "Q♣",
    "9♥"
  ],
  "community": [
    "5♥",
    "6♥",
    "9♠",
    "2♦"
  ],
  "your_chips": 3084,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3084)"
  ],
  "history": [
    "Player 1 called 295",
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦"
  ]
}
2025-10-31 18:58:55,457 - poker_game - DEBUG - Create Session: {'id': 'd3718c58-dd0a-467f-8bad-9157a672db25', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904735.4536653}
2025-10-31 18:58:57,504 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたの手札（Q♣, 9♥）は、ボード（5♥, 6♥, 9♠, 2♦）のナインとペアになっています。これは悪くないハンドですが、強力なハンドとは言えません。相手（プレイヤー3）はまだアクションを起こしておらず、チェックをする可能性があります。相手がベットしてきた場合、その強さを見てから判断するのが賢明です。したがって、ここではチェックして、相手のアクションを見守るのが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 138, 'promptTokenCount': 916, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 916}], 'totalTokenCount': 1054}, 'invocationId': 'e-6ab1d42e-b92a-4efc-9013-1094cf7c54bb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'URaZ07ub', 'timestamp': 1761904735.469168}]
2025-10-31 18:58:57,506 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:58:57,506 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "現在の状況では、あなたの手札（Q♣, 9♥）は、ボード（5♥, 6♥, 9♠, 2♦）のナインとペアになっています。これは悪くないハンドですが、強力なハンドとは言えません。相手（プレイヤー3）はまだアクションを起こしておらず、チェックをする可能性があります。相手がベットしてきた場合、その強さを見てから判断するのが賢明です。したがって、ここではチェックして、相手のアクションを見守るのが最善の選択です。"
}
```
2025-10-31 18:58:57,507 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:58:57,507 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたの手札（Q♣, 9♥）は、ボード（5♥, 6♥, 9♠, 2♦）のナインとペアになっています。これは悪くないハンドですが、強力なハンドとは言えません。相手（プレイヤー3）はまだアクションを起こしておらず、チェックをする可能性があります。相手がベットしてきた場合、その強さを見てから判断するのが賢明です。したがって、ここではチェックして、相手のアクションを見守るのが最善の選択です。"\n}\n```'
2025-10-31 18:58:57,507 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:58:57,508 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたの手札（Q♣, 9♥）は、ボード（5♥, 6♥, 9♠, 2♦）のナインとペアになっています。これは悪くないハンドですが、強力なハンドとは言えません。相手（プレイヤー3）はまだアクションを起こしておらず、チェックをする可能性があります。相手がベットしてきた場合、その強さを見てから判断するのが賢明です。したがって、ここではチェックして、相手のアクションを見守るのが最善の選択です。"\n}'
2025-10-31 18:58:57,508 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "現在の状況では、あなたの手札（Q♣, 9♥）は、ボード（5♥, 6♥, 9♠, 2♦）のナインとペアになっています。これは悪くないハンドですが、強力なハンドとは言えません。相手（プレイヤー3）はまだアクションを起こしておらず、チェックをする可能性があります。相手がベットしてきた場合、その強さを見てから判断するのが賢明です。したがって、ここではチェックして、相手のアクションを見守るのが最善の選択です。"
}
2025-10-31 18:58:57,508 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '現在の状況では、あなたの手札（Q♣, 9♥）は、ボード（5♥, 6♥, 9♠, 2♦）のナインとペアになっています。これは悪くないハンドですが、強力なハンドとは言えません。相手（プレイヤー3）はまだアクションを起こしておらず、チェックをする可能性があります。相手がベットしてきた場合、その強さを見てから判断するのが賢明です。したがって、ここではチェックして、相手のアクションを見守るのが最善の選択です。'}
2025-10-31 18:58:57,508 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 18:58:57,508 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 18:58:57,509 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:58:57,509 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, 現在の状況では、あなたの手札（Q♣, 9♥）は、ボード（5♥, 6♥, 9♠, 2♦）のナインとペアになっています。これは悪くないハンドですが、強力なハンドとは言えません。相手（プレイヤー3）はまだアクションを起こしておらず、チェックをする可能性があります。相手がベットしてきた場合、その強さを見てから判断するのが賢明です。したがって、ここではチェックして、相手のアクションを見守るのが最善の選択です。
2025-10-31 18:58:57,510 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 18:58:57,511 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:57,511 - poker_game - INFO - Hand #19, Phase: turn
2025-10-31 18:58:57,512 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:57,512 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:57,512 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:57,513 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:57,523 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:57,524 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦']
2025-10-31 18:58:57,524 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:57,525 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:57,525 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:57,526 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:57,526 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:57,527 - poker_game - INFO - ==================================================
2025-10-31 18:58:57,527 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:58:57,550 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:57,551 - poker_game - INFO - Hand #19, Phase: turn
2025-10-31 18:58:57,552 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:57,552 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:57,553 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:57,553 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:57,554 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:57,554 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦']
2025-10-31 18:58:57,555 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:57,555 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:57,556 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:57,556 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:57,556 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:57,557 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:58:57,557 - poker_game - INFO - ==================================================
2025-10-31 18:58:57,557 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:57,558 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:57,558 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:58:57,558 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:58:57,559 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:57,559 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:57,559 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:57,559 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:58:57,559 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:58:57,560 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:58:57,560 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:58:57,560 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:58:57,560 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 1
2025-10-31 18:58:57,560 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:57,561 - poker_game - INFO - Hand #19, Phase: turn
2025-10-31 18:58:57,561 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:57,564 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:57,564 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:57,565 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:57,566 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:57,567 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦']
2025-10-31 18:58:57,568 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:57,569 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:57,569 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:57,570 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:57,570 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:57,571 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:58:57,571 - poker_game - INFO - ==================================================
2025-10-31 18:58:57,674 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "8♥",
    "6♠"
  ],
  "community": [
    "5♥",
    "6♥",
    "9♠",
    "2♦"
  ],
  "your_chips": 1437,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3084,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1437)"
  ],
  "history": [
    "Player 3 called 295",
    "Showdown: Player 1 hand=One Pair: 8s - Q♦, J♣, 9♦, 8♥, 8♦ cards=8♥, 9♦",
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked"
  ]
}
2025-10-31 18:58:57,691 - poker_game - DEBUG - Create Session: {'id': '7aeb8ddc-4ac0-4ecd-b28f-9785ad2560d8', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904737.6871529}
2025-10-31 18:58:59,458 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたは2ペア（6のペアと8のペア）を持っています。これは強いハンドですが、コミュニティカードにはストレート（5-6-7-8-9）やフラッシュの可能性もあります。対戦相手（Player 1）はチェックを続けており、あまりアグレッシブではありません。ポットサイズもそれほど大きくないので、リスクを抑えてコールするのが最善と判断しました。このラウンドでのベット額（your_bet_this_round）は0で、コールする必要のある額（to_call）も0なので、チェックで進行するのが合理的です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 159, 'promptTokenCount': 912, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 912}], 'totalTokenCount': 1071}, 'invocationId': 'e-831ad937-91b0-43e1-9fc3-a9004fee9c6e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'HS5Kquxh', 'timestamp': 1761904737.706434}]
2025-10-31 18:58:59,459 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:58:59,459 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "現在の状況では、あなたは2ペア（6のペアと8のペア）を持っています。これは強いハンドですが、コミュニティカードにはストレート（5-6-7-8-9）やフラッシュの可能性もあります。対戦相手（Player 1）はチェックを続けており、あまりアグレッシブではありません。ポットサイズもそれほど大きくないので、リスクを抑えてコールするのが最善と判断しました。このラウンドでのベット額（your_bet_this_round）は0で、コールする必要のある額（to_call）も0なので、チェックで進行するのが合理的です。"
}
```
2025-10-31 18:58:59,459 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:58:59,460 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたは2ペア（6のペアと8のペア）を持っています。これは強いハンドですが、コミュニティカードにはストレート（5-6-7-8-9）やフラッシュの可能性もあります。対戦相手（Player 1）はチェックを続けており、あまりアグレッシブではありません。ポットサイズもそれほど大きくないので、リスクを抑えてコールするのが最善と判断しました。このラウンドでのベット額（your_bet_this_round）は0で、コールする必要のある額（to_call）も0なので、チェックで進行するのが合理的です。"\n}\n```'
2025-10-31 18:58:59,460 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:58:59,460 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたは2ペア（6のペアと8のペア）を持っています。これは強いハンドですが、コミュニティカードにはストレート（5-6-7-8-9）やフラッシュの可能性もあります。対戦相手（Player 1）はチェックを続けており、あまりアグレッシブではありません。ポットサイズもそれほど大きくないので、リスクを抑えてコールするのが最善と判断しました。このラウンドでのベット額（your_bet_this_round）は0で、コールする必要のある額（to_call）も0なので、チェックで進行するのが合理的です。"\n}'
2025-10-31 18:58:59,460 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "現在の状況では、あなたは2ペア（6のペアと8のペア）を持っています。これは強いハンドですが、コミュニティカードにはストレート（5-6-7-8-9）やフラッシュの可能性もあります。対戦相手（Player 1）はチェックを続けており、あまりアグレッシブではありません。ポットサイズもそれほど大きくないので、リスクを抑えてコールするのが最善と判断しました。このラウンドでのベット額（your_bet_this_round）は0で、コールする必要のある額（to_call）も0なので、チェックで進行するのが合理的です。"
}
2025-10-31 18:58:59,460 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': '現在の状況では、あなたは2ペア（6のペアと8のペア）を持っています。これは強いハンドですが、コミュニティカードにはストレート（5-6-7-8-9）やフラッシュの可能性もあります。対戦相手（Player 1）はチェックを続けており、あまりアグレッシブではありません。ポットサイズもそれほど大きくないので、リスクを抑えてコールするのが最善と判断しました。このラウンドでのベット額（your_bet_this_round）は0で、コールする必要のある額（to_call）も0なので、チェックで進行するのが合理的です。'}
2025-10-31 18:58:59,461 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 0
2025-10-31 18:58:59,461 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1437)']
2025-10-31 18:58:59,461 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 18:58:59,461 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 0, 現在の状況では、あなたは2ペア（6のペアと8のペア）を持っています。これは強いハンドですが、コミュニティカードにはストレート（5-6-7-8-9）やフラッシュの可能性もあります。対戦相手（Player 1）はチェックを続けており、あまりアグレッシブではありません。ポットサイズもそれほど大きくないので、リスクを抑えてコールするのが最善と判断しました。このラウンドでのベット額（your_bet_this_round）は0で、コールする必要のある額（to_call）も0なので、チェックで進行するのが合理的です。
2025-10-31 18:58:59,462 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 0
2025-10-31 18:58:59,463 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:58:59,463 - poker_game - INFO - Hand #19, Phase: turn
2025-10-31 18:58:59,463 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:59,464 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:59,464 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:59,465 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:59,465 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:59,466 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦']
2025-10-31 18:58:59,466 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:59,467 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:59,467 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:59,467 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:59,468 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:59,469 - poker_game - INFO - ==================================================
2025-10-31 18:58:59,470 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:58:59,481 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:58:59,481 - poker_game - INFO - Hand #19, Phase: turn
2025-10-31 18:58:59,482 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:58:59,482 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:59,483 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:59,483 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:59,484 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:59,484 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦']
2025-10-31 18:58:59,484 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:59,485 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:59,485 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:59,485 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:59,486 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:59,486 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:58:59,486 - poker_game - INFO - ==================================================
2025-10-31 18:58:59,487 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:58:59,487 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:58:59,487 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:58:59,488 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 18:58:59,488 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:58:59,489 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:58:59,489 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:58:59,489 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:58:59,489 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:58:59,489 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:58:59,489 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:58:59,490 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:58:59,490 - poker_game - INFO - Betting complete: Back to first actor 1 (all players have acted)
2025-10-31 18:58:59,490 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:58:59,490 - poker_game - INFO - Hand #19, Phase: turn
2025-10-31 18:58:59,490 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:59,491 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:59,491 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:59,492 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:59,492 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:59,493 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦']
2025-10-31 18:58:59,493 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:59,493 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:59,494 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:59,494 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:59,496 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:59,496 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:58:59,497 - poker_game - INFO - ==================================================
2025-10-31 18:58:59,598 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 18:58:59,599 - poker_game - INFO - Betting round complete: True
2025-10-31 18:58:59,599 - poker_game - INFO - Remaining players: 2
2025-10-31 18:58:59,600 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:58:59,600 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:58:59,600 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 18:58:59,612 - poker_game - INFO - Starting new betting round
2025-10-31 18:58:59,613 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:58:59,613 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:58:59,614 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 18:58:59,614 - poker_game - DEBUG - Dealer button: 4
2025-10-31 18:58:59,614 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 18:58:59,615 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:58:59,615 - poker_game - INFO - Hand #19, Phase: river
2025-10-31 18:58:59,616 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:58:59,616 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:58:59,617 - poker_game - INFO - Last raiser: None
2025-10-31 18:58:59,618 - poker_game - INFO - Betting round complete: False
2025-10-31 18:58:59,618 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:58:59,619 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:58:59,619 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:58:59,620 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:58:59,620 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:58:59,621 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:58:59,621 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:58:59,622 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 18:58:59,622 - poker_game - INFO - ==================================================
2025-10-31 18:58:59,623 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "Q♣",
    "9♥"
  ],
  "community": [
    "5♥",
    "6♥",
    "9♠",
    "2♦",
    "A♦"
  ],
  "your_chips": 3084,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3084)"
  ],
  "history": [
    "Showdown: Player 3 hand=High Card: A♦ - A♦, Q♦, J♣, 9♥, 8♦ cards=A♦, 9♥",
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦"
  ]
}
2025-10-31 18:58:59,638 - poker_game - DEBUG - Create Session: {'id': 'ec155afc-e035-422c-a4bd-6532754528b8', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904739.6351032}
2025-10-31 18:59:02,184 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「Q♣」「9♥」で、コミュニティカードは「5♥」「6♥」「9♠」「2♦」「A♦」です。これにより、あなたのベストハンドは「ペア」で、9のペアができます。しかし、ボードにはA（エース）があり、相手がAを持っている可能性が高いです。過去の履歴を見ると、プリフロップ（最初のカード配布後）であなたはコールしており、フロップ、ターン、リバーとチェックを続けています。相手（プレイヤー3）も同様にチェックを続けているため、お互いに強いハンドを持っていない、あるいは相手もブラフ（はったり）を試みている可能性があります。ポットサイズとあなたのチップ量、そして相手のチップ量を考慮すると、ここでのチェックは、相手のハンドを判断し、もし相手がベットしてきた場合にコールするかフォールドするかを決定するための、リスクの少ない選択です。レイズ（ベット額を上げる）は、相手があなたより強いハンドを持っている可能性が高いため、リスクが高すぎます。オールインも同様です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 258, 'promptTokenCount': 879, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 879}], 'totalTokenCount': 1137}, 'invocationId': 'e-8bbc3aea-c4f1-40c4-9188-bbc239a44676', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'hX3yJUTc', 'timestamp': 1761904739.650135}]
2025-10-31 18:59:02,184 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:59:02,184 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「Q♣」「9♥」で、コミュニティカードは「5♥」「6♥」「9♠」「2♦」「A♦」です。これにより、あなたのベストハンドは「ペア」で、9のペアができます。しかし、ボードにはA（エース）があり、相手がAを持っている可能性が高いです。過去の履歴を見ると、プリフロップ（最初のカード配布後）であなたはコールしており、フロップ、ターン、リバーとチェックを続けています。相手（プレイヤー3）も同様にチェックを続けているため、お互いに強いハンドを持っていない、あるいは相手もブラフ（はったり）を試みている可能性があります。ポットサイズとあなたのチップ量、そして相手のチップ量を考慮すると、ここでのチェックは、相手のハンドを判断し、もし相手がベットしてきた場合にコールするかフォールドするかを決定するための、リスクの少ない選択です。レイズ（ベット額を上げる）は、相手があなたより強いハンドを持っている可能性が高いため、リスクが高すぎます。オールインも同様です。"
}
```
2025-10-31 18:59:02,185 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:59:02,185 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「Q♣」「9♥」で、コミュニティカードは「5♥」「6♥」「9♠」「2♦」「A♦」です。これにより、あなたのベストハンドは「ペア」で、9のペアができます。しかし、ボードにはA（エース）があり、相手がAを持っている可能性が高いです。過去の履歴を見ると、プリフロップ（最初のカード配布後）であなたはコールしており、フロップ、ターン、リバーとチェックを続けています。相手（プレイヤー3）も同様にチェックを続けているため、お互いに強いハンドを持っていない、あるいは相手もブラフ（はったり）を試みている可能性があります。ポットサイズとあなたのチップ量、そして相手のチップ量を考慮すると、ここでのチェックは、相手のハンドを判断し、もし相手がベットしてきた場合にコールするかフォールドするかを決定するための、リスクの少ない選択です。レイズ（ベット額を上げる）は、相手があなたより強いハンドを持っている可能性が高いため、リスクが高すぎます。オールインも同様です。"\n}\n```'
2025-10-31 18:59:02,185 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:59:02,185 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「Q♣」「9♥」で、コミュニティカードは「5♥」「6♥」「9♠」「2♦」「A♦」です。これにより、あなたのベストハンドは「ペア」で、9のペアができます。しかし、ボードにはA（エース）があり、相手がAを持っている可能性が高いです。過去の履歴を見ると、プリフロップ（最初のカード配布後）であなたはコールしており、フロップ、ターン、リバーとチェックを続けています。相手（プレイヤー3）も同様にチェックを続けているため、お互いに強いハンドを持っていない、あるいは相手もブラフ（はったり）を試みている可能性があります。ポットサイズとあなたのチップ量、そして相手のチップ量を考慮すると、ここでのチェックは、相手のハンドを判断し、もし相手がベットしてきた場合にコールするかフォールドするかを決定するための、リスクの少ない選択です。レイズ（ベット額を上げる）は、相手があなたより強いハンドを持っている可能性が高いため、リスクが高すぎます。オールインも同様です。"\n}'
2025-10-31 18:59:02,185 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「Q♣」「9♥」で、コミュニティカードは「5♥」「6♥」「9♠」「2♦」「A♦」です。これにより、あなたのベストハンドは「ペア」で、9のペアができます。しかし、ボードにはA（エース）があり、相手がAを持っている可能性が高いです。過去の履歴を見ると、プリフロップ（最初のカード配布後）であなたはコールしており、フロップ、ターン、リバーとチェックを続けています。相手（プレイヤー3）も同様にチェックを続けているため、お互いに強いハンドを持っていない、あるいは相手もブラフ（はったり）を試みている可能性があります。ポットサイズとあなたのチップ量、そして相手のチップ量を考慮すると、ここでのチェックは、相手のハンドを判断し、もし相手がベットしてきた場合にコールするかフォールドするかを決定するための、リスクの少ない選択です。レイズ（ベット額を上げる）は、相手があなたより強いハンドを持っている可能性が高いため、リスクが高すぎます。オールインも同様です。"
}
2025-10-31 18:59:02,185 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最終ラウンド）で、あなたの手札は「Q♣」「9♥」で、コミュニティカードは「5♥」「6♥」「9♠」「2♦」「A♦」です。これにより、あなたのベストハンドは「ペア」で、9のペアができます。しかし、ボードにはA（エース）があり、相手がAを持っている可能性が高いです。過去の履歴を見ると、プリフロップ（最初のカード配布後）であなたはコールしており、フロップ、ターン、リバーとチェックを続けています。相手（プレイヤー3）も同様にチェックを続けているため、お互いに強いハンドを持っていない、あるいは相手もブラフ（はったり）を試みている可能性があります。ポットサイズとあなたのチップ量、そして相手のチップ量を考慮すると、ここでのチェックは、相手のハンドを判断し、もし相手がベットしてきた場合にコールするかフォールドするかを決定するための、リスクの少ない選択です。レイズ（ベット額を上げる）は、相手があなたより強いハンドを持っている可能性が高いため、リスクが高すぎます。オールインも同様です。'}
2025-10-31 18:59:02,185 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 18:59:02,186 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 18:59:02,186 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:59:02,186 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, リバー（最終ラウンド）で、あなたの手札は「Q♣」「9♥」で、コミュニティカードは「5♥」「6♥」「9♠」「2♦」「A♦」です。これにより、あなたのベストハンドは「ペア」で、9のペアができます。しかし、ボードにはA（エース）があり、相手がAを持っている可能性が高いです。過去の履歴を見ると、プリフロップ（最初のカード配布後）であなたはコールしており、フロップ、ターン、リバーとチェックを続けています。相手（プレイヤー3）も同様にチェックを続けているため、お互いに強いハンドを持っていない、あるいは相手もブラフ（はったり）を試みている可能性があります。ポットサイズとあなたのチップ量、そして相手のチップ量を考慮すると、ここでのチェックは、相手のハンドを判断し、もし相手がベットしてきた場合にコールするかフォールドするかを決定するための、リスクの少ない選択です。レイズ（ベット額を上げる）は、相手があなたより強いハンドを持っている可能性が高いため、リスクが高すぎます。オールインも同様です。
2025-10-31 18:59:02,186 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 18:59:02,187 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:59:02,187 - poker_game - INFO - Hand #19, Phase: river
2025-10-31 18:59:02,187 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:59:02,187 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:59:02,188 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:02,188 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:02,188 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:59:02,188 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:02,188 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:02,188 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:59:02,189 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:02,189 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:59:02,189 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:59:02,189 - poker_game - INFO - ==================================================
2025-10-31 18:59:02,189 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 18:59:02,198 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:59:02,198 - poker_game - INFO - Hand #19, Phase: river
2025-10-31 18:59:02,198 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:59:02,199 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:59:02,199 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:02,199 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:02,199 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:59:02,199 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:02,200 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:02,200 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:59:02,200 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:02,200 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:59:02,201 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:59:02,201 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 18:59:02,201 - poker_game - INFO - ==================================================
2025-10-31 18:59:02,202 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:59:02,202 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:59:02,202 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:59:02,202 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:59:02,202 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:59:02,203 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:59:02,203 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:59:02,203 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:59:02,203 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:59:02,203 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:59:02,203 - poker_game - DEBUG - Current player index: 3
2025-10-31 18:59:02,203 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:59:02,203 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 1
2025-10-31 18:59:02,204 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:59:02,204 - poker_game - INFO - Hand #19, Phase: river
2025-10-31 18:59:02,204 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:59:02,205 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:59:02,205 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:02,205 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:02,205 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:59:02,205 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:02,206 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:02,206 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:59:02,206 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:02,206 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:59:02,206 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:59:02,206 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:59:02,207 - poker_game - INFO - ==================================================
2025-10-31 18:59:02,308 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "8♥",
    "6♠"
  ],
  "community": [
    "5♥",
    "6♥",
    "9♠",
    "2♦",
    "A♦"
  ],
  "your_chips": 1437,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3084,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1437)"
  ],
  "history": [
    "Showdown: Player 4 hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥ cards=7♥, Q♠",
    "Side pot layer 0: amount=1332, winners=4 best_hand=One Pair: Qs - Q♠, Q♦, J♣, 8♦, 7♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked"
  ]
}
2025-10-31 18:59:02,326 - poker_game - DEBUG - Create Session: {'id': 'ed34cac3-03ee-4408-befd-043ff2592259', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904742.3239443}
2025-10-31 18:59:04,335 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「8♥6♥」で、コミュニティカードは「5♥6♥9♠2♦A♦」です。これは、あなたの手札で「6のペア」ができており、ハートのフラッシュ（同じスートのカードが5枚揃うこと）はありません。相手（プレイヤー1）はこれまでチェックを続けており、ポットもそれほど大きくありません。相手が強力なハンドを持っていない可能性が高いため、リスクを冒さずにチェックしてショーダウン（カードを開いて勝者を決めること）に進むのが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 161, 'promptTokenCount': 845, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 845}], 'totalTokenCount': 1006}, 'invocationId': 'e-cd44c700-ba31-440a-972f-cc91c154518c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'v8e0FhpM', 'timestamp': 1761904742.339017}]
2025-10-31 18:59:04,336 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:59:04,336 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「8♥6♥」で、コミュニティカードは「5♥6♥9♠2♦A♦」です。これは、あなたの手札で「6のペア」ができており、ハートのフラッシュ（同じスートのカードが5枚揃うこと）はありません。相手（プレイヤー1）はこれまでチェックを続けており、ポットもそれほど大きくありません。相手が強力なハンドを持っていない可能性が高いため、リスクを冒さずにチェックしてショーダウン（カードを開いて勝者を決めること）に進むのが最善の選択です。"
}
```
2025-10-31 18:59:04,336 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:59:04,336 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「8♥6♥」で、コミュニティカードは「5♥6♥9♠2♦A♦」です。これは、あなたの手札で「6のペア」ができており、ハートのフラッシュ（同じスートのカードが5枚揃うこと）はありません。相手（プレイヤー1）はこれまでチェックを続けており、ポットもそれほど大きくありません。相手が強力なハンドを持っていない可能性が高いため、リスクを冒さずにチェックしてショーダウン（カードを開いて勝者を決めること）に進むのが最善の選択です。"\n}\n```'
2025-10-31 18:59:04,336 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:59:04,336 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「8♥6♥」で、コミュニティカードは「5♥6♥9♠2♦A♦」です。これは、あなたの手札で「6のペア」ができており、ハートのフラッシュ（同じスートのカードが5枚揃うこと）はありません。相手（プレイヤー1）はこれまでチェックを続けており、ポットもそれほど大きくありません。相手が強力なハンドを持っていない可能性が高いため、リスクを冒さずにチェックしてショーダウン（カードを開いて勝者を決めること）に進むのが最善の選択です。"\n}'
2025-10-31 18:59:04,337 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ラウンド）で、あなたの手札は「8♥6♥」で、コミュニティカードは「5♥6♥9♠2♦A♦」です。これは、あなたの手札で「6のペア」ができており、ハートのフラッシュ（同じスートのカードが5枚揃うこと）はありません。相手（プレイヤー1）はこれまでチェックを続けており、ポットもそれほど大きくありません。相手が強力なハンドを持っていない可能性が高いため、リスクを冒さずにチェックしてショーダウン（カードを開いて勝者を決めること）に進むのが最善の選択です。"
}
2025-10-31 18:59:04,337 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最終ラウンド）で、あなたの手札は「8♥6♥」で、コミュニティカードは「5♥6♥9♠2♦A♦」です。これは、あなたの手札で「6のペア」ができており、ハートのフラッシュ（同じスートのカードが5枚揃うこと）はありません。相手（プレイヤー1）はこれまでチェックを続けており、ポットもそれほど大きくありません。相手が強力なハンドを持っていない可能性が高いため、リスクを冒さずにチェックしてショーダウン（カードを開いて勝者を決めること）に進むのが最善の選択です。'}
2025-10-31 18:59:04,337 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 18:59:04,337 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 18:59:04,337 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:59:04,337 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, リバー（最終ラウンド）で、あなたの手札は「8♥6♥」で、コミュニティカードは「5♥6♥9♠2♦A♦」です。これは、あなたの手札で「6のペア」ができており、ハートのフラッシュ（同じスートのカードが5枚揃うこと）はありません。相手（プレイヤー1）はこれまでチェックを続けており、ポットもそれほど大きくありません。相手が強力なハンドを持っていない可能性が高いため、リスクを冒さずにチェックしてショーダウン（カードを開いて勝者を決めること）に進むのが最善の選択です。
2025-10-31 18:59:04,338 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 18:59:04,338 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:59:04,338 - poker_game - INFO - Hand #19, Phase: river
2025-10-31 18:59:04,338 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:59:04,339 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:59:04,339 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:04,339 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:04,339 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:59:04,339 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:04,340 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:04,340 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:59:04,340 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:04,340 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:59:04,341 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:59:04,341 - poker_game - INFO - ==================================================
2025-10-31 18:59:04,341 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 18:59:04,358 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:59:04,358 - poker_game - INFO - Hand #19, Phase: river
2025-10-31 18:59:04,358 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 18:59:04,358 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:59:04,359 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:04,359 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:04,359 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:59:04,359 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:04,359 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:04,360 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:59:04,360 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:04,360 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:59:04,360 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:59:04,360 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 18:59:04,360 - poker_game - INFO - ==================================================
2025-10-31 18:59:04,361 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:59:04,361 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:59:04,361 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 18:59:04,361 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 18:59:04,361 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:59:04,362 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:59:04,362 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 18:59:04,362 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 18:59:04,362 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 18:59:04,362 - poker_game - DEBUG - Last raiser index: None
2025-10-31 18:59:04,362 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:59:04,362 - poker_game - DEBUG - First actor index: 1
2025-10-31 18:59:04,362 - poker_game - INFO - Betting complete: Back to first actor 1 (all players have acted)
2025-10-31 18:59:04,362 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:59:04,363 - poker_game - INFO - Hand #19, Phase: river
2025-10-31 18:59:04,363 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:59:04,363 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:59:04,363 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:04,363 - poker_game - INFO - Betting round complete: True
2025-10-31 18:59:04,364 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:59:04,364 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:04,364 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:04,364 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:59:04,364 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:04,365 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:59:04,365 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:59:04,365 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:59:04,365 - poker_game - INFO - ==================================================
2025-10-31 18:59:04,466 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 18:59:04,467 - poker_game - INFO - Betting round complete: True
2025-10-31 18:59:04,468 - poker_game - INFO - Remaining players: 2
2025-10-31 18:59:04,468 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:59:04,468 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:59:04,468 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 18:59:04,469 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 18:59:04,469 - poker_game - INFO - Hand #19, Phase: showdown
2025-10-31 18:59:04,470 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 18:59:04,470 - poker_game - INFO - Pot: 40, Current bet: 0
2025-10-31 18:59:04,471 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:04,471 - poker_game - INFO - Betting round complete: True
2025-10-31 18:59:04,472 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 18:59:04,475 - poker_game - INFO - Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:04,476 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:04,479 - poker_game - INFO -   P1(Agent1): chips=3084, bet=0, status=active
2025-10-31 18:59:04,479 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:04,480 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 18:59:04,480 - poker_game - INFO -   P4(Agent4): chips=5439, bet=0, status=folded
2025-10-31 18:59:04,480 - poker_game - INFO - ==================================================
2025-10-31 18:59:04,481 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 18:59:04,481 - poker_game - INFO - Pot: 40, Community cards: ['5♥', '6♥', '9♠', '2♦', 'A♦']
2025-10-31 18:59:04,482 - poker_game - INFO -   Player 1 status=active cards=['Q♣', '9♥']
2025-10-31 18:59:04,482 - poker_game - INFO -   Player 3 status=active cards=['8♥', '6♠']
2025-10-31 18:59:04,485 - poker_game - INFO -   Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=['Q♣', '9♥']
2025-10-31 18:59:04,486 - poker_game - INFO -   Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=['8♥', '6♠']
2025-10-31 18:59:04,487 - poker_game - INFO - Pot layer 0: amount=40, contributors=[1, 3]
2025-10-31 18:59:04,487 - poker_game - INFO - Showdown total awarded: 40 (game.pot=40)
2025-10-31 18:59:04,488 - poker_game - INFO - Showdown winners (aggregated): [1]
2025-10-31 18:59:04,488 - poker_game - INFO -   Awarded 40 to Player 1 (hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥)
2025-10-31 18:59:04,489 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 18:59:04,527 - poker_game - INFO - === STARTING NEW HAND #20 ===
2025-10-31 18:59:04,528 - poker_game - INFO - Active players for new hand: 3
2025-10-31 18:59:04,528 - poker_game - INFO - Moving dealer button
2025-10-31 18:59:04,528 - poker_game - INFO - Posting blinds
2025-10-31 18:59:04,556 - poker_game - INFO - Dealing hole cards
2025-10-31 18:59:04,557 - poker_game - INFO - Setting first actor for preflop
2025-10-31 18:59:04,569 - poker_game - INFO - Started new hand in database: hand_id=20
2025-10-31 18:59:04,570 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 18:59:04,570 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:04,571 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:59:04,572 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:59:04,572 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:04,572 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:04,573 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:04,573 - poker_game - INFO - Community cards: []
2025-10-31 18:59:04,573 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:04,574 - poker_game - INFO -   P1(Agent1): chips=3124, bet=0, status=active
2025-10-31 18:59:04,574 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:04,575 - poker_game - INFO -   P3(Agent3): chips=1427, bet=10, status=active
2025-10-31 18:59:04,576 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:04,577 - poker_game - INFO - ==================================================
2025-10-31 18:59:04,579 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "7♦",
    "J♦"
  ],
  "community": [],
  "your_chips": 3124,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1427,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (3124)"
  ],
  "history": [
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 18:59:04,594 - poker_game - DEBUG - Create Session: {'id': 'b8427ea6-2fe0-4e8b-9c22-9ea2a7b04a2a', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904744.5910177}
2025-10-31 18:59:06,611 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "J♦7♦はフロップでフラッシュドロー（同じスートのカードが3枚揃うこと）がありますが、現時点ではまだ完成していません。ポットオッズ（コールに必要な金額とポットの比率）は悪くないため、コールして次のカード（ターン）を見て、フラッシュが完成するかどうか判断します。相手がアグレッシブではないと仮定して、エクスプロイト（相手の弱点につけこむ）の可能性も探ります。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 136, 'promptTokenCount': 858, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 858}], 'totalTokenCount': 994}, 'invocationId': 'e-66343583-671e-4231-85f4-d2ebf1b029c4', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '3aQbHqef', 'timestamp': 1761904744.609269}]
2025-10-31 18:59:06,611 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 18:59:06,611 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "J♦7♦はフロップでフラッシュドロー（同じスートのカードが3枚揃うこと）がありますが、現時点ではまだ完成していません。ポットオッズ（コールに必要な金額とポットの比率）は悪くないため、コールして次のカード（ターン）を見て、フラッシュが完成するかどうか判断します。相手がアグレッシブではないと仮定して、エクスプロイト（相手の弱点につけこむ）の可能性も探ります。"
}
```
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "J♦7♦はフロップでフラッシュドロー（同じスートのカードが3枚揃うこと）がありますが、現時点ではまだ完成していません。ポットオッズ（コールに必要な金額とポットの比率）は悪くないため、コールして次のカード（ターン）を見て、フラッシュが完成するかどうか判断します。相手がアグレッシブではないと仮定して、エクスプロイト（相手の弱点につけこむ）の可能性も探ります。"\n}\n```'
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "J♦7♦はフロップでフラッシュドロー（同じスートのカードが3枚揃うこと）がありますが、現時点ではまだ完成していません。ポットオッズ（コールに必要な金額とポットの比率）は悪くないため、コールして次のカード（ターン）を見て、フラッシュが完成するかどうか判断します。相手がアグレッシブではないと仮定して、エクスプロイト（相手の弱点につけこむ）の可能性も探ります。"\n}'
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "J♦7♦はフロップでフラッシュドロー（同じスートのカードが3枚揃うこと）がありますが、現時点ではまだ完成していません。ポットオッズ（コールに必要な金額とポットの比率）は悪くないため、コールして次のカード（ターン）を見て、フラッシュが完成するかどうか判断します。相手がアグレッシブではないと仮定して、エクスプロイト（相手の弱点につけこむ）の可能性も探ります。"
}
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'J♦7♦はフロップでフラッシュドロー（同じスートのカードが3枚揃うこと）がありますが、現時点ではまだ完成していません。ポットオッズ（コールに必要な金額とポットの比率）は悪くないため、コールして次のカード（ターン）を見て、フラッシュが完成するかどうか判断します。相手がアグレッシブではないと仮定して、エクスプロイト（相手の弱点につけこむ）の可能性も探ります。'}
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 20
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (3124)']
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (20)': 20
2025-10-31 18:59:06,612 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 18:59:06,613 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 20, J♦7♦はフロップでフラッシュドロー（同じスートのカードが3枚揃うこと）がありますが、現時点ではまだ完成していません。ポットオッズ（コールに必要な金額とポットの比率）は悪くないため、コールして次のカード（ターン）を見て、フラッシュが完成するかどうか判断します。相手がアグレッシブではないと仮定して、エクスプロイト（相手の弱点につけこむ）の可能性も探ります。
2025-10-31 18:59:06,613 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 20
2025-10-31 18:59:06,613 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:59:06,614 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:06,614 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:59:06,614 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 18:59:06,614 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:06,614 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:06,615 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:06,615 - poker_game - INFO - Community cards: []
2025-10-31 18:59:06,615 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:06,615 - poker_game - INFO -   P1(Agent1): chips=3124, bet=0, status=active
2025-10-31 18:59:06,615 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:06,616 - poker_game - INFO -   P3(Agent3): chips=1427, bet=10, status=active
2025-10-31 18:59:06,616 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:06,616 - poker_game - INFO - ==================================================
2025-10-31 18:59:06,616 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 20
2025-10-31 18:59:06,628 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:59:06,628 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:06,629 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:59:06,629 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:59:06,629 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:06,630 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:06,630 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:06,630 - poker_game - INFO - Community cards: []
2025-10-31 18:59:06,631 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:06,631 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:06,632 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:06,632 - poker_game - INFO -   P3(Agent3): chips=1427, bet=10, status=active
2025-10-31 18:59:06,632 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:06,633 - poker_game - INFO - Extra: Action: Player 1 called 20
2025-10-31 18:59:06,633 - poker_game - INFO - ==================================================
2025-10-31 18:59:06,634 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:59:06,634 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:59:06,634 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:59:06,634 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 18:59:06,635 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:59:06,635 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:59:06,635 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:59:06,636 - poker_game - DEBUG - Player bets: [20, 10, 20], Current bet: 20, All same: False
2025-10-31 18:59:06,636 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:59:06,636 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:59:06,636 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:06,637 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:59:06,637 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:59:06,637 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:06,638 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:06,638 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:06,638 - poker_game - INFO - Community cards: []
2025-10-31 18:59:06,639 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:06,639 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:06,639 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:06,639 - poker_game - INFO -   P3(Agent3): chips=1427, bet=10, status=active
2025-10-31 18:59:06,640 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:06,640 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:59:06,641 - poker_game - INFO - ==================================================
2025-10-31 18:59:06,743 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "7♠",
    "8♣"
  ],
  "community": [],
  "your_chips": 1427,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3104,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1427)"
  ],
  "history": [
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20"
  ]
}
2025-10-31 18:59:06,760 - poker_game - DEBUG - Create Session: {'id': '0e75ab81-42a5-46c3-9792-fe303f96c219', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904746.7566502}
2025-10-31 18:59:08,282 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで78s（スーテッド）は、ミドルポジションからのレイズに対してコールするのに十分な強さがあります。相手がレイズしたわけではないので、ポットを維持するためにコールします。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 77, 'promptTokenCount': 857, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 857}], 'totalTokenCount': 934}, 'invocationId': 'e-dcceb72e-bd72-48f0-83b4-00f6d3d2fcaa', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'TGWhrV9I', 'timestamp': 1761904746.772984}]
2025-10-31 18:59:08,283 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:59:08,283 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで78s（スーテッド）は、ミドルポジションからのレイズに対してコールするのに十分な強さがあります。相手がレイズしたわけではないので、ポットを維持するためにコールします。"
}
```
2025-10-31 18:59:08,283 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:59:08,284 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで78s（スーテッド）は、ミドルポジションからのレイズに対してコールするのに十分な強さがあります。相手がレイズしたわけではないので、ポットを維持するためにコールします。"\n}\n```'
2025-10-31 18:59:08,284 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:59:08,284 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで78s（スーテッド）は、ミドルポジションからのレイズに対してコールするのに十分な強さがあります。相手がレイズしたわけではないので、ポットを維持するためにコールします。"\n}'
2025-10-31 18:59:08,284 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで78s（スーテッド）は、ミドルポジションからのレイズに対してコールするのに十分な強さがあります。相手がレイズしたわけではないので、ポットを維持するためにコールします。"
}
2025-10-31 18:59:08,284 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップで78s（スーテッド）は、ミドルポジションからのレイズに対してコールするのに十分な強さがあります。相手がレイズしたわけではないので、ポットを維持するためにコールします。'}
2025-10-31 18:59:08,285 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 10
2025-10-31 18:59:08,285 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (1427)']
2025-10-31 18:59:08,285 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (10)': 10
2025-10-31 18:59:08,285 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 18:59:08,285 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 10, プリフロップで78s（スーテッド）は、ミドルポジションからのレイズに対してコールするのに十分な強さがあります。相手がレイズしたわけではないので、ポットを維持するためにコールします。
2025-10-31 18:59:08,287 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 10
2025-10-31 18:59:08,287 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:59:08,287 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:08,290 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:59:08,291 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 18:59:08,291 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:08,292 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:08,292 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:08,292 - poker_game - INFO - Community cards: []
2025-10-31 18:59:08,293 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:08,293 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:08,294 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:08,294 - poker_game - INFO -   P3(Agent3): chips=1427, bet=10, status=active
2025-10-31 18:59:08,294 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:08,295 - poker_game - INFO - ==================================================
2025-10-31 18:59:08,295 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 10
2025-10-31 18:59:08,330 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:59:08,331 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:08,332 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:59:08,332 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:59:08,333 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:08,333 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:08,334 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:08,334 - poker_game - INFO - Community cards: []
2025-10-31 18:59:08,335 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:08,335 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:08,336 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:08,336 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 18:59:08,337 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:08,337 - poker_game - INFO - Extra: Action: Player 3 called 10
2025-10-31 18:59:08,338 - poker_game - INFO - ==================================================
2025-10-31 18:59:08,338 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:59:08,338 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:59:08,339 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:59:08,339 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:59:08,339 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:59:08,340 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:59:08,340 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:59:08,340 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:59:08,340 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:59:08,341 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:59:08,341 - poker_game - DEBUG - Current player index: 4
2025-10-31 18:59:08,341 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:59:08,341 - poker_game - DEBUG - Betting continues: Current player 4 != next after raiser 1
2025-10-31 18:59:08,341 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:59:08,342 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:08,344 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:59:08,345 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:59:08,348 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:08,348 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:08,352 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:08,352 - poker_game - INFO - Community cards: []
2025-10-31 18:59:08,353 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:08,353 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:08,354 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:08,354 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 18:59:08,354 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:08,355 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:59:08,355 - poker_game - INFO - ==================================================
2025-10-31 18:59:08,456 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "2♣",
    "A♦"
  ],
  "community": [],
  "your_chips": 5419,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3104,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1417,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (5419)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10"
  ]
}
2025-10-31 18:59:08,477 - poker_game - DEBUG - Create Session: {'id': 'd4ced980-c208-4987-92d4-660d7893bf1d', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904748.471255}
2025-10-31 18:59:18,635 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 18:59:28,558 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 18:59:38,595 - poker_game - INFO - Waiting for LLM API response for Agent4... 30 seconds elapsed
2025-10-31 18:59:39,220 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_Xf9DXBo0uUyZya5JcUryPmXm', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1181, 'totalTokenCount': 1198}, 'invocationId': 'e-c0deb6db-4086-42d7-8e5e-f533012a3c62', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'ymlgN0o0', 'timestamp': 1761904748.491429}, {'content': {'parts': [{'functionResponse': {'id': 'call_Xf9DXBo0uUyZya5JcUryPmXm', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-c0deb6db-4086-42d7-8e5e-f533012a3c62', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '2SKdYMcZ', 'timestamp': 1761904749.833558}, {'content': {'parts': [{'functionCall': {'id': 'call_IrCiZxQQCqqjvZpwL3XL3Wnm', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['2♣', 'A♦'], 'community': [], 'your_chips': 5419, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3104, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1417, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (5419)'], 'history': ['Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 checked', 'Flop dealt: 5♥, 6♥, 9♠', 'Player 1 checked', 'Player 3 checked', 'Turn dealt: 2♦', 'Player 1 checked', 'Player 3 checked', 'River dealt: A♦', 'Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥', 'Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠', 'Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 412, 'promptTokenCount': 1705, 'totalTokenCount': 2117}, 'invocationId': 'e-c0deb6db-4086-42d7-8e5e-f533012a3c62', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'AdOOcmbX', 'timestamp': 1761904749.83507}, {'content': {'parts': [{'functionResponse': {'id': 'call_IrCiZxQQCqqjvZpwL3XL3Wnm', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（24.00(ポットに対して40.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-c0deb6db-4086-42d7-8e5e-f533012a3c62', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'k8qaflxp', 'timestamp': 1761904777.67761}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2168, 'totalTokenCount': 2206}, 'invocationId': 'e-c0deb6db-4086-42d7-8e5e-f533012a3c62', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'a65gaJUN', 'timestamp': 1761904777.680011}]
2025-10-31 18:59:39,220 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 18:59:39,220 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}
2025-10-31 18:59:39,220 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 18:59:39,220 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}'
2025-10-31 18:59:39,221 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 18:59:39,221 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（24.00(ポットに対して40.00%）ため、チェックします"}
2025-10-31 18:59:39,221 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（24.00(ポットに対して40.00%）ため、チェックします'}
2025-10-31 18:59:39,221 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 18:59:39,221 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 18:59:39,221 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 18:59:39,221 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（24.00(ポットに対して40.00%）ため、チェックします
2025-10-31 18:59:39,222 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 18:59:39,223 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:59:39,223 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:39,223 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:59:39,223 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:59:39,223 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:39,224 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:39,224 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:39,224 - poker_game - INFO - Community cards: []
2025-10-31 18:59:39,224 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:39,224 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:39,225 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:39,225 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 18:59:39,225 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:39,225 - poker_game - INFO - ==================================================
2025-10-31 18:59:39,225 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 18:59:39,239 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:59:39,240 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:39,240 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:59:39,240 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:59:39,240 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:39,241 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:39,241 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:39,241 - poker_game - INFO - Community cards: []
2025-10-31 18:59:39,241 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:39,241 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:39,242 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:39,242 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 18:59:39,242 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:39,242 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 18:59:39,242 - poker_game - INFO - ==================================================
2025-10-31 18:59:39,243 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:59:39,243 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:59:39,243 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:59:39,243 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 18:59:39,243 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:59:39,244 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:59:39,244 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:59:39,244 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 18:59:39,244 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 18:59:39,244 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 18:59:39,244 - poker_game - DEBUG - Current player index: 1
2025-10-31 18:59:39,244 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 18:59:39,244 - poker_game - INFO - Betting complete: Back to player 1 after last raiser 4
2025-10-31 18:59:39,245 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:59:39,245 - poker_game - INFO - Hand #20, Phase: preflop
2025-10-31 18:59:39,245 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 18:59:39,245 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 18:59:39,245 - poker_game - INFO - Last raiser: 4
2025-10-31 18:59:39,246 - poker_game - INFO - Betting round complete: True
2025-10-31 18:59:39,246 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:39,246 - poker_game - INFO - Community cards: []
2025-10-31 18:59:39,246 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:39,246 - poker_game - INFO -   P1(Agent1): chips=3104, bet=20, status=active
2025-10-31 18:59:39,247 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:39,247 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 18:59:39,247 - poker_game - INFO -   P4(Agent4): chips=5419, bet=20, status=active
2025-10-31 18:59:39,248 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 18:59:39,249 - poker_game - INFO - ==================================================
2025-10-31 18:59:39,352 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 18:59:39,353 - poker_game - INFO - Betting round complete: True
2025-10-31 18:59:39,353 - poker_game - INFO - Remaining players: 3
2025-10-31 18:59:39,354 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 18:59:39,354 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 18:59:39,354 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 18:59:39,354 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 18:59:39,365 - poker_game - INFO - Starting new betting round
2025-10-31 18:59:39,366 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 18:59:39,366 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 18:59:39,366 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 18:59:39,367 - poker_game - DEBUG - Dealer button: 1
2025-10-31 18:59:39,367 - poker_game - INFO - First actor: Player 3 (by phase rule), was 1
2025-10-31 18:59:39,367 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 18:59:39,368 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 18:59:39,368 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:59:39,368 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:59:39,369 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:39,369 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:39,369 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:39,369 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 18:59:39,370 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:39,370 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 18:59:39,371 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:39,371 - poker_game - INFO -   P3(Agent3): chips=1417, bet=0, status=active
2025-10-31 18:59:39,371 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=active
2025-10-31 18:59:39,372 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 18:59:39,372 - poker_game - INFO - ==================================================
2025-10-31 18:59:39,373 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "7♠",
    "8♣"
  ],
  "community": [
    "4♠",
    "10♣",
    "5♥"
  ],
  "your_chips": 1417,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3104,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1417)"
  ],
  "history": [
    "Player 1 called 10",
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥"
  ]
}
2025-10-31 18:59:39,389 - poker_game - DEBUG - Create Session: {'id': 'c1b9f569-5cc2-4f2d-aaa5-64a0251cf9e7', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904779.3857718}
2025-10-31 18:59:41,585 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札（7♠ 8♣）は、コミュニティカード（4♠ 10♣ 5♥）と組み合わせてストレート（連続した数字の役）のドロー（完成しそうな役）になりました。具体的には、6か9が出ればストレートが完成します。現在のポットサイズ（60）に対して、最低ベット額（20）から倍の60にレイズ（ベット額を上げるアクション）することで、相手にプレッシャーを与え、ドローを完成させるチャンスを最大限に活かします。まだコール（相手のベット額と同額を支払うアクション）の必要がないため、チェック（ベットせずに次のプレイヤーに番を回すアクション）またはレイズが選択肢となります。相手がベットしてきた場合、コールまたはレイズを検討します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 216, 'promptTokenCount': 876, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 876}], 'totalTokenCount': 1092}, 'invocationId': 'e-e03044a2-accf-4643-b080-efaf2dd4cca6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ZcZ8BBEN', 'timestamp': 1761904779.403242}]
2025-10-31 18:59:41,585 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 18:59:41,586 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 60,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札（7♠ 8♣）は、コミュニティカード（4♠ 10♣ 5♥）と組み合わせてストレート（連続した数字の役）のドロー（完成しそうな役）になりました。具体的には、6か9が出ればストレートが完成します。現在のポットサイズ（60）に対して、最低ベット額（20）から倍の60にレイズ（ベット額を上げるアクション）することで、相手にプレッシャーを与え、ドローを完成させるチャンスを最大限に活かします。まだコール（相手のベット額と同額を支払うアクション）の必要がないため、チェック（ベットせずに次のプレイヤーに番を回すアクション）またはレイズが選択肢となります。相手がベットしてきた場合、コールまたはレイズを検討します。"
}
```
2025-10-31 18:59:41,586 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 18:59:41,586 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札（7♠ 8♣）は、コミュニティカード（4♠ 10♣ 5♥）と組み合わせてストレート（連続した数字の役）のドロー（完成しそうな役）になりました。具体的には、6か9が出ればストレートが完成します。現在のポットサイズ（60）に対して、最低ベット額（20）から倍の60にレイズ（ベット額を上げるアクション）することで、相手にプレッシャーを与え、ドローを完成させるチャンスを最大限に活かします。まだコール（相手のベット額と同額を支払うアクション）の必要がないため、チェック（ベットせずに次のプレイヤーに番を回すアクション）またはレイズが選択肢となります。相手がベットしてきた場合、コールまたはレイズを検討します。"\n}\n```'
2025-10-31 18:59:41,586 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 18:59:41,586 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札（7♠ 8♣）は、コミュニティカード（4♠ 10♣ 5♥）と組み合わせてストレート（連続した数字の役）のドロー（完成しそうな役）になりました。具体的には、6か9が出ればストレートが完成します。現在のポットサイズ（60）に対して、最低ベット額（20）から倍の60にレイズ（ベット額を上げるアクション）することで、相手にプレッシャーを与え、ドローを完成させるチャンスを最大限に活かします。まだコール（相手のベット額と同額を支払うアクション）の必要がないため、チェック（ベットせずに次のプレイヤーに番を回すアクション）またはレイズが選択肢となります。相手がベットしてきた場合、コールまたはレイズを検討します。"\n}'
2025-10-31 18:59:41,587 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 60,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札（7♠ 8♣）は、コミュニティカード（4♠ 10♣ 5♥）と組み合わせてストレート（連続した数字の役）のドロー（完成しそうな役）になりました。具体的には、6か9が出ればストレートが完成します。現在のポットサイズ（60）に対して、最低ベット額（20）から倍の60にレイズ（ベット額を上げるアクション）することで、相手にプレッシャーを与え、ドローを完成させるチャンスを最大限に活かします。まだコール（相手のベット額と同額を支払うアクション）の必要がないため、チェック（ベットせずに次のプレイヤーに番を回すアクション）またはレイズが選択肢となります。相手がベットしてきた場合、コールまたはレイズを検討します。"
}
2025-10-31 18:59:41,587 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 60, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）で、あなたの手札（7♠ 8♣）は、コミュニティカード（4♠ 10♣ 5♥）と組み合わせてストレート（連続した数字の役）のドロー（完成しそうな役）になりました。具体的には、6か9が出ればストレートが完成します。現在のポットサイズ（60）に対して、最低ベット額（20）から倍の60にレイズ（ベット額を上げるアクション）することで、相手にプレッシャーを与え、ドローを完成させるチャンスを最大限に活かします。まだコール（相手のベット額と同額を支払うアクション）の必要がないため、チェック（ベットせずに次のプレイヤーに番を回すアクション）またはレイズが選択肢となります。相手がベットしてきた場合、コールまたはレイズを検討します。'}
2025-10-31 18:59:41,587 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 60
2025-10-31 18:59:41,587 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1417)']
2025-10-31 18:59:41,587 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 18:59:41,587 - poker_game - DEBUG - [Agent3] Raise amount 60 is valid (min: 20)
2025-10-31 18:59:41,587 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 60}
2025-10-31 18:59:41,587 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 60, フロップ（最初の3枚のコミュニティカード）で、あなたの手札（7♠ 8♣）は、コミュニティカード（4♠ 10♣ 5♥）と組み合わせてストレート（連続した数字の役）のドロー（完成しそうな役）になりました。具体的には、6か9が出ればストレートが完成します。現在のポットサイズ（60）に対して、最低ベット額（20）から倍の60にレイズ（ベット額を上げるアクション）することで、相手にプレッシャーを与え、ドローを完成させるチャンスを最大限に活かします。まだコール（相手のベット額と同額を支払うアクション）の必要がないため、チェック（ベットせずに次のプレイヤーに番を回すアクション）またはレイズが選択肢となります。相手がベットしてきた場合、コールまたはレイズを検討します。
2025-10-31 18:59:41,588 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 60
2025-10-31 18:59:41,589 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 18:59:41,589 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 18:59:41,589 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:59:41,589 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 18:59:41,590 - poker_game - INFO - Last raiser: None
2025-10-31 18:59:41,590 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:41,590 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:41,590 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 18:59:41,591 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:41,591 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 18:59:41,591 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:41,592 - poker_game - INFO -   P3(Agent3): chips=1417, bet=0, status=active
2025-10-31 18:59:41,592 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=active
2025-10-31 18:59:41,592 - poker_game - INFO - ==================================================
2025-10-31 18:59:41,592 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 60
2025-10-31 18:59:41,605 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 18:59:41,605 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 18:59:41,605 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 18:59:41,606 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 18:59:41,606 - poker_game - INFO - Last raiser: 3
2025-10-31 18:59:41,606 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:41,606 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:41,606 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 18:59:41,607 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:41,607 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 18:59:41,607 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:41,607 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 18:59:41,608 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=active
2025-10-31 18:59:41,608 - poker_game - INFO - Extra: Action: Player 3 raised to 60
2025-10-31 18:59:41,608 - poker_game - INFO - ==================================================
2025-10-31 18:59:41,608 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 18:59:41,609 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 18:59:41,609 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 18:59:41,609 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 18:59:41,609 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 18:59:41,609 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 18:59:41,609 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 18:59:41,610 - poker_game - DEBUG - Player bets: [0, 60, 0], Current bet: 60, All same: False
2025-10-31 18:59:41,610 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 18:59:41,610 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 18:59:41,610 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 18:59:41,611 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 18:59:41,611 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 18:59:41,611 - poker_game - INFO - Last raiser: 3
2025-10-31 18:59:41,611 - poker_game - INFO - Betting round complete: False
2025-10-31 18:59:41,611 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 18:59:41,612 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 18:59:41,612 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 18:59:41,612 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 18:59:41,612 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 18:59:41,613 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 18:59:41,613 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=active
2025-10-31 18:59:41,613 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 18:59:41,614 - poker_game - INFO - ==================================================
2025-10-31 18:59:41,718 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "2♣",
    "A♦"
  ],
  "community": [
    "4♠",
    "10♣",
    "5♥"
  ],
  "your_chips": 5419,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 120,
  "to_call": 60,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3104,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1357,
      "bet": 60,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (60)",
    "raise (min 80)",
    "all-in (5419)"
  ],
  "history": [
    "Player 3 checked",
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60"
  ]
}
2025-10-31 18:59:41,735 - poker_game - DEBUG - Create Session: {'id': 'ab525288-0f3c-4394-bd0f-8d4a46f9e86c', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904781.731752}
2025-10-31 18:59:54,287 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:00:01,897 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:00:04,891 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_KV8wC03mf8DmaCZsPjOO5YcW', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1211, 'totalTokenCount': 1228}, 'invocationId': 'e-bebe2390-9e48-4336-8960-70fe95f68811', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'yC3QL1jp', 'timestamp': 1761904781.746225}, {'content': {'parts': [{'functionResponse': {'id': 'call_KV8wC03mf8DmaCZsPjOO5YcW', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-bebe2390-9e48-4336-8960-70fe95f68811', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'ejzQkhgW', 'timestamp': 1761904782.591504}, {'content': {'parts': [{'functionCall': {'id': 'call_UmaJynSiurFmzJuZ8ka3MjEL', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['2♣', 'A♦'], 'community': ['4♠', '10♣', '5♥'], 'your_chips': 5419, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 120, 'to_call': 60, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3104, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1357, 'bet': 60, 'status': 'active'}], 'actions': ['fold', 'call (60)', 'raise (min 80)', 'all-in (5419)'], 'history': ['Player 3 checked', 'Flop dealt: 5♥, 6♥, 9♠', 'Player 1 checked', 'Player 3 checked', 'Player 1 checked', 'Player 3 checked', 'River dealt: A♦', 'Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥', 'Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥', 'Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♠, 10♣, 5♥', 'Player 3 raised to 60']}, 'call_amount': 60, 'pot_after_call': 180, 'equity': 0.28}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_12z2Y6ZNaBoUsWkzUQ40Jkjh', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['2♣', 'A♦'], 'community': ['4♠', '10♣', '5♥'], 'your_chips': 5419, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 120, 'to_call': 60, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3104, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1357, 'bet': 60, 'status': 'active'}], 'actions': ['fold', 'call (60)', 'raise (min 80)', 'all-in (5419)'], 'history': ['Player 3 checked', 'Flop dealt: 5♥, 6♥, 9♠', 'Player 1 checked', 'Player 3 checked', 'Player 1 checked', 'Player 3 checked', 'River dealt: A♦', 'Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥', 'Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥', 'Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♠, 10♣, 5♥', 'Player 3 raised to 60']}, 'call_amount': 60, 'pot_after_call': 180, 'equity': 0.18}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 854, 'promptTokenCount': 1735, 'totalTokenCount': 2589}, 'invocationId': 'e-bebe2390-9e48-4336-8960-70fe95f68811', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'hfIm8v3r', 'timestamp': 1761904782.597232}, {'content': {'parts': [{'functionResponse': {'id': 'call_UmaJynSiurFmzJuZ8ka3MjEL', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が7.20(ポットに対して6.00%で、マイナスなのでフォールド'}}}, {'functionResponse': {'id': 'call_12z2Y6ZNaBoUsWkzUQ40Jkjh', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-16.80(ポットに対して-14.00%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': '4121HRcz', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'hczduB1t', 'timestamp': 1761904803.060371}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が-16.80(ポットに対して-14.00%で、マイナスなのでフォールド)"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 42, 'promptTokenCount': 2822, 'totalTokenCount': 2864}, 'invocationId': 'e-bebe2390-9e48-4336-8960-70fe95f68811', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'JGqKWbiD', 'timestamp': 1761904803.067133}]
2025-10-31 19:00:04,892 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:00:04,892 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が-16.80(ポットに対して-14.00%で、マイナスなのでフォールド)"}
2025-10-31 19:00:04,893 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:00:04,893 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が-16.80(ポットに対して-14.00%で、マイナスなのでフォールド)"}'
2025-10-31 19:00:04,894 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:00:04,894 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が-16.80(ポットに対して-14.00%で、マイナスなのでフォールド)"}
2025-10-31 19:00:04,894 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-16.80(ポットに対して-14.00%で、マイナスなのでフォールド)'}
2025-10-31 19:00:04,894 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 19:00:04,895 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 19:00:04,895 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:00:04,895 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が-16.80(ポットに対して-14.00%で、マイナスなのでフォールド)
2025-10-31 19:00:04,897 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 19:00:04,897 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:04,898 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 19:00:04,898 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:00:04,899 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 19:00:04,899 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:04,899 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:04,900 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:00:04,900 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 19:00:04,901 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:04,901 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 19:00:04,901 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:04,905 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 19:00:04,906 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=active
2025-10-31 19:00:04,908 - poker_game - INFO - ==================================================
2025-10-31 19:00:04,909 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 19:00:04,923 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:04,923 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 19:00:04,924 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:00:04,924 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 19:00:04,925 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:04,925 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:04,926 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:04,926 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 19:00:04,927 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:04,927 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 19:00:04,927 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:04,928 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 19:00:04,928 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:04,929 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 19:00:04,931 - poker_game - INFO - ==================================================
2025-10-31 19:00:04,931 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:04,932 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:04,933 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:04,933 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:00:04,934 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:04,936 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:04,939 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:04,939 - poker_game - DEBUG - Player bets: [0, 60], Current bet: 60, All same: False
2025-10-31 19:00:04,939 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:00:04,940 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:04,941 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 19:00:04,941 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:04,942 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 19:00:04,942 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:04,942 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:04,943 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:04,943 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 19:00:04,943 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:04,944 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 19:00:04,944 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:04,944 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 19:00:04,945 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:04,945 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:00:04,946 - poker_game - INFO - ==================================================
2025-10-31 19:00:05,047 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "7♦",
    "J♦"
  ],
  "community": [
    "4♠",
    "10♣",
    "5♥"
  ],
  "your_chips": 3104,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 120,
  "to_call": 60,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1357,
      "bet": 60,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (60)",
    "raise (min 80)",
    "all-in (3104)"
  ],
  "history": [
    "Flop dealt: 5♥, 6♥, 9♠",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60",
    "Player 4 folded"
  ]
}
2025-10-31 19:00:05,067 - poker_game - DEBUG - Create Session: {'id': '4cb05139-6962-4efe-a09e-bdf16b44a750', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904805.063742}
2025-10-31 19:00:07,643 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 60,\n  "reasoning": "フロップ（コミュニティカードが3枚開かれた段階）で、私の手札はJ♦7♦です。コミュニティカードは4♠ 10♣ 5♥で、フラッシュ（同じスートのカードが5枚揃うこと）は狙えません。ストレート（数字が連続するカードが揃うこと）も作れません。相手（プレイヤー3）が60ベットしてきたので、コール（相手のベット額と同額を支払うこと）して、ターン（4枚目のコミュニティカード）を見て、より良いカードが来るか、または相手のベットがブラフ（強い手札を持っていないのに強く見せること）だった場合に勝負を続けます。レイズ（ベット額を上げる）するには、私の手札はまだ弱いです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 199, 'promptTokenCount': 883, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 883}], 'totalTokenCount': 1082}, 'invocationId': 'e-e1b5d885-86c4-494d-8dab-0c28f05f62ff', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '1Ebla8zr', 'timestamp': 1761904805.083065}]
2025-10-31 19:00:07,643 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:00:07,644 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 60,
  "reasoning": "フロップ（コミュニティカードが3枚開かれた段階）で、私の手札はJ♦7♦です。コミュニティカードは4♠ 10♣ 5♥で、フラッシュ（同じスートのカードが5枚揃うこと）は狙えません。ストレート（数字が連続するカードが揃うこと）も作れません。相手（プレイヤー3）が60ベットしてきたので、コール（相手のベット額と同額を支払うこと）して、ターン（4枚目のコミュニティカード）を見て、より良いカードが来るか、または相手のベットがブラフ（強い手札を持っていないのに強く見せること）だった場合に勝負を続けます。レイズ（ベット額を上げる）するには、私の手札はまだ弱いです。"
}
```
2025-10-31 19:00:07,644 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:00:07,644 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 60,\n  "reasoning": "フロップ（コミュニティカードが3枚開かれた段階）で、私の手札はJ♦7♦です。コミュニティカードは4♠ 10♣ 5♥で、フラッシュ（同じスートのカードが5枚揃うこと）は狙えません。ストレート（数字が連続するカードが揃うこと）も作れません。相手（プレイヤー3）が60ベットしてきたので、コール（相手のベット額と同額を支払うこと）して、ターン（4枚目のコミュニティカード）を見て、より良いカードが来るか、または相手のベットがブラフ（強い手札を持っていないのに強く見せること）だった場合に勝負を続けます。レイズ（ベット額を上げる）するには、私の手札はまだ弱いです。"\n}\n```'
2025-10-31 19:00:07,644 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:00:07,644 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 60,\n  "reasoning": "フロップ（コミュニティカードが3枚開かれた段階）で、私の手札はJ♦7♦です。コミュニティカードは4♠ 10♣ 5♥で、フラッシュ（同じスートのカードが5枚揃うこと）は狙えません。ストレート（数字が連続するカードが揃うこと）も作れません。相手（プレイヤー3）が60ベットしてきたので、コール（相手のベット額と同額を支払うこと）して、ターン（4枚目のコミュニティカード）を見て、より良いカードが来るか、または相手のベットがブラフ（強い手札を持っていないのに強く見せること）だった場合に勝負を続けます。レイズ（ベット額を上げる）するには、私の手札はまだ弱いです。"\n}'
2025-10-31 19:00:07,644 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 60,
  "reasoning": "フロップ（コミュニティカードが3枚開かれた段階）で、私の手札はJ♦7♦です。コミュニティカードは4♠ 10♣ 5♥で、フラッシュ（同じスートのカードが5枚揃うこと）は狙えません。ストレート（数字が連続するカードが揃うこと）も作れません。相手（プレイヤー3）が60ベットしてきたので、コール（相手のベット額と同額を支払うこと）して、ターン（4枚目のコミュニティカード）を見て、より良いカードが来るか、または相手のベットがブラフ（強い手札を持っていないのに強く見せること）だった場合に勝負を続けます。レイズ（ベット額を上げる）するには、私の手札はまだ弱いです。"
}
2025-10-31 19:00:07,645 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 60, 'reasoning': 'フロップ（コミュニティカードが3枚開かれた段階）で、私の手札はJ♦7♦です。コミュニティカードは4♠ 10♣ 5♥で、フラッシュ（同じスートのカードが5枚揃うこと）は狙えません。ストレート（数字が連続するカードが揃うこと）も作れません。相手（プレイヤー3）が60ベットしてきたので、コール（相手のベット額と同額を支払うこと）して、ターン（4枚目のコミュニティカード）を見て、より良いカードが来るか、または相手のベットがブラフ（強い手札を持っていないのに強く見せること）だった場合に勝負を続けます。レイズ（ベット額を上げる）するには、私の手札はまだ弱いです。'}
2025-10-31 19:00:07,645 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 60
2025-10-31 19:00:07,645 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (60)', 'raise (min 80)', 'all-in (3104)']
2025-10-31 19:00:07,645 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (60)': 60
2025-10-31 19:00:07,645 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 60}
2025-10-31 19:00:07,645 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 60, フロップ（コミュニティカードが3枚開かれた段階）で、私の手札はJ♦7♦です。コミュニティカードは4♠ 10♣ 5♥で、フラッシュ（同じスートのカードが5枚揃うこと）は狙えません。ストレート（数字が連続するカードが揃うこと）も作れません。相手（プレイヤー3）が60ベットしてきたので、コール（相手のベット額と同額を支払うこと）して、ターン（4枚目のコミュニティカード）を見て、より良いカードが来るか、または相手のベットがブラフ（強い手札を持っていないのに強く見せること）だった場合に勝負を続けます。レイズ（ベット額を上げる）するには、私の手札はまだ弱いです。
2025-10-31 19:00:07,646 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 60
2025-10-31 19:00:07,647 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:07,647 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 19:00:07,647 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:07,648 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 19:00:07,648 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:07,648 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:07,649 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:07,649 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 19:00:07,650 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:07,650 - poker_game - INFO -   P1(Agent1): chips=3104, bet=0, status=active
2025-10-31 19:00:07,650 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:07,650 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 19:00:07,651 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:07,651 - poker_game - INFO - ==================================================
2025-10-31 19:00:07,651 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 60
2025-10-31 19:00:07,667 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:07,669 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 19:00:07,670 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:07,670 - poker_game - INFO - Pot: 180, Current bet: 60
2025-10-31 19:00:07,671 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:07,671 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:07,672 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:07,672 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 19:00:07,673 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:07,673 - poker_game - INFO -   P1(Agent1): chips=3044, bet=60, status=active
2025-10-31 19:00:07,673 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:07,674 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 19:00:07,675 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:07,675 - poker_game - INFO - Extra: Action: Player 1 called 60
2025-10-31 19:00:07,675 - poker_game - INFO - ==================================================
2025-10-31 19:00:07,676 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:07,676 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:07,677 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:07,677 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:00:07,677 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:07,677 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:07,678 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:07,678 - poker_game - DEBUG - Player bets: [60, 60], Current bet: 60, All same: True
2025-10-31 19:00:07,678 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:00:07,679 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:07,683 - poker_game - INFO - Hand #20, Phase: flop
2025-10-31 19:00:07,684 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:07,686 - poker_game - INFO - Pot: 180, Current bet: 60
2025-10-31 19:00:07,687 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:07,688 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:07,688 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:07,688 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥']
2025-10-31 19:00:07,689 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:07,689 - poker_game - INFO -   P1(Agent1): chips=3044, bet=60, status=active
2025-10-31 19:00:07,690 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:07,690 - poker_game - INFO -   P3(Agent3): chips=1357, bet=60, status=active
2025-10-31 19:00:07,690 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:07,691 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:00:07,691 - poker_game - INFO - ==================================================
2025-10-31 19:00:07,793 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 19:00:07,793 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:07,794 - poker_game - INFO - Remaining players: 2
2025-10-31 19:00:07,795 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:00:07,796 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:00:07,796 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 19:00:07,808 - poker_game - INFO - Starting new betting round
2025-10-31 19:00:07,809 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:00:07,809 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:00:07,809 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 19:00:07,810 - poker_game - DEBUG - Dealer button: 1
2025-10-31 19:00:07,810 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 19:00:07,810 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:00:07,811 - poker_game - INFO - Hand #20, Phase: turn
2025-10-31 19:00:07,811 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:07,813 - poker_game - INFO - Pot: 180, Current bet: 0
2025-10-31 19:00:07,814 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:07,814 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:07,815 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:07,815 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠']
2025-10-31 19:00:07,816 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:07,816 - poker_game - INFO -   P1(Agent1): chips=3044, bet=0, status=active
2025-10-31 19:00:07,817 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:07,817 - poker_game - INFO -   P3(Agent3): chips=1357, bet=0, status=active
2025-10-31 19:00:07,818 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:07,818 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 19:00:07,819 - poker_game - INFO - ==================================================
2025-10-31 19:00:07,819 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "7♠",
    "8♣"
  ],
  "community": [
    "4♠",
    "10♣",
    "5♥",
    "8♠"
  ],
  "your_chips": 1357,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 180,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3044,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1357)"
  ],
  "history": [
    "Player 3 checked",
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠"
  ]
}
2025-10-31 19:00:07,842 - poker_game - DEBUG - Create Session: {'id': '74e4fb7c-2fdc-4e7b-a4b5-da24bf594ac8', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904807.837905}
2025-10-31 19:00:09,959 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 120,\n  "reasoning": "現在のボード（4♠ 10♣ 5♥ 8♠）では、あなたの手札（7♠ 8♣）はボードの8♠とペアになっています。これは「ワンペア」と呼ばれる役です。さらに、7♠と8♣でストレート（5-6-7-8-9）のドロー（完成する可能性のある役）があります。対戦相手（Player 1）はまだアクションを起こしておらず、ポットもそれほど大きくありません。相手のレイズ（raise）の可能性も考慮しつつ、自分のハンドの強さとドローの可能性を活かすために、レイズ（raise）をしてポットを大きくします。レイズ額は、相手のコール（call）を促しつつ、リスクも抑えるために、最低ベット額（20）の倍の60（合計120）に設定します。これは、相手にプレッシャーを与え、より有利な状況を作るための戦略です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 236, 'promptTokenCount': 878, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 878}], 'totalTokenCount': 1114}, 'invocationId': 'e-932a8af9-bb40-4cee-8424-bff376f3a7fc', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '36eBRs4c', 'timestamp': 1761904807.863957}]
2025-10-31 19:00:09,960 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:00:09,960 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 120,
  "reasoning": "現在のボード（4♠ 10♣ 5♥ 8♠）では、あなたの手札（7♠ 8♣）はボードの8♠とペアになっています。これは「ワンペア」と呼ばれる役です。さらに、7♠と8♣でストレート（5-6-7-8-9）のドロー（完成する可能性のある役）があります。対戦相手（Player 1）はまだアクションを起こしておらず、ポットもそれほど大きくありません。相手のレイズ（raise）の可能性も考慮しつつ、自分のハンドの強さとドローの可能性を活かすために、レイズ（raise）をしてポットを大きくします。レイズ額は、相手のコール（call）を促しつつ、リスクも抑えるために、最低ベット額（20）の倍の60（合計120）に設定します。これは、相手にプレッシャーを与え、より有利な状況を作るための戦略です。"
}
```
2025-10-31 19:00:09,960 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:00:09,960 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 120,\n  "reasoning": "現在のボード（4♠ 10♣ 5♥ 8♠）では、あなたの手札（7♠ 8♣）はボードの8♠とペアになっています。これは「ワンペア」と呼ばれる役です。さらに、7♠と8♣でストレート（5-6-7-8-9）のドロー（完成する可能性のある役）があります。対戦相手（Player 1）はまだアクションを起こしておらず、ポットもそれほど大きくありません。相手のレイズ（raise）の可能性も考慮しつつ、自分のハンドの強さとドローの可能性を活かすために、レイズ（raise）をしてポットを大きくします。レイズ額は、相手のコール（call）を促しつつ、リスクも抑えるために、最低ベット額（20）の倍の60（合計120）に設定します。これは、相手にプレッシャーを与え、より有利な状況を作るための戦略です。"\n}\n```'
2025-10-31 19:00:09,960 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:00:09,960 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 120,\n  "reasoning": "現在のボード（4♠ 10♣ 5♥ 8♠）では、あなたの手札（7♠ 8♣）はボードの8♠とペアになっています。これは「ワンペア」と呼ばれる役です。さらに、7♠と8♣でストレート（5-6-7-8-9）のドロー（完成する可能性のある役）があります。対戦相手（Player 1）はまだアクションを起こしておらず、ポットもそれほど大きくありません。相手のレイズ（raise）の可能性も考慮しつつ、自分のハンドの強さとドローの可能性を活かすために、レイズ（raise）をしてポットを大きくします。レイズ額は、相手のコール（call）を促しつつ、リスクも抑えるために、最低ベット額（20）の倍の60（合計120）に設定します。これは、相手にプレッシャーを与え、より有利な状況を作るための戦略です。"\n}'
2025-10-31 19:00:09,961 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 120,
  "reasoning": "現在のボード（4♠ 10♣ 5♥ 8♠）では、あなたの手札（7♠ 8♣）はボードの8♠とペアになっています。これは「ワンペア」と呼ばれる役です。さらに、7♠と8♣でストレート（5-6-7-8-9）のドロー（完成する可能性のある役）があります。対戦相手（Player 1）はまだアクションを起こしておらず、ポットもそれほど大きくありません。相手のレイズ（raise）の可能性も考慮しつつ、自分のハンドの強さとドローの可能性を活かすために、レイズ（raise）をしてポットを大きくします。レイズ額は、相手のコール（call）を促しつつ、リスクも抑えるために、最低ベット額（20）の倍の60（合計120）に設定します。これは、相手にプレッシャーを与え、より有利な状況を作るための戦略です。"
}
2025-10-31 19:00:09,961 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 120, 'reasoning': '現在のボード（4♠ 10♣ 5♥ 8♠）では、あなたの手札（7♠ 8♣）はボードの8♠とペアになっています。これは「ワンペア」と呼ばれる役です。さらに、7♠と8♣でストレート（5-6-7-8-9）のドロー（完成する可能性のある役）があります。対戦相手（Player 1）はまだアクションを起こしておらず、ポットもそれほど大きくありません。相手のレイズ（raise）の可能性も考慮しつつ、自分のハンドの強さとドローの可能性を活かすために、レイズ（raise）をしてポットを大きくします。レイズ額は、相手のコール（call）を促しつつ、リスクも抑えるために、最低ベット額（20）の倍の60（合計120）に設定します。これは、相手にプレッシャーを与え、より有利な状況を作るための戦略です。'}
2025-10-31 19:00:09,961 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 120
2025-10-31 19:00:09,961 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1357)']
2025-10-31 19:00:09,961 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 19:00:09,962 - poker_game - DEBUG - [Agent3] Raise amount 120 is valid (min: 20)
2025-10-31 19:00:09,962 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 120}
2025-10-31 19:00:09,963 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 120, 現在のボード（4♠ 10♣ 5♥ 8♠）では、あなたの手札（7♠ 8♣）はボードの8♠とペアになっています。これは「ワンペア」と呼ばれる役です。さらに、7♠と8♣でストレート（5-6-7-8-9）のドロー（完成する可能性のある役）があります。対戦相手（Player 1）はまだアクションを起こしておらず、ポットもそれほど大きくありません。相手のレイズ（raise）の可能性も考慮しつつ、自分のハンドの強さとドローの可能性を活かすために、レイズ（raise）をしてポットを大きくします。レイズ額は、相手のコール（call）を促しつつ、リスクも抑えるために、最低ベット額（20）の倍の60（合計120）に設定します。これは、相手にプレッシャーを与え、より有利な状況を作るための戦略です。
2025-10-31 19:00:09,964 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 120
2025-10-31 19:00:09,964 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:09,964 - poker_game - INFO - Hand #20, Phase: turn
2025-10-31 19:00:09,965 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:09,965 - poker_game - INFO - Pot: 180, Current bet: 0
2025-10-31 19:00:09,965 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:09,965 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:09,965 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:09,966 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠']
2025-10-31 19:00:09,966 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:09,966 - poker_game - INFO -   P1(Agent1): chips=3044, bet=0, status=active
2025-10-31 19:00:09,966 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:09,967 - poker_game - INFO -   P3(Agent3): chips=1357, bet=0, status=active
2025-10-31 19:00:09,967 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:09,967 - poker_game - INFO - ==================================================
2025-10-31 19:00:09,967 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 120
2025-10-31 19:00:09,974 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:09,974 - poker_game - INFO - Hand #20, Phase: turn
2025-10-31 19:00:09,975 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:09,975 - poker_game - INFO - Pot: 300, Current bet: 120
2025-10-31 19:00:09,975 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:09,975 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:09,976 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:09,976 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠']
2025-10-31 19:00:09,976 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:09,976 - poker_game - INFO -   P1(Agent1): chips=3044, bet=0, status=active
2025-10-31 19:00:09,976 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:09,977 - poker_game - INFO -   P3(Agent3): chips=1237, bet=120, status=active
2025-10-31 19:00:09,977 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:09,977 - poker_game - INFO - Extra: Action: Player 3 raised to 120
2025-10-31 19:00:09,977 - poker_game - INFO - ==================================================
2025-10-31 19:00:09,978 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:09,978 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:09,978 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:09,978 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:00:09,978 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:09,978 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:09,979 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:09,979 - poker_game - DEBUG - Player bets: [0, 120], Current bet: 120, All same: False
2025-10-31 19:00:09,979 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:00:09,979 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:09,979 - poker_game - INFO - Hand #20, Phase: turn
2025-10-31 19:00:09,980 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:09,980 - poker_game - INFO - Pot: 300, Current bet: 120
2025-10-31 19:00:09,980 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:09,980 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:09,981 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:09,981 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠']
2025-10-31 19:00:09,981 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:09,981 - poker_game - INFO -   P1(Agent1): chips=3044, bet=0, status=active
2025-10-31 19:00:09,982 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:09,982 - poker_game - INFO -   P3(Agent3): chips=1237, bet=120, status=active
2025-10-31 19:00:09,982 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:09,982 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:00:09,982 - poker_game - INFO - ==================================================
2025-10-31 19:00:10,086 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "7♦",
    "J♦"
  ],
  "community": [
    "4♠",
    "10♣",
    "5♥",
    "8♠"
  ],
  "your_chips": 3044,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 300,
  "to_call": 120,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1237,
      "bet": 120,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (120)",
    "raise (min 140)",
    "all-in (3044)"
  ],
  "history": [
    "Turn dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120"
  ]
}
2025-10-31 19:00:10,099 - poker_game - DEBUG - Create Session: {'id': '52851294-7bb7-41d5-a784-725fbed234fb', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904810.097045}
2025-10-31 19:00:11,871 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 120,\n  "reasoning": "現在のボード（4♠, 10♣, 5♥, 8♠）とあなたの手札（7♦, J♦）では、フラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。しかし、ボードにストレート（連続した数字のカード）の可能性（6-7-8-9-10）がわずかにあります。相手のベット額（120）は、ポットサイズ（300）と比較してそれほど大きくありません。相手が強いハンドを持っている可能性もありますが、コールして次のカード（リバー）を見るのが最善と考えられます。もしリバーでフラッシュやストレートが完成すれば、より有利な状況になります。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 184, 'promptTokenCount': 892, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 892}], 'totalTokenCount': 1076}, 'invocationId': 'e-06fd039a-53c7-4043-9c59-0bf82699b749', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'oak7ty1H', 'timestamp': 1761904810.110939}]
2025-10-31 19:00:11,872 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:00:11,872 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 120,
  "reasoning": "現在のボード（4♠, 10♣, 5♥, 8♠）とあなたの手札（7♦, J♦）では、フラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。しかし、ボードにストレート（連続した数字のカード）の可能性（6-7-8-9-10）がわずかにあります。相手のベット額（120）は、ポットサイズ（300）と比較してそれほど大きくありません。相手が強いハンドを持っている可能性もありますが、コールして次のカード（リバー）を見るのが最善と考えられます。もしリバーでフラッシュやストレートが完成すれば、より有利な状況になります。"
}
```
2025-10-31 19:00:11,872 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:00:11,872 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 120,\n  "reasoning": "現在のボード（4♠, 10♣, 5♥, 8♠）とあなたの手札（7♦, J♦）では、フラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。しかし、ボードにストレート（連続した数字のカード）の可能性（6-7-8-9-10）がわずかにあります。相手のベット額（120）は、ポットサイズ（300）と比較してそれほど大きくありません。相手が強いハンドを持っている可能性もありますが、コールして次のカード（リバー）を見るのが最善と考えられます。もしリバーでフラッシュやストレートが完成すれば、より有利な状況になります。"\n}\n```'
2025-10-31 19:00:11,872 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:00:11,873 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 120,\n  "reasoning": "現在のボード（4♠, 10♣, 5♥, 8♠）とあなたの手札（7♦, J♦）では、フラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。しかし、ボードにストレート（連続した数字のカード）の可能性（6-7-8-9-10）がわずかにあります。相手のベット額（120）は、ポットサイズ（300）と比較してそれほど大きくありません。相手が強いハンドを持っている可能性もありますが、コールして次のカード（リバー）を見るのが最善と考えられます。もしリバーでフラッシュやストレートが完成すれば、より有利な状況になります。"\n}'
2025-10-31 19:00:11,873 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 120,
  "reasoning": "現在のボード（4♠, 10♣, 5♥, 8♠）とあなたの手札（7♦, J♦）では、フラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。しかし、ボードにストレート（連続した数字のカード）の可能性（6-7-8-9-10）がわずかにあります。相手のベット額（120）は、ポットサイズ（300）と比較してそれほど大きくありません。相手が強いハンドを持っている可能性もありますが、コールして次のカード（リバー）を見るのが最善と考えられます。もしリバーでフラッシュやストレートが完成すれば、より有利な状況になります。"
}
2025-10-31 19:00:11,873 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 120, 'reasoning': '現在のボード（4♠, 10♣, 5♥, 8♠）とあなたの手札（7♦, J♦）では、フラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。しかし、ボードにストレート（連続した数字のカード）の可能性（6-7-8-9-10）がわずかにあります。相手のベット額（120）は、ポットサイズ（300）と比較してそれほど大きくありません。相手が強いハンドを持っている可能性もありますが、コールして次のカード（リバー）を見るのが最善と考えられます。もしリバーでフラッシュやストレートが完成すれば、より有利な状況になります。'}
2025-10-31 19:00:11,873 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 120
2025-10-31 19:00:11,873 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (120)', 'raise (min 140)', 'all-in (3044)']
2025-10-31 19:00:11,873 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (120)': 120
2025-10-31 19:00:11,874 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 120}
2025-10-31 19:00:11,874 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 120, 現在のボード（4♠, 10♣, 5♥, 8♠）とあなたの手札（7♦, J♦）では、フラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。しかし、ボードにストレート（連続した数字のカード）の可能性（6-7-8-9-10）がわずかにあります。相手のベット額（120）は、ポットサイズ（300）と比較してそれほど大きくありません。相手が強いハンドを持っている可能性もありますが、コールして次のカード（リバー）を見るのが最善と考えられます。もしリバーでフラッシュやストレートが完成すれば、より有利な状況になります。
2025-10-31 19:00:11,874 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 120
2025-10-31 19:00:11,875 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:11,875 - poker_game - INFO - Hand #20, Phase: turn
2025-10-31 19:00:11,875 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:11,875 - poker_game - INFO - Pot: 300, Current bet: 120
2025-10-31 19:00:11,876 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:11,876 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:11,876 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:11,877 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠']
2025-10-31 19:00:11,877 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:11,877 - poker_game - INFO -   P1(Agent1): chips=3044, bet=0, status=active
2025-10-31 19:00:11,877 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:11,878 - poker_game - INFO -   P3(Agent3): chips=1237, bet=120, status=active
2025-10-31 19:00:11,878 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:11,878 - poker_game - INFO - ==================================================
2025-10-31 19:00:11,878 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 120
2025-10-31 19:00:11,889 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:11,890 - poker_game - INFO - Hand #20, Phase: turn
2025-10-31 19:00:11,890 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:11,891 - poker_game - INFO - Pot: 420, Current bet: 120
2025-10-31 19:00:11,891 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:11,891 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:11,892 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:11,892 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠']
2025-10-31 19:00:11,892 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:11,893 - poker_game - INFO -   P1(Agent1): chips=2924, bet=120, status=active
2025-10-31 19:00:11,893 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:11,893 - poker_game - INFO -   P3(Agent3): chips=1237, bet=120, status=active
2025-10-31 19:00:11,894 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:11,894 - poker_game - INFO - Extra: Action: Player 1 called 120
2025-10-31 19:00:11,894 - poker_game - INFO - ==================================================
2025-10-31 19:00:11,895 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:11,895 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:11,895 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:11,896 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:00:11,896 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:11,896 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:11,897 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:11,897 - poker_game - DEBUG - Player bets: [120, 120], Current bet: 120, All same: True
2025-10-31 19:00:11,897 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:00:11,897 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:11,897 - poker_game - INFO - Hand #20, Phase: turn
2025-10-31 19:00:11,898 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:11,898 - poker_game - INFO - Pot: 420, Current bet: 120
2025-10-31 19:00:11,898 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:11,899 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:11,899 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:11,899 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠']
2025-10-31 19:00:11,900 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:11,900 - poker_game - INFO -   P1(Agent1): chips=2924, bet=120, status=active
2025-10-31 19:00:11,900 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:11,901 - poker_game - INFO -   P3(Agent3): chips=1237, bet=120, status=active
2025-10-31 19:00:11,901 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:11,901 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:00:11,901 - poker_game - INFO - ==================================================
2025-10-31 19:00:12,003 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 19:00:12,004 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:12,004 - poker_game - INFO - Remaining players: 2
2025-10-31 19:00:12,005 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:00:12,005 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:00:12,005 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 19:00:12,018 - poker_game - INFO - Starting new betting round
2025-10-31 19:00:12,019 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:00:12,019 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:00:12,020 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 19:00:12,020 - poker_game - DEBUG - Dealer button: 1
2025-10-31 19:00:12,020 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 19:00:12,021 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:00:12,022 - poker_game - INFO - Hand #20, Phase: river
2025-10-31 19:00:12,022 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:12,023 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:12,023 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:12,023 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:12,024 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:12,024 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:12,025 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:12,026 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:12,026 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:12,027 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:12,027 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:12,028 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 19:00:12,028 - poker_game - INFO - ==================================================
2025-10-31 19:00:12,029 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "7♠",
    "8♣"
  ],
  "community": [
    "4♠",
    "10♣",
    "5♥",
    "8♠",
    "3♥"
  ],
  "your_chips": 1237,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 200,
  "pot": 420,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2924,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1237)"
  ],
  "history": [
    "Player 3 checked",
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥"
  ]
}
2025-10-31 19:00:12,047 - poker_game - DEBUG - Create Session: {'id': '234bf254-771c-4c08-a90e-f05e94c02adf', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904812.0436237}
2025-10-31 19:00:14,147 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（全てのコミュニティカードが開かれた最終段階）で、あなたの手札は「8」のワンペアです。コミュニティカードには「8♠」があり、あなたのホールカード「8♣」と合わせてペアになっています。これはそこそこのハンドですが、対戦相手（プレイヤー1）がベットしてこなかったため、チェックしてショーダウン（役の公開）に進むのが最善です。もし相手がベットしてきた場合は、相手のベット額とあなたのチップ量、そして相手のプレイスタイルを考慮してコールするかフォールドするかを判断します。今回は相手もチェックしたので、お互いに持っている役を見せ合うことになります。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 168, 'promptTokenCount': 894, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 894}], 'totalTokenCount': 1062}, 'invocationId': 'e-8f56fb26-3e17-4d6b-a169-746a451e399d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '4mFaUl0h', 'timestamp': 1761904812.057276}]
2025-10-31 19:00:14,148 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:00:14,149 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（全てのコミュニティカードが開かれた最終段階）で、あなたの手札は「8」のワンペアです。コミュニティカードには「8♠」があり、あなたのホールカード「8♣」と合わせてペアになっています。これはそこそこのハンドですが、対戦相手（プレイヤー1）がベットしてこなかったため、チェックしてショーダウン（役の公開）に進むのが最善です。もし相手がベットしてきた場合は、相手のベット額とあなたのチップ量、そして相手のプレイスタイルを考慮してコールするかフォールドするかを判断します。今回は相手もチェックしたので、お互いに持っている役を見せ合うことになります。"
}
```
2025-10-31 19:00:14,149 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:00:14,149 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（全てのコミュニティカードが開かれた最終段階）で、あなたの手札は「8」のワンペアです。コミュニティカードには「8♠」があり、あなたのホールカード「8♣」と合わせてペアになっています。これはそこそこのハンドですが、対戦相手（プレイヤー1）がベットしてこなかったため、チェックしてショーダウン（役の公開）に進むのが最善です。もし相手がベットしてきた場合は、相手のベット額とあなたのチップ量、そして相手のプレイスタイルを考慮してコールするかフォールドするかを判断します。今回は相手もチェックしたので、お互いに持っている役を見せ合うことになります。"\n}\n```'
2025-10-31 19:00:14,150 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:00:14,150 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（全てのコミュニティカードが開かれた最終段階）で、あなたの手札は「8」のワンペアです。コミュニティカードには「8♠」があり、あなたのホールカード「8♣」と合わせてペアになっています。これはそこそこのハンドですが、対戦相手（プレイヤー1）がベットしてこなかったため、チェックしてショーダウン（役の公開）に進むのが最善です。もし相手がベットしてきた場合は、相手のベット額とあなたのチップ量、そして相手のプレイスタイルを考慮してコールするかフォールドするかを判断します。今回は相手もチェックしたので、お互いに持っている役を見せ合うことになります。"\n}'
2025-10-31 19:00:14,150 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（全てのコミュニティカードが開かれた最終段階）で、あなたの手札は「8」のワンペアです。コミュニティカードには「8♠」があり、あなたのホールカード「8♣」と合わせてペアになっています。これはそこそこのハンドですが、対戦相手（プレイヤー1）がベットしてこなかったため、チェックしてショーダウン（役の公開）に進むのが最善です。もし相手がベットしてきた場合は、相手のベット額とあなたのチップ量、そして相手のプレイスタイルを考慮してコールするかフォールドするかを判断します。今回は相手もチェックしたので、お互いに持っている役を見せ合うことになります。"
}
2025-10-31 19:00:14,150 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（全てのコミュニティカードが開かれた最終段階）で、あなたの手札は「8」のワンペアです。コミュニティカードには「8♠」があり、あなたのホールカード「8♣」と合わせてペアになっています。これはそこそこのハンドですが、対戦相手（プレイヤー1）がベットしてこなかったため、チェックしてショーダウン（役の公開）に進むのが最善です。もし相手がベットしてきた場合は、相手のベット額とあなたのチップ量、そして相手のプレイスタイルを考慮してコールするかフォールドするかを判断します。今回は相手もチェックしたので、お互いに持っている役を見せ合うことになります。'}
2025-10-31 19:00:14,153 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 19:00:14,154 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 19:00:14,154 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:00:14,154 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, リバー（全てのコミュニティカードが開かれた最終段階）で、あなたの手札は「8」のワンペアです。コミュニティカードには「8♠」があり、あなたのホールカード「8♣」と合わせてペアになっています。これはそこそこのハンドですが、対戦相手（プレイヤー1）がベットしてこなかったため、チェックしてショーダウン（役の公開）に進むのが最善です。もし相手がベットしてきた場合は、相手のベット額とあなたのチップ量、そして相手のプレイスタイルを考慮してコールするかフォールドするかを判断します。今回は相手もチェックしたので、お互いに持っている役を見せ合うことになります。
2025-10-31 19:00:14,158 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 19:00:14,159 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:14,159 - poker_game - INFO - Hand #20, Phase: river
2025-10-31 19:00:14,160 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:14,160 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:14,161 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:14,161 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:14,161 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:14,162 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:14,162 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:14,163 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:14,163 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:14,163 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:14,164 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:14,164 - poker_game - INFO - ==================================================
2025-10-31 19:00:14,165 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 19:00:14,179 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:14,180 - poker_game - INFO - Hand #20, Phase: river
2025-10-31 19:00:14,180 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:14,181 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:14,181 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:14,181 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:14,182 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:14,182 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:14,183 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:14,183 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:14,184 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:14,184 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:14,184 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:14,185 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 19:00:14,185 - poker_game - INFO - ==================================================
2025-10-31 19:00:14,186 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:14,186 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:14,186 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:14,187 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:00:14,187 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:14,187 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:14,188 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:14,188 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 19:00:14,188 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:00:14,188 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:00:14,189 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:00:14,189 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:00:14,189 - poker_game - DEBUG - Betting continues: Current player 1 != first actor 3
2025-10-31 19:00:14,189 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:14,190 - poker_game - INFO - Hand #20, Phase: river
2025-10-31 19:00:14,191 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:14,192 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:14,193 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:14,194 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:14,195 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:14,197 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:14,198 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:14,199 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:14,199 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:14,200 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:14,200 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:14,200 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:00:14,200 - poker_game - INFO - ==================================================
2025-10-31 19:00:14,306 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "7♦",
    "J♦"
  ],
  "community": [
    "4♠",
    "10♣",
    "5♥",
    "8♠",
    "3♥"
  ],
  "your_chips": 2924,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 200,
  "pot": 420,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1237,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5419,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (2924)"
  ],
  "history": [
    "River dealt: A♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥ cards=Q♣, 9♥",
    "Showdown: Player 3 hand=One Pair: 6s - A♦, 9♠, 8♥, 6♠, 6♥ cards=8♥, 6♠",
    "Side pot layer 0: amount=40, winners=1 best_hand=One Pair: 9s - A♦, Q♣, 9♥, 9♠, 6♥",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked"
  ]
}
2025-10-31 19:00:14,321 - poker_game - DEBUG - Create Session: {'id': '6985d115-67c6-4583-b9eb-e14d246e5210', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904814.3188264}
2025-10-31 19:00:16,572 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はJ♦7♦、コミュニティカードは4♠ 10♣ 5♥ 8♠ 3♥です。これで完成する役は、Jハイ（ジャックが一番強いカード）です。相手（プレイヤー3）はチェックしたので、こちらもチェックし、ショーダウン（役の強さを比べて勝者を決めること）に進みます。これ以上のベットはリスクが高すぎます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 130, 'promptTokenCount': 894, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 894}], 'totalTokenCount': 1024}, 'invocationId': 'e-c1796a38-2eaa-4c0b-a181-13d40931fda1', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'XkBiprvC', 'timestamp': 1761904814.337195}]
2025-10-31 19:00:16,572 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:00:16,573 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はJ♦7♦、コミュニティカードは4♠ 10♣ 5♥ 8♠ 3♥です。これで完成する役は、Jハイ（ジャックが一番強いカード）です。相手（プレイヤー3）はチェックしたので、こちらもチェックし、ショーダウン（役の強さを比べて勝者を決めること）に進みます。これ以上のベットはリスクが高すぎます。"
}
```
2025-10-31 19:00:16,573 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:00:16,573 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はJ♦7♦、コミュニティカードは4♠ 10♣ 5♥ 8♠ 3♥です。これで完成する役は、Jハイ（ジャックが一番強いカード）です。相手（プレイヤー3）はチェックしたので、こちらもチェックし、ショーダウン（役の強さを比べて勝者を決めること）に進みます。これ以上のベットはリスクが高すぎます。"\n}\n```'
2025-10-31 19:00:16,574 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:00:16,574 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はJ♦7♦、コミュニティカードは4♠ 10♣ 5♥ 8♠ 3♥です。これで完成する役は、Jハイ（ジャックが一番強いカード）です。相手（プレイヤー3）はチェックしたので、こちらもチェックし、ショーダウン（役の強さを比べて勝者を決めること）に進みます。これ以上のベットはリスクが高すぎます。"\n}'
2025-10-31 19:00:16,574 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はJ♦7♦、コミュニティカードは4♠ 10♣ 5♥ 8♠ 3♥です。これで完成する役は、Jハイ（ジャックが一番強いカード）です。相手（プレイヤー3）はチェックしたので、こちらもチェックし、ショーダウン（役の強さを比べて勝者を決めること）に進みます。これ以上のベットはリスクが高すぎます。"
}
2025-10-31 19:00:16,575 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最後のコミュニティカード）が配られ、あなたの手札はJ♦7♦、コミュニティカードは4♠ 10♣ 5♥ 8♠ 3♥です。これで完成する役は、Jハイ（ジャックが一番強いカード）です。相手（プレイヤー3）はチェックしたので、こちらもチェックし、ショーダウン（役の強さを比べて勝者を決めること）に進みます。これ以上のベットはリスクが高すぎます。'}
2025-10-31 19:00:16,575 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 19:00:16,575 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 19:00:16,575 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:00:16,576 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, リバー（最後のコミュニティカード）が配られ、あなたの手札はJ♦7♦、コミュニティカードは4♠ 10♣ 5♥ 8♠ 3♥です。これで完成する役は、Jハイ（ジャックが一番強いカード）です。相手（プレイヤー3）はチェックしたので、こちらもチェックし、ショーダウン（役の強さを比べて勝者を決めること）に進みます。これ以上のベットはリスクが高すぎます。
2025-10-31 19:00:16,577 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 19:00:16,578 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:16,578 - poker_game - INFO - Hand #20, Phase: river
2025-10-31 19:00:16,578 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:16,579 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:16,579 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:16,580 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:16,581 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:16,582 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:16,582 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,583 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:16,583 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,584 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:16,585 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:16,585 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,586 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 19:00:16,600 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:16,601 - poker_game - INFO - Hand #20, Phase: river
2025-10-31 19:00:16,601 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:00:16,602 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:16,602 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:16,603 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:16,603 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:16,603 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:16,604 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,604 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:16,604 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,604 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:16,605 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:16,605 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 19:00:16,605 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,606 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:16,606 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:16,606 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:16,606 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:00:16,606 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:16,607 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:16,607 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:16,607 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 19:00:16,608 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:00:16,608 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:00:16,608 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:00:16,608 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:00:16,608 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 19:00:16,609 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:16,609 - poker_game - INFO - Hand #20, Phase: river
2025-10-31 19:00:16,610 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:16,610 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:16,611 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:16,611 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:16,612 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:16,612 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:16,613 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,613 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:16,613 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,614 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:16,615 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:16,615 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:00:16,615 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,716 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 19:00:16,718 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:16,719 - poker_game - INFO - Remaining players: 2
2025-10-31 19:00:16,719 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:00:16,719 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:00:16,720 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 19:00:16,720 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:00:16,720 - poker_game - INFO - Hand #20, Phase: showdown
2025-10-31 19:00:16,720 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:00:16,720 - poker_game - INFO - Pot: 420, Current bet: 0
2025-10-31 19:00:16,721 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:16,721 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:16,721 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:16,721 - poker_game - INFO - Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:16,722 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,722 - poker_game - INFO -   P1(Agent1): chips=2924, bet=0, status=active
2025-10-31 19:00:16,722 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,722 - poker_game - INFO -   P3(Agent3): chips=1237, bet=0, status=active
2025-10-31 19:00:16,723 - poker_game - INFO -   P4(Agent4): chips=5419, bet=0, status=folded
2025-10-31 19:00:16,723 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,723 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:00:16,724 - poker_game - INFO - Pot: 420, Community cards: ['4♠', '10♣', '5♥', '8♠', '3♥']
2025-10-31 19:00:16,724 - poker_game - INFO -   Player 1 status=active cards=['7♦', 'J♦']
2025-10-31 19:00:16,724 - poker_game - INFO -   Player 3 status=active cards=['7♠', '8♣']
2025-10-31 19:00:16,727 - poker_game - INFO -   Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=['7♦', 'J♦']
2025-10-31 19:00:16,728 - poker_game - INFO -   Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=['7♠', '8♣']
2025-10-31 19:00:16,728 - poker_game - INFO - Pot layer 0: amount=60, contributors=[1, 3, 4]
2025-10-31 19:00:16,729 - poker_game - INFO - Pot layer 1: amount=360, contributors=[1, 3]
2025-10-31 19:00:16,729 - poker_game - INFO - Showdown total awarded: 420 (game.pot=420)
2025-10-31 19:00:16,730 - poker_game - INFO - Showdown winners (aggregated): [3]
2025-10-31 19:00:16,730 - poker_game - INFO -   Awarded 420 to Player 3 (hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥)
2025-10-31 19:00:16,731 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:00:16,777 - poker_game - INFO - === STARTING NEW HAND #21 ===
2025-10-31 19:00:16,777 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:00:16,778 - poker_game - INFO - Moving dealer button
2025-10-31 19:00:16,778 - poker_game - INFO - Posting blinds
2025-10-31 19:00:16,801 - poker_game - INFO - Dealing hole cards
2025-10-31 19:00:16,801 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:00:16,815 - poker_game - INFO - Started new hand in database: hand_id=21
2025-10-31 19:00:16,816 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:00:16,817 - poker_game - INFO - Hand #21, Phase: preflop
2025-10-31 19:00:16,817 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:00:16,817 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:16,818 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:16,818 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:16,819 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:00:16,819 - poker_game - INFO - Community cards: []
2025-10-31 19:00:16,819 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,820 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:16,820 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,821 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=active
2025-10-31 19:00:16,821 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=active
2025-10-31 19:00:16,821 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,822 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "4♠",
    "8♦"
  ],
  "community": [],
  "your_chips": 1657,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2904,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1657)"
  ],
  "history": [
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 19:00:16,841 - poker_game - DEBUG - Create Session: {'id': 'aba06dfe-32ae-48e3-90c4-194f1511d031', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904816.8373322}
2025-10-31 19:00:16,581 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Preflopで 48o という弱いハンドを持っています。コールするには20チップ必要ですが、ポットのサイズ（30）と相手のベット（20）を考慮すると、このハンドでコールするのは不利です。相手がレイズしてきた場合、さらに不利な状況になります。したがって、フォールドするのが最善の判断です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 103, 'promptTokenCount': 915, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 915}], 'totalTokenCount': 1018}, 'invocationId': 'e-d5941cca-04e9-4e3d-98c7-ab34ce520f44', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'NiuCvNzr', 'timestamp': 1761904816.855341}]
2025-10-31 19:00:16,582 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:00:16,582 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "Preflopで 48o という弱いハンドを持っています。コールするには20チップ必要ですが、ポットのサイズ（30）と相手のベット（20）を考慮すると、このハンドでコールするのは不利です。相手がレイズしてきた場合、さらに不利な状況になります。したがって、フォールドするのが最善の判断です。"
}
```
2025-10-31 19:00:16,582 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:00:16,583 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Preflopで 48o という弱いハンドを持っています。コールするには20チップ必要ですが、ポットのサイズ（30）と相手のベット（20）を考慮すると、このハンドでコールするのは不利です。相手がレイズしてきた場合、さらに不利な状況になります。したがって、フォールドするのが最善の判断です。"\n}\n```'
2025-10-31 19:00:16,583 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:00:16,583 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "Preflopで 48o という弱いハンドを持っています。コールするには20チップ必要ですが、ポットのサイズ（30）と相手のベット（20）を考慮すると、このハンドでコールするのは不利です。相手がレイズしてきた場合、さらに不利な状況になります。したがって、フォールドするのが最善の判断です。"\n}'
2025-10-31 19:00:16,584 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "Preflopで 48o という弱いハンドを持っています。コールするには20チップ必要ですが、ポットのサイズ（30）と相手のベット（20）を考慮すると、このハンドでコールするのは不利です。相手がレイズしてきた場合、さらに不利な状況になります。したがって、フォールドするのが最善の判断です。"
}
2025-10-31 19:00:16,584 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'Preflopで 48o という弱いハンドを持っています。コールするには20チップ必要ですが、ポットのサイズ（30）と相手のベット（20）を考慮すると、このハンドでコールするのは不利です。相手がレイズしてきた場合、さらに不利な状況になります。したがって、フォールドするのが最善の判断です。'}
2025-10-31 19:00:16,584 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 19:00:16,584 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 19:00:16,584 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:00:16,584 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, Preflopで 48o という弱いハンドを持っています。コールするには20チップ必要ですが、ポットのサイズ（30）と相手のベット（20）を考慮すると、このハンドでコールするのは不利です。相手がレイズしてきた場合、さらに不利な状況になります。したがって、フォールドするのが最善の判断です。
2025-10-31 19:00:16,586 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 19:00:16,586 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:16,587 - poker_game - INFO - Hand #21, Phase: preflop
2025-10-31 19:00:16,589 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:00:16,589 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:16,590 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:16,590 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:16,591 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:00:16,591 - poker_game - INFO - Community cards: []
2025-10-31 19:00:16,593 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,593 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:16,593 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,594 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=active
2025-10-31 19:00:16,594 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=active
2025-10-31 19:00:16,594 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,595 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 19:00:16,614 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:16,615 - poker_game - INFO - Hand #21, Phase: preflop
2025-10-31 19:00:16,615 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:00:16,615 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:16,616 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:16,616 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:16,617 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:16,617 - poker_game - INFO - Community cards: []
2025-10-31 19:00:16,619 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,620 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:16,620 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,620 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=folded
2025-10-31 19:00:16,621 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=active
2025-10-31 19:00:16,621 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 19:00:16,621 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,622 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:16,622 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:16,623 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:00:16,623 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:00:16,623 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:16,623 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:16,624 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:16,624 - poker_game - DEBUG - Player bets: [20, 10], Current bet: 20, All same: False
2025-10-31 19:00:16,624 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:00:16,624 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:16,625 - poker_game - INFO - Hand #21, Phase: preflop
2025-10-31 19:00:16,625 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:00:16,625 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:16,625 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:16,626 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:16,626 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:16,627 - poker_game - INFO - Community cards: []
2025-10-31 19:00:16,627 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:16,627 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:16,628 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:16,628 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=folded
2025-10-31 19:00:16,628 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=active
2025-10-31 19:00:16,629 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:00:16,629 - poker_game - INFO - ==================================================
2025-10-31 19:00:16,730 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "J♥",
    "4♣"
  ],
  "community": [],
  "your_chips": 5409,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2904,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1657,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (5409)"
  ],
  "history": [
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 4♠, 10♣, 5♥",
    "Player 3 raised to 60",
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded"
  ]
}
2025-10-31 19:00:16,745 - poker_game - DEBUG - Create Session: {'id': '778daf2f-2da9-4366-81b6-6511e5215cd1', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904816.7420967}
2025-10-31 19:00:26,859 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:00:36,874 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:00:40,636 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_KPvDlMxg7JdRQNv5V9KDjMSb', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1239, 'totalTokenCount': 1256}, 'invocationId': 'e-ea6a15d1-d942-4b99-929e-bdfbc49fb461', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'wj5HuyvI', 'timestamp': 1761904816.756892}, {'content': {'parts': [{'functionResponse': {'id': 'call_KPvDlMxg7JdRQNv5V9KDjMSb', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-ea6a15d1-d942-4b99-929e-bdfbc49fb461', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'FVUdw4g3', 'timestamp': 1761904818.411455}, {'content': {'parts': [{'functionCall': {'id': 'call_nAOxsjY1z84PS99hxMoNdcjG', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♥', '4♣'], 'community': [], 'your_chips': 5409, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2904, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1657, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (5409)'], 'history': ['Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♠, 10♣, 5♥', 'Player 3 raised to 60', 'Player 4 folded', 'Player 1 called 60', 'Turn dealt: 8♠', 'Player 3 raised to 120', 'Player 1 called 120', 'River dealt: 3♥', 'Player 3 checked', 'Player 1 checked', 'Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦', 'Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣', 'Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥', 'Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.2}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_0AozsdSgZMGKfO9wom30dd2e', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['J♥', '4♣'], 'community': [], 'your_chips': 5409, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2904, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1657, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (5409)'], 'history': ['Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 4♠, 10♣, 5♥', 'Player 3 raised to 60', 'Player 4 folded', 'Player 1 called 60', 'Turn dealt: 8♠', 'Player 3 raised to 120', 'Player 1 called 120', 'River dealt: 3♥', 'Player 3 checked', 'Player 1 checked', 'Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦', 'Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣', 'Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥', 'Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 958, 'promptTokenCount': 1763, 'totalTokenCount': 2721}, 'invocationId': 'e-ea6a15d1-d942-4b99-929e-bdfbc49fb461', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '7Wc4QyIG', 'timestamp': 1761904818.414717}, {'content': {'parts': [{'functionResponse': {'id': 'call_nAOxsjY1z84PS99hxMoNdcjG', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド'}}}, {'functionResponse': {'id': 'call_0AozsdSgZMGKfO9wom30dd2e', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'GKZmNUod', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'aHeyJDHC', 'timestamp': 1761904837.746047}, {'content': {'parts': [{'text': '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 49, 'promptTokenCount': 2951, 'totalTokenCount': 3000}, 'invocationId': 'e-ea6a15d1-d942-4b99-929e-bdfbc49fb461', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'R5jkPSIA', 'timestamp': 1761904837.754473}]
2025-10-31 19:00:40,636 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:00:40,637 - poker_game - DEBUG - {
  "action": "fold",
  "amount": 0,
  "reasoning": "期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド"
}
2025-10-31 19:00:40,637 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:00:40,638 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド"\n}'
2025-10-31 19:00:40,638 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:00:40,638 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド"
}
2025-10-31 19:00:40,638 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド'}
2025-10-31 19:00:40,638 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 19:00:40,639 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 19:00:40,639 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:00:40,639 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が0.00(ポットに対して0.00%で、マイナスなのでフォールド
2025-10-31 19:00:40,640 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 19:00:40,641 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:40,641 - poker_game - INFO - Hand #21, Phase: preflop
2025-10-31 19:00:40,642 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:00:40,642 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:40,642 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:40,643 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:40,643 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:40,643 - poker_game - INFO - Community cards: []
2025-10-31 19:00:40,644 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:40,644 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:40,645 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:40,645 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=folded
2025-10-31 19:00:40,645 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=active
2025-10-31 19:00:40,646 - poker_game - INFO - ==================================================
2025-10-31 19:00:40,646 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 19:00:40,658 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:40,659 - poker_game - INFO - Hand #21, Phase: preflop
2025-10-31 19:00:40,660 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:00:40,661 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:40,661 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:40,661 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:40,662 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:00:40,662 - poker_game - INFO - Community cards: []
2025-10-31 19:00:40,663 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:40,663 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:40,664 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:40,664 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=folded
2025-10-31 19:00:40,665 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=folded
2025-10-31 19:00:40,665 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 19:00:40,665 - poker_game - INFO - ==================================================
2025-10-31 19:00:40,666 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:40,666 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:40,667 - poker_game - DEBUG - Active players: [1]
2025-10-31 19:00:40,667 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:00:40,667 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:40,668 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:40,668 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 19:00:40,668 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 19:00:40,669 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:40,669 - poker_game - INFO - Hand #21, Phase: preflop
2025-10-31 19:00:40,669 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:00:40,669 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:40,670 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:40,670 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:40,670 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:00:40,671 - poker_game - INFO - Community cards: []
2025-10-31 19:00:40,671 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:40,671 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:40,671 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:40,672 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=folded
2025-10-31 19:00:40,672 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=folded
2025-10-31 19:00:40,672 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:00:40,673 - poker_game - INFO - ==================================================
2025-10-31 19:00:40,774 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:00:40,775 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:40,775 - poker_game - INFO - Remaining players: 1
2025-10-31 19:00:40,775 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:00:40,775 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 19:00:40,775 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:00:40,776 - poker_game - INFO - Hand #21, Phase: showdown
2025-10-31 19:00:40,776 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:00:40,777 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:40,777 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:40,777 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:40,778 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:00:40,778 - poker_game - INFO - Community cards: []
2025-10-31 19:00:40,779 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:40,779 - poker_game - INFO -   P1(Agent1): chips=2904, bet=20, status=active
2025-10-31 19:00:40,779 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:40,780 - poker_game - INFO -   P3(Agent3): chips=1657, bet=0, status=folded
2025-10-31 19:00:40,780 - poker_game - INFO -   P4(Agent4): chips=5409, bet=10, status=folded
2025-10-31 19:00:40,781 - poker_game - INFO - ==================================================
2025-10-31 19:00:40,782 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:00:40,782 - poker_game - INFO - Pot: 30, Community cards: []
2025-10-31 19:00:40,783 - poker_game - INFO -   Player 1 status=active cards=['2♠', 'J♣']
2025-10-31 19:00:40,784 - poker_game - INFO - Showdown winner by default: Player 1 awarded 30
2025-10-31 19:00:40,785 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:00:40,785 - poker_game - INFO - === STARTING NEW HAND #22 ===
2025-10-31 19:00:40,786 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:00:40,787 - poker_game - INFO - Moving dealer button
2025-10-31 19:00:40,787 - poker_game - INFO - Posting blinds
2025-10-31 19:00:40,813 - poker_game - INFO - Dealing hole cards
2025-10-31 19:00:40,813 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:00:40,824 - poker_game - INFO - Started new hand in database: hand_id=22
2025-10-31 19:00:40,825 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:00:40,825 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:40,826 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:00:40,826 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:40,826 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:40,827 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:40,827 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:00:40,828 - poker_game - INFO - Community cards: []
2025-10-31 19:00:40,828 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:40,828 - poker_game - INFO -   P1(Agent1): chips=2924, bet=10, status=active
2025-10-31 19:00:40,829 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:40,829 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:40,830 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=active
2025-10-31 19:00:40,831 - poker_game - INFO - ==================================================
2025-10-31 19:00:40,832 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "2♥",
    "4♠"
  ],
  "community": [],
  "your_chips": 5409,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2924,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1637,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (5409)"
  ],
  "history": [
    "Player 3 raised to 60",
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 19:00:40,843 - poker_game - DEBUG - Create Session: {'id': 'd341161b-9bfd-43cb-ad85-ab032d4c803d', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904840.839417}
2025-10-31 19:00:50,874 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:00:53,825 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_DFxDSBnXj9tcGZDXmbPVopEO', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1234, 'totalTokenCount': 1251}, 'invocationId': 'e-80ddec19-678b-465c-9dba-4529da67daf4', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Y9Oeb9KS', 'timestamp': 1761904840.854064}, {'content': {'parts': [{'functionResponse': {'id': 'call_DFxDSBnXj9tcGZDXmbPVopEO', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-80ddec19-678b-465c-9dba-4529da67daf4', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'AK9ANXun', 'timestamp': 1761904842.042212}, {'content': {'parts': [{'functionCall': {'id': 'call_RnnEi7CKfo3SQOg1PGykXh0W', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_6n7HpJXRwqvIx9fdFlABNyvE', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['2♥', '4♠'], 'community': [], 'your_chips': 5409, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2924, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 1637, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (5409)'], 'history': ['Player 3 raised to 60', 'Player 4 folded', 'Player 1 called 60', 'Turn dealt: 8♠', 'Player 3 raised to 120', 'Player 1 called 120', 'River dealt: 3♥', 'Player 3 checked', 'Player 1 checked', 'Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦', 'Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣', 'Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥', 'Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.1}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 473, 'promptTokenCount': 1758, 'totalTokenCount': 2231}, 'invocationId': 'e-80ddec19-678b-465c-9dba-4529da67daf4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '2gNVUja8', 'timestamp': 1761904842.046528}, {'content': {'parts': [{'functionResponse': {'id': 'call_RnnEi7CKfo3SQOg1PGykXh0W', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_6n7HpJXRwqvIx9fdFlABNyvE', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-13.00(ポットに対して-43.33%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'Pv7P5ioW', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '3IAuloGF', 'timestamp': 1761904851.605493}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が-13.00(ポットに対して-43.33%で、マイナスなのでフォールド)"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 42, 'promptTokenCount': 2360, 'totalTokenCount': 2402}, 'invocationId': 'e-80ddec19-678b-465c-9dba-4529da67daf4', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'bLKnds8p', 'timestamp': 1761904851.608087}]
2025-10-31 19:00:53,826 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:00:53,826 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が-13.00(ポットに対して-43.33%で、マイナスなのでフォールド)"}
2025-10-31 19:00:53,826 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:00:53,826 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が-13.00(ポットに対して-43.33%で、マイナスなのでフォールド)"}'
2025-10-31 19:00:53,827 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:00:53,827 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が-13.00(ポットに対して-43.33%で、マイナスなのでフォールド)"}
2025-10-31 19:00:53,827 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-13.00(ポットに対して-43.33%で、マイナスなのでフォールド)'}
2025-10-31 19:00:53,827 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 19:00:53,827 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 19:00:53,827 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:00:53,827 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が-13.00(ポットに対して-43.33%で、マイナスなのでフォールド)
2025-10-31 19:00:53,828 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 19:00:53,828 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:53,828 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:53,829 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:00:53,829 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:53,829 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:53,829 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:53,829 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:00:53,829 - poker_game - INFO - Community cards: []
2025-10-31 19:00:53,830 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:53,830 - poker_game - INFO -   P1(Agent1): chips=2924, bet=10, status=active
2025-10-31 19:00:53,830 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:53,830 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:53,831 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=active
2025-10-31 19:00:53,831 - poker_game - INFO - ==================================================
2025-10-31 19:00:53,831 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 19:00:53,842 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:53,843 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:53,843 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:00:53,843 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:53,843 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:53,843 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:53,844 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:53,844 - poker_game - INFO - Community cards: []
2025-10-31 19:00:53,844 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:53,844 - poker_game - INFO -   P1(Agent1): chips=2924, bet=10, status=active
2025-10-31 19:00:53,844 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:53,845 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:53,845 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:53,845 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 19:00:53,845 - poker_game - INFO - ==================================================
2025-10-31 19:00:53,845 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:53,846 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:53,846 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:53,846 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:00:53,846 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:53,846 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:53,846 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:53,846 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 19:00:53,846 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:00:53,847 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:53,847 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:53,847 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:00:53,847 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:53,847 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:53,847 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:53,847 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:53,847 - poker_game - INFO - Community cards: []
2025-10-31 19:00:53,848 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:53,848 - poker_game - INFO -   P1(Agent1): chips=2924, bet=10, status=active
2025-10-31 19:00:53,848 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:53,848 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:53,848 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:53,848 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:00:53,849 - poker_game - INFO - ==================================================
2025-10-31 19:00:53,950 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "5♣",
    "5♦"
  ],
  "community": [],
  "your_chips": 2924,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1637,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (2924)"
  ],
  "history": [
    "Player 4 folded",
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded"
  ]
}
2025-10-31 19:00:53,961 - poker_game - DEBUG - Create Session: {'id': 'a1e361c0-9dce-4480-a9fc-467c5d52d873', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904853.9590666}
2025-10-31 19:00:56,087 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "ペア（5-5）を持っており、フロップ前の段階では強いハンドです。ポットを大きくしたいので、最小限のレイズ（40）でアクションします。これは、相手にコールするか、さらにレイズするか、フォールドするかを迫るための戦略です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 91, 'promptTokenCount': 905, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 905}], 'totalTokenCount': 996}, 'invocationId': 'e-75f4bb8e-c086-4d89-aab6-44a8392e4379', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'AXSgUaQC', 'timestamp': 1761904853.973611}]
2025-10-31 19:00:56,088 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:00:56,088 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 40,
  "reasoning": "ペア（5-5）を持っており、フロップ前の段階では強いハンドです。ポットを大きくしたいので、最小限のレイズ（40）でアクションします。これは、相手にコールするか、さらにレイズするか、フォールドするかを迫るための戦略です。"
}
```
2025-10-31 19:00:56,088 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:00:56,088 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "ペア（5-5）を持っており、フロップ前の段階では強いハンドです。ポットを大きくしたいので、最小限のレイズ（40）でアクションします。これは、相手にコールするか、さらにレイズするか、フォールドするかを迫るための戦略です。"\n}\n```'
2025-10-31 19:00:56,089 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:00:56,089 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "ペア（5-5）を持っており、フロップ前の段階では強いハンドです。ポットを大きくしたいので、最小限のレイズ（40）でアクションします。これは、相手にコールするか、さらにレイズするか、フォールドするかを迫るための戦略です。"\n}'
2025-10-31 19:00:56,089 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 40,
  "reasoning": "ペア（5-5）を持っており、フロップ前の段階では強いハンドです。ポットを大きくしたいので、最小限のレイズ（40）でアクションします。これは、相手にコールするか、さらにレイズするか、フォールドするかを迫るための戦略です。"
}
2025-10-31 19:00:56,089 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 40, 'reasoning': 'ペア（5-5）を持っており、フロップ前の段階では強いハンドです。ポットを大きくしたいので、最小限のレイズ（40）でアクションします。これは、相手にコールするか、さらにレイズするか、フォールドするかを迫るための戦略です。'}
2025-10-31 19:00:56,089 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 40
2025-10-31 19:00:56,090 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (2924)']
2025-10-31 19:00:56,090 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 19:00:56,090 - poker_game - DEBUG - [Agent1] Raise amount 40 is valid (min: 40)
2025-10-31 19:00:56,090 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 40}
2025-10-31 19:00:56,090 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 40, ペア（5-5）を持っており、フロップ前の段階では強いハンドです。ポットを大きくしたいので、最小限のレイズ（40）でアクションします。これは、相手にコールするか、さらにレイズするか、フォールドするかを迫るための戦略です。
2025-10-31 19:00:56,091 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 40
2025-10-31 19:00:56,092 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:56,092 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:56,093 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:00:56,093 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:00:56,093 - poker_game - INFO - Last raiser: 3
2025-10-31 19:00:56,094 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:56,094 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:56,094 - poker_game - INFO - Community cards: []
2025-10-31 19:00:56,095 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:56,095 - poker_game - INFO -   P1(Agent1): chips=2924, bet=10, status=active
2025-10-31 19:00:56,096 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:56,096 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:56,096 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:56,097 - poker_game - INFO - ==================================================
2025-10-31 19:00:56,097 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 60
2025-10-31 19:00:56,112 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:56,112 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:56,113 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:00:56,113 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:00:56,114 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:56,115 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:56,115 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:56,116 - poker_game - INFO - Community cards: []
2025-10-31 19:00:56,116 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:56,117 - poker_game - INFO -   P1(Agent1): chips=2874, bet=60, status=active
2025-10-31 19:00:56,117 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:56,117 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:56,118 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:56,118 - poker_game - INFO - Extra: Action: Player 1 raised to 60
2025-10-31 19:00:56,118 - poker_game - INFO - ==================================================
2025-10-31 19:00:56,119 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:56,119 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:56,119 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:56,119 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:00:56,120 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:56,120 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:56,120 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:56,120 - poker_game - DEBUG - Player bets: [60, 20], Current bet: 60, All same: False
2025-10-31 19:00:56,120 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:00:56,121 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:56,121 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:56,121 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:00:56,122 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:00:56,122 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:56,123 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:56,124 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:56,125 - poker_game - INFO - Community cards: []
2025-10-31 19:00:56,127 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:56,127 - poker_game - INFO -   P1(Agent1): chips=2874, bet=60, status=active
2025-10-31 19:00:56,129 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:56,131 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:56,132 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:56,134 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:00:56,135 - poker_game - INFO - ==================================================
2025-10-31 19:00:56,236 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "9♣",
    "A♥"
  ],
  "community": [],
  "your_chips": 1637,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 80,
  "to_call": 40,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2874,
      "bet": 60,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (40)",
    "raise (min 80)",
    "all-in (1637)"
  ],
  "history": [
    "Player 1 called 60",
    "Turn dealt: 8♠",
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60"
  ]
}
2025-10-31 19:00:56,251 - poker_game - DEBUG - Create Session: {'id': 'db91d223-37ca-4712-a575-e7b3027be81b', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904856.2474098}
2025-10-31 19:00:58,896 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 40,\n  "reasoning": "Asi es, tienes A-9 offsuit, lo cual es una mano decente preflop, pero el historial de la mano indica que el jugador 1 es agresivo y ya ha apostado. Tu posición es mala, ya que eres el último en actuar. Considerando que el bote ya es considerable (80 fichas) y el coste para ver la siguiente carta es de 40, es una llamada razonable. El jugador 1 ha apostado 60, y tú has puesto 20 ya. Necesitas poner 40 más para igualar su apuesta y ver el flop. Si hubieras actuado antes, una subida podría haber sido una opción para intentar llevarte el bote preflop, pero con la información de que el jugador 1 ha completado (llamado) la apuesta anterior y ahora ha vuelto a apostar 60, es más prudente ver el flop antes de comprometer más fichas."\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 227, 'promptTokenCount': 909, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 909}], 'totalTokenCount': 1136}, 'invocationId': 'e-c3d41e7e-9376-4c56-830c-2d86804f9bca', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'bMc1CGfO', 'timestamp': 1761904856.265937}]
2025-10-31 19:00:58,897 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:00:58,897 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 40,
  "reasoning": "Asi es, tienes A-9 offsuit, lo cual es una mano decente preflop, pero el historial de la mano indica que el jugador 1 es agresivo y ya ha apostado. Tu posición es mala, ya que eres el último en actuar. Considerando que el bote ya es considerable (80 fichas) y el coste para ver la siguiente carta es de 40, es una llamada razonable. El jugador 1 ha apostado 60, y tú has puesto 20 ya. Necesitas poner 40 más para igualar su apuesta y ver el flop. Si hubieras actuado antes, una subida podría haber sido una opción para intentar llevarte el bote preflop, pero con la información de que el jugador 1 ha completado (llamado) la apuesta anterior y ahora ha vuelto a apostar 60, es más prudente ver el flop antes de comprometer más fichas."
}
```
2025-10-31 19:00:58,897 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:00:58,898 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 40,\n  "reasoning": "Asi es, tienes A-9 offsuit, lo cual es una mano decente preflop, pero el historial de la mano indica que el jugador 1 es agresivo y ya ha apostado. Tu posición es mala, ya que eres el último en actuar. Considerando que el bote ya es considerable (80 fichas) y el coste para ver la siguiente carta es de 40, es una llamada razonable. El jugador 1 ha apostado 60, y tú has puesto 20 ya. Necesitas poner 40 más para igualar su apuesta y ver el flop. Si hubieras actuado antes, una subida podría haber sido una opción para intentar llevarte el bote preflop, pero con la información de que el jugador 1 ha completado (llamado) la apuesta anterior y ahora ha vuelto a apostar 60, es más prudente ver el flop antes de comprometer más fichas."\n}\n```'
2025-10-31 19:00:58,898 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:00:58,898 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 40,\n  "reasoning": "Asi es, tienes A-9 offsuit, lo cual es una mano decente preflop, pero el historial de la mano indica que el jugador 1 es agresivo y ya ha apostado. Tu posición es mala, ya que eres el último en actuar. Considerando que el bote ya es considerable (80 fichas) y el coste para ver la siguiente carta es de 40, es una llamada razonable. El jugador 1 ha apostado 60, y tú has puesto 20 ya. Necesitas poner 40 más para igualar su apuesta y ver el flop. Si hubieras actuado antes, una subida podría haber sido una opción para intentar llevarte el bote preflop, pero con la información de que el jugador 1 ha completado (llamado) la apuesta anterior y ahora ha vuelto a apostar 60, es más prudente ver el flop antes de comprometer más fichas."\n}'
2025-10-31 19:00:58,898 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 40,
  "reasoning": "Asi es, tienes A-9 offsuit, lo cual es una mano decente preflop, pero el historial de la mano indica que el jugador 1 es agresivo y ya ha apostado. Tu posición es mala, ya que eres el último en actuar. Considerando que el bote ya es considerable (80 fichas) y el coste para ver la siguiente carta es de 40, es una llamada razonable. El jugador 1 ha apostado 60, y tú has puesto 20 ya. Necesitas poner 40 más para igualar su apuesta y ver el flop. Si hubieras actuado antes, una subida podría haber sido una opción para intentar llevarte el bote preflop, pero con la información de que el jugador 1 ha completado (llamado) la apuesta anterior y ahora ha vuelto a apostar 60, es más prudente ver el flop antes de comprometer más fichas."
}
2025-10-31 19:00:58,899 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 40, 'reasoning': 'Asi es, tienes A-9 offsuit, lo cual es una mano decente preflop, pero el historial de la mano indica que el jugador 1 es agresivo y ya ha apostado. Tu posición es mala, ya que eres el último en actuar. Considerando que el bote ya es considerable (80 fichas) y el coste para ver la siguiente carta es de 40, es una llamada razonable. El jugador 1 ha apostado 60, y tú has puesto 20 ya. Necesitas poner 40 más para igualar su apuesta y ver el flop. Si hubieras actuado antes, una subida podría haber sido una opción para intentar llevarte el bote preflop, pero con la información de que el jugador 1 ha completado (llamado) la apuesta anterior y ahora ha vuelto a apostar 60, es más prudente ver el flop antes de comprometer más fichas.'}
2025-10-31 19:00:58,899 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 40
2025-10-31 19:00:58,899 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (40)', 'raise (min 80)', 'all-in (1637)']
2025-10-31 19:00:58,899 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (40)': 40
2025-10-31 19:00:58,899 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 40}
2025-10-31 19:00:58,899 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 40, Asi es, tienes A-9 offsuit, lo cual es una mano decente preflop, pero el historial de la mano indica que el jugador 1 es agresivo y ya ha apostado. Tu posición es mala, ya que eres el último en actuar. Considerando que el bote ya es considerable (80 fichas) y el coste para ver la siguiente carta es de 40, es una llamada razonable. El jugador 1 ha apostado 60, y tú has puesto 20 ya. Necesitas poner 40 más para igualar su apuesta y ver el flop. Si hubieras actuado antes, una subida podría haber sido una opción para intentar llevarte el bote preflop, pero con la información de que el jugador 1 ha completado (llamado) la apuesta anterior y ahora ha vuelto a apostar 60, es más prudente ver el flop antes de comprometer más fichas.
2025-10-31 19:00:58,900 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 40
2025-10-31 19:00:58,901 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:00:58,901 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:58,902 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:00:58,902 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:00:58,902 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:58,903 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:58,903 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:58,903 - poker_game - INFO - Community cards: []
2025-10-31 19:00:58,904 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:58,904 - poker_game - INFO -   P1(Agent1): chips=2874, bet=60, status=active
2025-10-31 19:00:58,905 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:58,905 - poker_game - INFO -   P3(Agent3): chips=1637, bet=20, status=active
2025-10-31 19:00:58,905 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:58,906 - poker_game - INFO - ==================================================
2025-10-31 19:00:58,907 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 40
2025-10-31 19:00:58,917 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:00:58,918 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:58,918 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:00:58,918 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 19:00:58,919 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:58,919 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:58,920 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:58,920 - poker_game - INFO - Community cards: []
2025-10-31 19:00:58,920 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:58,921 - poker_game - INFO -   P1(Agent1): chips=2874, bet=60, status=active
2025-10-31 19:00:58,921 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:58,922 - poker_game - INFO -   P3(Agent3): chips=1597, bet=60, status=active
2025-10-31 19:00:58,922 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:58,922 - poker_game - INFO - Extra: Action: Player 3 called 40
2025-10-31 19:00:58,923 - poker_game - INFO - ==================================================
2025-10-31 19:00:58,923 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:00:58,924 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:00:58,924 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:00:58,924 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:00:58,924 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:00:58,925 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:00:58,925 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:00:58,925 - poker_game - DEBUG - Player bets: [60, 60], Current bet: 60, All same: True
2025-10-31 19:00:58,926 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:00:58,926 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:00:58,927 - poker_game - INFO - Hand #22, Phase: preflop
2025-10-31 19:00:58,927 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:00:58,928 - poker_game - INFO - Pot: 120, Current bet: 60
2025-10-31 19:00:58,928 - poker_game - INFO - Last raiser: 1
2025-10-31 19:00:58,928 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:58,928 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:58,929 - poker_game - INFO - Community cards: []
2025-10-31 19:00:58,929 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:58,930 - poker_game - INFO -   P1(Agent1): chips=2874, bet=60, status=active
2025-10-31 19:00:58,930 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:58,931 - poker_game - INFO -   P3(Agent3): chips=1597, bet=60, status=active
2025-10-31 19:00:58,931 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:58,932 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:00:58,932 - poker_game - INFO - ==================================================
2025-10-31 19:00:59,033 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:00:59,034 - poker_game - INFO - Betting round complete: True
2025-10-31 19:00:59,035 - poker_game - INFO - Remaining players: 2
2025-10-31 19:00:59,036 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:00:59,036 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:00:59,036 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 19:00:59,047 - poker_game - INFO - Starting new betting round
2025-10-31 19:00:59,048 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:00:59,048 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:00:59,049 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 19:00:59,049 - poker_game - DEBUG - Dealer button: 4
2025-10-31 19:00:59,049 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 19:00:59,049 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:00:59,050 - poker_game - INFO - Hand #22, Phase: flop
2025-10-31 19:00:59,050 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:00:59,051 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:00:59,052 - poker_game - INFO - Last raiser: None
2025-10-31 19:00:59,053 - poker_game - INFO - Betting round complete: False
2025-10-31 19:00:59,053 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:00:59,054 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥']
2025-10-31 19:00:59,054 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:00:59,054 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:00:59,054 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:00:59,055 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:00:59,055 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:00:59,056 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 19:00:59,056 - poker_game - INFO - ==================================================
2025-10-31 19:00:59,057 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "5♣",
    "5♦"
  ],
  "community": [
    "6♥",
    "K♣",
    "K♥"
  ],
  "your_chips": 2874,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 60,
  "pot": 120,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1597,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (2874)"
  ],
  "history": [
    "Player 3 raised to 120",
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥"
  ]
}
2025-10-31 19:00:59,074 - poker_game - DEBUG - Create Session: {'id': '5273752d-efdf-4ed7-8eef-cb81eb7c4232', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904859.070744}
2025-10-31 19:01:01,376 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（Flop）は 6♥ K♣ K♥ です。あなたの手札は 5♣ 5♦ で、ペア（Pair）はまだありません。コミュニティカードにはキングのペア（K♣ K♥）がありますが、あなたはそれを持っていません。現在のポットは120で、あなたのアクションはチェック（check）です。つまり、ベットせずに次のカード（ターン、Turn）に進むか、相手のアクションを待つことができます。相手（Player 3）は、プリフロップ（pre-flop、最初のベットラウンド）でレイズ（raise、ベット額を上げる）してきましたが、フロップではチェックしました。これは、相手も強い役を持っていないか、あるいはブラフ（bluff、弱い役で相手を降ろさせようとすること）をしている可能性があります。あなたの手札はあまり強くありませんが、相手のチェックを見て、追加のベットをせずに様子を見るのが最善です。これにより、次のカードで役ができる可能性を探ることができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 238, 'promptTokenCount': 931, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 931}], 'totalTokenCount': 1169}, 'invocationId': 'e-d58154a0-73ea-45e2-a108-68183a953693', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'hqKzEnQ2', 'timestamp': 1761904859.085073}]
2025-10-31 19:01:01,377 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:01:01,377 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（Flop）は 6♥ K♣ K♥ です。あなたの手札は 5♣ 5♦ で、ペア（Pair）はまだありません。コミュニティカードにはキングのペア（K♣ K♥）がありますが、あなたはそれを持っていません。現在のポットは120で、あなたのアクションはチェック（check）です。つまり、ベットせずに次のカード（ターン、Turn）に進むか、相手のアクションを待つことができます。相手（Player 3）は、プリフロップ（pre-flop、最初のベットラウンド）でレイズ（raise、ベット額を上げる）してきましたが、フロップではチェックしました。これは、相手も強い役を持っていないか、あるいはブラフ（bluff、弱い役で相手を降ろさせようとすること）をしている可能性があります。あなたの手札はあまり強くありませんが、相手のチェックを見て、追加のベットをせずに様子を見るのが最善です。これにより、次のカードで役ができる可能性を探ることができます。"
}
```
2025-10-31 19:01:01,377 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:01:01,377 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（Flop）は 6♥ K♣ K♥ です。あなたの手札は 5♣ 5♦ で、ペア（Pair）はまだありません。コミュニティカードにはキングのペア（K♣ K♥）がありますが、あなたはそれを持っていません。現在のポットは120で、あなたのアクションはチェック（check）です。つまり、ベットせずに次のカード（ターン、Turn）に進むか、相手のアクションを待つことができます。相手（Player 3）は、プリフロップ（pre-flop、最初のベットラウンド）でレイズ（raise、ベット額を上げる）してきましたが、フロップではチェックしました。これは、相手も強い役を持っていないか、あるいはブラフ（bluff、弱い役で相手を降ろさせようとすること）をしている可能性があります。あなたの手札はあまり強くありませんが、相手のチェックを見て、追加のベットをせずに様子を見るのが最善です。これにより、次のカードで役ができる可能性を探ることができます。"\n}\n```'
2025-10-31 19:01:01,377 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:01:01,377 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（Flop）は 6♥ K♣ K♥ です。あなたの手札は 5♣ 5♦ で、ペア（Pair）はまだありません。コミュニティカードにはキングのペア（K♣ K♥）がありますが、あなたはそれを持っていません。現在のポットは120で、あなたのアクションはチェック（check）です。つまり、ベットせずに次のカード（ターン、Turn）に進むか、相手のアクションを待つことができます。相手（Player 3）は、プリフロップ（pre-flop、最初のベットラウンド）でレイズ（raise、ベット額を上げる）してきましたが、フロップではチェックしました。これは、相手も強い役を持っていないか、あるいはブラフ（bluff、弱い役で相手を降ろさせようとすること）をしている可能性があります。あなたの手札はあまり強くありませんが、相手のチェックを見て、追加のベットをせずに様子を見るのが最善です。これにより、次のカードで役ができる可能性を探ることができます。"\n}'
2025-10-31 19:01:01,378 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（Flop）は 6♥ K♣ K♥ です。あなたの手札は 5♣ 5♦ で、ペア（Pair）はまだありません。コミュニティカードにはキングのペア（K♣ K♥）がありますが、あなたはそれを持っていません。現在のポットは120で、あなたのアクションはチェック（check）です。つまり、ベットせずに次のカード（ターン、Turn）に進むか、相手のアクションを待つことができます。相手（Player 3）は、プリフロップ（pre-flop、最初のベットラウンド）でレイズ（raise、ベット額を上げる）してきましたが、フロップではチェックしました。これは、相手も強い役を持っていないか、あるいはブラフ（bluff、弱い役で相手を降ろさせようとすること）をしている可能性があります。あなたの手札はあまり強くありませんが、相手のチェックを見て、追加のベットをせずに様子を見るのが最善です。これにより、次のカードで役ができる可能性を探ることができます。"
}
2025-10-31 19:01:01,378 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（Flop）は 6♥ K♣ K♥ です。あなたの手札は 5♣ 5♦ で、ペア（Pair）はまだありません。コミュニティカードにはキングのペア（K♣ K♥）がありますが、あなたはそれを持っていません。現在のポットは120で、あなたのアクションはチェック（check）です。つまり、ベットせずに次のカード（ターン、Turn）に進むか、相手のアクションを待つことができます。相手（Player 3）は、プリフロップ（pre-flop、最初のベットラウンド）でレイズ（raise、ベット額を上げる）してきましたが、フロップではチェックしました。これは、相手も強い役を持っていないか、あるいはブラフ（bluff、弱い役で相手を降ろさせようとすること）をしている可能性があります。あなたの手札はあまり強くありませんが、相手のチェックを見て、追加のベットをせずに様子を見るのが最善です。これにより、次のカードで役ができる可能性を探ることができます。'}
2025-10-31 19:01:01,378 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:01,378 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 19:01:01,378 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:01,378 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, フロップ（Flop）は 6♥ K♣ K♥ です。あなたの手札は 5♣ 5♦ で、ペア（Pair）はまだありません。コミュニティカードにはキングのペア（K♣ K♥）がありますが、あなたはそれを持っていません。現在のポットは120で、あなたのアクションはチェック（check）です。つまり、ベットせずに次のカード（ターン、Turn）に進むか、相手のアクションを待つことができます。相手（Player 3）は、プリフロップ（pre-flop、最初のベットラウンド）でレイズ（raise、ベット額を上げる）してきましたが、フロップではチェックしました。これは、相手も強い役を持っていないか、あるいはブラフ（bluff、弱い役で相手を降ろさせようとすること）をしている可能性があります。あなたの手札はあまり強くありませんが、相手のチェックを見て、追加のベットをせずに様子を見るのが最善です。これにより、次のカードで役ができる可能性を探ることができます。
2025-10-31 19:01:01,379 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 19:01:01,379 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:01,379 - poker_game - INFO - Hand #22, Phase: flop
2025-10-31 19:01:01,379 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:01,380 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:01,380 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:01,380 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:01,380 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:01,380 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥']
2025-10-31 19:01:01,380 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:01,381 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:01,381 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:01,381 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:01,381 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:01,381 - poker_game - INFO - ==================================================
2025-10-31 19:01:01,381 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 19:01:01,393 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:01,394 - poker_game - INFO - Hand #22, Phase: flop
2025-10-31 19:01:01,394 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:01,394 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:01,394 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:01,394 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:01,395 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:01,395 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥']
2025-10-31 19:01:01,395 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:01,395 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:01,395 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:01,396 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:01,396 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:01,396 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 19:01:01,396 - poker_game - INFO - ==================================================
2025-10-31 19:01:01,396 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:01,397 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:01,397 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:01:01,397 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:01:01,397 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:01,397 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:01,397 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:01:01,397 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 19:01:01,397 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:01:01,397 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:01,397 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:01:01,398 - poker_game - DEBUG - First actor index: 1
2025-10-31 19:01:01,398 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 1
2025-10-31 19:01:01,398 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:01,398 - poker_game - INFO - Hand #22, Phase: flop
2025-10-31 19:01:01,398 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:01,398 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:01,398 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:01,398 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:01,399 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:01,399 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥']
2025-10-31 19:01:01,399 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:01,399 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:01,399 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:01,399 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:01,400 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:01,400 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:01,400 - poker_game - INFO - ==================================================
2025-10-31 19:01:01,502 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "9♣",
    "A♥"
  ],
  "community": [
    "6♥",
    "K♣",
    "K♥"
  ],
  "your_chips": 1597,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 60,
  "pot": 120,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2874,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1597)"
  ],
  "history": [
    "Player 1 called 120",
    "River dealt: 3♥",
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked"
  ]
}
2025-10-31 19:01:01,514 - poker_game - DEBUG - Create Session: {'id': '88af645e-207e-4662-b513-841aee8e2ee4', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904861.5116224}
2025-10-31 19:01:03,644 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ペア」と呼ばれる強い役ですが、相手もキングのペアを持っている可能性があります。さらに、相手はまだアクションをしていないので、様子を見るのが最善です。チェック（ベットせずに次のプレイヤーに順番を回すこと）を選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 126, 'promptTokenCount': 926, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 926}], 'totalTokenCount': 1052}, 'invocationId': 'e-678cd160-70c3-4f35-ac0c-8916e2f1cd23', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'fKKUcZbX', 'timestamp': 1761904861.525287}]
2025-10-31 19:01:03,645 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:01:03,645 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ペア」と呼ばれる強い役ですが、相手もキングのペアを持っている可能性があります。さらに、相手はまだアクションをしていないので、様子を見るのが最善です。チェック（ベットせずに次のプレイヤーに順番を回すこと）を選択します。"
}
```
2025-10-31 19:01:03,646 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:01:03,646 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ペア」と呼ばれる強い役ですが、相手もキングのペアを持っている可能性があります。さらに、相手はまだアクションをしていないので、様子を見るのが最善です。チェック（ベットせずに次のプレイヤーに順番を回すこと）を選択します。"\n}\n```'
2025-10-31 19:01:03,646 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:01:03,646 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ペア」と呼ばれる強い役ですが、相手もキングのペアを持っている可能性があります。さらに、相手はまだアクションをしていないので、様子を見るのが最善です。チェック（ベットせずに次のプレイヤーに順番を回すこと）を選択します。"\n}'
2025-10-31 19:01:03,647 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ペア」と呼ばれる強い役ですが、相手もキングのペアを持っている可能性があります。さらに、相手はまだアクションをしていないので、様子を見るのが最善です。チェック（ベットせずに次のプレイヤーに順番を回すこと）を選択します。"
}
2025-10-31 19:01:03,647 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ペア」と呼ばれる強い役ですが、相手もキングのペアを持っている可能性があります。さらに、相手はまだアクションをしていないので、様子を見るのが最善です。チェック（ベットせずに次のプレイヤーに順番を回すこと）を選択します。'}
2025-10-31 19:01:03,647 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:03,647 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 19:01:03,647 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:03,647 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, フロップ（最初の3枚のコミュニティカード）で、あなたの手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ペア」と呼ばれる強い役ですが、相手もキングのペアを持っている可能性があります。さらに、相手はまだアクションをしていないので、様子を見るのが最善です。チェック（ベットせずに次のプレイヤーに順番を回すこと）を選択します。
2025-10-31 19:01:03,648 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 19:01:03,649 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:03,649 - poker_game - INFO - Hand #22, Phase: flop
2025-10-31 19:01:03,649 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:03,650 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:03,650 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:03,650 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:03,651 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:03,651 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥']
2025-10-31 19:01:03,652 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:03,652 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:03,653 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:03,653 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:03,654 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:03,655 - poker_game - INFO - ==================================================
2025-10-31 19:01:03,658 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 19:01:03,669 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:03,670 - poker_game - INFO - Hand #22, Phase: flop
2025-10-31 19:01:03,670 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:03,671 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:03,671 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:03,672 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:03,672 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:03,672 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥']
2025-10-31 19:01:03,673 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:03,673 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:03,674 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:03,674 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:03,674 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:03,675 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 19:01:03,675 - poker_game - INFO - ==================================================
2025-10-31 19:01:03,675 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:03,675 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:03,676 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:01:03,676 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:01:03,676 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:03,677 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:03,677 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:01:03,677 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 19:01:03,677 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:01:03,677 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:03,678 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:01:03,678 - poker_game - DEBUG - First actor index: 1
2025-10-31 19:01:03,678 - poker_game - INFO - Betting complete: Back to first actor 1 (all players have acted)
2025-10-31 19:01:03,680 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:03,681 - poker_game - INFO - Hand #22, Phase: flop
2025-10-31 19:01:03,682 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:03,682 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:03,683 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:03,684 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:03,685 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:03,685 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥']
2025-10-31 19:01:03,686 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:03,687 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:03,687 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:03,687 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:03,688 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:03,689 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:01:03,689 - poker_game - INFO - ==================================================
2025-10-31 19:01:03,790 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 19:01:03,791 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:03,791 - poker_game - INFO - Remaining players: 2
2025-10-31 19:01:03,792 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:01:03,792 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:01:03,792 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 19:01:03,808 - poker_game - INFO - Starting new betting round
2025-10-31 19:01:03,809 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:01:03,809 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:01:03,810 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 19:01:03,810 - poker_game - DEBUG - Dealer button: 4
2025-10-31 19:01:03,810 - poker_game - INFO - First actor: Player 1 (by phase rule), was 1
2025-10-31 19:01:03,811 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:01:03,811 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:03,812 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:03,812 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:03,812 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:03,813 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:03,813 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:03,813 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:03,814 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:03,814 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:03,814 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:03,815 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:03,815 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:03,815 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 19:01:03,816 - poker_game - INFO - ==================================================
2025-10-31 19:01:03,816 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "5♣",
    "5♦"
  ],
  "community": [
    "6♥",
    "K♣",
    "K♥",
    "7♥"
  ],
  "your_chips": 2874,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 60,
  "pot": 120,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1597,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (2874)"
  ],
  "history": [
    "Player 3 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥"
  ]
}
2025-10-31 19:01:03,829 - poker_game - DEBUG - Create Session: {'id': '16650a18-273f-4341-b7c6-a548488fbb2f', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904863.8261213}
2025-10-31 19:01:05,859 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "ターン（Turn）で、あなたの手札は5♣ 5♦、コミュニティカードは6♥ K♣ K♥ 7♥です。ボードにはキング（K）が2枚あり、ペアができています。あなたは5のペアを持っていますが、ボードのキングに負けています。対戦相手（Player 3）もチェックしているので、こちらもチェックして、フリーでリバー（River）のカードを見るのが最善です。これにより、ポットを大きくせずに、より良いカードが来る可能性を探ることができます。コールやレイズは、現時点では不利な状況です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 155, 'promptTokenCount': 928, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 928}], 'totalTokenCount': 1083}, 'invocationId': 'e-59a7309c-98a8-43b3-9a34-7fb5ff260e4e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'xhZ4s29J', 'timestamp': 1761904863.84127}]
2025-10-31 19:01:05,860 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:01:05,860 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "ターン（Turn）で、あなたの手札は5♣ 5♦、コミュニティカードは6♥ K♣ K♥ 7♥です。ボードにはキング（K）が2枚あり、ペアができています。あなたは5のペアを持っていますが、ボードのキングに負けています。対戦相手（Player 3）もチェックしているので、こちらもチェックして、フリーでリバー（River）のカードを見るのが最善です。これにより、ポットを大きくせずに、より良いカードが来る可能性を探ることができます。コールやレイズは、現時点では不利な状況です。"
}
```
2025-10-31 19:01:05,860 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:01:05,861 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "ターン（Turn）で、あなたの手札は5♣ 5♦、コミュニティカードは6♥ K♣ K♥ 7♥です。ボードにはキング（K）が2枚あり、ペアができています。あなたは5のペアを持っていますが、ボードのキングに負けています。対戦相手（Player 3）もチェックしているので、こちらもチェックして、フリーでリバー（River）のカードを見るのが最善です。これにより、ポットを大きくせずに、より良いカードが来る可能性を探ることができます。コールやレイズは、現時点では不利な状況です。"\n}\n```'
2025-10-31 19:01:05,861 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:01:05,861 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "ターン（Turn）で、あなたの手札は5♣ 5♦、コミュニティカードは6♥ K♣ K♥ 7♥です。ボードにはキング（K）が2枚あり、ペアができています。あなたは5のペアを持っていますが、ボードのキングに負けています。対戦相手（Player 3）もチェックしているので、こちらもチェックして、フリーでリバー（River）のカードを見るのが最善です。これにより、ポットを大きくせずに、より良いカードが来る可能性を探ることができます。コールやレイズは、現時点では不利な状況です。"\n}'
2025-10-31 19:01:05,861 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "ターン（Turn）で、あなたの手札は5♣ 5♦、コミュニティカードは6♥ K♣ K♥ 7♥です。ボードにはキング（K）が2枚あり、ペアができています。あなたは5のペアを持っていますが、ボードのキングに負けています。対戦相手（Player 3）もチェックしているので、こちらもチェックして、フリーでリバー（River）のカードを見るのが最善です。これにより、ポットを大きくせずに、より良いカードが来る可能性を探ることができます。コールやレイズは、現時点では不利な状況です。"
}
2025-10-31 19:01:05,861 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'ターン（Turn）で、あなたの手札は5♣ 5♦、コミュニティカードは6♥ K♣ K♥ 7♥です。ボードにはキング（K）が2枚あり、ペアができています。あなたは5のペアを持っていますが、ボードのキングに負けています。対戦相手（Player 3）もチェックしているので、こちらもチェックして、フリーでリバー（River）のカードを見るのが最善です。これにより、ポットを大きくせずに、より良いカードが来る可能性を探ることができます。コールやレイズは、現時点では不利な状況です。'}
2025-10-31 19:01:05,862 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:05,862 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 19:01:05,862 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:05,862 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, ターン（Turn）で、あなたの手札は5♣ 5♦、コミュニティカードは6♥ K♣ K♥ 7♥です。ボードにはキング（K）が2枚あり、ペアができています。あなたは5のペアを持っていますが、ボードのキングに負けています。対戦相手（Player 3）もチェックしているので、こちらもチェックして、フリーでリバー（River）のカードを見るのが最善です。これにより、ポットを大きくせずに、より良いカードが来る可能性を探ることができます。コールやレイズは、現時点では不利な状況です。
2025-10-31 19:01:05,863 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 19:01:05,864 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:05,864 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:05,865 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:05,865 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:05,867 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:05,868 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:05,869 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:05,871 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:05,872 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:05,875 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:05,876 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:05,877 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:05,877 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:05,878 - poker_game - INFO - ==================================================
2025-10-31 19:01:05,878 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 19:01:05,891 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:05,892 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:05,893 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:05,893 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:05,893 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:05,894 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:05,894 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:05,895 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:05,895 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:05,896 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:05,896 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:05,897 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:05,897 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:05,898 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 19:01:05,898 - poker_game - INFO - ==================================================
2025-10-31 19:01:05,898 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:05,899 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:05,899 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:01:05,899 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:01:05,900 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:05,900 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:05,901 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:01:05,901 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 19:01:05,901 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:01:05,901 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:05,902 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:01:05,902 - poker_game - DEBUG - First actor index: 1
2025-10-31 19:01:05,902 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 1
2025-10-31 19:01:05,902 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:05,902 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:05,903 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:05,903 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:05,904 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:05,904 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:05,904 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:05,905 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:05,905 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:05,905 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:05,906 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:05,906 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:05,907 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:05,907 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:05,907 - poker_game - INFO - ==================================================
2025-10-31 19:01:06,010 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "9♣",
    "A♥"
  ],
  "community": [
    "6♥",
    "K♣",
    "K♥",
    "7♥"
  ],
  "your_chips": 1597,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 60,
  "pot": 120,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2874,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1597)"
  ],
  "history": [
    "Player 1 checked",
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked"
  ]
}
2025-10-31 19:01:06,021 - poker_game - DEBUG - Create Session: {'id': 'c3d1c3ad-1674-4ed3-9faa-b052250d5098', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904866.0193}
2025-10-31 19:01:09,715 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 140,\n  "reasoning": "私の手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ポケットペア」と呼ばれる強い役で、相手もキングを持っている可能性が高いです。しかし、私の持っているA♥とコミュニティカードの7♥、6♥でフラッシュ（同じスートのカードが5枚揃う役）の可能性も出てきました。現時点では相手の役は不明ですが、ブラフ（はったり）や、私より弱い役（例えば、キングのペアだがキッカーが私より弱い、など）を持っている可能性もあります。ポットサイズ（現在の賭け金の合計）が120で、相手のベットが0なので、チェック（何もせずに次のアクションを待つこと）ができますが、ここでレイズ（賭け金を上げる）することで、相手にプレッシャーをかけ、ポットを大きくすることができます。相手のチップ量（2874）を考慮すると、140のレイズは相手にとってコールするかフォールド（諦めること）かの判断を迫るのに十分な額だと考えられます。もし相手が強い役を持っているなら、彼がレイズしてくるでしょうし、そうでなければフォールドするか、コールしてフラッシュの完成を待つかもしれません。ここでは、相手の弱い役を降ろさせるか、ポットを大きくする目的でレイズを選択します。コール額が0なので、レイズ額は120 + 20（ビッグブラインド）+ 20（レイズ額）= 160、または、最小レイズ額20を考慮して、120 + 20 = 140 とします。ここでは140でレイズします。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 400, 'promptTokenCount': 928, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 928}], 'totalTokenCount': 1328}, 'invocationId': 'e-1d860b4f-b6c5-42fd-87b0-a898708f357f', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'dFZXbiyQ', 'timestamp': 1761904866.033677}]
2025-10-31 19:01:09,715 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:01:09,715 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 140,
  "reasoning": "私の手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ポケットペア」と呼ばれる強い役で、相手もキングを持っている可能性が高いです。しかし、私の持っているA♥とコミュニティカードの7♥、6♥でフラッシュ（同じスートのカードが5枚揃う役）の可能性も出てきました。現時点では相手の役は不明ですが、ブラフ（はったり）や、私より弱い役（例えば、キングのペアだがキッカーが私より弱い、など）を持っている可能性もあります。ポットサイズ（現在の賭け金の合計）が120で、相手のベットが0なので、チェック（何もせずに次のアクションを待つこと）ができますが、ここでレイズ（賭け金を上げる）することで、相手にプレッシャーをかけ、ポットを大きくすることができます。相手のチップ量（2874）を考慮すると、140のレイズは相手にとってコールするかフォールド（諦めること）かの判断を迫るのに十分な額だと考えられます。もし相手が強い役を持っているなら、彼がレイズしてくるでしょうし、そうでなければフォールドするか、コールしてフラッシュの完成を待つかもしれません。ここでは、相手の弱い役を降ろさせるか、ポットを大きくする目的でレイズを選択します。コール額が0なので、レイズ額は120 + 20（ビッグブラインド）+ 20（レイズ額）= 160、または、最小レイズ額20を考慮して、120 + 20 = 140 とします。ここでは140でレイズします。"
}
```
2025-10-31 19:01:09,716 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:01:09,716 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 140,\n  "reasoning": "私の手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ポケットペア」と呼ばれる強い役で、相手もキングを持っている可能性が高いです。しかし、私の持っているA♥とコミュニティカードの7♥、6♥でフラッシュ（同じスートのカードが5枚揃う役）の可能性も出てきました。現時点では相手の役は不明ですが、ブラフ（はったり）や、私より弱い役（例えば、キングのペアだがキッカーが私より弱い、など）を持っている可能性もあります。ポットサイズ（現在の賭け金の合計）が120で、相手のベットが0なので、チェック（何もせずに次のアクションを待つこと）ができますが、ここでレイズ（賭け金を上げる）することで、相手にプレッシャーをかけ、ポットを大きくすることができます。相手のチップ量（2874）を考慮すると、140のレイズは相手にとってコールするかフォールド（諦めること）かの判断を迫るのに十分な額だと考えられます。もし相手が強い役を持っているなら、彼がレイズしてくるでしょうし、そうでなければフォールドするか、コールしてフラッシュの完成を待つかもしれません。ここでは、相手の弱い役を降ろさせるか、ポットを大きくする目的でレイズを選択します。コール額が0なので、レイズ額は120 + 20（ビッグブラインド）+ 20（レイズ額）= 160、または、最小レイズ額20を考慮して、120 + 20 = 140 とします。ここでは140でレイズします。"\n}\n```'
2025-10-31 19:01:09,716 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:01:09,716 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 140,\n  "reasoning": "私の手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ポケットペア」と呼ばれる強い役で、相手もキングを持っている可能性が高いです。しかし、私の持っているA♥とコミュニティカードの7♥、6♥でフラッシュ（同じスートのカードが5枚揃う役）の可能性も出てきました。現時点では相手の役は不明ですが、ブラフ（はったり）や、私より弱い役（例えば、キングのペアだがキッカーが私より弱い、など）を持っている可能性もあります。ポットサイズ（現在の賭け金の合計）が120で、相手のベットが0なので、チェック（何もせずに次のアクションを待つこと）ができますが、ここでレイズ（賭け金を上げる）することで、相手にプレッシャーをかけ、ポットを大きくすることができます。相手のチップ量（2874）を考慮すると、140のレイズは相手にとってコールするかフォールド（諦めること）かの判断を迫るのに十分な額だと考えられます。もし相手が強い役を持っているなら、彼がレイズしてくるでしょうし、そうでなければフォールドするか、コールしてフラッシュの完成を待つかもしれません。ここでは、相手の弱い役を降ろさせるか、ポットを大きくする目的でレイズを選択します。コール額が0なので、レイズ額は120 + 20（ビッグブラインド）+ 20（レイズ額）= 160、または、最小レイズ額20を考慮して、120 + 20 = 140 とします。ここでは140でレイズします。"\n}'
2025-10-31 19:01:09,716 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 140,
  "reasoning": "私の手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ポケットペア」と呼ばれる強い役で、相手もキングを持っている可能性が高いです。しかし、私の持っているA♥とコミュニティカードの7♥、6♥でフラッシュ（同じスートのカードが5枚揃う役）の可能性も出てきました。現時点では相手の役は不明ですが、ブラフ（はったり）や、私より弱い役（例えば、キングのペアだがキッカーが私より弱い、など）を持っている可能性もあります。ポットサイズ（現在の賭け金の合計）が120で、相手のベットが0なので、チェック（何もせずに次のアクションを待つこと）ができますが、ここでレイズ（賭け金を上げる）することで、相手にプレッシャーをかけ、ポットを大きくすることができます。相手のチップ量（2874）を考慮すると、140のレイズは相手にとってコールするかフォールド（諦めること）かの判断を迫るのに十分な額だと考えられます。もし相手が強い役を持っているなら、彼がレイズしてくるでしょうし、そうでなければフォールドするか、コールしてフラッシュの完成を待つかもしれません。ここでは、相手の弱い役を降ろさせるか、ポットを大きくする目的でレイズを選択します。コール額が0なので、レイズ額は120 + 20（ビッグブラインド）+ 20（レイズ額）= 160、または、最小レイズ額20を考慮して、120 + 20 = 140 とします。ここでは140でレイズします。"
}
2025-10-31 19:01:09,716 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 140, 'reasoning': '私の手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ポケットペア」と呼ばれる強い役で、相手もキングを持っている可能性が高いです。しかし、私の持っているA♥とコミュニティカードの7♥、6♥でフラッシュ（同じスートのカードが5枚揃う役）の可能性も出てきました。現時点では相手の役は不明ですが、ブラフ（はったり）や、私より弱い役（例えば、キングのペアだがキッカーが私より弱い、など）を持っている可能性もあります。ポットサイズ（現在の賭け金の合計）が120で、相手のベットが0なので、チェック（何もせずに次のアクションを待つこと）ができますが、ここでレイズ（賭け金を上げる）することで、相手にプレッシャーをかけ、ポットを大きくすることができます。相手のチップ量（2874）を考慮すると、140のレイズは相手にとってコールするかフォールド（諦めること）かの判断を迫るのに十分な額だと考えられます。もし相手が強い役を持っているなら、彼がレイズしてくるでしょうし、そうでなければフォールドするか、コールしてフラッシュの完成を待つかもしれません。ここでは、相手の弱い役を降ろさせるか、ポットを大きくする目的でレイズを選択します。コール額が0なので、レイズ額は120 + 20（ビッグブラインド）+ 20（レイズ額）= 160、または、最小レイズ額20を考慮して、120 + 20 = 140 とします。ここでは140でレイズします。'}
2025-10-31 19:01:09,717 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 140
2025-10-31 19:01:09,717 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1597)']
2025-10-31 19:01:09,717 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 19:01:09,717 - poker_game - DEBUG - [Agent3] Raise amount 140 is valid (min: 20)
2025-10-31 19:01:09,717 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 140}
2025-10-31 19:01:09,717 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 140, 私の手札はAハイ（エースが一番強いカード）ですが、コミュニティカードにはキングが2枚（K♣, K♥）あります。これは「ポケットペア」と呼ばれる強い役で、相手もキングを持っている可能性が高いです。しかし、私の持っているA♥とコミュニティカードの7♥、6♥でフラッシュ（同じスートのカードが5枚揃う役）の可能性も出てきました。現時点では相手の役は不明ですが、ブラフ（はったり）や、私より弱い役（例えば、キングのペアだがキッカーが私より弱い、など）を持っている可能性もあります。ポットサイズ（現在の賭け金の合計）が120で、相手のベットが0なので、チェック（何もせずに次のアクションを待つこと）ができますが、ここでレイズ（賭け金を上げる）することで、相手にプレッシャーをかけ、ポットを大きくすることができます。相手のチップ量（2874）を考慮すると、140のレイズは相手にとってコールするかフォールド（諦めること）かの判断を迫るのに十分な額だと考えられます。もし相手が強い役を持っているなら、彼がレイズしてくるでしょうし、そうでなければフォールドするか、コールしてフラッシュの完成を待つかもしれません。ここでは、相手の弱い役を降ろさせるか、ポットを大きくする目的でレイズを選択します。コール額が0なので、レイズ額は120 + 20（ビッグブラインド）+ 20（レイズ額）= 160、または、最小レイズ額20を考慮して、120 + 20 = 140 とします。ここでは140でレイズします。
2025-10-31 19:01:09,718 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 140
2025-10-31 19:01:09,718 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:09,718 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:09,718 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:09,719 - poker_game - INFO - Pot: 120, Current bet: 0
2025-10-31 19:01:09,719 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:09,719 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:09,719 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:09,719 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:09,719 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:09,720 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:09,720 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:09,720 - poker_game - INFO -   P3(Agent3): chips=1597, bet=0, status=active
2025-10-31 19:01:09,720 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:09,720 - poker_game - INFO - ==================================================
2025-10-31 19:01:09,721 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 140
2025-10-31 19:01:09,730 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:09,731 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:09,731 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:09,731 - poker_game - INFO - Pot: 260, Current bet: 140
2025-10-31 19:01:09,731 - poker_game - INFO - Last raiser: 3
2025-10-31 19:01:09,731 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:09,731 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:09,732 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:09,732 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:09,732 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:09,732 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:09,732 - poker_game - INFO -   P3(Agent3): chips=1457, bet=140, status=active
2025-10-31 19:01:09,732 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:09,732 - poker_game - INFO - Extra: Action: Player 3 raised to 140
2025-10-31 19:01:09,733 - poker_game - INFO - ==================================================
2025-10-31 19:01:09,733 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:09,733 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:09,733 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:01:09,733 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:01:09,733 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:09,733 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:09,734 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:01:09,734 - poker_game - DEBUG - Player bets: [0, 140], Current bet: 140, All same: False
2025-10-31 19:01:09,734 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:01:09,734 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:09,734 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:09,735 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:09,736 - poker_game - INFO - Pot: 260, Current bet: 140
2025-10-31 19:01:09,736 - poker_game - INFO - Last raiser: 3
2025-10-31 19:01:09,736 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:09,736 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:09,737 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:09,737 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:09,737 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:09,737 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:09,737 - poker_game - INFO -   P3(Agent3): chips=1457, bet=140, status=active
2025-10-31 19:01:09,738 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:09,738 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:09,738 - poker_game - INFO - ==================================================
2025-10-31 19:01:09,839 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "5♣",
    "5♦"
  ],
  "community": [
    "6♥",
    "K♣",
    "K♥",
    "7♥"
  ],
  "your_chips": 2874,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 60,
  "pot": 260,
  "to_call": 140,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1457,
      "bet": 140,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (140)",
    "raise (min 160)",
    "all-in (2874)"
  ],
  "history": [
    "Showdown: Player 1 hand=High Card: J♦ - J♦, 10♣, 8♠, 7♦, 5♥ cards=7♦, J♦",
    "Showdown: Player 3 hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥ cards=7♠, 8♣",
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140"
  ]
}
2025-10-31 19:01:09,852 - poker_game - DEBUG - Create Session: {'id': '38fe6375-e662-4558-9064-1f4e0db0ddcd', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904869.8488586}
2025-10-31 19:01:11,961 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 140,\n  "reasoning": "フロップでペアになったハンド（5-5）を持っています。コミュニティカードには2枚のキング（K）があり、相手がペアを持っている可能性が高いですが、私のペアもまだ有効です。ターンで7♥が表示され、ストレートやフラッシュの可能性も出てきましたが、私のハンドはまだ勝てる可能性があります。相手は140をベットしてきましたが、ポットサイズ（260 + 140 = 400）に対してコールは可能です。より強いハンドを持っている可能性はありますが、この状況でコールして、リバーカードを見て判断するのが最善と考えられます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 158, 'promptTokenCount': 942, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 942}], 'totalTokenCount': 1100}, 'invocationId': 'e-4bf0ebe5-5ea0-4b98-aa46-b83bad74c4ce', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'tc178OSD', 'timestamp': 1761904869.862931}]
2025-10-31 19:01:11,961 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:01:11,961 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 140,
  "reasoning": "フロップでペアになったハンド（5-5）を持っています。コミュニティカードには2枚のキング（K）があり、相手がペアを持っている可能性が高いですが、私のペアもまだ有効です。ターンで7♥が表示され、ストレートやフラッシュの可能性も出てきましたが、私のハンドはまだ勝てる可能性があります。相手は140をベットしてきましたが、ポットサイズ（260 + 140 = 400）に対してコールは可能です。より強いハンドを持っている可能性はありますが、この状況でコールして、リバーカードを見て判断するのが最善と考えられます。"
}
```
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 140,\n  "reasoning": "フロップでペアになったハンド（5-5）を持っています。コミュニティカードには2枚のキング（K）があり、相手がペアを持っている可能性が高いですが、私のペアもまだ有効です。ターンで7♥が表示され、ストレートやフラッシュの可能性も出てきましたが、私のハンドはまだ勝てる可能性があります。相手は140をベットしてきましたが、ポットサイズ（260 + 140 = 400）に対してコールは可能です。より強いハンドを持っている可能性はありますが、この状況でコールして、リバーカードを見て判断するのが最善と考えられます。"\n}\n```'
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 140,\n  "reasoning": "フロップでペアになったハンド（5-5）を持っています。コミュニティカードには2枚のキング（K）があり、相手がペアを持っている可能性が高いですが、私のペアもまだ有効です。ターンで7♥が表示され、ストレートやフラッシュの可能性も出てきましたが、私のハンドはまだ勝てる可能性があります。相手は140をベットしてきましたが、ポットサイズ（260 + 140 = 400）に対してコールは可能です。より強いハンドを持っている可能性はありますが、この状況でコールして、リバーカードを見て判断するのが最善と考えられます。"\n}'
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 140,
  "reasoning": "フロップでペアになったハンド（5-5）を持っています。コミュニティカードには2枚のキング（K）があり、相手がペアを持っている可能性が高いですが、私のペアもまだ有効です。ターンで7♥が表示され、ストレートやフラッシュの可能性も出てきましたが、私のハンドはまだ勝てる可能性があります。相手は140をベットしてきましたが、ポットサイズ（260 + 140 = 400）に対してコールは可能です。より強いハンドを持っている可能性はありますが、この状況でコールして、リバーカードを見て判断するのが最善と考えられます。"
}
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 140, 'reasoning': 'フロップでペアになったハンド（5-5）を持っています。コミュニティカードには2枚のキング（K）があり、相手がペアを持っている可能性が高いですが、私のペアもまだ有効です。ターンで7♥が表示され、ストレートやフラッシュの可能性も出てきましたが、私のハンドはまだ勝てる可能性があります。相手は140をベットしてきましたが、ポットサイズ（260 + 140 = 400）に対してコールは可能です。より強いハンドを持っている可能性はありますが、この状況でコールして、リバーカードを見て判断するのが最善と考えられます。'}
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 140
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (140)', 'raise (min 160)', 'all-in (2874)']
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (140)': 140
2025-10-31 19:01:11,962 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 140}
2025-10-31 19:01:11,962 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 140, フロップでペアになったハンド（5-5）を持っています。コミュニティカードには2枚のキング（K）があり、相手がペアを持っている可能性が高いですが、私のペアもまだ有効です。ターンで7♥が表示され、ストレートやフラッシュの可能性も出てきましたが、私のハンドはまだ勝てる可能性があります。相手は140をベットしてきましたが、ポットサイズ（260 + 140 = 400）に対してコールは可能です。より強いハンドを持っている可能性はありますが、この状況でコールして、リバーカードを見て判断するのが最善と考えられます。
2025-10-31 19:01:11,963 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 140
2025-10-31 19:01:11,963 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:11,963 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:11,963 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:11,964 - poker_game - INFO - Pot: 260, Current bet: 140
2025-10-31 19:01:11,964 - poker_game - INFO - Last raiser: 3
2025-10-31 19:01:11,964 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:11,964 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:11,964 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:11,964 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:11,964 - poker_game - INFO -   P1(Agent1): chips=2874, bet=0, status=active
2025-10-31 19:01:11,964 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:11,965 - poker_game - INFO -   P3(Agent3): chips=1457, bet=140, status=active
2025-10-31 19:01:11,965 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:11,965 - poker_game - INFO - ==================================================
2025-10-31 19:01:11,965 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 140
2025-10-31 19:01:11,987 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:11,987 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:11,988 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:11,988 - poker_game - INFO - Pot: 400, Current bet: 140
2025-10-31 19:01:11,988 - poker_game - INFO - Last raiser: 3
2025-10-31 19:01:11,988 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:11,989 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:11,989 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:11,989 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:11,989 - poker_game - INFO -   P1(Agent1): chips=2734, bet=140, status=active
2025-10-31 19:01:11,990 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:11,990 - poker_game - INFO -   P3(Agent3): chips=1457, bet=140, status=active
2025-10-31 19:01:11,990 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:11,990 - poker_game - INFO - Extra: Action: Player 1 called 140
2025-10-31 19:01:11,991 - poker_game - INFO - ==================================================
2025-10-31 19:01:11,991 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:11,991 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:11,991 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:01:11,991 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:01:11,992 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:11,992 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:11,992 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:01:11,992 - poker_game - DEBUG - Player bets: [140, 140], Current bet: 140, All same: True
2025-10-31 19:01:11,992 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:01:11,993 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:11,993 - poker_game - INFO - Hand #22, Phase: turn
2025-10-31 19:01:11,993 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:11,993 - poker_game - INFO - Pot: 400, Current bet: 140
2025-10-31 19:01:11,994 - poker_game - INFO - Last raiser: 3
2025-10-31 19:01:11,994 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:11,994 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:11,995 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥']
2025-10-31 19:01:11,995 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:11,995 - poker_game - INFO -   P1(Agent1): chips=2734, bet=140, status=active
2025-10-31 19:01:11,995 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:11,996 - poker_game - INFO -   P3(Agent3): chips=1457, bet=140, status=active
2025-10-31 19:01:11,996 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:11,996 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:01:11,997 - poker_game - INFO - ==================================================
2025-10-31 19:01:12,097 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 19:01:12,098 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:12,098 - poker_game - INFO - Remaining players: 2
2025-10-31 19:01:12,099 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:01:12,099 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:01:12,099 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 19:01:12,108 - poker_game - INFO - Starting new betting round
2025-10-31 19:01:12,109 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:01:12,110 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:01:12,110 - poker_game - DEBUG - Active players for new betting round: [1, 3]
2025-10-31 19:01:12,110 - poker_game - DEBUG - Dealer button: 4
2025-10-31 19:01:12,110 - poker_game - INFO - First actor: Player 1 (by phase rule), was 3
2025-10-31 19:01:12,111 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:01:12,111 - poker_game - INFO - Hand #22, Phase: river
2025-10-31 19:01:12,112 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:12,112 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:12,112 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:12,113 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:12,115 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:12,115 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:12,116 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:12,116 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:12,117 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:12,117 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:12,118 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:12,118 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 19:01:12,118 - poker_game - INFO - ==================================================
2025-10-31 19:01:12,119 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "5♣",
    "5♦"
  ],
  "community": [
    "6♥",
    "K♣",
    "K♥",
    "7♥",
    "2♦"
  ],
  "your_chips": 2734,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 200,
  "pot": 400,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1457,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (2734)"
  ],
  "history": [
    "Side pot layer 0: amount=60, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦"
  ]
}
2025-10-31 19:01:12,132 - poker_game - DEBUG - Create Session: {'id': '75920980-17cf-4563-a6a1-752358bc2e56', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904872.1299818}
2025-10-31 19:01:11,532 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカードが配られた後）で、あなたの手札は「5♣」「5♦」で、コミュニティカードは「6♥」「K♣」「K♥」「7♥」「2♦」です。あなたのベストハンドは、ペアのキング（K♣, K♥）です。対戦相手（プレイヤー3）はポットを大きくベットしてきませんでした。あなたのハンドは勝てる可能性もありますが、相手がより強いキングのペアや、スリーカード、フルハウスを持っている可能性も考慮すると、リスクを冒してベット（raise）するよりも、チェック（check）して相手のアクションを見るのが最善です。もし相手がチェックしたら、あなたのペアのキングで勝つことができます。もし相手がベットしてきたら、そのベット額を見て、コール（call）するかフォールド（fold）するかを判断します。全額ベット（all-in）は、相手のハンドが不明な状況ではリスクが高すぎます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 231, 'promptTokenCount': 871, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 871}], 'totalTokenCount': 1102}, 'invocationId': 'e-26f5deb1-1876-42e9-9454-1ea5b872e981', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'DHagZKTP', 'timestamp': 1761904872.140305}]
2025-10-31 19:01:11,533 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:01:11,533 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカードが配られた後）で、あなたの手札は「5♣」「5♦」で、コミュニティカードは「6♥」「K♣」「K♥」「7♥」「2♦」です。あなたのベストハンドは、ペアのキング（K♣, K♥）です。対戦相手（プレイヤー3）はポットを大きくベットしてきませんでした。あなたのハンドは勝てる可能性もありますが、相手がより強いキングのペアや、スリーカード、フルハウスを持っている可能性も考慮すると、リスクを冒してベット（raise）するよりも、チェック（check）して相手のアクションを見るのが最善です。もし相手がチェックしたら、あなたのペアのキングで勝つことができます。もし相手がベットしてきたら、そのベット額を見て、コール（call）するかフォールド（fold）するかを判断します。全額ベット（all-in）は、相手のハンドが不明な状況ではリスクが高すぎます。"
}
```
2025-10-31 19:01:11,533 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:01:11,534 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカードが配られた後）で、あなたの手札は「5♣」「5♦」で、コミュニティカードは「6♥」「K♣」「K♥」「7♥」「2♦」です。あなたのベストハンドは、ペアのキング（K♣, K♥）です。対戦相手（プレイヤー3）はポットを大きくベットしてきませんでした。あなたのハンドは勝てる可能性もありますが、相手がより強いキングのペアや、スリーカード、フルハウスを持っている可能性も考慮すると、リスクを冒してベット（raise）するよりも、チェック（check）して相手のアクションを見るのが最善です。もし相手がチェックしたら、あなたのペアのキングで勝つことができます。もし相手がベットしてきたら、そのベット額を見て、コール（call）するかフォールド（fold）するかを判断します。全額ベット（all-in）は、相手のハンドが不明な状況ではリスクが高すぎます。"\n}\n```'
2025-10-31 19:01:11,534 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:01:11,534 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のカードが配られた後）で、あなたの手札は「5♣」「5♦」で、コミュニティカードは「6♥」「K♣」「K♥」「7♥」「2♦」です。あなたのベストハンドは、ペアのキング（K♣, K♥）です。対戦相手（プレイヤー3）はポットを大きくベットしてきませんでした。あなたのハンドは勝てる可能性もありますが、相手がより強いキングのペアや、スリーカード、フルハウスを持っている可能性も考慮すると、リスクを冒してベット（raise）するよりも、チェック（check）して相手のアクションを見るのが最善です。もし相手がチェックしたら、あなたのペアのキングで勝つことができます。もし相手がベットしてきたら、そのベット額を見て、コール（call）するかフォールド（fold）するかを判断します。全額ベット（all-in）は、相手のハンドが不明な状況ではリスクが高すぎます。"\n}'
2025-10-31 19:01:11,534 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のカードが配られた後）で、あなたの手札は「5♣」「5♦」で、コミュニティカードは「6♥」「K♣」「K♥」「7♥」「2♦」です。あなたのベストハンドは、ペアのキング（K♣, K♥）です。対戦相手（プレイヤー3）はポットを大きくベットしてきませんでした。あなたのハンドは勝てる可能性もありますが、相手がより強いキングのペアや、スリーカード、フルハウスを持っている可能性も考慮すると、リスクを冒してベット（raise）するよりも、チェック（check）して相手のアクションを見るのが最善です。もし相手がチェックしたら、あなたのペアのキングで勝つことができます。もし相手がベットしてきたら、そのベット額を見て、コール（call）するかフォールド（fold）するかを判断します。全額ベット（all-in）は、相手のハンドが不明な状況ではリスクが高すぎます。"
}
2025-10-31 19:01:11,534 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最後のカードが配られた後）で、あなたの手札は「5♣」「5♦」で、コミュニティカードは「6♥」「K♣」「K♥」「7♥」「2♦」です。あなたのベストハンドは、ペアのキング（K♣, K♥）です。対戦相手（プレイヤー3）はポットを大きくベットしてきませんでした。あなたのハンドは勝てる可能性もありますが、相手がより強いキングのペアや、スリーカード、フルハウスを持っている可能性も考慮すると、リスクを冒してベット（raise）するよりも、チェック（check）して相手のアクションを見るのが最善です。もし相手がチェックしたら、あなたのペアのキングで勝つことができます。もし相手がベットしてきたら、そのベット額を見て、コール（call）するかフォールド（fold）するかを判断します。全額ベット（all-in）は、相手のハンドが不明な状況ではリスクが高すぎます。'}
2025-10-31 19:01:11,534 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:11,535 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 19:01:11,535 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:11,535 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, リバー（最後のカードが配られた後）で、あなたの手札は「5♣」「5♦」で、コミュニティカードは「6♥」「K♣」「K♥」「7♥」「2♦」です。あなたのベストハンドは、ペアのキング（K♣, K♥）です。対戦相手（プレイヤー3）はポットを大きくベットしてきませんでした。あなたのハンドは勝てる可能性もありますが、相手がより強いキングのペアや、スリーカード、フルハウスを持っている可能性も考慮すると、リスクを冒してベット（raise）するよりも、チェック（check）して相手のアクションを見るのが最善です。もし相手がチェックしたら、あなたのペアのキングで勝つことができます。もし相手がベットしてきたら、そのベット額を見て、コール（call）するかフォールド（fold）するかを判断します。全額ベット（all-in）は、相手のハンドが不明な状況ではリスクが高すぎます。
2025-10-31 19:01:11,536 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 19:01:11,536 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:11,536 - poker_game - INFO - Hand #22, Phase: river
2025-10-31 19:01:11,538 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:11,538 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:11,539 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:11,539 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:11,539 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:11,540 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:11,541 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:11,541 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:11,541 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:11,541 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:11,541 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:11,541 - poker_game - INFO - ==================================================
2025-10-31 19:01:11,542 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 19:01:11,549 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:11,549 - poker_game - INFO - Hand #22, Phase: river
2025-10-31 19:01:11,550 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:11,550 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:11,550 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:11,550 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:11,551 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:11,551 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:11,551 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:11,551 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:11,551 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:11,552 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:11,552 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:11,552 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 19:01:11,552 - poker_game - INFO - ==================================================
2025-10-31 19:01:11,553 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:11,553 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:11,553 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:01:11,553 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:01:11,553 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:11,553 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:11,554 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:01:11,554 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 19:01:11,554 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:01:11,554 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:11,554 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:01:11,554 - poker_game - DEBUG - First actor index: 1
2025-10-31 19:01:11,554 - poker_game - DEBUG - Betting continues: Current player 3 != first actor 1
2025-10-31 19:01:11,554 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:11,554 - poker_game - INFO - Hand #22, Phase: river
2025-10-31 19:01:11,555 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:11,555 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:11,555 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:11,555 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:11,555 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:11,555 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:11,556 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:11,556 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:11,556 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:11,556 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:11,557 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:11,557 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:11,557 - poker_game - INFO - ==================================================
2025-10-31 19:01:11,659 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "9♣",
    "A♥"
  ],
  "community": [
    "6♥",
    "K♣",
    "K♥",
    "7♥",
    "2♦"
  ],
  "your_chips": 1457,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 200,
  "pot": 400,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2734,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5409,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1457)"
  ],
  "history": [
    "Side pot layer 1: amount=360, winners=3 best_hand=One Pair: 8s - 10♣, 8♣, 8♠, 7♠, 5♥",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 folded",
    "Showdown: Player 1 won 30",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked"
  ]
}
2025-10-31 19:01:11,668 - poker_game - DEBUG - Create Session: {'id': '6a7592f3-8b23-4a4f-b670-6ed1b6744bda', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904871.6651657}
2025-10-31 19:01:14,735 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "リバー（最後のカードが配られた後）の状況です。あなたの手札は A♥ 9♣ で、ボードは K♣ K♥ 6♥ 7♥ 2♦ です。あなたの手札では、Aハイ（エースが一番強いカード）ですが、ボードにはKが2枚（Kペア）あり、さらにハートが3枚（フラッシュの可能性）あります。あなたの手札にハートは1枚もありませんが、相手（プレイヤー1）はチェックをしました。これは、相手も強い手を持っていないか、あるいはブラフ（はったり）の可能性があります。あなたの手札はAハイなので、相手がKペアよりも強い手を持っている可能性は低いです。しかし、相手がフラッシュ（同じスートのカードが5枚揃うこと）を持っている可能性はあります。相手はチェックしましたが、あなたのコール額は0です。つまり、相手はベットしていないので、あなたは無料でボードを見ることができます。Aハイは必ずしも強い手ではありませんが、相手がチェックしたことで、ブラフの可能性も考慮できます。ここでは、相手がチェックしたため、コール額は0であり、そのままチェック（handの進行を待つこと）するか、またはレイズ（ベット額を上げること）してブラフを試みることも考えられます。しかし、相手がKペア以上の強い手を持っている可能性を考えると、ここではコール（相手のベット額と同じ額を出すこと）を選択するのが安全です。今回の状況では、相手はチェックしているので、コール額は0です。つまり、そのまま進行することができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 351, 'promptTokenCount': 830, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 830}], 'totalTokenCount': 1181}, 'invocationId': 'e-53550e3d-2635-4be6-a77c-9c74942309db', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'LVcVmraL', 'timestamp': 1761904871.677119}]
2025-10-31 19:01:14,736 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:01:14,736 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 0,
  "reasoning": "リバー（最後のカードが配られた後）の状況です。あなたの手札は A♥ 9♣ で、ボードは K♣ K♥ 6♥ 7♥ 2♦ です。あなたの手札では、Aハイ（エースが一番強いカード）ですが、ボードにはKが2枚（Kペア）あり、さらにハートが3枚（フラッシュの可能性）あります。あなたの手札にハートは1枚もありませんが、相手（プレイヤー1）はチェックをしました。これは、相手も強い手を持っていないか、あるいはブラフ（はったり）の可能性があります。あなたの手札はAハイなので、相手がKペアよりも強い手を持っている可能性は低いです。しかし、相手がフラッシュ（同じスートのカードが5枚揃うこと）を持っている可能性はあります。相手はチェックしましたが、あなたのコール額は0です。つまり、相手はベットしていないので、あなたは無料でボードを見ることができます。Aハイは必ずしも強い手ではありませんが、相手がチェックしたことで、ブラフの可能性も考慮できます。ここでは、相手がチェックしたため、コール額は0であり、そのままチェック（handの進行を待つこと）するか、またはレイズ（ベット額を上げること）してブラフを試みることも考えられます。しかし、相手がKペア以上の強い手を持っている可能性を考えると、ここではコール（相手のベット額と同じ額を出すこと）を選択するのが安全です。今回の状況では、相手はチェックしているので、コール額は0です。つまり、そのまま進行することができます。"
}
```
2025-10-31 19:01:14,737 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:01:14,737 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "リバー（最後のカードが配られた後）の状況です。あなたの手札は A♥ 9♣ で、ボードは K♣ K♥ 6♥ 7♥ 2♦ です。あなたの手札では、Aハイ（エースが一番強いカード）ですが、ボードにはKが2枚（Kペア）あり、さらにハートが3枚（フラッシュの可能性）あります。あなたの手札にハートは1枚もありませんが、相手（プレイヤー1）はチェックをしました。これは、相手も強い手を持っていないか、あるいはブラフ（はったり）の可能性があります。あなたの手札はAハイなので、相手がKペアよりも強い手を持っている可能性は低いです。しかし、相手がフラッシュ（同じスートのカードが5枚揃うこと）を持っている可能性はあります。相手はチェックしましたが、あなたのコール額は0です。つまり、相手はベットしていないので、あなたは無料でボードを見ることができます。Aハイは必ずしも強い手ではありませんが、相手がチェックしたことで、ブラフの可能性も考慮できます。ここでは、相手がチェックしたため、コール額は0であり、そのままチェック（handの進行を待つこと）するか、またはレイズ（ベット額を上げること）してブラフを試みることも考えられます。しかし、相手がKペア以上の強い手を持っている可能性を考えると、ここではコール（相手のベット額と同じ額を出すこと）を選択するのが安全です。今回の状況では、相手はチェックしているので、コール額は0です。つまり、そのまま進行することができます。"\n}\n```'
2025-10-31 19:01:14,737 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:01:14,737 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 0,\n  "reasoning": "リバー（最後のカードが配られた後）の状況です。あなたの手札は A♥ 9♣ で、ボードは K♣ K♥ 6♥ 7♥ 2♦ です。あなたの手札では、Aハイ（エースが一番強いカード）ですが、ボードにはKが2枚（Kペア）あり、さらにハートが3枚（フラッシュの可能性）あります。あなたの手札にハートは1枚もありませんが、相手（プレイヤー1）はチェックをしました。これは、相手も強い手を持っていないか、あるいはブラフ（はったり）の可能性があります。あなたの手札はAハイなので、相手がKペアよりも強い手を持っている可能性は低いです。しかし、相手がフラッシュ（同じスートのカードが5枚揃うこと）を持っている可能性はあります。相手はチェックしましたが、あなたのコール額は0です。つまり、相手はベットしていないので、あなたは無料でボードを見ることができます。Aハイは必ずしも強い手ではありませんが、相手がチェックしたことで、ブラフの可能性も考慮できます。ここでは、相手がチェックしたため、コール額は0であり、そのままチェック（handの進行を待つこと）するか、またはレイズ（ベット額を上げること）してブラフを試みることも考えられます。しかし、相手がKペア以上の強い手を持っている可能性を考えると、ここではコール（相手のベット額と同じ額を出すこと）を選択するのが安全です。今回の状況では、相手はチェックしているので、コール額は0です。つまり、そのまま進行することができます。"\n}'
2025-10-31 19:01:14,737 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 0,
  "reasoning": "リバー（最後のカードが配られた後）の状況です。あなたの手札は A♥ 9♣ で、ボードは K♣ K♥ 6♥ 7♥ 2♦ です。あなたの手札では、Aハイ（エースが一番強いカード）ですが、ボードにはKが2枚（Kペア）あり、さらにハートが3枚（フラッシュの可能性）あります。あなたの手札にハートは1枚もありませんが、相手（プレイヤー1）はチェックをしました。これは、相手も強い手を持っていないか、あるいはブラフ（はったり）の可能性があります。あなたの手札はAハイなので、相手がKペアよりも強い手を持っている可能性は低いです。しかし、相手がフラッシュ（同じスートのカードが5枚揃うこと）を持っている可能性はあります。相手はチェックしましたが、あなたのコール額は0です。つまり、相手はベットしていないので、あなたは無料でボードを見ることができます。Aハイは必ずしも強い手ではありませんが、相手がチェックしたことで、ブラフの可能性も考慮できます。ここでは、相手がチェックしたため、コール額は0であり、そのままチェック（handの進行を待つこと）するか、またはレイズ（ベット額を上げること）してブラフを試みることも考えられます。しかし、相手がKペア以上の強い手を持っている可能性を考えると、ここではコール（相手のベット額と同じ額を出すこと）を選択するのが安全です。今回の状況では、相手はチェックしているので、コール額は0です。つまり、そのまま進行することができます。"
}
2025-10-31 19:01:14,738 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 0, 'reasoning': 'リバー（最後のカードが配られた後）の状況です。あなたの手札は A♥ 9♣ で、ボードは K♣ K♥ 6♥ 7♥ 2♦ です。あなたの手札では、Aハイ（エースが一番強いカード）ですが、ボードにはKが2枚（Kペア）あり、さらにハートが3枚（フラッシュの可能性）あります。あなたの手札にハートは1枚もありませんが、相手（プレイヤー1）はチェックをしました。これは、相手も強い手を持っていないか、あるいはブラフ（はったり）の可能性があります。あなたの手札はAハイなので、相手がKペアよりも強い手を持っている可能性は低いです。しかし、相手がフラッシュ（同じスートのカードが5枚揃うこと）を持っている可能性はあります。相手はチェックしましたが、あなたのコール額は0です。つまり、相手はベットしていないので、あなたは無料でボードを見ることができます。Aハイは必ずしも強い手ではありませんが、相手がチェックしたことで、ブラフの可能性も考慮できます。ここでは、相手がチェックしたため、コール額は0であり、そのままチェック（handの進行を待つこと）するか、またはレイズ（ベット額を上げること）してブラフを試みることも考えられます。しかし、相手がKペア以上の強い手を持っている可能性を考えると、ここではコール（相手のベット額と同じ額を出すこと）を選択するのが安全です。今回の状況では、相手はチェックしているので、コール額は0です。つまり、そのまま進行することができます。'}
2025-10-31 19:01:14,738 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 0
2025-10-31 19:01:14,738 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (1457)']
2025-10-31 19:01:14,738 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 0}
2025-10-31 19:01:14,738 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 0, リバー（最後のカードが配られた後）の状況です。あなたの手札は A♥ 9♣ で、ボードは K♣ K♥ 6♥ 7♥ 2♦ です。あなたの手札では、Aハイ（エースが一番強いカード）ですが、ボードにはKが2枚（Kペア）あり、さらにハートが3枚（フラッシュの可能性）あります。あなたの手札にハートは1枚もありませんが、相手（プレイヤー1）はチェックをしました。これは、相手も強い手を持っていないか、あるいはブラフ（はったり）の可能性があります。あなたの手札はAハイなので、相手がKペアよりも強い手を持っている可能性は低いです。しかし、相手がフラッシュ（同じスートのカードが5枚揃うこと）を持っている可能性はあります。相手はチェックしましたが、あなたのコール額は0です。つまり、相手はベットしていないので、あなたは無料でボードを見ることができます。Aハイは必ずしも強い手ではありませんが、相手がチェックしたことで、ブラフの可能性も考慮できます。ここでは、相手がチェックしたため、コール額は0であり、そのままチェック（handの進行を待つこと）するか、またはレイズ（ベット額を上げること）してブラフを試みることも考えられます。しかし、相手がKペア以上の強い手を持っている可能性を考えると、ここではコール（相手のベット額と同じ額を出すこと）を選択するのが安全です。今回の状況では、相手はチェックしているので、コール額は0です。つまり、そのまま進行することができます。
2025-10-31 19:01:14,739 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 0
2025-10-31 19:01:14,739 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:14,739 - poker_game - INFO - Hand #22, Phase: river
2025-10-31 19:01:14,740 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:14,740 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:14,740 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:14,740 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:14,740 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:14,741 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:14,741 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:14,741 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:14,741 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:14,742 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:14,742 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:14,742 - poker_game - INFO - ==================================================
2025-10-31 19:01:14,742 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 19:01:14,749 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:14,750 - poker_game - INFO - Hand #22, Phase: river
2025-10-31 19:01:14,750 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:01:14,750 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:14,750 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:14,750 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:14,751 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:14,751 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:14,751 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:14,751 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:14,751 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:14,752 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:14,752 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:14,752 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 19:01:14,752 - poker_game - INFO - ==================================================
2025-10-31 19:01:14,753 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:14,753 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:14,753 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:01:14,753 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:01:14,753 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:14,754 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:14,754 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:01:14,755 - poker_game - DEBUG - Player bets: [0, 0], Current bet: 0, All same: True
2025-10-31 19:01:14,755 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:01:14,755 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:14,755 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:01:14,756 - poker_game - DEBUG - First actor index: 1
2025-10-31 19:01:14,756 - poker_game - INFO - Betting complete: Back to first actor 1 (all players have acted)
2025-10-31 19:01:14,756 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:14,757 - poker_game - INFO - Hand #22, Phase: river
2025-10-31 19:01:14,757 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:14,757 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:14,758 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:14,758 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:14,758 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:14,758 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:14,759 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:14,759 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:14,759 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:14,759 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:14,759 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:14,759 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:01:14,760 - poker_game - INFO - ==================================================
2025-10-31 19:01:14,860 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 19:01:14,861 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:14,861 - poker_game - INFO - Remaining players: 2
2025-10-31 19:01:14,861 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:01:14,862 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:01:14,862 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 19:01:14,862 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:01:14,862 - poker_game - INFO - Hand #22, Phase: showdown
2025-10-31 19:01:14,863 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:01:14,863 - poker_game - INFO - Pot: 400, Current bet: 0
2025-10-31 19:01:14,863 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:14,864 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:14,864 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:01:14,864 - poker_game - INFO - Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:14,865 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:14,865 - poker_game - INFO -   P1(Agent1): chips=2734, bet=0, status=active
2025-10-31 19:01:14,865 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:14,866 - poker_game - INFO -   P3(Agent3): chips=1457, bet=0, status=active
2025-10-31 19:01:14,866 - poker_game - INFO -   P4(Agent4): chips=5409, bet=0, status=folded
2025-10-31 19:01:14,866 - poker_game - INFO - ==================================================
2025-10-31 19:01:14,867 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:01:14,867 - poker_game - INFO - Pot: 400, Community cards: ['6♥', 'K♣', 'K♥', '7♥', '2♦']
2025-10-31 19:01:14,867 - poker_game - INFO -   Player 1 status=active cards=['5♣', '5♦']
2025-10-31 19:01:14,868 - poker_game - INFO -   Player 3 status=active cards=['9♣', 'A♥']
2025-10-31 19:01:14,871 - poker_game - INFO -   Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=['5♣', '5♦']
2025-10-31 19:01:14,872 - poker_game - INFO -   Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=['9♣', 'A♥']
2025-10-31 19:01:14,874 - poker_game - INFO - Pot layer 0: amount=400, contributors=[1, 3]
2025-10-31 19:01:14,880 - poker_game - INFO - Showdown total awarded: 400 (game.pot=400)
2025-10-31 19:01:14,880 - poker_game - INFO - Showdown winners (aggregated): [1]
2025-10-31 19:01:14,881 - poker_game - INFO -   Awarded 400 to Player 1 (hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦)
2025-10-31 19:01:14,882 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:01:14,921 - poker_game - INFO - === STARTING NEW HAND #23 ===
2025-10-31 19:01:14,922 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:01:14,922 - poker_game - INFO - Moving dealer button
2025-10-31 19:01:14,923 - poker_game - INFO - Posting blinds
2025-10-31 19:01:14,947 - poker_game - INFO - Dealing hole cards
2025-10-31 19:01:14,948 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:01:14,963 - poker_game - INFO - Started new hand in database: hand_id=23
2025-10-31 19:01:14,963 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:01:14,964 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:14,964 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:01:14,964 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:01:14,965 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:14,966 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:14,966 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:14,967 - poker_game - INFO - Community cards: []
2025-10-31 19:01:14,967 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:14,968 - poker_game - INFO -   P1(Agent1): chips=3134, bet=0, status=active
2025-10-31 19:01:14,968 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:14,968 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:01:14,969 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:14,969 - poker_game - INFO - ==================================================
2025-10-31 19:01:14,970 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "K♣",
    "7♥"
  ],
  "community": [],
  "your_chips": 3134,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1447,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (3134)"
  ],
  "history": [
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 19:01:14,984 - poker_game - DEBUG - Create Session: {'id': 'bb9b1fda-7547-44d1-ad2b-0744551072ac', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904874.979947}
2025-10-31 19:01:16,423 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでK7オフスートは弱いハンドなので、フォールドします。しかし、すでにビッグブラインドとして20をベットしており、コールするためのコストは20なので、コールが最も合理的な選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 79, 'promptTokenCount': 864, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 864}], 'totalTokenCount': 943}, 'invocationId': 'e-7db3c3e2-a756-4d58-b42d-909c1f966668', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QQ0YZnhj', 'timestamp': 1761904874.99724}]
2025-10-31 19:01:16,423 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:01:16,423 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップでK7オフスートは弱いハンドなので、フォールドします。しかし、すでにビッグブラインドとして20をベットしており、コールするためのコストは20なので、コールが最も合理的な選択です。"
}
```
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでK7オフスートは弱いハンドなので、フォールドします。しかし、すでにビッグブラインドとして20をベットしており、コールするためのコストは20なので、コールが最も合理的な選択です。"\n}\n```'
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "プリフロップでK7オフスートは弱いハンドなので、フォールドします。しかし、すでにビッグブラインドとして20をベットしており、コールするためのコストは20なので、コールが最も合理的な選択です。"\n}'
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "プリフロップでK7オフスートは弱いハンドなので、フォールドします。しかし、すでにビッグブラインドとして20をベットしており、コールするためのコストは20なので、コールが最も合理的な選択です。"
}
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'プリフロップでK7オフスートは弱いハンドなので、フォールドします。しかし、すでにビッグブラインドとして20をベットしており、コールするためのコストは20なので、コールが最も合理的な選択です。'}
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 20
2025-10-31 19:01:16,424 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (3134)']
2025-10-31 19:01:16,425 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (20)': 20
2025-10-31 19:01:16,425 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 19:01:16,425 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 20, プリフロップでK7オフスートは弱いハンドなので、フォールドします。しかし、すでにビッグブラインドとして20をベットしており、コールするためのコストは20なので、コールが最も合理的な選択です。
2025-10-31 19:01:16,425 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 20
2025-10-31 19:01:16,426 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:16,426 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:16,426 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:01:16,426 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:01:16,426 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:16,427 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:16,427 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:16,427 - poker_game - INFO - Community cards: []
2025-10-31 19:01:16,427 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:16,427 - poker_game - INFO -   P1(Agent1): chips=3134, bet=0, status=active
2025-10-31 19:01:16,427 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:16,427 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:01:16,428 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:16,428 - poker_game - INFO - ==================================================
2025-10-31 19:01:16,428 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 20
2025-10-31 19:01:16,437 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:16,438 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:16,438 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:01:16,438 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 19:01:16,438 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:16,439 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:16,439 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:16,439 - poker_game - INFO - Community cards: []
2025-10-31 19:01:16,439 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:16,439 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:16,440 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:16,440 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:01:16,440 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:16,440 - poker_game - INFO - Extra: Action: Player 1 called 20
2025-10-31 19:01:16,440 - poker_game - INFO - ==================================================
2025-10-31 19:01:16,441 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:16,441 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:16,441 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:01:16,441 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:01:16,441 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:16,442 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:16,442 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:01:16,442 - poker_game - DEBUG - Player bets: [20, 10, 20], Current bet: 20, All same: False
2025-10-31 19:01:16,442 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:01:16,442 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:16,442 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:16,442 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:16,443 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 19:01:16,443 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:16,443 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:16,443 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:16,443 - poker_game - INFO - Community cards: []
2025-10-31 19:01:16,444 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:16,444 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:16,444 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:16,444 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:01:16,444 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:16,445 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:16,445 - poker_game - INFO - ==================================================
2025-10-31 19:01:16,547 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "K♥",
    "7♠"
  ],
  "community": [],
  "your_chips": 1447,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1447)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20"
  ]
}
2025-10-31 19:01:16,556 - poker_game - DEBUG - Create Session: {'id': '60ec2d80-215e-4a00-b3a2-f4d6294e265a', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904876.554718}
2025-10-31 19:01:18,797 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（カードが配られた直後の最初のベットラウンド）で、私の手札はK♥と7♠です。ポットには50があり、コールするには10を支払う必要があります。これは、私の手札にエースやキングなどの強いカードがあるか、またはペアになっている場合に有利な状況です。しかし、私の手札はKと7であり、これはそれほど強力ではありません。相手のプレイヤーがレイズ（ベット額を上げる）している場合、フォールド（降りる）することも検討しますが、今回はコールで様子を見ます。相手のプレイヤー情報がないため、慎重にプレイします。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 160, 'promptTokenCount': 864, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 864}], 'totalTokenCount': 1024}, 'invocationId': 'e-25d55c1f-bed5-4305-bec6-13ebcca8ff05', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'keeXhSon', 'timestamp': 1761904876.566573}]
2025-10-31 19:01:18,798 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:01:18,798 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップ（カードが配られた直後の最初のベットラウンド）で、私の手札はK♥と7♠です。ポットには50があり、コールするには10を支払う必要があります。これは、私の手札にエースやキングなどの強いカードがあるか、またはペアになっている場合に有利な状況です。しかし、私の手札はKと7であり、これはそれほど強力ではありません。相手のプレイヤーがレイズ（ベット額を上げる）している場合、フォールド（降りる）することも検討しますが、今回はコールで様子を見ます。相手のプレイヤー情報がないため、慎重にプレイします。"
}
```
2025-10-31 19:01:18,799 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:01:18,799 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（カードが配られた直後の最初のベットラウンド）で、私の手札はK♥と7♠です。ポットには50があり、コールするには10を支払う必要があります。これは、私の手札にエースやキングなどの強いカードがあるか、またはペアになっている場合に有利な状況です。しかし、私の手札はKと7であり、これはそれほど強力ではありません。相手のプレイヤーがレイズ（ベット額を上げる）している場合、フォールド（降りる）することも検討しますが、今回はコールで様子を見ます。相手のプレイヤー情報がないため、慎重にプレイします。"\n}\n```'
2025-10-31 19:01:18,799 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:01:18,799 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップ（カードが配られた直後の最初のベットラウンド）で、私の手札はK♥と7♠です。ポットには50があり、コールするには10を支払う必要があります。これは、私の手札にエースやキングなどの強いカードがあるか、またはペアになっている場合に有利な状況です。しかし、私の手札はKと7であり、これはそれほど強力ではありません。相手のプレイヤーがレイズ（ベット額を上げる）している場合、フォールド（降りる）することも検討しますが、今回はコールで様子を見ます。相手のプレイヤー情報がないため、慎重にプレイします。"\n}'
2025-10-31 19:01:18,799 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップ（カードが配られた直後の最初のベットラウンド）で、私の手札はK♥と7♠です。ポットには50があり、コールするには10を支払う必要があります。これは、私の手札にエースやキングなどの強いカードがあるか、またはペアになっている場合に有利な状況です。しかし、私の手札はKと7であり、これはそれほど強力ではありません。相手のプレイヤーがレイズ（ベット額を上げる）している場合、フォールド（降りる）することも検討しますが、今回はコールで様子を見ます。相手のプレイヤー情報がないため、慎重にプレイします。"
}
2025-10-31 19:01:18,800 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップ（カードが配られた直後の最初のベットラウンド）で、私の手札はK♥と7♠です。ポットには50があり、コールするには10を支払う必要があります。これは、私の手札にエースやキングなどの強いカードがあるか、またはペアになっている場合に有利な状況です。しかし、私の手札はKと7であり、これはそれほど強力ではありません。相手のプレイヤーがレイズ（ベット額を上げる）している場合、フォールド（降りる）することも検討しますが、今回はコールで様子を見ます。相手のプレイヤー情報がないため、慎重にプレイします。'}
2025-10-31 19:01:18,800 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 10
2025-10-31 19:01:18,800 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (1447)']
2025-10-31 19:01:18,800 - poker_game - DEBUG - [Agent3] Call amount extracted from 'call (10)': 10
2025-10-31 19:01:18,800 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 19:01:18,800 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 10, プリフロップ（カードが配られた直後の最初のベットラウンド）で、私の手札はK♥と7♠です。ポットには50があり、コールするには10を支払う必要があります。これは、私の手札にエースやキングなどの強いカードがあるか、またはペアになっている場合に有利な状況です。しかし、私の手札はKと7であり、これはそれほど強力ではありません。相手のプレイヤーがレイズ（ベット額を上げる）している場合、フォールド（降りる）することも検討しますが、今回はコールで様子を見ます。相手のプレイヤー情報がないため、慎重にプレイします。
2025-10-31 19:01:18,801 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 10
2025-10-31 19:01:18,802 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:18,802 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:18,803 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:18,803 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 19:01:18,804 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:18,804 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:18,804 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:18,805 - poker_game - INFO - Community cards: []
2025-10-31 19:01:18,805 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:18,805 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:18,806 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:18,806 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:01:18,807 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:18,807 - poker_game - INFO - ==================================================
2025-10-31 19:01:18,807 - poker_game - INFO - ACTION_EXECUTED: Player 3 called 10
2025-10-31 19:01:18,820 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:18,821 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:18,821 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:18,822 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 19:01:18,822 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:18,823 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:18,823 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:18,823 - poker_game - INFO - Community cards: []
2025-10-31 19:01:18,824 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:18,824 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:18,824 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:18,825 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 19:01:18,825 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:18,826 - poker_game - INFO - Extra: Action: Player 3 called 10
2025-10-31 19:01:18,826 - poker_game - INFO - ==================================================
2025-10-31 19:01:18,827 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:18,827 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:18,827 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:01:18,827 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:01:18,827 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:18,828 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:18,828 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:01:18,828 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 19:01:18,828 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:01:18,828 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 19:01:18,828 - poker_game - DEBUG - Current player index: 4
2025-10-31 19:01:18,829 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 19:01:18,829 - poker_game - DEBUG - Betting continues: Current player 4 != next after raiser 1
2025-10-31 19:01:18,829 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:18,829 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:18,830 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:01:18,830 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 19:01:18,831 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:18,832 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:18,832 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:18,833 - poker_game - INFO - Community cards: []
2025-10-31 19:01:18,833 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:18,834 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:18,834 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:18,835 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 19:01:18,835 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:18,836 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:18,836 - poker_game - INFO - ==================================================
2025-10-31 19:01:18,937 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "5♣",
    "2♣"
  ],
  "community": [],
  "your_chips": 5389,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (5389)"
  ],
  "history": [
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10"
  ]
}
2025-10-31 19:01:18,948 - poker_game - DEBUG - Create Session: {'id': '36bc3bd3-0734-4432-a8a9-f02cf78165ae', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904878.946489}
2025-10-31 19:01:29,110 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:01:31,742 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_IPD3svMUkFCYcThqS201Ogjx', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1184, 'totalTokenCount': 1201}, 'invocationId': 'e-c35f6510-b429-48f1-81d9-74f446f0a248', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'V0B94ROT', 'timestamp': 1761904878.957135}, {'content': {'parts': [{'functionResponse': {'id': 'call_IPD3svMUkFCYcThqS201Ogjx', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-c35f6510-b429-48f1-81d9-74f446f0a248', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'SF3U6uVV', 'timestamp': 1761904880.02296}, {'content': {'parts': [{'functionCall': {'id': 'call_T1q7sUdiM5dRwDSYA2OXTTMW', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['5♣', '2♣'], 'community': [], 'your_chips': 5389, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3114, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 40)', 'all-in (5389)'], 'history': ['Player 4 folded', 'Player 1 raised to 60', 'Player 3 called 40', 'Flop dealt: 6♥, K♣, K♥', 'Player 1 checked', 'Player 3 checked', 'Turn dealt: 7♥', 'Player 1 checked', 'Player 3 raised to 140', 'Player 1 called 140', 'River dealt: 2♦', 'Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦', 'Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥', 'Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 431, 'promptTokenCount': 1708, 'totalTokenCount': 2139}, 'invocationId': 'e-c35f6510-b429-48f1-81d9-74f446f0a248', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'vFMZmwdT', 'timestamp': 1761904880.024573}, {'content': {'parts': [{'functionResponse': {'id': 'call_T1q7sUdiM5dRwDSYA2OXTTMW', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（12.00(ポットに対して20.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-c35f6510-b429-48f1-81d9-74f446f0a248', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'XJj0jwre', 'timestamp': 1761904889.935249}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2174, 'totalTokenCount': 2212}, 'invocationId': 'e-c35f6510-b429-48f1-81d9-74f446f0a248', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'HzSrpCsK', 'timestamp': 1761904889.93752}]
2025-10-31 19:01:31,742 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:01:31,742 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}'
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（12.00(ポットに対して20.00%）ため、チェックします'}
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 19:01:31,743 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:31,743 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（12.00(ポットに対して20.00%）ため、チェックします
2025-10-31 19:01:31,744 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 19:01:31,744 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:31,744 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:31,744 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:01:31,744 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 19:01:31,744 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:31,744 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:31,745 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:31,745 - poker_game - INFO - Community cards: []
2025-10-31 19:01:31,745 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:31,745 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:31,745 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:31,745 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 19:01:31,745 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:31,745 - poker_game - INFO - ==================================================
2025-10-31 19:01:31,745 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 19:01:31,757 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:31,757 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:31,758 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:01:31,758 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 19:01:31,758 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:31,758 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:31,758 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:31,758 - poker_game - INFO - Community cards: []
2025-10-31 19:01:31,758 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:31,758 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:31,758 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:31,759 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 19:01:31,759 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:31,759 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 19:01:31,759 - poker_game - INFO - ==================================================
2025-10-31 19:01:31,759 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:31,759 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:31,759 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:01:31,759 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:01:31,759 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:31,759 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:31,759 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:01:31,759 - poker_game - DEBUG - Player bets: [20, 20, 20], Current bet: 20, All same: True
2025-10-31 19:01:31,760 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:01:31,760 - poker_game - DEBUG - Last raiser index: 4
2025-10-31 19:01:31,760 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:01:31,760 - poker_game - DEBUG - Next after last raiser 4: 1
2025-10-31 19:01:31,760 - poker_game - INFO - Betting complete: Back to player 1 after last raiser 4
2025-10-31 19:01:31,760 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:31,760 - poker_game - INFO - Hand #23, Phase: preflop
2025-10-31 19:01:31,760 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:01:31,760 - poker_game - INFO - Pot: 60, Current bet: 20
2025-10-31 19:01:31,760 - poker_game - INFO - Last raiser: 4
2025-10-31 19:01:31,761 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:31,761 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:31,761 - poker_game - INFO - Community cards: []
2025-10-31 19:01:31,761 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:31,761 - poker_game - INFO -   P1(Agent1): chips=3114, bet=20, status=active
2025-10-31 19:01:31,761 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:31,761 - poker_game - INFO -   P3(Agent3): chips=1437, bet=20, status=active
2025-10-31 19:01:31,761 - poker_game - INFO -   P4(Agent4): chips=5389, bet=20, status=active
2025-10-31 19:01:31,761 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:01:31,761 - poker_game - INFO - ==================================================
2025-10-31 19:01:31,862 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:01:31,863 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:31,863 - poker_game - INFO - Remaining players: 3
2025-10-31 19:01:31,863 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:01:31,864 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:01:31,864 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:01:31,864 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 19:01:31,874 - poker_game - INFO - Starting new betting round
2025-10-31 19:01:31,874 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:01:31,874 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:01:31,875 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 19:01:31,875 - poker_game - DEBUG - Dealer button: 1
2025-10-31 19:01:31,875 - poker_game - INFO - First actor: Player 3 (by phase rule), was 1
2025-10-31 19:01:31,876 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:01:31,876 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:31,876 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:31,877 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:31,877 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:31,877 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:31,878 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:31,878 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:31,878 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:31,879 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:31,879 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:31,880 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:31,882 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:31,883 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 19:01:31,883 - poker_game - INFO - ==================================================
2025-10-31 19:01:31,884 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "flop",
  "your_cards": [
    "K♥",
    "7♠"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠"
  ],
  "your_chips": 1437,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1437)"
  ],
  "history": [
    "Player 3 called 40",
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠"
  ]
}
2025-10-31 19:01:31,893 - poker_game - DEBUG - Create Session: {'id': 'f99c5b84-fe98-4d22-90d3-fc4611c17682', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904891.891238}
2025-10-31 19:01:34,458 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）の段階で、あなたの手札はK♥ 7♠、フロップは3♠ 9♥ 6♠です。あなたの手札にペアはありませんが、K（キング）がフロップにあるため、トップペア（最も高いランクのカードでできたペア）の可能性がわずかにあります。しかし、フロップにはフラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続したカードが揃うこと）のドロー（揃えられそうなカード）があり、相手がそれを持っている可能性も考慮する必要があります。現在のポットサイズ（賞金プール）は60で、コール（相手のベット額と同じ額を支払うこと）の必要額は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択するのが最善です。これにより、追加のベットなしで次のカード（ターン）を見ることができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 228, 'promptTokenCount': 882, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 882}], 'totalTokenCount': 1110}, 'invocationId': 'e-f7bb9c19-586a-45ba-9359-a5034b347b50', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QMkMI3i7', 'timestamp': 1761904891.902455}]
2025-10-31 19:01:34,458 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:01:34,459 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）の段階で、あなたの手札はK♥ 7♠、フロップは3♠ 9♥ 6♠です。あなたの手札にペアはありませんが、K（キング）がフロップにあるため、トップペア（最も高いランクのカードでできたペア）の可能性がわずかにあります。しかし、フロップにはフラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続したカードが揃うこと）のドロー（揃えられそうなカード）があり、相手がそれを持っている可能性も考慮する必要があります。現在のポットサイズ（賞金プール）は60で、コール（相手のベット額と同じ額を支払うこと）の必要額は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択するのが最善です。これにより、追加のベットなしで次のカード（ターン）を見ることができます。"
}
```
2025-10-31 19:01:34,459 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:01:34,459 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）の段階で、あなたの手札はK♥ 7♠、フロップは3♠ 9♥ 6♠です。あなたの手札にペアはありませんが、K（キング）がフロップにあるため、トップペア（最も高いランクのカードでできたペア）の可能性がわずかにあります。しかし、フロップにはフラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続したカードが揃うこと）のドロー（揃えられそうなカード）があり、相手がそれを持っている可能性も考慮する必要があります。現在のポットサイズ（賞金プール）は60で、コール（相手のベット額と同じ額を支払うこと）の必要額は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択するのが最善です。これにより、追加のベットなしで次のカード（ターン）を見ることができます。"\n}\n```'
2025-10-31 19:01:34,459 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:01:34,459 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）の段階で、あなたの手札はK♥ 7♠、フロップは3♠ 9♥ 6♠です。あなたの手札にペアはありませんが、K（キング）がフロップにあるため、トップペア（最も高いランクのカードでできたペア）の可能性がわずかにあります。しかし、フロップにはフラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続したカードが揃うこと）のドロー（揃えられそうなカード）があり、相手がそれを持っている可能性も考慮する必要があります。現在のポットサイズ（賞金プール）は60で、コール（相手のベット額と同じ額を支払うこと）の必要額は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択するのが最善です。これにより、追加のベットなしで次のカード（ターン）を見ることができます。"\n}'
2025-10-31 19:01:34,460 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）の段階で、あなたの手札はK♥ 7♠、フロップは3♠ 9♥ 6♠です。あなたの手札にペアはありませんが、K（キング）がフロップにあるため、トップペア（最も高いランクのカードでできたペア）の可能性がわずかにあります。しかし、フロップにはフラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続したカードが揃うこと）のドロー（揃えられそうなカード）があり、相手がそれを持っている可能性も考慮する必要があります。現在のポットサイズ（賞金プール）は60で、コール（相手のベット額と同じ額を支払うこと）の必要額は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択するのが最善です。これにより、追加のベットなしで次のカード（ターン）を見ることができます。"
}
2025-10-31 19:01:34,460 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）の段階で、あなたの手札はK♥ 7♠、フロップは3♠ 9♥ 6♠です。あなたの手札にペアはありませんが、K（キング）がフロップにあるため、トップペア（最も高いランクのカードでできたペア）の可能性がわずかにあります。しかし、フロップにはフラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続したカードが揃うこと）のドロー（揃えられそうなカード）があり、相手がそれを持っている可能性も考慮する必要があります。現在のポットサイズ（賞金プール）は60で、コール（相手のベット額と同じ額を支払うこと）の必要額は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択するのが最善です。これにより、追加のベットなしで次のカード（ターン）を見ることができます。'}
2025-10-31 19:01:34,460 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:34,460 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 19:01:34,460 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:34,460 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, フロップ（最初の3枚のコミュニティカード）の段階で、あなたの手札はK♥ 7♠、フロップは3♠ 9♥ 6♠です。あなたの手札にペアはありませんが、K（キング）がフロップにあるため、トップペア（最も高いランクのカードでできたペア）の可能性がわずかにあります。しかし、フロップにはフラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続したカードが揃うこと）のドロー（揃えられそうなカード）があり、相手がそれを持っている可能性も考慮する必要があります。現在のポットサイズ（賞金プール）は60で、コール（相手のベット額と同じ額を支払うこと）の必要額は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択するのが最善です。これにより、追加のベットなしで次のカード（ターン）を見ることができます。
2025-10-31 19:01:34,462 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 19:01:34,462 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:34,462 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:34,462 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:34,463 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:34,463 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:34,463 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:34,463 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:34,463 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:34,464 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:34,464 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:34,464 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:34,464 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:34,464 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:34,464 - poker_game - INFO - ==================================================
2025-10-31 19:01:34,465 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 19:01:34,479 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:34,479 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:34,479 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:34,480 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:34,480 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:34,480 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:34,480 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:34,480 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:34,481 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:34,481 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:34,481 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:34,481 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:34,481 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:34,481 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 19:01:34,482 - poker_game - INFO - ==================================================
2025-10-31 19:01:34,482 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:34,482 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:34,482 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:01:34,482 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:01:34,482 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:34,483 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:34,483 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:01:34,483 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:01:34,483 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:01:34,483 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:34,483 - poker_game - DEBUG - Current player index: 4
2025-10-31 19:01:34,483 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:01:34,483 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 19:01:34,483 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:34,483 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:34,483 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:01:34,484 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:34,484 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:34,484 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:34,484 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:34,484 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:34,484 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:34,484 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:34,485 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:34,485 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:34,485 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:34,485 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:34,485 - poker_game - INFO - ==================================================
2025-10-31 19:01:34,587 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "5♣",
    "2♣"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠"
  ],
  "your_chips": 5389,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5389)"
  ],
  "history": [
    "Flop dealt: 6♥, K♣, K♥",
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked"
  ]
}
2025-10-31 19:01:34,599 - poker_game - DEBUG - Create Session: {'id': 'cbdcffd1-a306-46fa-a732-de5ffedd97c7', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904894.5971787}
2025-10-31 19:01:44,668 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:01:47,471 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_6Jrk9dvT4uLK4pci3JSiPL9b', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1210, 'totalTokenCount': 1227}, 'invocationId': 'e-cc9414db-3b4e-4041-8591-6209ddb469e2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'za7JnXKk', 'timestamp': 1761904894.608116}, {'content': {'parts': [{'functionResponse': {'id': 'call_6Jrk9dvT4uLK4pci3JSiPL9b', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-cc9414db-3b4e-4041-8591-6209ddb469e2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'Jiz9fQuf', 'timestamp': 1761904895.931868}, {'content': {'parts': [{'functionCall': {'id': 'call_wCyiTKJ5pkw4ST7IIndXYJld', 'args': {'call_amount': 0, 'pot_after_call': 60, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 29, 'promptTokenCount': 1734, 'totalTokenCount': 1763}, 'invocationId': 'e-cc9414db-3b4e-4041-8591-6209ddb469e2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'BlaERO6v', 'timestamp': 1761904895.933567}, {'content': {'parts': [{'functionResponse': {'id': 'call_wCyiTKJ5pkw4ST7IIndXYJld', 'name': 'action_decision', 'response': {'error': 'Invoking `action_decision()` failed as the following mandatory input parameters are not present:\ngame_state\nYou could retry calling this tool, but it is IMPORTANT for you to provide all the mandatory parameters.'}}}], 'role': 'user'}, 'invocationId': 'e-cc9414db-3b4e-4041-8591-6209ddb469e2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'UPcFZ3NY', 'timestamp': 1761904897.157641}, {'content': {'parts': [{'functionCall': {'id': 'call_duL4d2pXYI90kX51dtTTE6tb', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['5♣', '2♣'], 'community': ['3♠', '9♥', '6♠'], 'your_chips': 5389, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3114, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (5389)'], 'history': ['Flop dealt: 6♥, K♣, K♥', 'Player 1 checked', 'Player 3 checked', 'Turn dealt: 7♥', 'Player 1 checked', 'Player 3 raised to 140', 'Player 1 called 140', 'River dealt: 2♦', 'Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦', 'Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥', 'Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 3♠, 9♥, 6♠', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 425, 'promptTokenCount': 1819, 'totalTokenCount': 2244}, 'invocationId': 'e-cc9414db-3b4e-4041-8591-6209ddb469e2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '0SSvnT1p', 'timestamp': 1761904897.160935}, {'content': {'parts': [{'functionResponse': {'id': 'call_duL4d2pXYI90kX51dtTTE6tb', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（12.00(ポットに対して20.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-cc9414db-3b4e-4041-8591-6209ddb469e2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'kMHbppvu', 'timestamp': 1761904905.236739}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2295, 'totalTokenCount': 2333}, 'invocationId': 'e-cc9414db-3b4e-4041-8591-6209ddb469e2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '5OmCCP2t', 'timestamp': 1761904905.238848}]
2025-10-31 19:01:47,471 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:01:47,471 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 19:01:47,472 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:01:47,472 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}'
2025-10-31 19:01:47,472 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:01:47,472 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（12.00(ポットに対して20.00%）ため、チェックします"}
2025-10-31 19:01:47,472 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（12.00(ポットに対して20.00%）ため、チェックします'}
2025-10-31 19:01:47,472 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:47,473 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 19:01:47,473 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:47,473 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（12.00(ポットに対して20.00%）ため、チェックします
2025-10-31 19:01:47,473 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 19:01:47,474 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:47,474 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:47,474 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:01:47,474 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:47,474 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:47,475 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:47,476 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:47,477 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:47,478 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:47,478 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:47,479 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:47,479 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:47,479 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:47,479 - poker_game - INFO - ==================================================
2025-10-31 19:01:47,479 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 19:01:47,489 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:47,490 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:47,490 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:01:47,490 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:47,490 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:47,491 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:47,491 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:47,491 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:47,491 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:47,491 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:47,492 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:47,492 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:47,492 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:47,492 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 19:01:47,492 - poker_game - INFO - ==================================================
2025-10-31 19:01:47,492 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:47,493 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:47,493 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:01:47,493 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:01:47,493 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:47,493 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:47,493 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:01:47,493 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:01:47,494 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:01:47,494 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:47,494 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:01:47,494 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:01:47,494 - poker_game - DEBUG - Betting continues: Current player 1 != first actor 3
2025-10-31 19:01:47,494 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:47,494 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:47,494 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:01:47,494 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:47,494 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:47,495 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:47,495 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:47,495 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:47,495 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:47,495 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:47,495 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:47,495 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:47,496 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:47,496 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:47,496 - poker_game - INFO - ==================================================
2025-10-31 19:01:47,598 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "K♣",
    "7♥"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠"
  ],
  "your_chips": 3114,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3114)"
  ],
  "history": [
    "Player 1 checked",
    "Player 3 checked",
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked"
  ]
}
2025-10-31 19:01:47,610 - poker_game - DEBUG - Create Session: {'id': '6b8c8400-5f1f-4a5c-9282-82286c26c388', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904907.6074412}
2025-10-31 19:01:49,972 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠）を合わせても、強い役はできていません。K（キング）が一番高いカードですが、ペアもありません。ポット（場にあるチップの総額）は60で、コール（相手のベット額と同額を支払ってゲームを続けること）は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択し、状況を見るのが最善です。相手のプレイヤー3と4はまだベットしていないので、チェックで反応を見ることができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 170, 'promptTokenCount': 870, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 870}], 'totalTokenCount': 1040}, 'invocationId': 'e-461ef9ce-e0a7-4fd7-bf2d-ed3c33e49d3f', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '4UQyecrm', 'timestamp': 1761904907.623423}]
2025-10-31 19:01:49,972 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:01:49,972 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠）を合わせても、強い役はできていません。K（キング）が一番高いカードですが、ペアもありません。ポット（場にあるチップの総額）は60で、コール（相手のベット額と同額を支払ってゲームを続けること）は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択し、状況を見るのが最善です。相手のプレイヤー3と4はまだベットしていないので、チェックで反応を見ることができます。"
}
```
2025-10-31 19:01:49,972 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:01:49,972 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠）を合わせても、強い役はできていません。K（キング）が一番高いカードですが、ペアもありません。ポット（場にあるチップの総額）は60で、コール（相手のベット額と同額を支払ってゲームを続けること）は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択し、状況を見るのが最善です。相手のプレイヤー3と4はまだベットしていないので、チェックで反応を見ることができます。"\n}\n```'
2025-10-31 19:01:49,973 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:01:49,973 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "フロップ（最初の3枚のコミュニティカード）では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠）を合わせても、強い役はできていません。K（キング）が一番高いカードですが、ペアもありません。ポット（場にあるチップの総額）は60で、コール（相手のベット額と同額を支払ってゲームを続けること）は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択し、状況を見るのが最善です。相手のプレイヤー3と4はまだベットしていないので、チェックで反応を見ることができます。"\n}'
2025-10-31 19:01:49,973 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "フロップ（最初の3枚のコミュニティカード）では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠）を合わせても、強い役はできていません。K（キング）が一番高いカードですが、ペアもありません。ポット（場にあるチップの総額）は60で、コール（相手のベット額と同額を支払ってゲームを続けること）は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択し、状況を見るのが最善です。相手のプレイヤー3と4はまだベットしていないので、チェックで反応を見ることができます。"
}
2025-10-31 19:01:49,973 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'フロップ（最初の3枚のコミュニティカード）では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠）を合わせても、強い役はできていません。K（キング）が一番高いカードですが、ペアもありません。ポット（場にあるチップの総額）は60で、コール（相手のベット額と同額を支払ってゲームを続けること）は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択し、状況を見るのが最善です。相手のプレイヤー3と4はまだベットしていないので、チェックで反応を見ることができます。'}
2025-10-31 19:01:49,973 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:49,973 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 19:01:49,973 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:49,973 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, フロップ（最初の3枚のコミュニティカード）では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠）を合わせても、強い役はできていません。K（キング）が一番高いカードですが、ペアもありません。ポット（場にあるチップの総額）は60で、コール（相手のベット額と同額を支払ってゲームを続けること）は0なので、チェック（ベットせずに次のプレイヤーに番を回すこと）を選択し、状況を見るのが最善です。相手のプレイヤー3と4はまだベットしていないので、チェックで反応を見ることができます。
2025-10-31 19:01:49,974 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 19:01:49,974 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:49,974 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:49,974 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:01:49,975 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:49,975 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:49,975 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:49,975 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:49,975 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:49,976 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:49,976 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:49,976 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:49,976 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:49,976 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:49,977 - poker_game - INFO - ==================================================
2025-10-31 19:01:49,977 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 19:01:49,985 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:49,985 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:49,985 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:01:49,985 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:49,986 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:49,986 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:49,986 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:49,986 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:49,987 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:49,987 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:49,987 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:49,987 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:49,987 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:49,988 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 19:01:49,988 - poker_game - INFO - ==================================================
2025-10-31 19:01:49,988 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:49,988 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:49,989 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:01:49,989 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:01:49,989 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:49,989 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:49,989 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:01:49,989 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:01:49,989 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:01:49,990 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:49,990 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:01:49,990 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:01:49,990 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 19:01:49,990 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:49,990 - poker_game - INFO - Hand #23, Phase: flop
2025-10-31 19:01:49,991 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:49,991 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:49,991 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:49,991 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:49,991 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:49,992 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠']
2025-10-31 19:01:49,992 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:49,992 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:49,992 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:49,993 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:49,993 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:49,993 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:01:49,993 - poker_game - INFO - ==================================================
2025-10-31 19:01:50,094 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 19:01:50,095 - poker_game - INFO - Betting round complete: True
2025-10-31 19:01:50,095 - poker_game - INFO - Remaining players: 3
2025-10-31 19:01:50,095 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:01:50,095 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:01:50,095 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:01:50,095 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 19:01:50,107 - poker_game - INFO - Starting new betting round
2025-10-31 19:01:50,108 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:01:50,108 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:01:50,108 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 19:01:50,109 - poker_game - DEBUG - Dealer button: 1
2025-10-31 19:01:50,109 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 19:01:50,109 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:01:50,110 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:01:50,110 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:50,110 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:50,111 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:50,112 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:50,112 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:50,112 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:01:50,113 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:50,114 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:50,114 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:50,115 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:50,115 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:50,116 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 19:01:50,117 - poker_game - INFO - ==================================================
2025-10-31 19:01:50,119 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "turn",
  "your_cards": [
    "K♥",
    "7♠"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠",
    "4♣"
  ],
  "your_chips": 1437,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1437)"
  ],
  "history": [
    "Turn dealt: 7♥",
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣"
  ]
}
2025-10-31 19:01:50,131 - poker_game - DEBUG - Create Session: {'id': 'bac31ce4-def1-4b5e-872a-821b3e6d9bb9', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904910.1286194}
2025-10-31 19:01:52,226 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（3♠ 9♥ 6♠ 4♣）では、あなたの手札（K♥ 7♠）はペアを作っておらず、ストレートやフラッシュの可能性も低い状況です。相手もチェックしてきたため、追加のベットをせずに次のカード（リバー）を見るのが最善の選択です。これは、無駄なチップを失うリスクを避けつつ、より良いカードが来る可能性に賭ける戦略です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 127, 'promptTokenCount': 878, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 878}], 'totalTokenCount': 1005}, 'invocationId': 'e-4299a7f7-a0af-4ee5-8900-8ab3fc12c5dd', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ZXYP4cX7', 'timestamp': 1761904910.141371}]
2025-10-31 19:01:52,226 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:01:52,226 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "現在のボード（3♠ 9♥ 6♠ 4♣）では、あなたの手札（K♥ 7♠）はペアを作っておらず、ストレートやフラッシュの可能性も低い状況です。相手もチェックしてきたため、追加のベットをせずに次のカード（リバー）を見るのが最善の選択です。これは、無駄なチップを失うリスクを避けつつ、より良いカードが来る可能性に賭ける戦略です。"
}
```
2025-10-31 19:01:52,226 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:01:52,226 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（3♠ 9♥ 6♠ 4♣）では、あなたの手札（K♥ 7♠）はペアを作っておらず、ストレートやフラッシュの可能性も低い状況です。相手もチェックしてきたため、追加のベットをせずに次のカード（リバー）を見るのが最善の選択です。これは、無駄なチップを失うリスクを避けつつ、より良いカードが来る可能性に賭ける戦略です。"\n}\n```'
2025-10-31 19:01:52,227 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:01:52,227 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在のボード（3♠ 9♥ 6♠ 4♣）では、あなたの手札（K♥ 7♠）はペアを作っておらず、ストレートやフラッシュの可能性も低い状況です。相手もチェックしてきたため、追加のベットをせずに次のカード（リバー）を見るのが最善の選択です。これは、無駄なチップを失うリスクを避けつつ、より良いカードが来る可能性に賭ける戦略です。"\n}'
2025-10-31 19:01:52,227 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "現在のボード（3♠ 9♥ 6♠ 4♣）では、あなたの手札（K♥ 7♠）はペアを作っておらず、ストレートやフラッシュの可能性も低い状況です。相手もチェックしてきたため、追加のベットをせずに次のカード（リバー）を見るのが最善の選択です。これは、無駄なチップを失うリスクを避けつつ、より良いカードが来る可能性に賭ける戦略です。"
}
2025-10-31 19:01:52,227 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '現在のボード（3♠ 9♥ 6♠ 4♣）では、あなたの手札（K♥ 7♠）はペアを作っておらず、ストレートやフラッシュの可能性も低い状況です。相手もチェックしてきたため、追加のベットをせずに次のカード（リバー）を見るのが最善の選択です。これは、無駄なチップを失うリスクを避けつつ、より良いカードが来る可能性に賭ける戦略です。'}
2025-10-31 19:01:52,227 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 19:01:52,227 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 19:01:52,227 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:01:52,227 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, 現在のボード（3♠ 9♥ 6♠ 4♣）では、あなたの手札（K♥ 7♠）はペアを作っておらず、ストレートやフラッシュの可能性も低い状況です。相手もチェックしてきたため、追加のベットをせずに次のカード（リバー）を見るのが最善の選択です。これは、無駄なチップを失うリスクを避けつつ、より良いカードが来る可能性に賭ける戦略です。
2025-10-31 19:01:52,228 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 19:01:52,228 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:01:52,228 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:01:52,229 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:52,229 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:52,229 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:52,229 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:52,229 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:52,229 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:01:52,229 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:52,230 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:52,230 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:52,230 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:52,230 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:52,230 - poker_game - INFO - ==================================================
2025-10-31 19:01:52,230 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 19:01:52,243 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:01:52,244 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:01:52,244 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:01:52,244 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:52,244 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:52,244 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:52,244 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:52,245 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:01:52,245 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:52,245 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:52,245 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:52,245 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:52,245 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:52,246 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 19:01:52,246 - poker_game - INFO - ==================================================
2025-10-31 19:01:52,246 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:01:52,246 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:01:52,246 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:01:52,246 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:01:52,246 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:01:52,247 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:01:52,247 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:01:52,247 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:01:52,247 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:01:52,247 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:01:52,247 - poker_game - DEBUG - Current player index: 4
2025-10-31 19:01:52,247 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:01:52,247 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 19:01:52,247 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:01:52,248 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:01:52,248 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:01:52,248 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:01:52,248 - poker_game - INFO - Last raiser: None
2025-10-31 19:01:52,248 - poker_game - INFO - Betting round complete: False
2025-10-31 19:01:52,248 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:01:52,249 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:01:52,249 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:01:52,249 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:01:52,249 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:01:52,249 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:01:52,249 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:01:52,249 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:01:52,250 - poker_game - INFO - ==================================================
2025-10-31 19:01:52,351 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "5♣",
    "2♣"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠",
    "4♣"
  ],
  "your_chips": 5389,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5389)"
  ],
  "history": [
    "Player 1 checked",
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked"
  ]
}
2025-10-31 19:01:52,361 - poker_game - DEBUG - Create Session: {'id': 'deddd314-23dc-4ce2-bae9-6a3ece9053aa', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904912.359006}
2025-10-31 19:02:02,401 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:02:07,340 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_97HRUP66gNTW5l2qdyQNoRz2', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1206, 'totalTokenCount': 1223}, 'invocationId': 'e-c9dce2c6-b26a-42b4-8d0c-117cfe49a670', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'kP9NJ183', 'timestamp': 1761904912.371989}, {'content': {'parts': [{'functionResponse': {'id': 'call_97HRUP66gNTW5l2qdyQNoRz2', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-c9dce2c6-b26a-42b4-8d0c-117cfe49a670', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'toSdZcjn', 'timestamp': 1761904913.352871}, {'content': {'parts': [{'functionCall': {'id': 'call_BvB5nnn46ZglIzCdftF9R9VQ', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['5♣', '2♣'], 'community': ['3♠', '9♥', '6♠', '4♣'], 'your_chips': 5389, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3114, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (5389)'], 'history': ['Player 1 checked', 'Player 3 raised to 140', 'Player 1 called 140', 'River dealt: 2♦', 'Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦', 'Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥', 'Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 3♠, 9♥, 6♠', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 4♣', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.0}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 427, 'promptTokenCount': 1730, 'totalTokenCount': 2157}, 'invocationId': 'e-c9dce2c6-b26a-42b4-8d0c-117cfe49a670', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'asjEGpLD', 'timestamp': 1761904913.35724}, {'content': {'parts': [{'functionResponse': {'id': 'call_BvB5nnn46ZglIzCdftF9R9VQ', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（0.00(ポットに対して0.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'e-c9dce2c6-b26a-42b4-8d0c-117cfe49a670', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'IUnS0s6d', 'timestamp': 1761904925.574756}, {'content': {'parts': [{'text': '{"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 38, 'promptTokenCount': 2208, 'totalTokenCount': 2246}, 'invocationId': 'e-c9dce2c6-b26a-42b4-8d0c-117cfe49a670', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'paXtbfBv', 'timestamp': 1761904925.576645}]
2025-10-31 19:02:07,341 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:02:07,341 - poker_game - DEBUG - {"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}
2025-10-31 19:02:07,342 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:02:07,342 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}'
2025-10-31 19:02:07,342 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:02:07,342 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"check","amount":0,"reasoning":"期待値が低い（0.00(ポットに対して0.00%）ため、チェックします"}
2025-10-31 19:02:07,342 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（0.00(ポットに対して0.00%）ため、チェックします'}
2025-10-31 19:02:07,342 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 19:02:07,343 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 19:02:07,343 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:02:07,343 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い（0.00(ポットに対して0.00%）ため、チェックします
2025-10-31 19:02:07,344 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 19:02:07,344 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:02:07,345 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:02:07,345 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:02:07,345 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:07,346 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:07,346 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:07,347 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:07,348 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:02:07,349 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:07,350 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:07,350 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:07,350 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:07,351 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:07,352 - poker_game - INFO - ==================================================
2025-10-31 19:02:07,353 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 19:02:07,368 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:02:07,369 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:02:07,369 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:02:07,369 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:07,370 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:07,371 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:07,373 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:07,375 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:02:07,376 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:07,377 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:07,377 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:07,377 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:07,378 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:07,378 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 19:02:07,378 - poker_game - INFO - ==================================================
2025-10-31 19:02:07,379 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:02:07,379 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:02:07,379 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:02:07,379 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:02:07,380 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:02:07,380 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:02:07,380 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:02:07,381 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:02:07,381 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:02:07,381 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:02:07,381 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:02:07,381 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:02:07,381 - poker_game - DEBUG - Betting continues: Current player 1 != first actor 3
2025-10-31 19:02:07,382 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:02:07,382 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:02:07,382 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:02:07,383 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:07,383 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:07,383 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:07,383 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:07,384 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:02:07,384 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:07,384 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:07,385 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:07,385 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:07,385 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:07,385 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:02:07,386 - poker_game - INFO - ==================================================
2025-10-31 19:02:07,487 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "K♣",
    "7♥"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠",
    "4♣"
  ],
  "your_chips": 3114,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3114)"
  ],
  "history": [
    "Player 3 raised to 140",
    "Player 1 called 140",
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked"
  ]
}
2025-10-31 19:02:07,505 - poker_game - DEBUG - Create Session: {'id': 'e74935de-acce-4be1-ab27-014d2f1d5b59', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904927.5021062}
2025-10-31 19:02:06,235 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣）から、強い役はできていません。相手のプレイヤーもチェックしているので、追加のベットはせず、次のカード（リバー）を見るのが最善です。これにより、より良いカードが出る可能性を待ちながら、チップを温存できます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 116, 'promptTokenCount': 876, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 876}], 'totalTokenCount': 992}, 'invocationId': 'e-16e612fa-9a7d-46be-83af-9e92581af19f', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'PYKNapwH', 'timestamp': 1761904927.516893}]
2025-10-31 19:02:06,235 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:02:06,236 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "現在の状況では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣）から、強い役はできていません。相手のプレイヤーもチェックしているので、追加のベットはせず、次のカード（リバー）を見るのが最善です。これにより、より良いカードが出る可能性を待ちながら、チップを温存できます。"
}
```
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣）から、強い役はできていません。相手のプレイヤーもチェックしているので、追加のベットはせず、次のカード（リバー）を見るのが最善です。これにより、より良いカードが出る可能性を待ちながら、チップを温存できます。"\n}\n```'
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "現在の状況では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣）から、強い役はできていません。相手のプレイヤーもチェックしているので、追加のベットはせず、次のカード（リバー）を見るのが最善です。これにより、より良いカードが出る可能性を待ちながら、チップを温存できます。"\n}'
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "現在の状況では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣）から、強い役はできていません。相手のプレイヤーもチェックしているので、追加のベットはせず、次のカード（リバー）を見るのが最善です。これにより、より良いカードが出る可能性を待ちながら、チップを温存できます。"
}
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '現在の状況では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣）から、強い役はできていません。相手のプレイヤーもチェックしているので、追加のベットはせず、次のカード（リバー）を見るのが最善です。これにより、より良いカードが出る可能性を待ちながら、チップを温存できます。'}
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 19:02:06,236 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:02:06,236 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, 現在の状況では、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣）から、強い役はできていません。相手のプレイヤーもチェックしているので、追加のベットはせず、次のカード（リバー）を見るのが最善です。これにより、より良いカードが出る可能性を待ちながら、チップを温存できます。
2025-10-31 19:02:06,237 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 19:02:06,237 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:02:06,237 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:02:06,238 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:02:06,238 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:06,238 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:06,238 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:06,238 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:06,239 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:02:06,239 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:06,239 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:06,239 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:06,239 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:06,239 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:06,240 - poker_game - INFO - ==================================================
2025-10-31 19:02:06,240 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 19:02:06,250 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:02:06,250 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:02:06,250 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:02:06,250 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:06,251 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:06,251 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:06,251 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:06,251 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:02:06,251 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:06,252 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:06,252 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:06,252 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:06,252 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:06,252 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 19:02:06,252 - poker_game - INFO - ==================================================
2025-10-31 19:02:06,252 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:02:06,253 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:02:06,253 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:02:06,253 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:02:06,255 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:02:06,255 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:02:06,255 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:02:06,256 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:02:06,256 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:02:06,256 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:02:06,256 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:02:06,256 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:02:06,256 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 19:02:06,256 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:02:06,256 - poker_game - INFO - Hand #23, Phase: turn
2025-10-31 19:02:06,256 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:02:06,257 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:06,257 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:06,257 - poker_game - INFO - Betting round complete: True
2025-10-31 19:02:06,257 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:06,257 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣']
2025-10-31 19:02:06,258 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:06,258 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:06,259 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:06,259 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:06,259 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:06,259 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:02:06,259 - poker_game - INFO - ==================================================
2025-10-31 19:02:06,360 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 19:02:06,361 - poker_game - INFO - Betting round complete: True
2025-10-31 19:02:06,361 - poker_game - INFO - Remaining players: 3
2025-10-31 19:02:06,361 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:02:06,362 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:02:06,362 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:02:06,362 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 19:02:06,373 - poker_game - INFO - Starting new betting round
2025-10-31 19:02:06,373 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:02:06,374 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:02:06,374 - poker_game - DEBUG - Active players for new betting round: [1, 3, 4]
2025-10-31 19:02:06,374 - poker_game - DEBUG - Dealer button: 1
2025-10-31 19:02:06,374 - poker_game - INFO - First actor: Player 3 (by phase rule), was 3
2025-10-31 19:02:06,375 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:02:06,375 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:06,375 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:02:06,375 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:06,376 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:06,376 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:06,376 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:06,377 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:06,377 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:06,378 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:06,378 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:06,378 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:06,379 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:06,379 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 19:02:06,379 - poker_game - INFO - ==================================================
2025-10-31 19:02:06,380 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "river",
  "your_cards": [
    "K♥",
    "7♠"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠",
    "4♣",
    "9♦"
  ],
  "your_chips": 1437,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (1437)"
  ],
  "history": [
    "River dealt: 2♦",
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦"
  ]
}
2025-10-31 19:02:06,394 - poker_game - DEBUG - Create Session: {'id': 'a6b6c710-e3dc-4a84-a416-2b87630a5dc6', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904926.3919067}
2025-10-31 19:02:08,943 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はK♥7♠、コミュニティカードは3♠9♥6♠4♣9♦です。あなたの手札とコミュニティカードを合わせると、Kハイ（キングが一番強いカード）です。しかし、コミュニティカードには9が2枚あるため、相手の誰かが9のワンペア（同じ数字のカードが2枚揃うこと）を持っている可能性があります。あなたの手札は、この9のペアよりも強いものではありません。現在の状況では、あなたはポットをチェック（アクションを起こさず、他のプレイヤーのアクションを見る）するのが最善です。もし相手がベットしてきた場合、あなたの手札では勝てない可能性が高いので、フォールド（ゲームから降りること）を検討することになります。今回の履歴を見ると、以前のラウンドで相手プレイヤーがポットをチェックしているため、あなたもチェックで対応し、ショーダウン（お互いの手札を見せ合って勝者を決めること）に進むのが合理的です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 244, 'promptTokenCount': 875, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 875}], 'totalTokenCount': 1119}, 'invocationId': 'e-7cc40e77-ad37-4415-871a-1e236431d5c5', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'y5bkrieR', 'timestamp': 1761904926.404849}]
2025-10-31 19:02:08,944 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:02:08,944 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はK♥7♠、コミュニティカードは3♠9♥6♠4♣9♦です。あなたの手札とコミュニティカードを合わせると、Kハイ（キングが一番強いカード）です。しかし、コミュニティカードには9が2枚あるため、相手の誰かが9のワンペア（同じ数字のカードが2枚揃うこと）を持っている可能性があります。あなたの手札は、この9のペアよりも強いものではありません。現在の状況では、あなたはポットをチェック（アクションを起こさず、他のプレイヤーのアクションを見る）するのが最善です。もし相手がベットしてきた場合、あなたの手札では勝てない可能性が高いので、フォールド（ゲームから降りること）を検討することになります。今回の履歴を見ると、以前のラウンドで相手プレイヤーがポットをチェックしているため、あなたもチェックで対応し、ショーダウン（お互いの手札を見せ合って勝者を決めること）に進むのが合理的です。"
}
```
2025-10-31 19:02:08,944 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:02:08,944 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はK♥7♠、コミュニティカードは3♠9♥6♠4♣9♦です。あなたの手札とコミュニティカードを合わせると、Kハイ（キングが一番強いカード）です。しかし、コミュニティカードには9が2枚あるため、相手の誰かが9のワンペア（同じ数字のカードが2枚揃うこと）を持っている可能性があります。あなたの手札は、この9のペアよりも強いものではありません。現在の状況では、あなたはポットをチェック（アクションを起こさず、他のプレイヤーのアクションを見る）するのが最善です。もし相手がベットしてきた場合、あなたの手札では勝てない可能性が高いので、フォールド（ゲームから降りること）を検討することになります。今回の履歴を見ると、以前のラウンドで相手プレイヤーがポットをチェックしているため、あなたもチェックで対応し、ショーダウン（お互いの手札を見せ合って勝者を決めること）に進むのが合理的です。"\n}\n```'
2025-10-31 19:02:08,944 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:02:08,944 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はK♥7♠、コミュニティカードは3♠9♥6♠4♣9♦です。あなたの手札とコミュニティカードを合わせると、Kハイ（キングが一番強いカード）です。しかし、コミュニティカードには9が2枚あるため、相手の誰かが9のワンペア（同じ数字のカードが2枚揃うこと）を持っている可能性があります。あなたの手札は、この9のペアよりも強いものではありません。現在の状況では、あなたはポットをチェック（アクションを起こさず、他のプレイヤーのアクションを見る）するのが最善です。もし相手がベットしてきた場合、あなたの手札では勝てない可能性が高いので、フォールド（ゲームから降りること）を検討することになります。今回の履歴を見ると、以前のラウンドで相手プレイヤーがポットをチェックしているため、あなたもチェックで対応し、ショーダウン（お互いの手札を見せ合って勝者を決めること）に進むのが合理的です。"\n}'
2025-10-31 19:02:08,945 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最後のコミュニティカード）が配られ、あなたの手札はK♥7♠、コミュニティカードは3♠9♥6♠4♣9♦です。あなたの手札とコミュニティカードを合わせると、Kハイ（キングが一番強いカード）です。しかし、コミュニティカードには9が2枚あるため、相手の誰かが9のワンペア（同じ数字のカードが2枚揃うこと）を持っている可能性があります。あなたの手札は、この9のペアよりも強いものではありません。現在の状況では、あなたはポットをチェック（アクションを起こさず、他のプレイヤーのアクションを見る）するのが最善です。もし相手がベットしてきた場合、あなたの手札では勝てない可能性が高いので、フォールド（ゲームから降りること）を検討することになります。今回の履歴を見ると、以前のラウンドで相手プレイヤーがポットをチェックしているため、あなたもチェックで対応し、ショーダウン（お互いの手札を見せ合って勝者を決めること）に進むのが合理的です。"
}
2025-10-31 19:02:08,945 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最後のコミュニティカード）が配られ、あなたの手札はK♥7♠、コミュニティカードは3♠9♥6♠4♣9♦です。あなたの手札とコミュニティカードを合わせると、Kハイ（キングが一番強いカード）です。しかし、コミュニティカードには9が2枚あるため、相手の誰かが9のワンペア（同じ数字のカードが2枚揃うこと）を持っている可能性があります。あなたの手札は、この9のペアよりも強いものではありません。現在の状況では、あなたはポットをチェック（アクションを起こさず、他のプレイヤーのアクションを見る）するのが最善です。もし相手がベットしてきた場合、あなたの手札では勝てない可能性が高いので、フォールド（ゲームから降りること）を検討することになります。今回の履歴を見ると、以前のラウンドで相手プレイヤーがポットをチェックしているため、あなたもチェックで対応し、ショーダウン（お互いの手札を見せ合って勝者を決めること）に進むのが合理的です。'}
2025-10-31 19:02:08,945 - poker_game - DEBUG - [Agent3] Extracted values - action: 'check', amount: 0
2025-10-31 19:02:08,945 - poker_game - DEBUG - [Agent3] Action 'check' normalized - amount set to 0
2025-10-31 19:02:08,945 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:02:08,945 - poker_game - INFO - [Agent3] Successfully parsed decision: check, 0, リバー（最後のコミュニティカード）が配られ、あなたの手札はK♥7♠、コミュニティカードは3♠9♥6♠4♣9♦です。あなたの手札とコミュニティカードを合わせると、Kハイ（キングが一番強いカード）です。しかし、コミュニティカードには9が2枚あるため、相手の誰かが9のワンペア（同じ数字のカードが2枚揃うこと）を持っている可能性があります。あなたの手札は、この9のペアよりも強いものではありません。現在の状況では、あなたはポットをチェック（アクションを起こさず、他のプレイヤーのアクションを見る）するのが最善です。もし相手がベットしてきた場合、あなたの手札では勝てない可能性が高いので、フォールド（ゲームから降りること）を検討することになります。今回の履歴を見ると、以前のラウンドで相手プレイヤーがポットをチェックしているため、あなたもチェックで対応し、ショーダウン（お互いの手札を見せ合って勝者を決めること）に進むのが合理的です。
2025-10-31 19:02:08,946 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'check' with amount 0
2025-10-31 19:02:08,946 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:02:08,946 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:08,946 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:02:08,946 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:08,947 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:08,947 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:08,947 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:08,947 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:08,947 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:08,947 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:08,948 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:08,948 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:08,948 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:08,948 - poker_game - INFO - ==================================================
2025-10-31 19:02:08,948 - poker_game - INFO - ACTION_EXECUTED: Player 3 checked
2025-10-31 19:02:08,975 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:02:08,975 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:08,975 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:02:08,976 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:08,976 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:08,976 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:08,976 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:08,976 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:08,977 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:08,977 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:08,977 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:08,977 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:08,977 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:08,978 - poker_game - INFO - Extra: Action: Player 3 checked
2025-10-31 19:02:08,978 - poker_game - INFO - ==================================================
2025-10-31 19:02:08,978 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:02:08,978 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:02:08,978 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:02:08,978 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:02:08,979 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:02:08,979 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:02:08,979 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:02:08,979 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:02:08,979 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:02:08,979 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:02:08,980 - poker_game - DEBUG - Current player index: 4
2025-10-31 19:02:08,980 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:02:08,980 - poker_game - DEBUG - Betting continues: Current player 4 != first actor 3
2025-10-31 19:02:08,980 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:02:08,980 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:08,980 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:02:08,980 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:08,981 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:08,981 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:08,981 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:08,981 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:08,982 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:08,982 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:08,982 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:08,982 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:08,982 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:08,982 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:02:08,983 - poker_game - INFO - ==================================================
2025-10-31 19:02:09,084 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "5♣",
    "2♣"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠",
    "4♣",
    "9♦"
  ],
  "your_chips": 5389,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3114,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5389)"
  ],
  "history": [
    "Player 1 checked",
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked"
  ]
}
2025-10-31 19:02:09,095 - poker_game - DEBUG - Create Session: {'id': '4f120e0c-a4e1-4bb5-a255-164f39fa211c', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904929.0934825}
2025-10-31 19:02:19,269 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:02:29,291 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:02:33,617 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_1kwqAjg9XyYDyeMzITh68Wam', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1206, 'totalTokenCount': 1223}, 'invocationId': 'e-f2935283-75d1-4adc-b4fc-4dfe61dd2ad2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'alUIqzBo', 'timestamp': 1761904929.108162}, {'content': {'parts': [{'functionResponse': {'id': 'call_1kwqAjg9XyYDyeMzITh68Wam', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-f2935283-75d1-4adc-b4fc-4dfe61dd2ad2', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'oVCes9sr', 'timestamp': 1761904930.418612}, {'content': {'parts': [{'functionCall': {'id': 'call_GuhNvpe46KzY4s6c2AMUoT2s', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['5♣', '2♣'], 'community': ['3♠', '9♥', '6♠', '4♣', '9♦'], 'your_chips': 5389, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3114, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (5389)'], 'history': ['Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦', 'Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥', 'Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 3♠, 9♥, 6♠', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 4♣', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'River dealt: 9♦', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.1}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_m5HaBnqO2vzpA2osBbQtcik3', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['5♣', '2♣'], 'community': ['3♠', '9♥', '6♠', '4♣', '9♦'], 'your_chips': 5389, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 20, 'pot': 60, 'to_call': 0, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3114, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'active'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (5389)'], 'history': ['Player 1 checked', 'Player 3 checked', 'Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦', 'Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥', 'Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 called 10', 'Player 4 checked', 'Flop dealt: 3♠, 9♥, 6♠', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 4♣', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'River dealt: 9♦', 'Player 3 checked']}, 'call_amount': 0, 'pot_after_call': 60, 'equity': 0.1}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 866, 'promptTokenCount': 1730, 'totalTokenCount': 2596}, 'invocationId': 'e-f2935283-75d1-4adc-b4fc-4dfe61dd2ad2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'cgA4vSPn', 'timestamp': 1761904930.423915}, {'content': {'parts': [{'functionResponse': {'id': 'call_GuhNvpe46KzY4s6c2AMUoT2s', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（6.00(ポットに対して10.00%）ため、チェックします'}}}, {'functionResponse': {'id': 'call_m5HaBnqO2vzpA2osBbQtcik3', 'name': 'action_decision', 'response': {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い（6.00(ポットに対して10.00%）ため、チェックします'}}}], 'role': 'user'}, 'invocationId': 'xtYcR9Fd', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'aVvuuw3Q', 'timestamp': 1761904951.466951}, {'content': {'parts': [{'text': '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い(6.00(ポットに対して10.00%)ため、チェックします"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 47, 'promptTokenCount': 2820, 'totalTokenCount': 2867}, 'invocationId': 'e-f2935283-75d1-4adc-b4fc-4dfe61dd2ad2', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'zDhBDNVh', 'timestamp': 1761904951.471145}]
2025-10-31 19:02:33,618 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:02:33,618 - poker_game - DEBUG - {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い(6.00(ポットに対して10.00%)ため、チェックします"
}
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "期待値が低い(6.00(ポットに対して10.00%)ため、チェックします"\n}'
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "期待値が低い(6.00(ポットに対して10.00%)ため、チェックします"
}
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': '期待値が低い(6.00(ポットに対して10.00%)ため、チェックします'}
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] Extracted values - action: 'check', amount: 0
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] Action 'check' normalized - amount set to 0
2025-10-31 19:02:33,619 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:02:33,620 - poker_game - INFO - [Agent4] Successfully parsed decision: check, 0, 期待値が低い(6.00(ポットに対して10.00%)ため、チェックします
2025-10-31 19:02:33,622 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'check' with amount 0
2025-10-31 19:02:33,622 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:02:33,622 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:33,622 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:02:33,622 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:33,623 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:33,623 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:33,623 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:33,623 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:33,624 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:33,624 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:33,624 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:33,624 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:33,624 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:33,624 - poker_game - INFO - ==================================================
2025-10-31 19:02:33,625 - poker_game - INFO - ACTION_EXECUTED: Player 4 checked
2025-10-31 19:02:33,659 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:02:33,659 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:33,659 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:02:33,659 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:33,660 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:33,660 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:33,660 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:33,660 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:33,660 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:33,660 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:33,661 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:33,661 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:33,661 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:33,661 - poker_game - INFO - Extra: Action: Player 4 checked
2025-10-31 19:02:33,661 - poker_game - INFO - ==================================================
2025-10-31 19:02:33,661 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:02:33,661 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:02:33,662 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:02:33,662 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:02:33,662 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:02:33,662 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:02:33,662 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:02:33,662 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:02:33,662 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:02:33,662 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:02:33,662 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:02:33,662 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:02:33,662 - poker_game - DEBUG - Betting continues: Current player 1 != first actor 3
2025-10-31 19:02:33,662 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:02:33,663 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:33,663 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:02:33,663 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:33,663 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:33,663 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:33,663 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:33,663 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:33,664 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:33,664 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:33,664 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:33,664 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:33,664 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:33,664 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:02:33,664 - poker_game - INFO - ==================================================
2025-10-31 19:02:33,766 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "K♣",
    "7♥"
  ],
  "community": [
    "3♠",
    "9♥",
    "6♠",
    "4♣",
    "9♦"
  ],
  "your_chips": 3114,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 20,
  "pot": 60,
  "to_call": 0,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5389,
      "bet": 0,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (3114)"
  ],
  "history": [
    "Player 3 checked",
    "Showdown: Player 1 hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦ cards=5♣, 5♦",
    "Showdown: Player 3 hand=One Pair: Ks - A♥, K♣, K♥, 9♣, 7♥ cards=9♣, A♥",
    "Side pot layer 0: amount=400, winners=1 best_hand=Two Pair: Ks and 5s - K♣, K♥, 7♥, 5♣, 5♦",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked"
  ]
}
2025-10-31 19:02:33,775 - poker_game - DEBUG - Create Session: {'id': '5a176e3f-5e90-4c8a-859e-4c89a9f87cf9', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904953.773102}
2025-10-31 19:02:37,910 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣, 9♦）を合わせると、ペア（9のペア）ができています。しかし、相手プレイヤーもチェックしているため、これ以上のベットはリスクに見合わないと判断しました。ショウダウン（カードを見せ合うこと）に進みます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 122, 'promptTokenCount': 873, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 873}], 'totalTokenCount': 995}, 'invocationId': 'e-62f6c668-6960-471a-b46d-2c89ee25ef41', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'aUwcFJci', 'timestamp': 1761904953.788049}]
2025-10-31 19:02:37,910 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:02:37,910 - poker_game - DEBUG - ```json
{
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ラウンド）で、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣, 9♦）を合わせると、ペア（9のペア）ができています。しかし、相手プレイヤーもチェックしているため、これ以上のベットはリスクに見合わないと判断しました。ショウダウン（カードを見せ合うこと）に進みます。"
}
```
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣, 9♦）を合わせると、ペア（9のペア）ができています。しかし、相手プレイヤーもチェックしているため、これ以上のベットはリスクに見合わないと判断しました。ショウダウン（カードを見せ合うこと）に進みます。"\n}\n```'
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "check",\n  "amount": 0,\n  "reasoning": "リバー（最終ラウンド）で、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣, 9♦）を合わせると、ペア（9のペア）ができています。しかし、相手プレイヤーもチェックしているため、これ以上のベットはリスクに見合わないと判断しました。ショウダウン（カードを見せ合うこと）に進みます。"\n}'
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "check",
  "amount": 0,
  "reasoning": "リバー（最終ラウンド）で、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣, 9♦）を合わせると、ペア（9のペア）ができています。しかし、相手プレイヤーもチェックしているため、これ以上のベットはリスクに見合わないと判断しました。ショウダウン（カードを見せ合うこと）に進みます。"
}
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'check', 'amount': 0, 'reasoning': 'リバー（最終ラウンド）で、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣, 9♦）を合わせると、ペア（9のペア）ができています。しかし、相手プレイヤーもチェックしているため、これ以上のベットはリスクに見合わないと判断しました。ショウダウン（カードを見せ合うこと）に進みます。'}
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] Extracted values - action: 'check', amount: 0
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] Action 'check' normalized - amount set to 0
2025-10-31 19:02:37,911 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'check', 'amount': 0}
2025-10-31 19:02:37,911 - poker_game - INFO - [Agent1] Successfully parsed decision: check, 0, リバー（最終ラウンド）で、あなたの手札（K♣, 7♥）とコミュニティカード（3♠, 9♥, 6♠, 4♣, 9♦）を合わせると、ペア（9のペア）ができています。しかし、相手プレイヤーもチェックしているため、これ以上のベットはリスクに見合わないと判断しました。ショウダウン（カードを見せ合うこと）に進みます。
2025-10-31 19:02:37,912 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'check' with amount 0
2025-10-31 19:02:37,912 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:02:37,912 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:37,912 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:02:37,913 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:37,913 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:37,913 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:37,913 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:37,913 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:37,913 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:37,914 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:37,914 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:37,914 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:37,914 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:37,914 - poker_game - INFO - ==================================================
2025-10-31 19:02:37,914 - poker_game - INFO - ACTION_EXECUTED: Player 1 checked
2025-10-31 19:02:37,932 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:02:37,933 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:37,933 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:02:37,933 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:37,933 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:37,934 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:37,934 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:37,934 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:37,934 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:37,934 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:37,935 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:37,935 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:37,935 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:37,935 - poker_game - INFO - Extra: Action: Player 1 checked
2025-10-31 19:02:37,935 - poker_game - INFO - ==================================================
2025-10-31 19:02:37,936 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:02:37,936 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:02:37,936 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:02:37,936 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:02:37,936 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:02:37,936 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:02:37,936 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:02:37,937 - poker_game - DEBUG - Player bets: [0, 0, 0], Current bet: 0, All same: True
2025-10-31 19:02:37,937 - poker_game - DEBUG - Active player indices: [1, 3, 4]
2025-10-31 19:02:37,937 - poker_game - DEBUG - Last raiser index: None
2025-10-31 19:02:37,937 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:02:37,937 - poker_game - DEBUG - First actor index: 3
2025-10-31 19:02:37,937 - poker_game - INFO - Betting complete: Back to first actor 3 (all players have acted)
2025-10-31 19:02:37,938 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:02:37,938 - poker_game - INFO - Hand #23, Phase: river
2025-10-31 19:02:37,938 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:02:37,938 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:37,938 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:37,938 - poker_game - INFO - Betting round complete: True
2025-10-31 19:02:37,939 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:37,939 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:37,939 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:37,939 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:37,939 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:37,939 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:37,940 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:37,940 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:02:37,940 - poker_game - INFO - ==================================================
2025-10-31 19:02:38,041 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 19:02:38,042 - poker_game - INFO - Betting round complete: True
2025-10-31 19:02:38,042 - poker_game - INFO - Remaining players: 3
2025-10-31 19:02:38,042 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:02:38,042 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:02:38,042 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:02:38,043 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 19:02:38,043 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:02:38,043 - poker_game - INFO - Hand #23, Phase: showdown
2025-10-31 19:02:38,043 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:02:38,044 - poker_game - INFO - Pot: 60, Current bet: 0
2025-10-31 19:02:38,044 - poker_game - INFO - Last raiser: None
2025-10-31 19:02:38,044 - poker_game - INFO - Betting round complete: True
2025-10-31 19:02:38,045 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:38,045 - poker_game - INFO - Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:38,045 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:38,045 - poker_game - INFO -   P1(Agent1): chips=3114, bet=0, status=active
2025-10-31 19:02:38,046 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:38,046 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:38,046 - poker_game - INFO -   P4(Agent4): chips=5389, bet=0, status=active
2025-10-31 19:02:38,047 - poker_game - INFO - ==================================================
2025-10-31 19:02:38,047 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:02:38,048 - poker_game - INFO - Pot: 60, Community cards: ['3♠', '9♥', '6♠', '4♣', '9♦']
2025-10-31 19:02:38,048 - poker_game - INFO -   Player 1 status=active cards=['K♣', '7♥']
2025-10-31 19:02:38,048 - poker_game - INFO -   Player 3 status=active cards=['K♥', '7♠']
2025-10-31 19:02:38,048 - poker_game - INFO -   Player 4 status=active cards=['5♣', '2♣']
2025-10-31 19:02:38,051 - poker_game - INFO -   Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=['K♣', '7♥']
2025-10-31 19:02:38,051 - poker_game - INFO -   Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=['K♥', '7♠']
2025-10-31 19:02:38,052 - poker_game - INFO -   Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=['5♣', '2♣']
2025-10-31 19:02:38,052 - poker_game - INFO - Pot layer 0: amount=60, contributors=[1, 3, 4]
2025-10-31 19:02:38,052 - poker_game - INFO - Showdown total awarded: 60 (game.pot=60)
2025-10-31 19:02:38,053 - poker_game - INFO - Showdown winners (aggregated): [4]
2025-10-31 19:02:38,053 - poker_game - INFO -   Awarded 60 to Player 4 (hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣)
2025-10-31 19:02:38,054 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:02:38,097 - poker_game - INFO - === STARTING NEW HAND #24 ===
2025-10-31 19:02:38,098 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:02:38,098 - poker_game - INFO - Moving dealer button
2025-10-31 19:02:38,098 - poker_game - INFO - Posting blinds
2025-10-31 19:02:38,119 - poker_game - INFO - Dealing hole cards
2025-10-31 19:02:38,120 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:02:38,129 - poker_game - INFO - Started new hand in database: hand_id=24
2025-10-31 19:02:38,130 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:02:38,130 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:02:38,131 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:02:38,131 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:02:38,131 - poker_game - INFO - Last raiser: 1
2025-10-31 19:02:38,132 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:38,132 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:38,133 - poker_game - INFO - Community cards: []
2025-10-31 19:02:38,133 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:38,133 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:02:38,134 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:38,134 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:38,135 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 19:02:38,136 - poker_game - INFO - ==================================================
2025-10-31 19:02:38,137 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "10♠",
    "3♦"
  ],
  "community": [],
  "your_chips": 1437,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3094,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5439,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1437)"
  ],
  "history": [
    "Player 3 called 10",
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 19:02:38,151 - poker_game - DEBUG - Create Session: {'id': '0ce8db7e-925c-4df8-84a7-0b7c81bf5782', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761904958.1491868}
2025-10-31 19:02:34,919 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが配られる前）で、私の手札は10と3のオフスート（異なるスート）であり、これは非常に弱いハンドです。ポットに参加するためのコール額（20）は、私のハンドの強さに見合わないため、フォールド（降りる）を選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 107, 'promptTokenCount': 885, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 885}], 'totalTokenCount': 992}, 'invocationId': 'e-6dfed727-37cc-4c77-999e-fd8cfe6513cb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'OqZtvokX', 'timestamp': 1761904958.161527}]
2025-10-31 19:02:34,920 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:02:34,920 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが配られる前）で、私の手札は10と3のオフスート（異なるスート）であり、これは非常に弱いハンドです。ポットに参加するためのコール額（20）は、私のハンドの強さに見合わないため、フォールド（降りる）を選択します。"
}
```
2025-10-31 19:02:34,921 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:02:34,921 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが配られる前）で、私の手札は10と3のオフスート（異なるスート）であり、これは非常に弱いハンドです。ポットに参加するためのコール額（20）は、私のハンドの強さに見合わないため、フォールド（降りる）を選択します。"\n}\n```'
2025-10-31 19:02:34,921 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:02:34,924 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが配られる前）で、私の手札は10と3のオフスート（異なるスート）であり、これは非常に弱いハンドです。ポットに参加するためのコール額（20）は、私のハンドの強さに見合わないため、フォールド（降りる）を選択します。"\n}'
2025-10-31 19:02:34,926 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが配られる前）で、私の手札は10と3のオフスート（異なるスート）であり、これは非常に弱いハンドです。ポットに参加するためのコール額（20）は、私のハンドの強さに見合わないため、フォールド（降りる）を選択します。"
}
2025-10-31 19:02:34,928 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（最初のカードが配られた後、コミュニティカードが配られる前）で、私の手札は10と3のオフスート（異なるスート）であり、これは非常に弱いハンドです。ポットに参加するためのコール額（20）は、私のハンドの強さに見合わないため、フォールド（降りる）を選択します。'}
2025-10-31 19:02:34,928 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 19:02:34,929 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 19:02:34,930 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:02:34,930 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップ（最初のカードが配られた後、コミュニティカードが配られる前）で、私の手札は10と3のオフスート（異なるスート）であり、これは非常に弱いハンドです。ポットに参加するためのコール額（20）は、私のハンドの強さに見合わないため、フォールド（降りる）を選択します。
2025-10-31 19:02:34,932 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 19:02:34,933 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:02:34,933 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:02:34,933 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:02:34,934 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:02:34,934 - poker_game - INFO - Last raiser: 1
2025-10-31 19:02:34,934 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:34,934 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:02:34,934 - poker_game - INFO - Community cards: []
2025-10-31 19:02:34,934 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:34,935 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:02:34,935 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:34,935 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=active
2025-10-31 19:02:34,936 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 19:02:34,936 - poker_game - INFO - ==================================================
2025-10-31 19:02:34,936 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 19:02:34,972 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:02:34,972 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:02:34,973 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:02:34,973 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:02:34,973 - poker_game - INFO - Last raiser: 1
2025-10-31 19:02:34,973 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:34,974 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:02:34,974 - poker_game - INFO - Community cards: []
2025-10-31 19:02:34,974 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:34,975 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:02:34,975 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:34,977 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:02:34,978 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 19:02:34,980 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 19:02:34,981 - poker_game - INFO - ==================================================
2025-10-31 19:02:34,982 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:02:34,984 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:02:34,984 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:02:34,984 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:02:34,984 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:02:34,984 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:02:34,985 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:02:34,986 - poker_game - DEBUG - Player bets: [20, 10], Current bet: 20, All same: False
2025-10-31 19:02:34,986 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:02:34,986 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:02:34,986 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:02:34,987 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:02:34,987 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:02:34,987 - poker_game - INFO - Last raiser: 1
2025-10-31 19:02:34,987 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:34,987 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:02:34,987 - poker_game - INFO - Community cards: []
2025-10-31 19:02:34,988 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:34,988 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:02:34,988 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:34,989 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:02:34,989 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 19:02:34,989 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:02:34,989 - poker_game - INFO - ==================================================
2025-10-31 19:02:35,091 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "6♣",
    "4♠"
  ],
  "community": [],
  "your_chips": 5439,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3094,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (5439)"
  ],
  "history": [
    "Player 4 checked",
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded"
  ]
}
2025-10-31 19:02:35,257 - poker_game - DEBUG - Create Session: {'id': 'a8115730-749e-4002-86e4-5c6bb7cac7c2', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904955.254404}
2025-10-31 19:02:45,415 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:02:55,307 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:02:59,727 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_oXVGpuhAaFhUAkJsWoELarjn', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1227, 'totalTokenCount': 1244}, 'invocationId': 'e-c88e82dd-7d5b-44cd-9473-8047b516b4e9', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'T8OPg5Yh', 'timestamp': 1761904955.271535}, {'content': {'parts': [{'functionResponse': {'id': 'call_oXVGpuhAaFhUAkJsWoELarjn', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-c88e82dd-7d5b-44cd-9473-8047b516b4e9', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '1BVn8Xrm', 'timestamp': 1761904956.742888}, {'content': {'parts': [{'functionCall': {'id': 'call_aJ7Un0iC0H3hZzvRdWHGaqEM', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['6♣', '4♠'], 'community': [], 'your_chips': 5439, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3094, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (5439)'], 'history': ['Player 4 checked', 'Flop dealt: 3♠, 9♥, 6♠', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 4♣', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'River dealt: 9♦', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥', 'Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠', 'Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣', 'Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.35}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_v1DAvNo8wJkwTbHm5ypy43Ty', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['6♣', '4♠'], 'community': [], 'your_chips': 5439, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3094, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (5439)'], 'history': ['Player 4 checked', 'Flop dealt: 3♠, 9♥, 6♠', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 4♣', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'River dealt: 9♦', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥', 'Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠', 'Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣', 'Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.35}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 934, 'promptTokenCount': 1751, 'totalTokenCount': 2685}, 'invocationId': 'e-c88e82dd-7d5b-44cd-9473-8047b516b4e9', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'wNXl1ZM2', 'timestamp': 1761904956.745324}, {'content': {'parts': [{'functionResponse': {'id': 'call_aJ7Un0iC0H3hZzvRdWHGaqEM', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（7.50(ポットに対して25.00%）、コールが妥当と判断。コール額: 10'}}}, {'functionResponse': {'id': 'call_v1DAvNo8wJkwTbHm5ypy43Ty', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（7.50(ポットに対して25.00%）、コールが妥当と判断。コール額: 10'}}}], 'role': 'user'}, 'invocationId': '1TeqNmAc', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Kt3cQhvH', 'timestamp': 1761904977.808004}, {'content': {'parts': [{'text': '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "ポットを満たしおり（7.50(ポットに対して25.00%)）、コールが妥当と判断。コール額: 10"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 62, 'promptTokenCount': 2991, 'totalTokenCount': 3053}, 'invocationId': 'e-c88e82dd-7d5b-44cd-9473-8047b516b4e9', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'Kgd2HOgb', 'timestamp': 1761904977.810734}]
2025-10-31 19:02:59,727 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:02:59,727 - poker_game - DEBUG - {
  "action": "call",
  "amount": 10,
  "reasoning": "ポットを満たしおり（7.50(ポットに対して25.00%)）、コールが妥当と判断。コール額: 10"
}
2025-10-31 19:02:59,728 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:02:59,728 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "ポットを満たしおり（7.50(ポットに対して25.00%)）、コールが妥当と判断。コール額: 10"\n}'
2025-10-31 19:02:59,728 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:02:59,728 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "ポットを満たしおり（7.50(ポットに対して25.00%)）、コールが妥当と判断。コール額: 10"
}
2025-10-31 19:02:59,728 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'ポットを満たしおり（7.50(ポットに対して25.00%)）、コールが妥当と判断。コール額: 10'}
2025-10-31 19:02:59,728 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 10
2025-10-31 19:02:59,728 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (5439)']
2025-10-31 19:02:59,729 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (10)': 10
2025-10-31 19:02:59,729 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 19:02:59,729 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 10, ポットを満たしおり（7.50(ポットに対して25.00%)）、コールが妥当と判断。コール額: 10
2025-10-31 19:02:59,729 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 10
2025-10-31 19:02:59,730 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:02:59,730 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:02:59,730 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:02:59,730 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:02:59,730 - poker_game - INFO - Last raiser: 1
2025-10-31 19:02:59,731 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:59,731 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:02:59,731 - poker_game - INFO - Community cards: []
2025-10-31 19:02:59,731 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:59,731 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:02:59,731 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:59,731 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:02:59,731 - poker_game - INFO -   P4(Agent4): chips=5439, bet=10, status=active
2025-10-31 19:02:59,732 - poker_game - INFO - ==================================================
2025-10-31 19:02:59,732 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 10
2025-10-31 19:02:59,743 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:02:59,744 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:02:59,744 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:02:59,744 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:02:59,744 - poker_game - INFO - Last raiser: 1
2025-10-31 19:02:59,744 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:59,745 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:02:59,745 - poker_game - INFO - Community cards: []
2025-10-31 19:02:59,745 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:59,745 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:02:59,745 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:59,745 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:02:59,746 - poker_game - INFO -   P4(Agent4): chips=5429, bet=20, status=active
2025-10-31 19:02:59,746 - poker_game - INFO - Extra: Action: Player 4 called 10
2025-10-31 19:02:59,746 - poker_game - INFO - ==================================================
2025-10-31 19:02:59,746 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:02:59,746 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:02:59,746 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:02:59,746 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:02:59,746 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:02:59,746 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:02:59,747 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:02:59,747 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 19:02:59,747 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 19:02:59,747 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 19:02:59,747 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:02:59,747 - poker_game - DEBUG - Next after last raiser 1: 4
2025-10-31 19:02:59,747 - poker_game - DEBUG - Betting continues: Current player 1 != next after raiser 4
2025-10-31 19:02:59,747 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:02:59,747 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:02:59,748 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:02:59,748 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:02:59,748 - poker_game - INFO - Last raiser: 1
2025-10-31 19:02:59,748 - poker_game - INFO - Betting round complete: False
2025-10-31 19:02:59,748 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:02:59,749 - poker_game - INFO - Community cards: []
2025-10-31 19:02:59,749 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:02:59,749 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:02:59,749 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:02:59,749 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:02:59,749 - poker_game - INFO -   P4(Agent4): chips=5429, bet=20, status=active
2025-10-31 19:02:59,750 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:02:59,750 - poker_game - INFO - ==================================================
2025-10-31 19:02:59,851 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "J♦",
    "J♣"
  ],
  "community": [],
  "your_chips": 3094,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5429,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (3094)"
  ],
  "history": [
    "Flop dealt: 3♠, 9♥, 6♠",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10"
  ]
}
2025-10-31 19:02:59,861 - poker_game - DEBUG - Create Session: {'id': '4fcab164-9647-4260-8c8b-eaa16c6b7cd4', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761904979.8589108}
2025-10-31 19:03:01,993 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "プリフロップでJ♦ J♣という強いハンドを持っています。相手は1人だけアクティブですが、まだベットしていないので、レイズしてポットを大きくし、主導権を握ります。ミニマムレイズは40なので、相手のベット額（20）に加えてポット額（40）の半分（20）を足した60にレイズします。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 117, 'promptTokenCount': 881, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 881}], 'totalTokenCount': 998}, 'invocationId': 'e-bf58d8c4-3e23-4c8e-b4e1-512678ea615c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ZjJ4wyok', 'timestamp': 1761904979.872194}]
2025-10-31 19:03:01,994 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:03:01,994 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 60,
  "reasoning": "プリフロップでJ♦ J♣という強いハンドを持っています。相手は1人だけアクティブですが、まだベットしていないので、レイズしてポットを大きくし、主導権を握ります。ミニマムレイズは40なので、相手のベット額（20）に加えてポット額（40）の半分（20）を足した60にレイズします。"
}
```
2025-10-31 19:03:01,994 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:03:01,994 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "プリフロップでJ♦ J♣という強いハンドを持っています。相手は1人だけアクティブですが、まだベットしていないので、レイズしてポットを大きくし、主導権を握ります。ミニマムレイズは40なので、相手のベット額（20）に加えてポット額（40）の半分（20）を足した60にレイズします。"\n}\n```'
2025-10-31 19:03:01,994 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "プリフロップでJ♦ J♣という強いハンドを持っています。相手は1人だけアクティブですが、まだベットしていないので、レイズしてポットを大きくし、主導権を握ります。ミニマムレイズは40なので、相手のベット額（20）に加えてポット額（40）の半分（20）を足した60にレイズします。"\n}'
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 60,
  "reasoning": "プリフロップでJ♦ J♣という強いハンドを持っています。相手は1人だけアクティブですが、まだベットしていないので、レイズしてポットを大きくし、主導権を握ります。ミニマムレイズは40なので、相手のベット額（20）に加えてポット額（40）の半分（20）を足した60にレイズします。"
}
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 60, 'reasoning': 'プリフロップでJ♦ J♣という強いハンドを持っています。相手は1人だけアクティブですが、まだベットしていないので、レイズしてポットを大きくし、主導権を握ります。ミニマムレイズは40なので、相手のベット額（20）に加えてポット額（40）の半分（20）を足した60にレイズします。'}
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 60
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (3094)']
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] Raise amount 60 is valid (min: 40)
2025-10-31 19:03:01,995 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 60}
2025-10-31 19:03:01,995 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 60, プリフロップでJ♦ J♣という強いハンドを持っています。相手は1人だけアクティブですが、まだベットしていないので、レイズしてポットを大きくし、主導権を握ります。ミニマムレイズは40なので、相手のベット額（20）に加えてポット額（40）の半分（20）を足した60にレイズします。
2025-10-31 19:03:01,996 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 60
2025-10-31 19:03:01,996 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:01,996 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:03:01,996 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:01,996 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:03:01,997 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:01,997 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:01,997 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:01,997 - poker_game - INFO - Community cards: []
2025-10-31 19:03:01,997 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:01,997 - poker_game - INFO -   P1(Agent1): chips=3094, bet=20, status=active
2025-10-31 19:03:01,997 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:01,997 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:01,998 - poker_game - INFO -   P4(Agent4): chips=5429, bet=20, status=active
2025-10-31 19:03:01,998 - poker_game - INFO - ==================================================
2025-10-31 19:03:01,998 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 80
2025-10-31 19:03:02,012 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:02,012 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:03:02,012 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:02,013 - poker_game - INFO - Pot: 100, Current bet: 80
2025-10-31 19:03:02,013 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:02,013 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:02,013 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:02,013 - poker_game - INFO - Community cards: []
2025-10-31 19:03:02,014 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:02,014 - poker_game - INFO -   P1(Agent1): chips=3034, bet=80, status=active
2025-10-31 19:03:02,014 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:02,014 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:02,014 - poker_game - INFO -   P4(Agent4): chips=5429, bet=20, status=active
2025-10-31 19:03:02,015 - poker_game - INFO - Extra: Action: Player 1 raised to 80
2025-10-31 19:03:02,015 - poker_game - INFO - ==================================================
2025-10-31 19:03:02,015 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:02,015 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:02,015 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:03:02,015 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 19:03:02,016 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:02,016 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:02,016 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:02,016 - poker_game - DEBUG - Player bets: [80, 20], Current bet: 80, All same: False
2025-10-31 19:03:02,016 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:03:02,016 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:02,016 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:03:02,017 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:02,017 - poker_game - INFO - Pot: 100, Current bet: 80
2025-10-31 19:03:02,017 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:02,017 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:02,017 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:02,017 - poker_game - INFO - Community cards: []
2025-10-31 19:03:02,017 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:02,017 - poker_game - INFO -   P1(Agent1): chips=3034, bet=80, status=active
2025-10-31 19:03:02,017 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:02,018 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:02,018 - poker_game - INFO -   P4(Agent4): chips=5429, bet=20, status=active
2025-10-31 19:03:02,018 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:02,018 - poker_game - INFO - ==================================================
2025-10-31 19:03:02,119 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "6♣",
    "4♠"
  ],
  "community": [],
  "your_chips": 5429,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 100,
  "to_call": 60,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3034,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (60)",
    "raise (min 100)",
    "all-in (5429)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80"
  ]
}
2025-10-31 19:03:02,132 - poker_game - DEBUG - Create Session: {'id': '9f00377d-d32c-4d50-9e5d-961d4be7738d', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904982.1293764}
2025-10-31 19:03:12,234 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:03:15,205 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_qUY6inZlLz48aefoySmGS9sH', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1219, 'totalTokenCount': 1236}, 'invocationId': 'e-cb87b70f-19cc-4c02-a9ce-fd5fd27148b1', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'HIrBBdbd', 'timestamp': 1761904982.14476}, {'content': {'parts': [{'functionResponse': {'id': 'call_qUY6inZlLz48aefoySmGS9sH', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-cb87b70f-19cc-4c02-a9ce-fd5fd27148b1', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'O8sGzBkr', 'timestamp': 1761904986.15047}, {'content': {'parts': [{'functionCall': {'id': 'call_uGcIMUSGeHxZahCSeg2QtueY', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['6♣', '4♠'], 'community': [], 'your_chips': 5429, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 100, 'to_call': 60, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3034, 'bet': 80, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (60)', 'raise (min 100)', 'all-in (5429)'], 'history': ['Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Turn dealt: 4♣', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'River dealt: 9♦', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥', 'Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠', 'Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣', 'Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80']}, 'call_amount': 60, 'pot_after_call': 160, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 467, 'promptTokenCount': 1743, 'totalTokenCount': 2210}, 'invocationId': 'e-cb87b70f-19cc-4c02-a9ce-fd5fd27148b1', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'qen3lnvX', 'timestamp': 1761904986.152184}, {'content': {'parts': [{'functionResponse': {'id': 'call_uGcIMUSGeHxZahCSeg2QtueY', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 60, 'reasoning': 'ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 60'}}}], 'role': 'user'}, 'invocationId': 'e-cb87b70f-19cc-4c02-a9ce-fd5fd27148b1', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'YzgR913i', 'timestamp': 1761904992.833185}, {'content': {'parts': [{'text': '{"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 60"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2261, 'totalTokenCount': 2315}, 'invocationId': 'e-cb87b70f-19cc-4c02-a9ce-fd5fd27148b1', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'lwRe9QiL', 'timestamp': 1761904992.837389}]
2025-10-31 19:03:15,206 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:03:15,206 - poker_game - DEBUG - {"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 60"}
2025-10-31 19:03:15,207 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:03:15,207 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 60"}'
2025-10-31 19:03:15,207 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:03:15,207 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":60,"reasoning":"ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 60"}
2025-10-31 19:03:15,207 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 60, 'reasoning': 'ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 60'}
2025-10-31 19:03:15,208 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 60
2025-10-31 19:03:15,208 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (60)', 'raise (min 100)', 'all-in (5429)']
2025-10-31 19:03:15,208 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (60)': 60
2025-10-31 19:03:15,208 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 60}
2025-10-31 19:03:15,208 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 60, ポットオッズを満たしており（50.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 60
2025-10-31 19:03:15,209 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 60
2025-10-31 19:03:15,210 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:15,210 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:03:15,210 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:15,210 - poker_game - INFO - Pot: 100, Current bet: 80
2025-10-31 19:03:15,211 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:15,211 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:15,211 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:15,211 - poker_game - INFO - Community cards: []
2025-10-31 19:03:15,212 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:15,212 - poker_game - INFO -   P1(Agent1): chips=3034, bet=80, status=active
2025-10-31 19:03:15,212 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:15,212 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:15,213 - poker_game - INFO -   P4(Agent4): chips=5429, bet=20, status=active
2025-10-31 19:03:15,213 - poker_game - INFO - ==================================================
2025-10-31 19:03:15,213 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 60
2025-10-31 19:03:15,224 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:15,225 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:03:15,225 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:15,225 - poker_game - INFO - Pot: 160, Current bet: 80
2025-10-31 19:03:15,226 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:15,226 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:15,227 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:15,227 - poker_game - INFO - Community cards: []
2025-10-31 19:03:15,227 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:15,228 - poker_game - INFO -   P1(Agent1): chips=3034, bet=80, status=active
2025-10-31 19:03:15,228 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:15,228 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:15,229 - poker_game - INFO -   P4(Agent4): chips=5369, bet=80, status=active
2025-10-31 19:03:15,229 - poker_game - INFO - Extra: Action: Player 4 called 60
2025-10-31 19:03:15,229 - poker_game - INFO - ==================================================
2025-10-31 19:03:15,230 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:15,230 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:15,230 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:03:15,231 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:03:15,231 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:15,231 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:15,232 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:15,232 - poker_game - DEBUG - Player bets: [80, 80], Current bet: 80, All same: True
2025-10-31 19:03:15,232 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:03:15,232 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:15,233 - poker_game - INFO - Hand #24, Phase: preflop
2025-10-31 19:03:15,233 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:15,234 - poker_game - INFO - Pot: 160, Current bet: 80
2025-10-31 19:03:15,234 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:15,235 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:15,236 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:15,236 - poker_game - INFO - Community cards: []
2025-10-31 19:03:15,236 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:15,237 - poker_game - INFO -   P1(Agent1): chips=3034, bet=80, status=active
2025-10-31 19:03:15,238 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:15,238 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:15,238 - poker_game - INFO -   P4(Agent4): chips=5369, bet=80, status=active
2025-10-31 19:03:15,239 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:03:15,239 - poker_game - INFO - ==================================================
2025-10-31 19:03:15,341 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:03:15,341 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:15,342 - poker_game - INFO - Remaining players: 2
2025-10-31 19:03:15,342 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:03:15,342 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:03:15,343 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 19:03:15,354 - poker_game - INFO - Starting new betting round
2025-10-31 19:03:15,355 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:03:15,355 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:03:15,356 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 19:03:15,356 - poker_game - DEBUG - Dealer button: 3
2025-10-31 19:03:15,356 - poker_game - INFO - First actor: Player 4 (by phase rule), was 1
2025-10-31 19:03:15,357 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:03:15,358 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:15,359 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:15,360 - poker_game - INFO - Pot: 160, Current bet: 0
2025-10-31 19:03:15,361 - poker_game - INFO - Last raiser: None
2025-10-31 19:03:15,361 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:15,362 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:15,362 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:15,363 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:15,363 - poker_game - INFO -   P1(Agent1): chips=3034, bet=0, status=active
2025-10-31 19:03:15,363 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:15,364 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:15,364 - poker_game - INFO -   P4(Agent4): chips=5369, bet=0, status=active
2025-10-31 19:03:15,365 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 19:03:15,365 - poker_game - INFO - ==================================================
2025-10-31 19:03:15,366 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "6♣",
    "4♠"
  ],
  "community": [
    "5♥",
    "8♣",
    "J♥"
  ],
  "your_chips": 5369,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 160,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3034,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (5369)"
  ],
  "history": [
    "Player 1 checked",
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥"
  ]
}
2025-10-31 19:03:15,383 - poker_game - DEBUG - Create Session: {'id': 'e8e3f6f5-7152-4f84-a915-7ed828f1e1a6', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761904995.379555}
2025-10-31 19:03:25,441 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:03:28,046 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_ml7Ajc5C30gmk8YTUsQ6rydC', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1247, 'totalTokenCount': 1264}, 'invocationId': 'e-b1123ee0-a956-40fa-b3c9-50c3e540fafd', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'SOJSk6JF', 'timestamp': 1761904995.398428}, {'content': {'parts': [{'functionResponse': {'id': 'call_ml7Ajc5C30gmk8YTUsQ6rydC', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-b1123ee0-a956-40fa-b3c9-50c3e540fafd', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'V1WGKp7Q', 'timestamp': 1761904997.215528}, {'content': {'parts': [{'functionCall': {'id': 'call_UvpyZFb3BXskOflWKlSbrbi3', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['6♣', '4♠'], 'community': ['5♥', '8♣', 'J♥'], 'your_chips': 5369, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 80, 'pot': 160, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3034, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (5369)'], 'history': ['Player 1 checked', 'Turn dealt: 4♣', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'River dealt: 9♦', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥', 'Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠', 'Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣', 'Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60,']}, 'call_amount': 0, 'pot_after_call': 160, 'equity': 1.0}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 463, 'promptTokenCount': 1771, 'totalTokenCount': 2234}, 'invocationId': 'e-b1123ee0-a956-40fa-b3c9-50c3e540fafd', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'f4yLR6dA', 'timestamp': 1761904997.218214}, {'content': {'parts': [{'functionResponse': {'id': 'call_UvpyZFb3BXskOflWKlSbrbi3', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 105, 'reasoning': '期待値が高い（160.00(ポットに対して100.00%）ため、2/3ポットでベットします。ベット額: 105'}}}], 'role': 'user'}, 'invocationId': 'e-b1123ee0-a956-40fa-b3c9-50c3e540fafd', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'OPIgfaXv', 'timestamp': 1761905008.192382}, {'content': {'parts': [{'text': '{"action":"raise","amount":105,"reasoning":"期待値が高い（160.00(ポットに対して100.00%）ため、2/3ポットでベットします。ベット額: 105"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 52, 'promptTokenCount': 2291, 'totalTokenCount': 2343}, 'invocationId': 'e-b1123ee0-a956-40fa-b3c9-50c3e540fafd', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'IwTERr4m', 'timestamp': 1761905008.194201}]
2025-10-31 19:03:28,046 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:03:28,046 - poker_game - DEBUG - {"action":"raise","amount":105,"reasoning":"期待値が高い（160.00(ポットに対して100.00%）ため、2/3ポットでベットします。ベット額: 105"}
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":105,"reasoning":"期待値が高い（160.00(ポットに対して100.00%）ため、2/3ポットでベットします。ベット額: 105"}'
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":105,"reasoning":"期待値が高い（160.00(ポットに対して100.00%）ため、2/3ポットでベットします。ベット額: 105"}
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 105, 'reasoning': '期待値が高い（160.00(ポットに対して100.00%）ため、2/3ポットでベットします。ベット額: 105'}
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 105
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (5369)']
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] Raise amount 105 is valid (min: 20)
2025-10-31 19:03:28,047 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 105}
2025-10-31 19:03:28,048 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 105, 期待値が高い（160.00(ポットに対して100.00%）ため、2/3ポットでベットします。ベット額: 105
2025-10-31 19:03:28,049 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 105
2025-10-31 19:03:28,050 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:28,050 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:28,050 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:28,050 - poker_game - INFO - Pot: 160, Current bet: 0
2025-10-31 19:03:28,050 - poker_game - INFO - Last raiser: None
2025-10-31 19:03:28,050 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:28,050 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:28,051 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:28,051 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:28,051 - poker_game - INFO -   P1(Agent1): chips=3034, bet=0, status=active
2025-10-31 19:03:28,051 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:28,051 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:28,051 - poker_game - INFO -   P4(Agent4): chips=5369, bet=0, status=active
2025-10-31 19:03:28,051 - poker_game - INFO - ==================================================
2025-10-31 19:03:28,051 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 105
2025-10-31 19:03:28,063 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:28,064 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:28,064 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:28,064 - poker_game - INFO - Pot: 265, Current bet: 105
2025-10-31 19:03:28,064 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:28,065 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:28,065 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:28,065 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:28,065 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:28,066 - poker_game - INFO -   P1(Agent1): chips=3034, bet=0, status=active
2025-10-31 19:03:28,066 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:28,066 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:28,066 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=active
2025-10-31 19:03:28,066 - poker_game - INFO - Extra: Action: Player 4 raised to 105
2025-10-31 19:03:28,067 - poker_game - INFO - ==================================================
2025-10-31 19:03:28,067 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:28,067 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:28,067 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:03:28,067 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:03:28,067 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:28,067 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:28,068 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:28,068 - poker_game - DEBUG - Player bets: [0, 105], Current bet: 105, All same: False
2025-10-31 19:03:28,068 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:03:28,068 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:28,068 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:28,069 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:28,069 - poker_game - INFO - Pot: 265, Current bet: 105
2025-10-31 19:03:28,069 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:28,069 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:28,069 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:28,069 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:28,069 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:28,070 - poker_game - INFO -   P1(Agent1): chips=3034, bet=0, status=active
2025-10-31 19:03:28,070 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:28,070 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:28,070 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=active
2025-10-31 19:03:28,070 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:28,071 - poker_game - INFO - ==================================================
2025-10-31 19:03:28,171 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "J♦",
    "J♣"
  ],
  "community": [
    "5♥",
    "8♣",
    "J♥"
  ],
  "your_chips": 3034,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 265,
  "to_call": 105,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5264,
      "bet": 105,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (105)",
    "raise (min 125)",
    "all-in (3034)"
  ],
  "history": [
    "Turn dealt: 4♣",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105"
  ]
}
2025-10-31 19:03:28,179 - poker_game - DEBUG - Create Session: {'id': '98099e67-bf4e-4ad8-b7d8-3c9ecf63dfef', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905008.1771793}
2025-10-31 19:03:29,847 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 300,\n  "reasoning": "フロップでスリーカード（Jのトリップス）が完成しました。これは非常に強いハンドであり、相手がコールまたはレイズする可能性が高いです。ベット額を大きくして、ポットを増やし、相手にプレッシャーをかけます。相手のベット額（105）に対して、コール額（105）の約3倍の300にレイズします。これにより、相手に不利な状況を強いることができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 130, 'promptTokenCount': 920, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 920}], 'totalTokenCount': 1050}, 'invocationId': 'e-d073b0d7-f293-4f93-84e3-4d63efaa851b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'qf372l4K', 'timestamp': 1761905008.189123}]
2025-10-31 19:03:29,847 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:03:29,848 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 300,
  "reasoning": "フロップでスリーカード（Jのトリップス）が完成しました。これは非常に強いハンドであり、相手がコールまたはレイズする可能性が高いです。ベット額を大きくして、ポットを増やし、相手にプレッシャーをかけます。相手のベット額（105）に対して、コール額（105）の約3倍の300にレイズします。これにより、相手に不利な状況を強いることができます。"
}
```
2025-10-31 19:03:29,848 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:03:29,848 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 300,\n  "reasoning": "フロップでスリーカード（Jのトリップス）が完成しました。これは非常に強いハンドであり、相手がコールまたはレイズする可能性が高いです。ベット額を大きくして、ポットを増やし、相手にプレッシャーをかけます。相手のベット額（105）に対して、コール額（105）の約3倍の300にレイズします。これにより、相手に不利な状況を強いることができます。"\n}\n```'
2025-10-31 19:03:29,848 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:03:29,848 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 300,\n  "reasoning": "フロップでスリーカード（Jのトリップス）が完成しました。これは非常に強いハンドであり、相手がコールまたはレイズする可能性が高いです。ベット額を大きくして、ポットを増やし、相手にプレッシャーをかけます。相手のベット額（105）に対して、コール額（105）の約3倍の300にレイズします。これにより、相手に不利な状況を強いることができます。"\n}'
2025-10-31 19:03:29,848 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 300,
  "reasoning": "フロップでスリーカード（Jのトリップス）が完成しました。これは非常に強いハンドであり、相手がコールまたはレイズする可能性が高いです。ベット額を大きくして、ポットを増やし、相手にプレッシャーをかけます。相手のベット額（105）に対して、コール額（105）の約3倍の300にレイズします。これにより、相手に不利な状況を強いることができます。"
}
2025-10-31 19:03:29,849 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 300, 'reasoning': 'フロップでスリーカード（Jのトリップス）が完成しました。これは非常に強いハンドであり、相手がコールまたはレイズする可能性が高いです。ベット額を大きくして、ポットを増やし、相手にプレッシャーをかけます。相手のベット額（105）に対して、コール額（105）の約3倍の300にレイズします。これにより、相手に不利な状況を強いることができます。'}
2025-10-31 19:03:29,849 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 300
2025-10-31 19:03:29,849 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'call (105)', 'raise (min 125)', 'all-in (3034)']
2025-10-31 19:03:29,849 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 125)': 125
2025-10-31 19:03:29,849 - poker_game - DEBUG - [Agent1] Raise amount 300 is valid (min: 125)
2025-10-31 19:03:29,849 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 300}
2025-10-31 19:03:29,849 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 300, フロップでスリーカード（Jのトリップス）が完成しました。これは非常に強いハンドであり、相手がコールまたはレイズする可能性が高いです。ベット額を大きくして、ポットを増やし、相手にプレッシャーをかけます。相手のベット額（105）に対して、コール額（105）の約3倍の300にレイズします。これにより、相手に不利な状況を強いることができます。
2025-10-31 19:03:29,850 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 300
2025-10-31 19:03:29,850 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:29,850 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:29,850 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:29,851 - poker_game - INFO - Pot: 265, Current bet: 105
2025-10-31 19:03:29,851 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:29,851 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:29,851 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:29,851 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:29,852 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:29,852 - poker_game - INFO -   P1(Agent1): chips=3034, bet=0, status=active
2025-10-31 19:03:29,852 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:29,852 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:29,852 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=active
2025-10-31 19:03:29,853 - poker_game - INFO - ==================================================
2025-10-31 19:03:29,853 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 405
2025-10-31 19:03:29,877 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:29,878 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:29,878 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:29,878 - poker_game - INFO - Pot: 670, Current bet: 405
2025-10-31 19:03:29,878 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:29,878 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:29,878 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:29,879 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:29,879 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:29,879 - poker_game - INFO -   P1(Agent1): chips=2629, bet=405, status=active
2025-10-31 19:03:29,879 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:29,879 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:29,879 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=active
2025-10-31 19:03:29,880 - poker_game - INFO - Extra: Action: Player 1 raised to 405
2025-10-31 19:03:29,880 - poker_game - INFO - ==================================================
2025-10-31 19:03:29,880 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:29,880 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:29,880 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:03:29,880 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 19:03:29,881 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:29,881 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:29,881 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:29,881 - poker_game - DEBUG - Player bets: [405, 105], Current bet: 405, All same: False
2025-10-31 19:03:29,881 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:03:29,881 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:29,882 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:29,882 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:29,882 - poker_game - INFO - Pot: 670, Current bet: 405
2025-10-31 19:03:29,882 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:29,882 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:29,883 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:29,883 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:29,883 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:29,883 - poker_game - INFO -   P1(Agent1): chips=2629, bet=405, status=active
2025-10-31 19:03:29,883 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:29,883 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:29,883 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=active
2025-10-31 19:03:29,883 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:29,883 - poker_game - INFO - ==================================================
2025-10-31 19:03:29,985 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "6♣",
    "4♠"
  ],
  "community": [
    "5♥",
    "8♣",
    "J♥"
  ],
  "your_chips": 5264,
  "your_bet_this_round": 105,
  "your_total_bet_this_hand": 185,
  "pot": 670,
  "to_call": 300,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2629,
      "bet": 405,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1437,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (300)",
    "raise (min 425)",
    "all-in (5264)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "River dealt: 9♦",
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405"
  ]
}
2025-10-31 19:03:30,001 - poker_game - DEBUG - Create Session: {'id': 'e9618b36-d795-466e-9b48-0aa39738fa37', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905009.998386}
2025-10-31 19:03:40,169 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:03:43,997 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_vCFXqJIN9SiCUow0DpDyV6Ki', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1252, 'totalTokenCount': 1269}, 'invocationId': 'e-4a0200f2-41f0-417a-b411-1c1ae0fbf859', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '5fzoK2aT', 'timestamp': 1761905010.016954}, {'content': {'parts': [{'functionResponse': {'id': 'call_vCFXqJIN9SiCUow0DpDyV6Ki', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-4a0200f2-41f0-417a-b411-1c1ae0fbf859', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'vvCgwX4Z', 'timestamp': 1761905011.288065}, {'content': {'parts': [{'functionCall': {'id': 'call_mypbmFqVOeSvdHbzFYmKBFPw', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_8jdxJO0Kfv3VyoQSXDXGhUlC', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['6♣', '4♠'], 'community': ['5♥', '8♣', 'J♥'], 'your_chips': 5264, 'your_bet_this_round': 105, 'your_total_bet_this_hand': 185, 'pot': 670, 'to_call': 300, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2629, 'bet': 405, 'status': 'active'}, {'id': 3, 'chips': 1437, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (300)', 'raise (min 425)', 'all-in (5264)'], 'history': ['Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'River dealt: 9♦', 'Player 3 checked', 'Player 4 checked', 'Player 1 checked', 'Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥', 'Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠', 'Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣', 'Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60', 'Flop dealt: 5♥, 8♣, J♥', 'Player 4 raised to 105', 'Player 1 raised to 405']}, 'call_amount': 300, 'pot_after_call': 970, 'equity': 0.2}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 512, 'promptTokenCount': 1776, 'totalTokenCount': 2288}, 'invocationId': 'e-4a0200f2-41f0-417a-b411-1c1ae0fbf859', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'GMy429Yg', 'timestamp': 1761905011.290966}, {'content': {'parts': [{'functionResponse': {'id': 'call_mypbmFqVOeSvdHbzFYmKBFPw', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_8jdxJO0Kfv3VyoQSXDXGhUlC', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-46.00(ポットに対して-6.87%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'wgpKsaoS', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'qKWsrCt0', 'timestamp': 1761905022.288802}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が-46.00(ポットに対して-6.87%で、マイナスなのでフォールド)"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 42, 'promptTokenCount': 2417, 'totalTokenCount': 2459}, 'invocationId': 'e-4a0200f2-41f0-417a-b411-1c1ae0fbf859', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '2XonMuBe', 'timestamp': 1761905022.294568}]
2025-10-31 19:03:43,998 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:03:43,998 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が-46.00(ポットに対して-6.87%で、マイナスなのでフォールド)"}
2025-10-31 19:03:43,998 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:03:43,998 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が-46.00(ポットに対して-6.87%で、マイナスなのでフォールド)"}'
2025-10-31 19:03:43,999 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:03:43,999 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が-46.00(ポットに対して-6.87%で、マイナスなのでフォールド)"}
2025-10-31 19:03:43,999 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-46.00(ポットに対して-6.87%で、マイナスなのでフォールド)'}
2025-10-31 19:03:43,999 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 19:03:43,999 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 19:03:43,999 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:03:43,999 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が-46.00(ポットに対して-6.87%で、マイナスなのでフォールド)
2025-10-31 19:03:44,004 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 19:03:44,004 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:44,004 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:44,004 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:44,005 - poker_game - INFO - Pot: 670, Current bet: 405
2025-10-31 19:03:44,005 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:44,005 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:44,005 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:44,005 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:44,005 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:44,006 - poker_game - INFO -   P1(Agent1): chips=2629, bet=405, status=active
2025-10-31 19:03:44,006 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:44,006 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:44,006 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=active
2025-10-31 19:03:44,006 - poker_game - INFO - ==================================================
2025-10-31 19:03:44,006 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 19:03:44,028 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:44,029 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:44,029 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:44,029 - poker_game - INFO - Pot: 670, Current bet: 405
2025-10-31 19:03:44,029 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:44,029 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:44,030 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:44,030 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:44,030 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:44,030 - poker_game - INFO -   P1(Agent1): chips=2629, bet=405, status=active
2025-10-31 19:03:44,030 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:44,031 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:44,031 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=folded
2025-10-31 19:03:44,031 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 19:03:44,031 - poker_game - INFO - ==================================================
2025-10-31 19:03:44,031 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:44,031 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:44,031 - poker_game - DEBUG - Active players: [1]
2025-10-31 19:03:44,031 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:03:44,032 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:44,032 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:44,032 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 19:03:44,032 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 19:03:44,032 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:44,032 - poker_game - INFO - Hand #24, Phase: flop
2025-10-31 19:03:44,033 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:44,033 - poker_game - INFO - Pot: 670, Current bet: 405
2025-10-31 19:03:44,033 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:44,033 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:44,034 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:44,034 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:44,034 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:44,035 - poker_game - INFO -   P1(Agent1): chips=2629, bet=405, status=active
2025-10-31 19:03:44,035 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:44,035 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:44,035 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=folded
2025-10-31 19:03:44,036 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:03:44,036 - poker_game - INFO - ==================================================
2025-10-31 19:03:44,136 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 19:03:44,137 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:44,137 - poker_game - INFO - Remaining players: 1
2025-10-31 19:03:44,138 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:03:44,138 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 19:03:44,138 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:03:44,139 - poker_game - INFO - Hand #24, Phase: showdown
2025-10-31 19:03:44,139 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:03:44,139 - poker_game - INFO - Pot: 670, Current bet: 405
2025-10-31 19:03:44,140 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:44,140 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:44,140 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:44,141 - poker_game - INFO - Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:44,141 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:44,141 - poker_game - INFO -   P1(Agent1): chips=2629, bet=405, status=active
2025-10-31 19:03:44,142 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:44,142 - poker_game - INFO -   P3(Agent3): chips=1437, bet=0, status=folded
2025-10-31 19:03:44,142 - poker_game - INFO -   P4(Agent4): chips=5264, bet=105, status=folded
2025-10-31 19:03:44,143 - poker_game - INFO - ==================================================
2025-10-31 19:03:44,143 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:03:44,143 - poker_game - INFO - Pot: 670, Community cards: ['5♥', '8♣', 'J♥']
2025-10-31 19:03:44,144 - poker_game - INFO -   Player 1 status=active cards=['J♦', 'J♣']
2025-10-31 19:03:44,144 - poker_game - INFO - Showdown winner by default: Player 1 awarded 670
2025-10-31 19:03:44,144 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:03:44,145 - poker_game - INFO - === STARTING NEW HAND #25 ===
2025-10-31 19:03:44,145 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:03:44,146 - poker_game - INFO - Moving dealer button
2025-10-31 19:03:44,148 - poker_game - INFO - Posting blinds
2025-10-31 19:03:44,168 - poker_game - INFO - Dealing hole cards
2025-10-31 19:03:44,169 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:03:44,181 - poker_game - INFO - Started new hand in database: hand_id=25
2025-10-31 19:03:44,181 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:03:44,182 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:44,182 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:03:44,183 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:44,183 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:44,183 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:44,183 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:44,184 - poker_game - INFO - Community cards: []
2025-10-31 19:03:44,184 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:44,184 - poker_game - INFO -   P1(Agent1): chips=3289, bet=10, status=active
2025-10-31 19:03:44,185 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:44,185 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:44,185 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=active
2025-10-31 19:03:44,185 - poker_game - INFO - ==================================================
2025-10-31 19:03:44,186 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "J♣",
    "3♥"
  ],
  "community": [],
  "your_chips": 5264,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3289,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1417,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (5264)"
  ],
  "history": [
    "Player 3 checked",
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 19:03:44,218 - poker_game - DEBUG - Create Session: {'id': '16e8b670-2ece-45b4-a916-7317c4d4da27', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905024.2148101}
2025-10-31 19:03:50,394 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_JDGRtcczM8zT9Qc7RHflASrU', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1244, 'totalTokenCount': 1261}, 'invocationId': 'e-a999ae9a-2703-4385-a3e4-c828a5597a70', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'NJheSmXr', 'timestamp': 1761905024.231792}, {'content': {'parts': [{'functionResponse': {'id': 'call_JDGRtcczM8zT9Qc7RHflASrU', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a999ae9a-2703-4385-a3e4-c828a5597a70', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '93p5mKP8', 'timestamp': 1761905025.263745}, {'content': {'parts': [{'functionCall': {'id': 'call_OgQS5BLOUFoy3tJUONO90mIQ', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1768, 'totalTokenCount': 1785}, 'invocationId': 'e-a999ae9a-2703-4385-a3e4-c828a5597a70', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Qpjk2BHB', 'timestamp': 1761905025.266189}, {'content': {'parts': [{'functionResponse': {'id': 'call_OgQS5BLOUFoy3tJUONO90mIQ', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a999ae9a-2703-4385-a3e4-c828a5597a70', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'JDT4SLdH', 'timestamp': 1761905026.434161}, {'content': {'parts': [{'functionCall': {'id': 'call_23FGLexsWMXN2zzVO2o5fcMC', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1799, 'totalTokenCount': 1819}, 'invocationId': 'e-a999ae9a-2703-4385-a3e4-c828a5597a70', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'PZVYLjs6', 'timestamp': 1761905026.437092}, {'content': {'parts': [{'functionResponse': {'id': 'call_23FGLexsWMXN2zzVO2o5fcMC', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a999ae9a-2703-4385-a3e4-c828a5597a70', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'PNNYgxd8', 'timestamp': 1761905028.14311}, {'content': {'parts': [{'text': '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "J♣ and 3♥ is a weak hand, especially in early position. The bet to call is high relative to my chip stack, and there are already aggressive raises. Folding is the best decision."\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 65, 'promptTokenCount': 1382, 'totalTokenCount': 1447}, 'invocationId': 'e-a999ae9a-2703-4385-a3e4-c828a5597a70', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'G7gtmA2q', 'timestamp': 1761905028.144738}]
2025-10-31 19:03:50,394 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:03:50,394 - poker_game - DEBUG - {
  "action": "fold",
  "amount": 0,
  "reasoning": "J♣ and 3♥ is a weak hand, especially in early position. The bet to call is high relative to my chip stack, and there are already aggressive raises. Folding is the best decision."
}
2025-10-31 19:03:50,395 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:03:50,395 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "J♣ and 3♥ is a weak hand, especially in early position. The bet to call is high relative to my chip stack, and there are already aggressive raises. Folding is the best decision."\n}'
2025-10-31 19:03:50,395 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:03:50,395 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "J♣ and 3♥ is a weak hand, especially in early position. The bet to call is high relative to my chip stack, and there are already aggressive raises. Folding is the best decision."
}
2025-10-31 19:03:50,395 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'J♣ and 3♥ is a weak hand, especially in early position. The bet to call is high relative to my chip stack, and there are already aggressive raises. Folding is the best decision.'}
2025-10-31 19:03:50,395 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 19:03:50,395 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 19:03:50,396 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:03:50,396 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, J♣ and 3♥ is a weak hand, especially in early position. The bet to call is high relative to my chip stack, and there are already aggressive raises. Folding is the best decision.
2025-10-31 19:03:50,396 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 19:03:50,397 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:50,397 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:50,397 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:03:50,397 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:50,397 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:50,398 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:50,398 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:50,398 - poker_game - INFO - Community cards: []
2025-10-31 19:03:50,398 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:50,398 - poker_game - INFO -   P1(Agent1): chips=3289, bet=10, status=active
2025-10-31 19:03:50,399 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:50,399 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:50,399 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=active
2025-10-31 19:03:50,399 - poker_game - INFO - ==================================================
2025-10-31 19:03:50,399 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 19:03:50,413 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:50,413 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:50,413 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:03:50,414 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:50,414 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:50,414 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:50,414 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:50,414 - poker_game - INFO - Community cards: []
2025-10-31 19:03:50,414 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:50,414 - poker_game - INFO -   P1(Agent1): chips=3289, bet=10, status=active
2025-10-31 19:03:50,415 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:50,415 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:50,415 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:50,415 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 19:03:50,415 - poker_game - INFO - ==================================================
2025-10-31 19:03:50,416 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:50,416 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:50,416 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:03:50,416 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:03:50,416 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:50,417 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:50,417 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:50,417 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 19:03:50,418 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:03:50,418 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:50,418 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:50,418 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:03:50,418 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:50,419 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:50,419 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:50,419 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:50,419 - poker_game - INFO - Community cards: []
2025-10-31 19:03:50,420 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:50,420 - poker_game - INFO -   P1(Agent1): chips=3289, bet=10, status=active
2025-10-31 19:03:50,420 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:50,420 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:50,420 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:50,421 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:50,421 - poker_game - INFO - ==================================================
2025-10-31 19:03:50,523 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "9♣",
    "7♠"
  ],
  "community": [],
  "your_chips": 3289,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1417,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5264,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (3289)"
  ],
  "history": [
    "Player 4 checked",
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded"
  ]
}
2025-10-31 19:03:50,531 - poker_game - DEBUG - Create Session: {'id': '017d18c2-b3b8-4cec-bffc-82b747d5136f', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905030.5290082}
2025-10-31 19:03:51,980 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、あなたの手札は9と7で、これは平均的な強さです。ポットは30で、コールするには10です。相手のプレイヤーは1人だけアクティブで、そのプレイヤーはすでに20をベットしており、あなたにコールするかレイズするかを選択肢を与えています。相手のプレイヤーの状況は不明ですが、この状況ではコールしてフロップを見るのが合理的です。フロップを見てから、より良い判断ができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 130, 'promptTokenCount': 914, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 914}], 'totalTokenCount': 1044}, 'invocationId': 'e-79ba7d0c-66cd-4c37-b6e2-f7b5d597fafd', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'eiwzm4k5', 'timestamp': 1761905030.540911}]
2025-10-31 19:03:51,980 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:03:51,981 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで、あなたの手札は9と7で、これは平均的な強さです。ポットは30で、コールするには10です。相手のプレイヤーは1人だけアクティブで、そのプレイヤーはすでに20をベットしており、あなたにコールするかレイズするかを選択肢を与えています。相手のプレイヤーの状況は不明ですが、この状況ではコールしてフロップを見るのが合理的です。フロップを見てから、より良い判断ができます。"
}
```
2025-10-31 19:03:51,981 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:03:51,981 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、あなたの手札は9と7で、これは平均的な強さです。ポットは30で、コールするには10です。相手のプレイヤーは1人だけアクティブで、そのプレイヤーはすでに20をベットしており、あなたにコールするかレイズするかを選択肢を与えています。相手のプレイヤーの状況は不明ですが、この状況ではコールしてフロップを見るのが合理的です。フロップを見てから、より良い判断ができます。"\n}\n```'
2025-10-31 19:03:51,981 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:03:51,981 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 10,\n  "reasoning": "プリフロップで、あなたの手札は9と7で、これは平均的な強さです。ポットは30で、コールするには10です。相手のプレイヤーは1人だけアクティブで、そのプレイヤーはすでに20をベットしており、あなたにコールするかレイズするかを選択肢を与えています。相手のプレイヤーの状況は不明ですが、この状況ではコールしてフロップを見るのが合理的です。フロップを見てから、より良い判断ができます。"\n}'
2025-10-31 19:03:51,981 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 10,
  "reasoning": "プリフロップで、あなたの手札は9と7で、これは平均的な強さです。ポットは30で、コールするには10です。相手のプレイヤーは1人だけアクティブで、そのプレイヤーはすでに20をベットしており、あなたにコールするかレイズするかを選択肢を与えています。相手のプレイヤーの状況は不明ですが、この状況ではコールしてフロップを見るのが合理的です。フロップを見てから、より良い判断ができます。"
}
2025-10-31 19:03:51,981 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'プリフロップで、あなたの手札は9と7で、これは平均的な強さです。ポットは30で、コールするには10です。相手のプレイヤーは1人だけアクティブで、そのプレイヤーはすでに20をベットしており、あなたにコールするかレイズするかを選択肢を与えています。相手のプレイヤーの状況は不明ですが、この状況ではコールしてフロップを見るのが合理的です。フロップを見てから、より良い判断ができます。'}
2025-10-31 19:03:51,982 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 10
2025-10-31 19:03:51,982 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (3289)']
2025-10-31 19:03:51,982 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (10)': 10
2025-10-31 19:03:51,982 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 19:03:51,982 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 10, プリフロップで、あなたの手札は9と7で、これは平均的な強さです。ポットは30で、コールするには10です。相手のプレイヤーは1人だけアクティブで、そのプレイヤーはすでに20をベットしており、あなたにコールするかレイズするかを選択肢を与えています。相手のプレイヤーの状況は不明ですが、この状況ではコールしてフロップを見るのが合理的です。フロップを見てから、より良い判断ができます。
2025-10-31 19:03:51,983 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 10
2025-10-31 19:03:51,983 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:51,984 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:51,984 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:03:51,984 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:51,984 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:51,984 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:51,985 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:51,985 - poker_game - INFO - Community cards: []
2025-10-31 19:03:51,985 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:51,985 - poker_game - INFO -   P1(Agent1): chips=3289, bet=10, status=active
2025-10-31 19:03:51,985 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:51,985 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:51,986 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:51,986 - poker_game - INFO - ==================================================
2025-10-31 19:03:51,986 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 10
2025-10-31 19:03:51,993 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:51,994 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:51,994 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:03:51,994 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:03:51,995 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:51,995 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:51,995 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:51,995 - poker_game - INFO - Community cards: []
2025-10-31 19:03:51,996 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:51,996 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=active
2025-10-31 19:03:51,996 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:51,996 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:51,997 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:51,997 - poker_game - INFO - Extra: Action: Player 1 called 10
2025-10-31 19:03:51,997 - poker_game - INFO - ==================================================
2025-10-31 19:03:51,998 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:51,998 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:51,998 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:03:51,998 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:03:51,999 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:51,999 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:52,000 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:52,000 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 19:03:52,000 - poker_game - DEBUG - Active player indices: [1, 3]
2025-10-31 19:03:52,000 - poker_game - DEBUG - Last raiser index: 3
2025-10-31 19:03:52,001 - poker_game - DEBUG - Current player index: 3
2025-10-31 19:03:52,001 - poker_game - DEBUG - Next after last raiser 3: 1
2025-10-31 19:03:52,001 - poker_game - DEBUG - Betting continues: Current player 3 != next after raiser 1
2025-10-31 19:03:52,001 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:52,002 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:52,002 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:03:52,003 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:03:52,003 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:52,004 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:52,005 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:52,006 - poker_game - INFO - Community cards: []
2025-10-31 19:03:52,006 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:52,007 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=active
2025-10-31 19:03:52,008 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:52,008 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:52,009 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:52,010 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:52,011 - poker_game - INFO - ==================================================
2025-10-31 19:03:52,112 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "10♣",
    "K♣"
  ],
  "community": [],
  "your_chips": 1417,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3279,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5264,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (1417)"
  ],
  "history": [
    "Player 1 checked",
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10"
  ]
}
2025-10-31 19:03:52,125 - poker_game - DEBUG - Create Session: {'id': 'd1c0826d-e82b-40d1-bcf2-3ffc7c248c3d', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905032.1223881}
2025-10-31 19:03:54,345 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 80,\n  "reasoning": "Kicker Kは強力なカードであり、クラブのフラッシュの可能性もあります。プリフロップでレイズすることで、相手にプレッシャーをかけ、ポットを大きくします。相手はプレイヤー1人であり、過去の履歴ではアグレッシブなプレイを見せていないため、レイズでフォールドさせるか、有利な状況でフロップに進むことを目指します。レイズ額は、相手のベット額（20）の4倍にし、相手にコールするかフォールドするかを判断させるためです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 145, 'promptTokenCount': 914, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 914}], 'totalTokenCount': 1059}, 'invocationId': 'e-fa722c79-659b-4401-ace9-7ce7613302e3', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'gYGQ9Bt9', 'timestamp': 1761905032.135758}]
2025-10-31 19:03:54,346 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:03:54,346 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 80,
  "reasoning": "Kicker Kは強力なカードであり、クラブのフラッシュの可能性もあります。プリフロップでレイズすることで、相手にプレッシャーをかけ、ポットを大きくします。相手はプレイヤー1人であり、過去の履歴ではアグレッシブなプレイを見せていないため、レイズでフォールドさせるか、有利な状況でフロップに進むことを目指します。レイズ額は、相手のベット額（20）の4倍にし、相手にコールするかフォールドするかを判断させるためです。"
}
```
2025-10-31 19:03:54,346 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:03:54,346 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 80,\n  "reasoning": "Kicker Kは強力なカードであり、クラブのフラッシュの可能性もあります。プリフロップでレイズすることで、相手にプレッシャーをかけ、ポットを大きくします。相手はプレイヤー1人であり、過去の履歴ではアグレッシブなプレイを見せていないため、レイズでフォールドさせるか、有利な状況でフロップに進むことを目指します。レイズ額は、相手のベット額（20）の4倍にし、相手にコールするかフォールドするかを判断させるためです。"\n}\n```'
2025-10-31 19:03:54,346 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:03:54,347 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 80,\n  "reasoning": "Kicker Kは強力なカードであり、クラブのフラッシュの可能性もあります。プリフロップでレイズすることで、相手にプレッシャーをかけ、ポットを大きくします。相手はプレイヤー1人であり、過去の履歴ではアグレッシブなプレイを見せていないため、レイズでフォールドさせるか、有利な状況でフロップに進むことを目指します。レイズ額は、相手のベット額（20）の4倍にし、相手にコールするかフォールドするかを判断させるためです。"\n}'
2025-10-31 19:03:54,347 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 80,
  "reasoning": "Kicker Kは強力なカードであり、クラブのフラッシュの可能性もあります。プリフロップでレイズすることで、相手にプレッシャーをかけ、ポットを大きくします。相手はプレイヤー1人であり、過去の履歴ではアグレッシブなプレイを見せていないため、レイズでフォールドさせるか、有利な状況でフロップに進むことを目指します。レイズ額は、相手のベット額（20）の4倍にし、相手にコールするかフォールドするかを判断させるためです。"
}
2025-10-31 19:03:54,347 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 80, 'reasoning': 'Kicker Kは強力なカードであり、クラブのフラッシュの可能性もあります。プリフロップでレイズすることで、相手にプレッシャーをかけ、ポットを大きくします。相手はプレイヤー1人であり、過去の履歴ではアグレッシブなプレイを見せていないため、レイズでフォールドさせるか、有利な状況でフロップに進むことを目指します。レイズ額は、相手のベット額（20）の4倍にし、相手にコールするかフォールドするかを判断させるためです。'}
2025-10-31 19:03:54,347 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 80
2025-10-31 19:03:54,347 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (1417)']
2025-10-31 19:03:54,347 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 19:03:54,347 - poker_game - DEBUG - [Agent3] Raise amount 80 is valid (min: 40)
2025-10-31 19:03:54,348 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 80}
2025-10-31 19:03:54,348 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 80, Kicker Kは強力なカードであり、クラブのフラッシュの可能性もあります。プリフロップでレイズすることで、相手にプレッシャーをかけ、ポットを大きくします。相手はプレイヤー1人であり、過去の履歴ではアグレッシブなプレイを見せていないため、レイズでフォールドさせるか、有利な状況でフロップに進むことを目指します。レイズ額は、相手のベット額（20）の4倍にし、相手にコールするかフォールドするかを判断させるためです。
2025-10-31 19:03:54,349 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 80
2025-10-31 19:03:54,349 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:54,349 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:54,350 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:03:54,350 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:03:54,351 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:54,352 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:54,353 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:54,354 - poker_game - INFO - Community cards: []
2025-10-31 19:03:54,354 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:54,355 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=active
2025-10-31 19:03:54,355 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:54,355 - poker_game - INFO -   P3(Agent3): chips=1417, bet=20, status=active
2025-10-31 19:03:54,356 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:54,356 - poker_game - INFO - ==================================================
2025-10-31 19:03:54,356 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 100
2025-10-31 19:03:54,368 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:54,369 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:54,370 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:03:54,370 - poker_game - INFO - Pot: 120, Current bet: 100
2025-10-31 19:03:54,370 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:54,371 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:54,371 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:54,371 - poker_game - INFO - Community cards: []
2025-10-31 19:03:54,372 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:54,372 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=active
2025-10-31 19:03:54,373 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:54,373 - poker_game - INFO -   P3(Agent3): chips=1337, bet=100, status=active
2025-10-31 19:03:54,374 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:54,374 - poker_game - INFO - Extra: Action: Player 3 raised to 100
2025-10-31 19:03:54,375 - poker_game - INFO - ==================================================
2025-10-31 19:03:54,376 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:54,377 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:54,377 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:03:54,378 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:03:54,378 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:54,378 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:54,378 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:54,379 - poker_game - DEBUG - Player bets: [20, 100], Current bet: 100, All same: False
2025-10-31 19:03:54,379 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:03:54,379 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:54,379 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:54,380 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:03:54,380 - poker_game - INFO - Pot: 120, Current bet: 100
2025-10-31 19:03:54,380 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:54,381 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:54,381 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:54,381 - poker_game - INFO - Community cards: []
2025-10-31 19:03:54,382 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:54,382 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=active
2025-10-31 19:03:54,382 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:54,383 - poker_game - INFO -   P3(Agent3): chips=1337, bet=100, status=active
2025-10-31 19:03:54,383 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:54,384 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:54,384 - poker_game - INFO - ==================================================
2025-10-31 19:03:54,486 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "9♣",
    "7♠"
  ],
  "community": [],
  "your_chips": 3279,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 120,
  "to_call": 80,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1337,
      "bet": 100,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5264,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (80)",
    "raise (min 120)",
    "all-in (3279)"
  ],
  "history": [
    "Showdown: Player 1 hand=One Pair: 9s - K♣, 9♥, 9♦, 7♥, 6♠ cards=K♣, 7♥",
    "Showdown: Player 3 hand=One Pair: 9s - K♥, 9♥, 9♦, 7♠, 6♠ cards=K♥, 7♠",
    "Showdown: Player 4 hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣ cards=5♣, 2♣",
    "Side pot layer 0: amount=60, winners=4 best_hand=Straight: 6-high - 6♠, 5♣, 4♣, 3♠, 2♣",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100"
  ]
}
2025-10-31 19:03:54,502 - poker_game - DEBUG - Create Session: {'id': '2dc7e7bb-4119-4f63-bdeb-05f1c29d3732', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905034.4989295}
2025-10-31 19:03:56,463 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（ゲーム開始前）で、手札が9と7のオフスート（異なるスーツ）です。これは弱いハンドであり、ビッグブラインド（BB）から80のコールが必要な状況で、ポットサイズ（120）や相手のベット額（100）を考慮すると、勝てる可能性が低いと判断しました。そのため、フォールド（降りる）を選択しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 119, 'promptTokenCount': 925, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 925}], 'totalTokenCount': 1044}, 'invocationId': 'e-c80b43c5-a2ba-4ad4-ad76-7a76cf58b3ae', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'QA4AljRB', 'timestamp': 1761905034.516468}]
2025-10-31 19:03:56,463 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:03:56,464 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（ゲーム開始前）で、手札が9と7のオフスート（異なるスーツ）です。これは弱いハンドであり、ビッグブラインド（BB）から80のコールが必要な状況で、ポットサイズ（120）や相手のベット額（100）を考慮すると、勝てる可能性が低いと判断しました。そのため、フォールド（降りる）を選択しました。"
}
```
2025-10-31 19:03:56,464 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:03:56,464 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（ゲーム開始前）で、手札が9と7のオフスート（異なるスーツ）です。これは弱いハンドであり、ビッグブラインド（BB）から80のコールが必要な状況で、ポットサイズ（120）や相手のベット額（100）を考慮すると、勝てる可能性が低いと判断しました。そのため、フォールド（降りる）を選択しました。"\n}\n```'
2025-10-31 19:03:56,465 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:03:56,465 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（ゲーム開始前）で、手札が9と7のオフスート（異なるスーツ）です。これは弱いハンドであり、ビッグブラインド（BB）から80のコールが必要な状況で、ポットサイズ（120）や相手のベット額（100）を考慮すると、勝てる可能性が低いと判断しました。そのため、フォールド（降りる）を選択しました。"\n}'
2025-10-31 19:03:56,465 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（ゲーム開始前）で、手札が9と7のオフスート（異なるスーツ）です。これは弱いハンドであり、ビッグブラインド（BB）から80のコールが必要な状況で、ポットサイズ（120）や相手のベット額（100）を考慮すると、勝てる可能性が低いと判断しました。そのため、フォールド（降りる）を選択しました。"
}
2025-10-31 19:03:56,465 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（ゲーム開始前）で、手札が9と7のオフスート（異なるスーツ）です。これは弱いハンドであり、ビッグブラインド（BB）から80のコールが必要な状況で、ポットサイズ（120）や相手のベット額（100）を考慮すると、勝てる可能性が低いと判断しました。そのため、フォールド（降りる）を選択しました。'}
2025-10-31 19:03:56,466 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 19:03:56,466 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 19:03:56,466 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:03:56,466 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップ（ゲーム開始前）で、手札が9と7のオフスート（異なるスーツ）です。これは弱いハンドであり、ビッグブラインド（BB）から80のコールが必要な状況で、ポットサイズ（120）や相手のベット額（100）を考慮すると、勝てる可能性が低いと判断しました。そのため、フォールド（降りる）を選択しました。
2025-10-31 19:03:56,467 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 19:03:56,468 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:56,469 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:56,469 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:03:56,470 - poker_game - INFO - Pot: 120, Current bet: 100
2025-10-31 19:03:56,470 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:56,471 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:56,471 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:56,472 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,472 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,473 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=active
2025-10-31 19:03:56,474 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,474 - poker_game - INFO -   P3(Agent3): chips=1337, bet=100, status=active
2025-10-31 19:03:56,474 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:56,475 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,475 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 19:03:56,487 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:56,488 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:56,488 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:03:56,489 - poker_game - INFO - Pot: 120, Current bet: 100
2025-10-31 19:03:56,489 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:56,489 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:56,489 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:56,490 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,490 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,491 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=folded
2025-10-31 19:03:56,491 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,492 - poker_game - INFO -   P3(Agent3): chips=1337, bet=100, status=active
2025-10-31 19:03:56,492 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:56,492 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 19:03:56,493 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,493 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:56,494 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:56,495 - poker_game - DEBUG - Active players: [3]
2025-10-31 19:03:56,495 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:03:56,496 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:56,496 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:56,497 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 19:03:56,497 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 19:03:56,498 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:56,498 - poker_game - INFO - Hand #25, Phase: preflop
2025-10-31 19:03:56,498 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:03:56,499 - poker_game - INFO - Pot: 120, Current bet: 100
2025-10-31 19:03:56,500 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:56,500 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:56,501 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:56,502 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,502 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,503 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=folded
2025-10-31 19:03:56,503 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,503 - poker_game - INFO -   P3(Agent3): chips=1337, bet=100, status=active
2025-10-31 19:03:56,503 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:56,504 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:03:56,504 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,607 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:03:56,608 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:56,609 - poker_game - INFO - Remaining players: 1
2025-10-31 19:03:56,610 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:03:56,610 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 19:03:56,610 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:03:56,611 - poker_game - INFO - Hand #25, Phase: showdown
2025-10-31 19:03:56,611 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:03:56,612 - poker_game - INFO - Pot: 120, Current bet: 100
2025-10-31 19:03:56,612 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:56,613 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:56,613 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:56,613 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,614 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,614 - poker_game - INFO -   P1(Agent1): chips=3279, bet=20, status=folded
2025-10-31 19:03:56,614 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,615 - poker_game - INFO -   P3(Agent3): chips=1337, bet=100, status=active
2025-10-31 19:03:56,615 - poker_game - INFO -   P4(Agent4): chips=5264, bet=0, status=folded
2025-10-31 19:03:56,616 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,616 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:03:56,617 - poker_game - INFO - Pot: 120, Community cards: []
2025-10-31 19:03:56,617 - poker_game - INFO -   Player 3 status=active cards=['10♣', 'K♣']
2025-10-31 19:03:56,618 - poker_game - INFO - Showdown winner by default: Player 3 awarded 120
2025-10-31 19:03:56,618 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:03:56,619 - poker_game - INFO - === STARTING NEW HAND #26 ===
2025-10-31 19:03:56,619 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:03:56,620 - poker_game - INFO - Moving dealer button
2025-10-31 19:03:56,620 - poker_game - INFO - Posting blinds
2025-10-31 19:03:56,642 - poker_game - INFO - Dealing hole cards
2025-10-31 19:03:56,643 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:03:56,653 - poker_game - INFO - Started new hand in database: hand_id=26
2025-10-31 19:03:56,653 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:03:56,654 - poker_game - INFO - Hand #26, Phase: preflop
2025-10-31 19:03:56,654 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:03:56,655 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:56,655 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:56,656 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:56,656 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:56,656 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,657 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,657 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=active
2025-10-31 19:03:56,658 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,658 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:03:56,658 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:56,659 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,660 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "10♠",
    "4♠"
  ],
  "community": [],
  "your_chips": 3279,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1447,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5244,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (3279)"
  ],
  "history": [
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 19:03:56,672 - poker_game - DEBUG - Create Session: {'id': 'b80ec714-f33e-4e8b-b83d-0e5528d6c207', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905036.6690166}
2025-10-31 19:03:56,033 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は10♠4♠です。これは「スーテッドコネクター」とは言えず、強い役を作るには弱すぎます。現在のベット額（to call: 20）はポットサイズ（pot: 30）に対して大きく、さらに既に他のプレイヤーがレイズ（raise）しています。この弱い手札でコール（call）するのはリスクが高いため、フォールド（fold）を選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 131, 'promptTokenCount': 787, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 787}], 'totalTokenCount': 918}, 'invocationId': 'e-77094308-a204-4540-9844-e4e79dd4ab05', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'ZeIhiSf4', 'timestamp': 1761905036.683526}]
2025-10-31 19:03:56,033 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:03:56,034 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は10♠4♠です。これは「スーテッドコネクター」とは言えず、強い役を作るには弱すぎます。現在のベット額（to call: 20）はポットサイズ（pot: 30）に対して大きく、さらに既に他のプレイヤーがレイズ（raise）しています。この弱い手札でコール（call）するのはリスクが高いため、フォールド（fold）を選択します。"
}
```
2025-10-31 19:03:56,034 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:03:56,034 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は10♠4♠です。これは「スーテッドコネクター」とは言えず、強い役を作るには弱すぎます。現在のベット額（to call: 20）はポットサイズ（pot: 30）に対して大きく、さらに既に他のプレイヤーがレイズ（raise）しています。この弱い手札でコール（call）するのはリスクが高いため、フォールド（fold）を選択します。"\n}\n```'
2025-10-31 19:03:56,034 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:03:56,035 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は10♠4♠です。これは「スーテッドコネクター」とは言えず、強い役を作るには弱すぎます。現在のベット額（to call: 20）はポットサイズ（pot: 30）に対して大きく、さらに既に他のプレイヤーがレイズ（raise）しています。この弱い手札でコール（call）するのはリスクが高いため、フォールド（fold）を選択します。"\n}'
2025-10-31 19:03:56,035 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（フロップが開く前）で、私の手札は10♠4♠です。これは「スーテッドコネクター」とは言えず、強い役を作るには弱すぎます。現在のベット額（to call: 20）はポットサイズ（pot: 30）に対して大きく、さらに既に他のプレイヤーがレイズ（raise）しています。この弱い手札でコール（call）するのはリスクが高いため、フォールド（fold）を選択します。"
}
2025-10-31 19:03:56,035 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（フロップが開く前）で、私の手札は10♠4♠です。これは「スーテッドコネクター」とは言えず、強い役を作るには弱すぎます。現在のベット額（to call: 20）はポットサイズ（pot: 30）に対して大きく、さらに既に他のプレイヤーがレイズ（raise）しています。この弱い手札でコール（call）するのはリスクが高いため、フォールド（fold）を選択します。'}
2025-10-31 19:03:56,035 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 19:03:56,035 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 19:03:56,035 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:03:56,035 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, プリフロップ（フロップが開く前）で、私の手札は10♠4♠です。これは「スーテッドコネクター」とは言えず、強い役を作るには弱すぎます。現在のベット額（to call: 20）はポットサイズ（pot: 30）に対して大きく、さらに既に他のプレイヤーがレイズ（raise）しています。この弱い手札でコール（call）するのはリスクが高いため、フォールド（fold）を選択します。
2025-10-31 19:03:56,036 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 19:03:56,037 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:56,037 - poker_game - INFO - Hand #26, Phase: preflop
2025-10-31 19:03:56,038 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:03:56,038 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:56,038 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:56,039 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:56,039 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:56,040 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,040 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,040 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=active
2025-10-31 19:03:56,041 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,041 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:03:56,041 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:56,042 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,042 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 19:03:56,054 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:56,055 - poker_game - INFO - Hand #26, Phase: preflop
2025-10-31 19:03:56,057 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:03:56,058 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:56,058 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:56,059 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:56,060 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:56,060 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,061 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,061 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=folded
2025-10-31 19:03:56,061 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,062 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:03:56,062 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:56,062 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 19:03:56,063 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,063 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:56,064 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:56,064 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 19:03:56,065 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:03:56,065 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:56,065 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:56,066 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:03:56,066 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 19:03:56,066 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:03:56,066 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:56,067 - poker_game - INFO - Hand #26, Phase: preflop
2025-10-31 19:03:56,067 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:03:56,068 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:56,070 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:56,071 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:56,072 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:56,073 - poker_game - INFO - Community cards: []
2025-10-31 19:03:56,074 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:56,075 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=folded
2025-10-31 19:03:56,077 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:56,080 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:03:56,080 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:56,081 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:56,081 - poker_game - INFO - ==================================================
2025-10-31 19:03:56,182 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "8♦",
    "6♣"
  ],
  "community": [],
  "your_chips": 1447,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3279,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5244,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (1447)"
  ],
  "history": [
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded"
  ]
}
2025-10-31 19:04:01,226 - poker_game - DEBUG - Create Session: {'id': 'a2d28348-5984-4b47-88bc-4c49126d93be', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905041.2236547}
2025-10-31 19:03:57,566 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで8♦6♣というハンドは、弱いハンドです。アーリーポジションからレイズするほどの強さはありません。ポットオッズも悪く、コールしても勝てる見込みが低いため、フォールドを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 81, 'promptTokenCount': 782, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 782}], 'totalTokenCount': 863}, 'invocationId': 'e-c6ae9f67-7c1d-4df3-aa20-f0e26fcb4e9b', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'JV8G96qn', 'timestamp': 1761905041.239734}]
2025-10-31 19:03:57,566 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:03:57,567 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで8♦6♣というハンドは、弱いハンドです。アーリーポジションからレイズするほどの強さはありません。ポットオッズも悪く、コールしても勝てる見込みが低いため、フォールドを選択します。"
}
```
2025-10-31 19:03:57,567 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:03:57,567 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで8♦6♣というハンドは、弱いハンドです。アーリーポジションからレイズするほどの強さはありません。ポットオッズも悪く、コールしても勝てる見込みが低いため、フォールドを選択します。"\n}\n```'
2025-10-31 19:03:57,567 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:03:57,567 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップで8♦6♣というハンドは、弱いハンドです。アーリーポジションからレイズするほどの強さはありません。ポットオッズも悪く、コールしても勝てる見込みが低いため、フォールドを選択します。"\n}'
2025-10-31 19:03:57,568 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップで8♦6♣というハンドは、弱いハンドです。アーリーポジションからレイズするほどの強さはありません。ポットオッズも悪く、コールしても勝てる見込みが低いため、フォールドを選択します。"
}
2025-10-31 19:03:57,568 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップで8♦6♣というハンドは、弱いハンドです。アーリーポジションからレイズするほどの強さはありません。ポットオッズも悪く、コールしても勝てる見込みが低いため、フォールドを選択します。'}
2025-10-31 19:03:57,568 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 19:03:57,568 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 19:03:57,568 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:03:57,568 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップで8♦6♣というハンドは、弱いハンドです。アーリーポジションからレイズするほどの強さはありません。ポットオッズも悪く、コールしても勝てる見込みが低いため、フォールドを選択します。
2025-10-31 19:03:57,569 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 19:03:57,569 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:57,570 - poker_game - INFO - Hand #26, Phase: preflop
2025-10-31 19:03:57,570 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:03:57,571 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:57,571 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:57,571 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:57,572 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:03:57,572 - poker_game - INFO - Community cards: []
2025-10-31 19:03:57,572 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:57,573 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=folded
2025-10-31 19:03:57,573 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:57,574 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=active
2025-10-31 19:03:57,575 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:57,576 - poker_game - INFO - ==================================================
2025-10-31 19:03:57,577 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 19:03:57,592 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:57,593 - poker_game - INFO - Hand #26, Phase: preflop
2025-10-31 19:03:57,593 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:03:57,594 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:57,594 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:57,595 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:57,595 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:57,595 - poker_game - INFO - Community cards: []
2025-10-31 19:03:57,596 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:57,596 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=folded
2025-10-31 19:03:57,597 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:57,597 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=folded
2025-10-31 19:03:57,597 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:57,597 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 19:03:57,598 - poker_game - INFO - ==================================================
2025-10-31 19:03:57,598 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:57,599 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:57,599 - poker_game - DEBUG - Active players: [4]
2025-10-31 19:03:57,599 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:03:57,600 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:57,601 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:57,601 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 19:03:57,602 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 19:03:57,602 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:57,603 - poker_game - INFO - Hand #26, Phase: preflop
2025-10-31 19:03:57,603 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:03:57,604 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:57,605 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:57,605 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:57,606 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:57,607 - poker_game - INFO - Community cards: []
2025-10-31 19:03:57,607 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:57,608 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=folded
2025-10-31 19:03:57,609 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:57,609 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=folded
2025-10-31 19:03:57,609 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:57,610 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:03:57,610 - poker_game - INFO - ==================================================
2025-10-31 19:03:57,712 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:03:57,713 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:57,713 - poker_game - INFO - Remaining players: 1
2025-10-31 19:03:57,714 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:03:57,714 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 19:03:57,714 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:03:57,715 - poker_game - INFO - Hand #26, Phase: showdown
2025-10-31 19:03:57,715 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:03:57,716 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:57,716 - poker_game - INFO - Last raiser: 4
2025-10-31 19:03:57,716 - poker_game - INFO - Betting round complete: True
2025-10-31 19:03:57,717 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:03:57,717 - poker_game - INFO - Community cards: []
2025-10-31 19:03:57,717 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:57,718 - poker_game - INFO -   P1(Agent1): chips=3279, bet=0, status=folded
2025-10-31 19:03:57,718 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:57,719 - poker_game - INFO -   P3(Agent3): chips=1447, bet=10, status=folded
2025-10-31 19:03:57,719 - poker_game - INFO -   P4(Agent4): chips=5244, bet=20, status=active
2025-10-31 19:03:57,719 - poker_game - INFO - ==================================================
2025-10-31 19:03:57,720 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:03:57,720 - poker_game - INFO - Pot: 30, Community cards: []
2025-10-31 19:03:57,721 - poker_game - INFO -   Player 4 status=active cards=['J♠', '9♦']
2025-10-31 19:03:57,721 - poker_game - INFO - Showdown winner by default: Player 4 awarded 30
2025-10-31 19:03:57,722 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:03:57,722 - poker_game - INFO - === STARTING NEW HAND #27 ===
2025-10-31 19:03:57,723 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:03:57,724 - poker_game - INFO - Moving dealer button
2025-10-31 19:03:57,724 - poker_game - INFO - Posting blinds
2025-10-31 19:03:57,747 - poker_game - INFO - Dealing hole cards
2025-10-31 19:03:57,747 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:03:57,759 - poker_game - INFO - Started new hand in database: hand_id=27
2025-10-31 19:03:57,761 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:03:57,762 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:03:57,762 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:03:57,763 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:57,763 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:57,764 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:57,764 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:57,765 - poker_game - INFO - Community cards: []
2025-10-31 19:03:57,765 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:57,766 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:03:57,766 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:57,766 - poker_game - INFO -   P3(Agent3): chips=1447, bet=0, status=active
2025-10-31 19:03:57,766 - poker_game - INFO -   P4(Agent4): chips=5264, bet=10, status=active
2025-10-31 19:03:57,767 - poker_game - INFO - ==================================================
2025-10-31 19:03:57,768 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "2♠",
    "K♠"
  ],
  "community": [],
  "your_chips": 1447,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 3259,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5264,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (1447)"
  ],
  "history": [
    "Player 4 called 60",
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 19:03:57,785 - poker_game - DEBUG - Create Session: {'id': 'e5c27dcb-06de-46dd-b0d1-490b9b715fa8', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905037.781952}
2025-10-31 19:03:59,891 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 100,\n  "reasoning": "PreflopでK♠ 2♠は、特にポジションが良い場合、レイズするのに十分な強さがあります。ビッグブラインド（BB）のプレイヤーがすでに20をベットしており、コールするには20必要です。ポットにはすでに30あり、相手のベットと自分のコールを考慮すると、3倍のレイズ（20 x 3 = 60）が標準的ですが、ここでは相手がコールまたは3ベットする可能性を考慮して、さらに大きくレイズします。100にレイズすることで、相手にプレッシャーをかけ、ポットコントロールを試みます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 160, 'promptTokenCount': 785, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 785}], 'totalTokenCount': 945}, 'invocationId': 'e-d785aab0-74fb-4f4e-a9de-d3a4598924b6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'fK2DYzOC', 'timestamp': 1761905037.798583}]
2025-10-31 19:03:59,892 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:03:59,892 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 100,
  "reasoning": "PreflopでK♠ 2♠は、特にポジションが良い場合、レイズするのに十分な強さがあります。ビッグブラインド（BB）のプレイヤーがすでに20をベットしており、コールするには20必要です。ポットにはすでに30あり、相手のベットと自分のコールを考慮すると、3倍のレイズ（20 x 3 = 60）が標準的ですが、ここでは相手がコールまたは3ベットする可能性を考慮して、さらに大きくレイズします。100にレイズすることで、相手にプレッシャーをかけ、ポットコントロールを試みます。"
}
```
2025-10-31 19:03:59,893 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:03:59,893 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 100,\n  "reasoning": "PreflopでK♠ 2♠は、特にポジションが良い場合、レイズするのに十分な強さがあります。ビッグブラインド（BB）のプレイヤーがすでに20をベットしており、コールするには20必要です。ポットにはすでに30あり、相手のベットと自分のコールを考慮すると、3倍のレイズ（20 x 3 = 60）が標準的ですが、ここでは相手がコールまたは3ベットする可能性を考慮して、さらに大きくレイズします。100にレイズすることで、相手にプレッシャーをかけ、ポットコントロールを試みます。"\n}\n```'
2025-10-31 19:03:59,893 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:03:59,893 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 100,\n  "reasoning": "PreflopでK♠ 2♠は、特にポジションが良い場合、レイズするのに十分な強さがあります。ビッグブラインド（BB）のプレイヤーがすでに20をベットしており、コールするには20必要です。ポットにはすでに30あり、相手のベットと自分のコールを考慮すると、3倍のレイズ（20 x 3 = 60）が標準的ですが、ここでは相手がコールまたは3ベットする可能性を考慮して、さらに大きくレイズします。100にレイズすることで、相手にプレッシャーをかけ、ポットコントロールを試みます。"\n}'
2025-10-31 19:03:59,894 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 100,
  "reasoning": "PreflopでK♠ 2♠は、特にポジションが良い場合、レイズするのに十分な強さがあります。ビッグブラインド（BB）のプレイヤーがすでに20をベットしており、コールするには20必要です。ポットにはすでに30あり、相手のベットと自分のコールを考慮すると、3倍のレイズ（20 x 3 = 60）が標準的ですが、ここでは相手がコールまたは3ベットする可能性を考慮して、さらに大きくレイズします。100にレイズすることで、相手にプレッシャーをかけ、ポットコントロールを試みます。"
}
2025-10-31 19:03:59,894 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 100, 'reasoning': 'PreflopでK♠ 2♠は、特にポジションが良い場合、レイズするのに十分な強さがあります。ビッグブラインド（BB）のプレイヤーがすでに20をベットしており、コールするには20必要です。ポットにはすでに30あり、相手のベットと自分のコールを考慮すると、3倍のレイズ（20 x 3 = 60）が標準的ですが、ここでは相手がコールまたは3ベットする可能性を考慮して、さらに大きくレイズします。100にレイズすることで、相手にプレッシャーをかけ、ポットコントロールを試みます。'}
2025-10-31 19:03:59,894 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 100
2025-10-31 19:03:59,894 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (1447)']
2025-10-31 19:03:59,895 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 19:03:59,895 - poker_game - DEBUG - [Agent3] Raise amount 100 is valid (min: 40)
2025-10-31 19:03:59,895 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 100}
2025-10-31 19:03:59,895 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 100, PreflopでK♠ 2♠は、特にポジションが良い場合、レイズするのに十分な強さがあります。ビッグブラインド（BB）のプレイヤーがすでに20をベットしており、コールするには20必要です。ポットにはすでに30あり、相手のベットと自分のコールを考慮すると、3倍のレイズ（20 x 3 = 60）が標準的ですが、ここでは相手がコールまたは3ベットする可能性を考慮して、さらに大きくレイズします。100にレイズすることで、相手にプレッシャーをかけ、ポットコントロールを試みます。
2025-10-31 19:03:59,896 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 100
2025-10-31 19:03:59,897 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:03:59,898 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:03:59,898 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:03:59,899 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:03:59,899 - poker_game - INFO - Last raiser: 1
2025-10-31 19:03:59,899 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:59,900 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:59,901 - poker_game - INFO - Community cards: []
2025-10-31 19:03:59,901 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:59,902 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:03:59,903 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:59,903 - poker_game - INFO -   P3(Agent3): chips=1447, bet=0, status=active
2025-10-31 19:03:59,904 - poker_game - INFO -   P4(Agent4): chips=5264, bet=10, status=active
2025-10-31 19:03:59,905 - poker_game - INFO - ==================================================
2025-10-31 19:03:59,906 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 120
2025-10-31 19:03:59,919 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:03:59,920 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:03:59,920 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:03:59,921 - poker_game - INFO - Pot: 150, Current bet: 120
2025-10-31 19:03:59,921 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:59,922 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:59,922 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:59,922 - poker_game - INFO - Community cards: []
2025-10-31 19:03:59,923 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:59,923 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:03:59,924 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:59,924 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:03:59,924 - poker_game - INFO -   P4(Agent4): chips=5264, bet=10, status=active
2025-10-31 19:03:59,925 - poker_game - INFO - Extra: Action: Player 3 raised to 120
2025-10-31 19:03:59,925 - poker_game - INFO - ==================================================
2025-10-31 19:03:59,926 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:03:59,926 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:03:59,927 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:03:59,927 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:03:59,927 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:03:59,929 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:03:59,929 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:03:59,930 - poker_game - DEBUG - Player bets: [20, 120, 10], Current bet: 120, All same: False
2025-10-31 19:03:59,930 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:03:59,930 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:03:59,931 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:03:59,931 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:03:59,932 - poker_game - INFO - Pot: 150, Current bet: 120
2025-10-31 19:03:59,932 - poker_game - INFO - Last raiser: 3
2025-10-31 19:03:59,933 - poker_game - INFO - Betting round complete: False
2025-10-31 19:03:59,933 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:03:59,934 - poker_game - INFO - Community cards: []
2025-10-31 19:03:59,934 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:03:59,935 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:03:59,935 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:03:59,936 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:03:59,936 - poker_game - INFO -   P4(Agent4): chips=5264, bet=10, status=active
2025-10-31 19:03:59,937 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:03:59,937 - poker_game - INFO - ==================================================
2025-10-31 19:04:00,038 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "4♠",
    "4♦"
  ],
  "community": [],
  "your_chips": 5264,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 150,
  "to_call": 110,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 3259,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 1327,
      "bet": 120,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (110)",
    "raise (min 140)",
    "all-in (5264)"
  ],
  "history": [
    "Flop dealt: 5♥, 8♣, J♥",
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120"
  ]
}
2025-10-31 19:04:00,050 - poker_game - DEBUG - Create Session: {'id': '355b93d5-772c-4447-9e53-e8063eb8c407', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905040.0475507}
2025-10-31 19:04:10,168 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:04:20,112 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:04:23,909 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_PvxIHc4C9eEkeoA2HNcy1Mrt', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1097, 'totalTokenCount': 1114}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'iSa8QnXz', 'timestamp': 1761905040.062551}, {'content': {'parts': [{'functionResponse': {'id': 'call_PvxIHc4C9eEkeoA2HNcy1Mrt', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'GAnffsrE', 'timestamp': 1761905041.06078}, {'content': {'parts': [{'functionCall': {'id': 'call_1ICWsQRCAj8N9oCaY6aLQP70', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1621, 'totalTokenCount': 1641}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '89nMv1Kp', 'timestamp': 1761905041.064648}, {'content': {'parts': [{'functionResponse': {'id': 'call_1ICWsQRCAj8N9oCaY6aLQP70', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'sWUG6z2F', 'timestamp': 1761905042.288706}, {'content': {'parts': [{'functionCall': {'id': 'call_ECX4RIBzpQ1dbPCMT7XNgxW2', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1183, 'totalTokenCount': 1200}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '4xqLqTqL', 'timestamp': 1761905042.296965}, {'content': {'parts': [{'functionResponse': {'id': 'call_ECX4RIBzpQ1dbPCMT7XNgxW2', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'nkQmQumR', 'timestamp': 1761905043.43198}, {'content': {'parts': [{'functionCall': {'id': 'call_GzKJdDiZ6nMKVSOEZqEyNpFp', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['4♠', '4♦'], 'community': [], 'your_chips': 5264, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 150, 'to_call': 110, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3259, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1327, 'bet': 120, 'status': 'active'}], 'actions': ['fold', 'call (110)', 'raise (min 140)', 'all-in (5264)'], 'history': ['Flop dealt: 5♥, 8♣, J♥', 'Player 4 raised to 105', 'Player 1 raised to 405', 'Player 4 folded', 'Showdown: Player 1 won 670', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 raised to 100', 'Player 1 folded', 'Showdown: Player 3 won 120', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 raised to 120']}, 'call_amount': 110, 'pot_after_call': 260, 'equity': 0.5}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_erjNWnDpAE0pRUsTORpe22Yr', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['4♠', '4♦'], 'community': [], 'your_chips': 5264, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 150, 'to_call': 110, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 3259, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 1327, 'bet': 120, 'status': 'active'}], 'actions': ['fold', 'call (110)', 'raise (min 140)', 'all-in (5264)'], 'history': ['Flop dealt: 5♥, 8♣, J♥', 'Player 4 raised to 105', 'Player 1 raised to 405', 'Player 4 folded', 'Showdown: Player 1 won 670', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 raised to 100', 'Player 1 folded', 'Showdown: Player 3 won 120', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 raised to 120']}, 'call_amount': 110, 'pot_after_call': 260, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 674, 'promptTokenCount': 1713, 'totalTokenCount': 2387}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '1RWqNl8B', 'timestamp': 1761905043.433859}, {'content': {'parts': [{'functionResponse': {'id': 'call_GzKJdDiZ6nMKVSOEZqEyNpFp', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 110, 'reasoning': 'ポットオッズを満たしており（75.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 110'}}}, {'functionResponse': {'id': 'call_erjNWnDpAE0pRUsTORpe22Yr', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 110, 'reasoning': 'ポットオッズを満たしており（75.00(ポットに対して50.00%）、コールが妥当と判断。コール額: 110'}}}], 'role': 'user'}, 'invocationId': 'OukM6Smb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'yAxYrYx7', 'timestamp': 1761905061.962506}, {'content': {'parts': [{'text': '{"action":"call","amount":110,"reasoning":"ポットオッズを満たしており(75.00(ポットに対し50.00%)、コールが妥当と判断。コール額: 110"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 54, 'promptTokenCount': 2695, 'totalTokenCount': 2749}, 'invocationId': 'e-e4e668cf-7afc-4a37-841f-363f82cb8dd6', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'JLqsp9oJ', 'timestamp': 1761905061.965824}]
2025-10-31 19:04:23,910 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:04:23,910 - poker_game - DEBUG - {"action":"call","amount":110,"reasoning":"ポットオッズを満たしており(75.00(ポットに対し50.00%)、コールが妥当と判断。コール額: 110"}
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":110,"reasoning":"ポットオッズを満たしており(75.00(ポットに対し50.00%)、コールが妥当と判断。コール額: 110"}'
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":110,"reasoning":"ポットオッズを満たしており(75.00(ポットに対し50.00%)、コールが妥当と判断。コール額: 110"}
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 110, 'reasoning': 'ポットオッズを満たしており(75.00(ポットに対し50.00%)、コールが妥当と判断。コール額: 110'}
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 110
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (110)', 'raise (min 140)', 'all-in (5264)']
2025-10-31 19:04:23,911 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (110)': 110
2025-10-31 19:04:23,912 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 110}
2025-10-31 19:04:23,912 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 110, ポットオッズを満たしており(75.00(ポットに対し50.00%)、コールが妥当と判断。コール額: 110
2025-10-31 19:04:23,913 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 110
2025-10-31 19:04:23,913 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:04:23,913 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:23,913 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:04:23,914 - poker_game - INFO - Pot: 150, Current bet: 120
2025-10-31 19:04:23,914 - poker_game - INFO - Last raiser: 3
2025-10-31 19:04:23,914 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:23,914 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:23,914 - poker_game - INFO - Community cards: []
2025-10-31 19:04:23,914 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:23,914 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:04:23,914 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:23,915 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:04:23,915 - poker_game - INFO -   P4(Agent4): chips=5264, bet=10, status=active
2025-10-31 19:04:23,915 - poker_game - INFO - ==================================================
2025-10-31 19:04:23,915 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 110
2025-10-31 19:04:23,925 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:04:23,926 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:23,926 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:04:23,926 - poker_game - INFO - Pot: 260, Current bet: 120
2025-10-31 19:04:23,926 - poker_game - INFO - Last raiser: 3
2025-10-31 19:04:23,926 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:23,927 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:23,927 - poker_game - INFO - Community cards: []
2025-10-31 19:04:23,927 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:23,927 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:04:23,927 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:23,927 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:04:23,927 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:23,928 - poker_game - INFO - Extra: Action: Player 4 called 110
2025-10-31 19:04:23,928 - poker_game - INFO - ==================================================
2025-10-31 19:04:23,928 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:04:23,928 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:04:23,928 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:04:23,929 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:04:23,929 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:04:23,929 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:04:23,929 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:04:23,929 - poker_game - DEBUG - Player bets: [20, 120, 120], Current bet: 120, All same: False
2025-10-31 19:04:23,929 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:04:23,929 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:04:23,930 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:23,930 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:04:23,930 - poker_game - INFO - Pot: 260, Current bet: 120
2025-10-31 19:04:23,930 - poker_game - INFO - Last raiser: 3
2025-10-31 19:04:23,930 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:23,931 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:23,931 - poker_game - INFO - Community cards: []
2025-10-31 19:04:23,931 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:23,931 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:04:23,933 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:23,933 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:04:23,933 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:23,933 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:04:23,933 - poker_game - INFO - ==================================================
2025-10-31 19:04:24,035 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "A♥",
    "J♥"
  ],
  "community": [],
  "your_chips": 3259,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 260,
  "to_call": 100,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 1327,
      "bet": 120,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5154,
      "bet": 120,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (100)",
    "raise (min 140)",
    "all-in (3259)"
  ],
  "history": [
    "Player 4 raised to 105",
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110"
  ]
}
2025-10-31 19:04:24,045 - poker_game - DEBUG - Create Session: {'id': '6534abb1-f1d9-4db1-a45d-a7e07f40466a', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905064.0428493}
2025-10-31 19:04:23,693 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 300,\n  "reasoning": "AKs (エースとキングのスーツが同じ) は、プリフロップで非常に強力なハンドです。相手がリレイズ（さらにベットを上げる）してきた状況ですが、ポットも大きくなっており、このハンドで勝負する価値は十分にあります。コールして様子を見ることもできますが、このハンドの強さを活かすために、さらにレイズして相手にプレッシャーをかけます。レイズ額は、相手がコールしやすい範囲にしつつ、ポットを大きくすることを狙います。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 138, 'promptTokenCount': 789, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 789}], 'totalTokenCount': 927}, 'invocationId': 'e-ac636b18-b8b4-46cc-b710-f287245c68ae', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'YztfmmWS', 'timestamp': 1761905064.054939}]
2025-10-31 19:04:23,693 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:04:23,693 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 300,
  "reasoning": "AKs (エースとキングのスーツが同じ) は、プリフロップで非常に強力なハンドです。相手がリレイズ（さらにベットを上げる）してきた状況ですが、ポットも大きくなっており、このハンドで勝負する価値は十分にあります。コールして様子を見ることもできますが、このハンドの強さを活かすために、さらにレイズして相手にプレッシャーをかけます。レイズ額は、相手がコールしやすい範囲にしつつ、ポットを大きくすることを狙います。"
}
```
2025-10-31 19:04:23,693 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:04:23,693 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 300,\n  "reasoning": "AKs (エースとキングのスーツが同じ) は、プリフロップで非常に強力なハンドです。相手がリレイズ（さらにベットを上げる）してきた状況ですが、ポットも大きくなっており、このハンドで勝負する価値は十分にあります。コールして様子を見ることもできますが、このハンドの強さを活かすために、さらにレイズして相手にプレッシャーをかけます。レイズ額は、相手がコールしやすい範囲にしつつ、ポットを大きくすることを狙います。"\n}\n```'
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 300,\n  "reasoning": "AKs (エースとキングのスーツが同じ) は、プリフロップで非常に強力なハンドです。相手がリレイズ（さらにベットを上げる）してきた状況ですが、ポットも大きくなっており、このハンドで勝負する価値は十分にあります。コールして様子を見ることもできますが、このハンドの強さを活かすために、さらにレイズして相手にプレッシャーをかけます。レイズ額は、相手がコールしやすい範囲にしつつ、ポットを大きくすることを狙います。"\n}'
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 300,
  "reasoning": "AKs (エースとキングのスーツが同じ) は、プリフロップで非常に強力なハンドです。相手がリレイズ（さらにベットを上げる）してきた状況ですが、ポットも大きくなっており、このハンドで勝負する価値は十分にあります。コールして様子を見ることもできますが、このハンドの強さを活かすために、さらにレイズして相手にプレッシャーをかけます。レイズ額は、相手がコールしやすい範囲にしつつ、ポットを大きくすることを狙います。"
}
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 300, 'reasoning': 'AKs (エースとキングのスーツが同じ) は、プリフロップで非常に強力なハンドです。相手がリレイズ（さらにベットを上げる）してきた状況ですが、ポットも大きくなっており、このハンドで勝負する価値は十分にあります。コールして様子を見ることもできますが、このハンドの強さを活かすために、さらにレイズして相手にプレッシャーをかけます。レイズ額は、相手がコールしやすい範囲にしつつ、ポットを大きくすることを狙います。'}
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 300
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'call (100)', 'raise (min 140)', 'all-in (3259)']
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 140)': 140
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] Raise amount 300 is valid (min: 140)
2025-10-31 19:04:23,694 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 300}
2025-10-31 19:04:23,694 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 300, AKs (エースとキングのスーツが同じ) は、プリフロップで非常に強力なハンドです。相手がリレイズ（さらにベットを上げる）してきた状況ですが、ポットも大きくなっており、このハンドで勝負する価値は十分にあります。コールして様子を見ることもできますが、このハンドの強さを活かすために、さらにレイズして相手にプレッシャーをかけます。レイズ額は、相手がコールしやすい範囲にしつつ、ポットを大きくすることを狙います。
2025-10-31 19:04:23,695 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 300
2025-10-31 19:04:23,695 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:04:23,695 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:23,695 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:04:23,695 - poker_game - INFO - Pot: 260, Current bet: 120
2025-10-31 19:04:23,695 - poker_game - INFO - Last raiser: 3
2025-10-31 19:04:23,695 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:23,696 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:23,696 - poker_game - INFO - Community cards: []
2025-10-31 19:04:23,696 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:23,696 - poker_game - INFO -   P1(Agent1): chips=3259, bet=20, status=active
2025-10-31 19:04:23,696 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:23,696 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:04:23,696 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:23,696 - poker_game - INFO - ==================================================
2025-10-31 19:04:23,697 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 420
2025-10-31 19:04:23,729 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:04:23,730 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:23,730 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:04:23,730 - poker_game - INFO - Pot: 660, Current bet: 420
2025-10-31 19:04:23,731 - poker_game - INFO - Last raiser: 1
2025-10-31 19:04:23,731 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:23,731 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:23,731 - poker_game - INFO - Community cards: []
2025-10-31 19:04:23,731 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:23,732 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:23,732 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:23,732 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:04:23,732 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:23,732 - poker_game - INFO - Extra: Action: Player 1 raised to 420
2025-10-31 19:04:23,733 - poker_game - INFO - ==================================================
2025-10-31 19:04:23,733 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:04:23,733 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:04:23,733 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:04:23,733 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:04:23,734 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:04:23,734 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:04:23,734 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:04:23,734 - poker_game - DEBUG - Player bets: [420, 120, 120], Current bet: 420, All same: False
2025-10-31 19:04:23,734 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:04:23,734 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:04:23,734 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:23,735 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:04:23,735 - poker_game - INFO - Pot: 660, Current bet: 420
2025-10-31 19:04:23,735 - poker_game - INFO - Last raiser: 1
2025-10-31 19:04:23,735 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:23,735 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:23,742 - poker_game - INFO - Community cards: []
2025-10-31 19:04:23,743 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:23,743 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:23,744 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:23,746 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:04:23,746 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:23,746 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:04:23,747 - poker_game - INFO - ==================================================
2025-10-31 19:04:23,848 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "2♠",
    "K♠"
  ],
  "community": [],
  "your_chips": 1327,
  "your_bet_this_round": 120,
  "your_total_bet_this_hand": 120,
  "pot": 660,
  "to_call": 300,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2859,
      "bet": 420,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 5154,
      "bet": 120,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (300)",
    "raise (min 440)",
    "all-in (1327)"
  ],
  "history": [
    "Player 1 raised to 405",
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420"
  ]
}
2025-10-31 19:04:23,861 - poker_game - DEBUG - Create Session: {'id': 'a287a7e1-b424-4974-af78-faebfe178ea5', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905063.8591585}
2025-10-31 19:04:26,126 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 420,\n  "reasoning": "K♠ 2♠ は、プリフロップ（フロップが開かれる前の段階）ではまずまずのハンドです。ポットが大きく、相手のプレイヤー1がすでに420をベットしている状況（レイズ）ですので、コール（相手のベット額と同額を支払うこと）するよりも、さらにレイズ（ベット額をさらに増やすこと）してポットを大きくし、相手にプレッシャーをかけるのが有利だと判断しました。相手のベット額と同額をコールするよりも、このハンドの強さを活かしてポットを大きくすることが、長期的に見て利益につながる可能性が高いからです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 162, 'promptTokenCount': 791, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 791}], 'totalTokenCount': 953}, 'invocationId': 'e-7f70737c-fa1d-454c-8600-a0f8d702e6a9', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'f5H2rJsP', 'timestamp': 1761905063.868809}]
2025-10-31 19:04:26,126 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:04:26,126 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 420,
  "reasoning": "K♠ 2♠ は、プリフロップ（フロップが開かれる前の段階）ではまずまずのハンドです。ポットが大きく、相手のプレイヤー1がすでに420をベットしている状況（レイズ）ですので、コール（相手のベット額と同額を支払うこと）するよりも、さらにレイズ（ベット額をさらに増やすこと）してポットを大きくし、相手にプレッシャーをかけるのが有利だと判断しました。相手のベット額と同額をコールするよりも、このハンドの強さを活かしてポットを大きくすることが、長期的に見て利益につながる可能性が高いからです。"
}
```
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 420,\n  "reasoning": "K♠ 2♠ は、プリフロップ（フロップが開かれる前の段階）ではまずまずのハンドです。ポットが大きく、相手のプレイヤー1がすでに420をベットしている状況（レイズ）ですので、コール（相手のベット額と同額を支払うこと）するよりも、さらにレイズ（ベット額をさらに増やすこと）してポットを大きくし、相手にプレッシャーをかけるのが有利だと判断しました。相手のベット額と同額をコールするよりも、このハンドの強さを活かしてポットを大きくすることが、長期的に見て利益につながる可能性が高いからです。"\n}\n```'
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 420,\n  "reasoning": "K♠ 2♠ は、プリフロップ（フロップが開かれる前の段階）ではまずまずのハンドです。ポットが大きく、相手のプレイヤー1がすでに420をベットしている状況（レイズ）ですので、コール（相手のベット額と同額を支払うこと）するよりも、さらにレイズ（ベット額をさらに増やすこと）してポットを大きくし、相手にプレッシャーをかけるのが有利だと判断しました。相手のベット額と同額をコールするよりも、このハンドの強さを活かしてポットを大きくすることが、長期的に見て利益につながる可能性が高いからです。"\n}'
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 420,
  "reasoning": "K♠ 2♠ は、プリフロップ（フロップが開かれる前の段階）ではまずまずのハンドです。ポットが大きく、相手のプレイヤー1がすでに420をベットしている状況（レイズ）ですので、コール（相手のベット額と同額を支払うこと）するよりも、さらにレイズ（ベット額をさらに増やすこと）してポットを大きくし、相手にプレッシャーをかけるのが有利だと判断しました。相手のベット額と同額をコールするよりも、このハンドの強さを活かしてポットを大きくすることが、長期的に見て利益につながる可能性が高いからです。"
}
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 420, 'reasoning': 'K♠ 2♠ は、プリフロップ（フロップが開かれる前の段階）ではまずまずのハンドです。ポットが大きく、相手のプレイヤー1がすでに420をベットしている状況（レイズ）ですので、コール（相手のベット額と同額を支払うこと）するよりも、さらにレイズ（ベット額をさらに増やすこと）してポットを大きくし、相手にプレッシャーをかけるのが有利だと判断しました。相手のベット額と同額をコールするよりも、このハンドの強さを活かしてポットを大きくすることが、長期的に見て利益につながる可能性が高いからです。'}
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 420
2025-10-31 19:04:26,127 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'call (300)', 'raise (min 440)', 'all-in (1327)']
2025-10-31 19:04:26,128 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 440)': 440
2025-10-31 19:04:26,128 - poker_game - DEBUG - [Agent3] Adjusting raise amount from 420 to minimum 440
2025-10-31 19:04:26,128 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 440}
2025-10-31 19:04:26,128 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 440, K♠ 2♠ は、プリフロップ（フロップが開かれる前の段階）ではまずまずのハンドです。ポットが大きく、相手のプレイヤー1がすでに420をベットしている状況（レイズ）ですので、コール（相手のベット額と同額を支払うこと）するよりも、さらにレイズ（ベット額をさらに増やすこと）してポットを大きくし、相手にプレッシャーをかけるのが有利だと判断しました。相手のベット額と同額をコールするよりも、このハンドの強さを活かしてポットを大きくすることが、長期的に見て利益につながる可能性が高いからです。
2025-10-31 19:04:26,129 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 440
2025-10-31 19:04:26,129 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:04:26,129 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:26,129 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:04:26,129 - poker_game - INFO - Pot: 660, Current bet: 420
2025-10-31 19:04:26,130 - poker_game - INFO - Last raiser: 1
2025-10-31 19:04:26,130 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:26,130 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:26,130 - poker_game - INFO - Community cards: []
2025-10-31 19:04:26,130 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:26,131 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:26,131 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:26,131 - poker_game - INFO -   P3(Agent3): chips=1327, bet=120, status=active
2025-10-31 19:04:26,131 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:26,131 - poker_game - INFO - ==================================================
2025-10-31 19:04:26,132 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 860
2025-10-31 19:04:26,161 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:04:26,161 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:26,161 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:04:26,162 - poker_game - INFO - Pot: 1400, Current bet: 860
2025-10-31 19:04:26,162 - poker_game - INFO - Last raiser: 3
2025-10-31 19:04:26,162 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:26,162 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:26,162 - poker_game - INFO - Community cards: []
2025-10-31 19:04:26,162 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:26,163 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:26,163 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:26,163 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:26,163 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:26,163 - poker_game - INFO - Extra: Action: Player 3 raised to 860
2025-10-31 19:04:26,163 - poker_game - INFO - ==================================================
2025-10-31 19:04:26,163 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:04:26,163 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:04:26,163 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:04:26,163 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:04:26,164 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:04:26,164 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:04:26,164 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:04:26,164 - poker_game - DEBUG - Player bets: [420, 860, 120], Current bet: 860, All same: False
2025-10-31 19:04:26,164 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:04:26,164 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:04:26,164 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:26,164 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:04:26,165 - poker_game - INFO - Pot: 1400, Current bet: 860
2025-10-31 19:04:26,165 - poker_game - INFO - Last raiser: 3
2025-10-31 19:04:26,165 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:26,165 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:26,165 - poker_game - INFO - Community cards: []
2025-10-31 19:04:26,165 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:26,166 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:26,166 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:26,166 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:26,166 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:26,166 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:04:26,166 - poker_game - INFO - ==================================================
2025-10-31 19:04:26,267 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "4♠",
    "4♦"
  ],
  "community": [],
  "your_chips": 5154,
  "your_bet_this_round": 120,
  "your_total_bet_this_hand": 120,
  "pot": 1400,
  "to_call": 740,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2859,
      "bet": 420,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 587,
      "bet": 860,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (740)",
    "raise (min 880)",
    "all-in (5154)"
  ],
  "history": [
    "Player 4 folded",
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860"
  ]
}
2025-10-31 19:04:26,281 - poker_game - DEBUG - Create Session: {'id': '87673af5-36e3-49ca-b1ac-eb01bae467f8', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905066.2794106}
2025-10-31 19:04:36,382 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:04:46,388 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:04:56,300 - poker_game - INFO - Waiting for LLM API response for Agent4... 30 seconds elapsed
2025-10-31 19:04:56,558 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_urJH79wH2FNZ5DNe2vmK6sda', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1088, 'totalTokenCount': 1105}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'FDFrNZAl', 'timestamp': 1761905066.291734}, {'content': {'parts': [{'functionResponse': {'id': 'call_urJH79wH2FNZ5DNe2vmK6sda', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'A5bg2q7R', 'timestamp': 1761905067.393735}, {'content': {'parts': [{'functionCall': {'id': 'call_Iy6hEkL03lkuCpjvzJ6rzppH', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1612, 'totalTokenCount': 1632}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'Z5Xz8uq0', 'timestamp': 1761905067.396212}, {'content': {'parts': [{'functionResponse': {'id': 'call_Iy6hEkL03lkuCpjvzJ6rzppH', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'Hi5zmHHf', 'timestamp': 1761905068.532453}, {'content': {'parts': [{'functionCall': {'id': 'call_jskEt4JmKPQcpqybCyJskVG3', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1174, 'totalTokenCount': 1191}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'UT4Bzb34', 'timestamp': 1761905068.533873}, {'content': {'parts': [{'functionResponse': {'id': 'call_jskEt4JmKPQcpqybCyJskVG3', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'VLoMMLWI', 'timestamp': 1761905069.652716}, {'content': {'parts': [{'functionCall': {'id': 'call_xGnMlcwB2GtdqZuW84CcuS10', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1704, 'totalTokenCount': 1724}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'scmTpJFh', 'timestamp': 1761905069.656474}, {'content': {'parts': [{'functionResponse': {'id': 'call_xGnMlcwB2GtdqZuW84CcuS10', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'NQdeAIjX', 'timestamp': 1761905070.9134}, {'content': {'parts': [{'functionCall': {'id': 'call_riS0QS7rM9Hndkhwai3zm3Ct', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1260, 'totalTokenCount': 1277}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'knvEwyla', 'timestamp': 1761905070.915051}, {'content': {'parts': [{'functionResponse': {'id': 'call_riS0QS7rM9Hndkhwai3zm3Ct', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '3pYVz4Yq', 'timestamp': 1761905072.161603}, {'content': {'parts': [{'functionCall': {'id': 'call_b3FwiBvtH8vK81OwIK5LldLJ', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1796, 'totalTokenCount': 1816}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'o40SCgO4', 'timestamp': 1761905072.164369}, {'content': {'parts': [{'functionResponse': {'id': 'call_b3FwiBvtH8vK81OwIK5LldLJ', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'lZXAcafl', 'timestamp': 1761905073.309472}, {'content': {'parts': [{'functionCall': {'id': 'call_RgHMcIzUzhOYat3mS5DqD8G5', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1346, 'totalTokenCount': 1363}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'RGzEpr70', 'timestamp': 1761905073.311644}, {'content': {'parts': [{'functionResponse': {'id': 'call_RgHMcIzUzhOYat3mS5DqD8G5', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'DlcqW630', 'timestamp': 1761905074.660292}, {'content': {'parts': [{'functionCall': {'id': 'call_KHVkmAuWBQWVBVUtTUWaGPuW', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1888, 'totalTokenCount': 1908}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'VcgcsUu6', 'timestamp': 1761905074.666418}, {'content': {'parts': [{'functionResponse': {'id': 'call_KHVkmAuWBQWVBVUtTUWaGPuW', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'F7uernNL', 'timestamp': 1761905075.914617}, {'content': {'parts': [{'functionCall': {'id': 'call_nRICGsPSIunKbMR9S6yCQXc8', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1432, 'totalTokenCount': 1449}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '39EXyZmV', 'timestamp': 1761905075.91689}, {'content': {'parts': [{'functionResponse': {'id': 'call_nRICGsPSIunKbMR9S6yCQXc8', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'lvaUNw7r', 'timestamp': 1761905077.081208}, {'content': {'parts': [{'functionCall': {'id': 'call_UtZFuv9EwnaVAiIUh2yl4MzC', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1980, 'totalTokenCount': 2000}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'jNPEW2JJ', 'timestamp': 1761905077.084674}, {'content': {'parts': [{'functionResponse': {'id': 'call_UtZFuv9EwnaVAiIUh2yl4MzC', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'SMxyHOVF', 'timestamp': 1761905078.234196}, {'content': {'parts': [{'functionCall': {'id': 'call_x09fiq9NZGD53fe9X8tQ0jKq', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1518, 'totalTokenCount': 1535}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '3Hfikr8l', 'timestamp': 1761905078.242174}, {'content': {'parts': [{'functionResponse': {'id': 'call_x09fiq9NZGD53fe9X8tQ0jKq', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'atTfp7ic', 'timestamp': 1761905079.791044}, {'content': {'parts': [{'functionCall': {'id': 'call_pWAWNNP8I3x2MPCxXngF16tn', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 2072, 'totalTokenCount': 2092}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'n5m2n7Bc', 'timestamp': 1761905079.795247}, {'content': {'parts': [{'functionResponse': {'id': 'call_pWAWNNP8I3x2MPCxXngF16tn', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '548liApJ', 'timestamp': 1761905081.367779}, {'content': {'parts': [{'functionCall': {'id': 'call_EVq8l7EAMZXHCt9FHCrPgwjI', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}, {'functionCall': {'id': 'call_Ru9ioKjZkC2ZSGCRScbbUToM', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 50, 'promptTokenCount': 1604, 'totalTokenCount': 1654}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'HzuWmroi', 'timestamp': 1761905081.372184}, {'content': {'parts': [{'functionResponse': {'id': 'call_EVq8l7EAMZXHCt9FHCrPgwjI', 'name': 'transfer_to_agent', 'response': {'result': None}}}, {'functionResponse': {'id': 'call_Ru9ioKjZkC2ZSGCRScbbUToM', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'oaR1ZNzf', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'RugCpObs', 'timestamp': 1761905087.729544}, {'content': {'parts': [{'functionCall': {'id': 'call_mE1UPMgxGRCgdQH6bulndGFW', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['4♠', '4♦'], 'community': [], 'your_chips': 5154, 'your_bet_this_round': 120, 'your_total_bet_this_hand': 120, 'pot': 1400, 'to_call': 740, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2859, 'bet': 420, 'status': 'active'}, {'id': 3, 'chips': 587, 'bet': 860, 'status': 'active'}], 'actions': ['fold', 'call (740)', 'raise (min 880)', 'all-in (5154)'], 'history': ['Player 4 folded', 'Showdown: Player 1 won 670', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 called 10', 'Player 3 raised to 100', 'Player 1 folded', 'Showdown: Player 3 won 120', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 raised to 120', 'Player 4 called 110', 'Player 1 raised to 420', 'Player 3 raised to 860']}, 'call_amount': 740, 'pot_after_call': 2140, 'equity': 0.7}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 321, 'promptTokenCount': 2209, 'totalTokenCount': 2530}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'LCOf0EmP', 'timestamp': 1761905087.744202}, {'content': {'parts': [{'functionResponse': {'id': 'call_mE1UPMgxGRCgdQH6bulndGFW', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 1850, 'reasoning': '期待値が高い（1276.00(ポットに対して91.14%）ため、2.5倍でバリューレイズします。レイズ額: 1850'}}}], 'role': 'user'}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'CThMeqOD', 'timestamp': 1761905094.282476}, {'content': {'parts': [{'text': '{"action":"raise","amount":1850,"reasoning":"期待値が高い（1276.00(ポットに対して91.14%）ため、2.5倍でバリューレイズします。レイズ額: 1850"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 58, 'promptTokenCount': 2601, 'totalTokenCount': 2659}, 'invocationId': 'e-062e5350-2738-4c34-ac88-2e712ae80350', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'aIaDWzUz', 'timestamp': 1761905094.286299}]
2025-10-31 19:04:56,559 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:04:56,560 - poker_game - DEBUG - {"action":"raise","amount":1850,"reasoning":"期待値が高い（1276.00(ポットに対して91.14%）ため、2.5倍でバリューレイズします。レイズ額: 1850"}
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":1850,"reasoning":"期待値が高い（1276.00(ポットに対して91.14%）ため、2.5倍でバリューレイズします。レイズ額: 1850"}'
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":1850,"reasoning":"期待値が高い（1276.00(ポットに対して91.14%）ため、2.5倍でバリューレイズします。レイズ額: 1850"}
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 1850, 'reasoning': '期待値が高い（1276.00(ポットに対して91.14%）ため、2.5倍でバリューレイズします。レイズ額: 1850'}
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 1850
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'call (740)', 'raise (min 880)', 'all-in (5154)']
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 880)': 880
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] Raise amount 1850 is valid (min: 880)
2025-10-31 19:04:56,561 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 1850}
2025-10-31 19:04:56,561 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 1850, 期待値が高い（1276.00(ポットに対して91.14%）ため、2.5倍でバリューレイズします。レイズ額: 1850
2025-10-31 19:04:56,562 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 1850
2025-10-31 19:04:56,562 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:04:56,563 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:56,563 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:04:56,563 - poker_game - INFO - Pot: 1400, Current bet: 860
2025-10-31 19:04:56,563 - poker_game - INFO - Last raiser: 3
2025-10-31 19:04:56,563 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:56,563 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:56,564 - poker_game - INFO - Community cards: []
2025-10-31 19:04:56,564 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:56,564 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:56,564 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:56,564 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:56,565 - poker_game - INFO -   P4(Agent4): chips=5154, bet=120, status=active
2025-10-31 19:04:56,565 - poker_game - INFO - ==================================================
2025-10-31 19:04:56,565 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 2710
2025-10-31 19:04:56,574 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:04:56,574 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:56,574 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:04:56,575 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:04:56,575 - poker_game - INFO - Last raiser: 4
2025-10-31 19:04:56,575 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:56,575 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:56,575 - poker_game - INFO - Community cards: []
2025-10-31 19:04:56,576 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:56,576 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:56,576 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:56,576 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:56,576 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:04:56,577 - poker_game - INFO - Extra: Action: Player 4 raised to 2710
2025-10-31 19:04:56,577 - poker_game - INFO - ==================================================
2025-10-31 19:04:56,577 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:04:56,577 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:04:56,577 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:04:56,577 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:04:56,578 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:04:56,578 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:04:56,578 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:04:56,578 - poker_game - DEBUG - Player bets: [420, 860, 2710], Current bet: 2710, All same: False
2025-10-31 19:04:56,578 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:04:56,578 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:04:56,578 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:56,578 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:04:56,578 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:04:56,579 - poker_game - INFO - Last raiser: 4
2025-10-31 19:04:56,579 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:56,579 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:56,579 - poker_game - INFO - Community cards: []
2025-10-31 19:04:56,580 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:56,580 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:56,580 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:56,580 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:56,580 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:04:56,580 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:04:56,580 - poker_game - INFO - ==================================================
2025-10-31 19:04:56,682 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "A♥",
    "J♥"
  ],
  "community": [],
  "your_chips": 2859,
  "your_bet_this_round": 420,
  "your_total_bet_this_hand": 420,
  "pot": 3990,
  "to_call": 2290,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 587,
      "bet": 860,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 2564,
      "bet": 2710,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (2290)",
    "raise (min 2730)",
    "all-in (2859)"
  ],
  "history": [
    "Showdown: Player 1 won 670",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710"
  ]
}
2025-10-31 19:04:56,693 - poker_game - DEBUG - Create Session: {'id': '5950de73-0d70-463d-ac5e-c315c7d86512', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905096.691127}
2025-10-31 19:04:58,755 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 2859,\n  "reasoning": "A♥J♥は非常に強力なハンド（プレミアムハンド）であり、特にプリフロップ（フロップが開く前）では、レイズする価値が高いです。対戦相手がすでに大きなベットをしているため、こちらもレイズで対抗するのが最善です。オールイン（全額ベット）を選択するのは、相手のベット額に対して、自分のチップ量で有利に戦うための戦略です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 118, 'promptTokenCount': 801, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 801}], 'totalTokenCount': 919}, 'invocationId': 'e-dfdd0226-c596-44fa-9506-603672f97c13', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '8pp1emMM', 'timestamp': 1761905096.700994}]
2025-10-31 19:04:58,756 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:04:58,756 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 2859,
  "reasoning": "A♥J♥は非常に強力なハンド（プレミアムハンド）であり、特にプリフロップ（フロップが開く前）では、レイズする価値が高いです。対戦相手がすでに大きなベットをしているため、こちらもレイズで対抗するのが最善です。オールイン（全額ベット）を選択するのは、相手のベット額に対して、自分のチップ量で有利に戦うための戦略です。"
}
```
2025-10-31 19:04:58,757 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:04:58,757 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 2859,\n  "reasoning": "A♥J♥は非常に強力なハンド（プレミアムハンド）であり、特にプリフロップ（フロップが開く前）では、レイズする価値が高いです。対戦相手がすでに大きなベットをしているため、こちらもレイズで対抗するのが最善です。オールイン（全額ベット）を選択するのは、相手のベット額に対して、自分のチップ量で有利に戦うための戦略です。"\n}\n```'
2025-10-31 19:04:58,757 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:04:58,757 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 2859,\n  "reasoning": "A♥J♥は非常に強力なハンド（プレミアムハンド）であり、特にプリフロップ（フロップが開く前）では、レイズする価値が高いです。対戦相手がすでに大きなベットをしているため、こちらもレイズで対抗するのが最善です。オールイン（全額ベット）を選択するのは、相手のベット額に対して、自分のチップ量で有利に戦うための戦略です。"\n}'
2025-10-31 19:04:58,758 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 2859,
  "reasoning": "A♥J♥は非常に強力なハンド（プレミアムハンド）であり、特にプリフロップ（フロップが開く前）では、レイズする価値が高いです。対戦相手がすでに大きなベットをしているため、こちらもレイズで対抗するのが最善です。オールイン（全額ベット）を選択するのは、相手のベット額に対して、自分のチップ量で有利に戦うための戦略です。"
}
2025-10-31 19:04:58,758 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 2859, 'reasoning': 'A♥J♥は非常に強力なハンド（プレミアムハンド）であり、特にプリフロップ（フロップが開く前）では、レイズする価値が高いです。対戦相手がすでに大きなベットをしているため、こちらもレイズで対抗するのが最善です。オールイン（全額ベット）を選択するのは、相手のベット額に対して、自分のチップ量で有利に戦うための戦略です。'}
2025-10-31 19:04:58,759 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 2859
2025-10-31 19:04:58,759 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'call (2290)', 'raise (min 2730)', 'all-in (2859)']
2025-10-31 19:04:58,759 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 2730)': 2730
2025-10-31 19:04:58,759 - poker_game - DEBUG - [Agent1] Raise amount 2859 is valid (min: 2730)
2025-10-31 19:04:58,759 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 2859}
2025-10-31 19:04:58,760 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 2859, A♥J♥は非常に強力なハンド（プレミアムハンド）であり、特にプリフロップ（フロップが開く前）では、レイズする価値が高いです。対戦相手がすでに大きなベットをしているため、こちらもレイズで対抗するのが最善です。オールイン（全額ベット）を選択するのは、相手のベット額に対して、自分のチップ量で有利に戦うための戦略です。
2025-10-31 19:04:58,761 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 2859
2025-10-31 19:04:58,761 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:04:58,762 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:58,762 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:04:58,762 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:04:58,763 - poker_game - INFO - Last raiser: 4
2025-10-31 19:04:58,763 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:58,764 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:58,764 - poker_game - INFO - Community cards: []
2025-10-31 19:04:58,764 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:58,765 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:58,765 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:58,766 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:58,766 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:04:58,767 - poker_game - INFO - ==================================================
2025-10-31 19:04:58,767 - poker_game - WARNING - Player 1 cannot raise - needs 5149, has 2859
2025-10-31 19:04:58,767 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 19:04:58,768 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:04:58,768 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:58,769 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:04:58,769 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:04:58,770 - poker_game - INFO - Last raiser: 4
2025-10-31 19:04:58,770 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:58,771 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:04:58,772 - poker_game - INFO - Community cards: []
2025-10-31 19:04:58,772 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:58,773 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=active
2025-10-31 19:04:58,773 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:58,774 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:58,774 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:04:58,775 - poker_game - INFO - ==================================================
2025-10-31 19:04:58,776 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 19:04:58,787 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:04:58,788 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:58,788 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:04:58,789 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:04:58,789 - poker_game - INFO - Last raiser: 4
2025-10-31 19:04:58,790 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:58,790 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:04:58,791 - poker_game - INFO - Community cards: []
2025-10-31 19:04:58,791 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:58,792 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=folded
2025-10-31 19:04:58,792 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:58,793 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:58,793 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:04:58,793 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 19:04:58,794 - poker_game - INFO - ==================================================
2025-10-31 19:04:58,794 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:04:58,794 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:04:58,795 - poker_game - DEBUG - Active players: [3, 4]
2025-10-31 19:04:58,795 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:04:58,795 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:04:58,796 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:04:58,796 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:04:58,796 - poker_game - DEBUG - Player bets: [860, 2710], Current bet: 2710, All same: False
2025-10-31 19:04:58,796 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:04:58,797 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:04:58,797 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:04:58,797 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:04:58,798 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:04:58,799 - poker_game - INFO - Last raiser: 4
2025-10-31 19:04:58,799 - poker_game - INFO - Betting round complete: False
2025-10-31 19:04:58,799 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:04:58,800 - poker_game - INFO - Community cards: []
2025-10-31 19:04:58,800 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:04:58,801 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=folded
2025-10-31 19:04:58,802 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:04:58,803 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:04:58,803 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:04:58,804 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:04:58,804 - poker_game - INFO - ==================================================
2025-10-31 19:04:58,906 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "2♠",
    "K♠"
  ],
  "community": [],
  "your_chips": 587,
  "your_bet_this_round": 860,
  "your_total_bet_this_hand": 860,
  "pot": 3990,
  "to_call": 1850,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2859,
      "bet": 420,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 2564,
      "bet": 2710,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "all-in (587)"
  ],
  "history": [
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 called 10",
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded"
  ]
}
2025-10-31 19:04:58,923 - poker_game - DEBUG - Create Session: {'id': '6d17aafe-a4a0-4d70-b0a4-d816152e395e', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905098.9200382}
2025-10-31 19:05:00,617 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 1850,\n  "reasoning": "K♠2♠はプリフロップで良いハンドです。相手は強力なアクションをしているので、ポットが大きくなる前にコールしてフロップを見ます。プリフロップ（Preflop）は、カードが配られた直後で、コミュニティカード（Community cards：全員で共有するカード）がまだ1枚も場に出ていない状況のことです。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 109, 'promptTokenCount': 771, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 771}], 'totalTokenCount': 880}, 'invocationId': 'e-b8bb816c-f2cc-458e-8af4-e1807230993c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'v0aUmqjR', 'timestamp': 1761905098.934352}]
2025-10-31 19:05:00,617 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:05:00,617 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 1850,
  "reasoning": "K♠2♠はプリフロップで良いハンドです。相手は強力なアクションをしているので、ポットが大きくなる前にコールしてフロップを見ます。プリフロップ（Preflop）は、カードが配られた直後で、コミュニティカード（Community cards：全員で共有するカード）がまだ1枚も場に出ていない状況のことです。"
}
```
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 1850,\n  "reasoning": "K♠2♠はプリフロップで良いハンドです。相手は強力なアクションをしているので、ポットが大きくなる前にコールしてフロップを見ます。プリフロップ（Preflop）は、カードが配られた直後で、コミュニティカード（Community cards：全員で共有するカード）がまだ1枚も場に出ていない状況のことです。"\n}\n```'
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 1850,\n  "reasoning": "K♠2♠はプリフロップで良いハンドです。相手は強力なアクションをしているので、ポットが大きくなる前にコールしてフロップを見ます。プリフロップ（Preflop）は、カードが配られた直後で、コミュニティカード（Community cards：全員で共有するカード）がまだ1枚も場に出ていない状況のことです。"\n}'
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "call",
  "amount": 1850,
  "reasoning": "K♠2♠はプリフロップで良いハンドです。相手は強力なアクションをしているので、ポットが大きくなる前にコールしてフロップを見ます。プリフロップ（Preflop）は、カードが配られた直後で、コミュニティカード（Community cards：全員で共有するカード）がまだ1枚も場に出ていない状況のことです。"
}
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'call', 'amount': 1850, 'reasoning': 'K♠2♠はプリフロップで良いハンドです。相手は強力なアクションをしているので、ポットが大きくなる前にコールしてフロップを見ます。プリフロップ（Preflop）は、カードが配られた直後で、コミュニティカード（Community cards：全員で共有するカード）がまだ1枚も場に出ていない状況のことです。'}
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] Extracted values - action: 'call', amount: 1850
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] Processing call action - available actions: ['fold', 'all-in (587)']
2025-10-31 19:05:00,618 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'call', 'amount': 1850}
2025-10-31 19:05:00,619 - poker_game - INFO - [Agent3] Successfully parsed decision: call, 1850, K♠2♠はプリフロップで良いハンドです。相手は強力なアクションをしているので、ポットが大きくなる前にコールしてフロップを見ます。プリフロップ（Preflop）は、カードが配られた直後で、コミュニティカード（Community cards：全員で共有するカード）がまだ1枚も場に出ていない状況のことです。
2025-10-31 19:05:00,619 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'call' with amount 1850
2025-10-31 19:05:00,619 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:00,620 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:05:00,620 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:05:00,620 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:05:00,620 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:00,620 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:00,620 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:00,620 - poker_game - INFO - Community cards: []
2025-10-31 19:05:00,621 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:00,621 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=folded
2025-10-31 19:05:00,621 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:00,621 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:05:00,621 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:05:00,621 - poker_game - INFO - ==================================================
2025-10-31 19:05:00,621 - poker_game - WARNING - Player 3 cannot call - to_call: 1850, chips: 587
2025-10-31 19:05:00,622 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 19:05:00,622 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:00,622 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:05:00,622 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:05:00,622 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:05:00,622 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:00,622 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:00,623 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:00,623 - poker_game - INFO - Community cards: []
2025-10-31 19:05:00,623 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:00,623 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=folded
2025-10-31 19:05:00,623 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:00,623 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=active
2025-10-31 19:05:00,623 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:05:00,623 - poker_game - INFO - ==================================================
2025-10-31 19:05:00,623 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 19:05:00,639 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:00,639 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:05:00,639 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:05:00,639 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:05:00,640 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:00,640 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:00,640 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:00,640 - poker_game - INFO - Community cards: []
2025-10-31 19:05:00,640 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:00,640 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=folded
2025-10-31 19:05:00,640 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:00,640 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=folded
2025-10-31 19:05:00,640 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:05:00,640 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 19:05:00,640 - poker_game - INFO - ==================================================
2025-10-31 19:05:00,640 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:00,641 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:00,641 - poker_game - DEBUG - Active players: [4]
2025-10-31 19:05:00,641 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:05:00,641 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:00,641 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:00,641 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 19:05:00,641 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 19:05:00,641 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:00,641 - poker_game - INFO - Hand #27, Phase: preflop
2025-10-31 19:05:00,641 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:05:00,641 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:05:00,641 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:00,642 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:00,642 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:00,642 - poker_game - INFO - Community cards: []
2025-10-31 19:05:00,642 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:00,642 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=folded
2025-10-31 19:05:00,642 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:00,642 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=folded
2025-10-31 19:05:00,643 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:05:00,643 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:05:00,643 - poker_game - INFO - ==================================================
2025-10-31 19:05:00,744 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:05:00,744 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:00,745 - poker_game - INFO - Remaining players: 1
2025-10-31 19:05:00,745 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:05:00,745 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 19:05:00,746 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:05:00,746 - poker_game - INFO - Hand #27, Phase: showdown
2025-10-31 19:05:00,746 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:05:00,747 - poker_game - INFO - Pot: 3990, Current bet: 2710
2025-10-31 19:05:00,747 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:00,747 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:00,747 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:00,748 - poker_game - INFO - Community cards: []
2025-10-31 19:05:00,748 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:00,748 - poker_game - INFO -   P1(Agent1): chips=2859, bet=420, status=folded
2025-10-31 19:05:00,749 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:00,749 - poker_game - INFO -   P3(Agent3): chips=587, bet=860, status=folded
2025-10-31 19:05:00,749 - poker_game - INFO -   P4(Agent4): chips=2564, bet=2710, status=active
2025-10-31 19:05:00,750 - poker_game - INFO - ==================================================
2025-10-31 19:05:00,750 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:05:00,750 - poker_game - INFO - Pot: 3990, Community cards: []
2025-10-31 19:05:00,751 - poker_game - INFO -   Player 4 status=active cards=['4♠', '4♦']
2025-10-31 19:05:00,751 - poker_game - INFO - Showdown winner by default: Player 4 awarded 3990
2025-10-31 19:05:00,751 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:05:00,752 - poker_game - INFO - === STARTING NEW HAND #28 ===
2025-10-31 19:05:00,752 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:05:00,753 - poker_game - INFO - Moving dealer button
2025-10-31 19:05:00,753 - poker_game - INFO - Posting blinds
2025-10-31 19:05:00,774 - poker_game - INFO - Dealing hole cards
2025-10-31 19:05:00,775 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:05:00,784 - poker_game - INFO - Started new hand in database: hand_id=28
2025-10-31 19:05:00,784 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:05:00,785 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:00,785 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:05:00,786 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:00,786 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:00,786 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:00,787 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:00,787 - poker_game - INFO - Community cards: []
2025-10-31 19:05:00,788 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:00,788 - poker_game - INFO -   P1(Agent1): chips=2849, bet=10, status=active
2025-10-31 19:05:00,789 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:00,789 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:00,790 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=active
2025-10-31 19:05:00,790 - poker_game - INFO - ==================================================
2025-10-31 19:05:00,791 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "3♠",
    "6♥"
  ],
  "community": [],
  "your_chips": 6554,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 4,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2849,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 567,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (6554)"
  ],
  "history": [
    "Player 3 raised to 100",
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20"
  ]
}
2025-10-31 19:05:00,806 - poker_game - DEBUG - Create Session: {'id': '004eff23-f78c-4ae0-a229-5f68965e36eb', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905100.8044007}
2025-10-31 19:05:10,824 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:05:13,998 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_47W2TuucB4SLuxSinjli8nES', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1090, 'totalTokenCount': 1107}, 'invocationId': 'e-af24f678-4ae4-4007-a81d-dc98b3cad64e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'jxfR1GTY', 'timestamp': 1761905100.81964}, {'content': {'parts': [{'functionResponse': {'id': 'call_47W2TuucB4SLuxSinjli8nES', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-af24f678-4ae4-4007-a81d-dc98b3cad64e', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '4BggBE2d', 'timestamp': 1761905102.630748}, {'content': {'parts': [{'functionCall': {'id': 'call_GcLLBmvmAKSkqHTMoIljq3ac', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['3♠', '6♥'], 'community': [], 'your_chips': 6554, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 0, 'pot': 30, 'to_call': 20, 'dealer_button': 4, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2849, 'bet': 10, 'status': 'active'}, {'id': 3, 'chips': 567, 'bet': 20, 'status': 'active'}], 'actions': ['fold', 'call (20)', 'raise (min 40)', 'all-in (6554)'], 'history': ['Player 3 raised to 100', 'Player 1 folded', 'Showdown: Player 3 won 120', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 30', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 raised to 120', 'Player 4 called 110', 'Player 1 raised to 420', 'Player 3 raised to 860', 'Player 4 raised to 2710', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 3990', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20']}, 'call_amount': 20, 'pot_after_call': 50, 'equity': 0.15}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 322, 'promptTokenCount': 1614, 'totalTokenCount': 1936}, 'invocationId': 'e-af24f678-4ae4-4007-a81d-dc98b3cad64e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'hjatSfxw', 'timestamp': 1761905102.632117}, {'content': {'parts': [{'functionResponse': {'id': 'call_GcLLBmvmAKSkqHTMoIljq3ac', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-9.50(ポットに対して-31.67%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'e-af24f678-4ae4-4007-a81d-dc98b3cad64e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '9hV0tP9t', 'timestamp': 1761905111.960496}, {'content': {'parts': [{'text': '{"action":"fold","amount":0,"reasoning":"期待値が-9.50(ポットに対して-31.67%で、マイナスなのでフォールド"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 41, 'promptTokenCount': 1990, 'totalTokenCount': 2031}, 'invocationId': 'e-af24f678-4ae4-4007-a81d-dc98b3cad64e', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'iwyGhnJ9', 'timestamp': 1761905111.962233}]
2025-10-31 19:05:13,998 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:05:13,999 - poker_game - DEBUG - {"action":"fold","amount":0,"reasoning":"期待値が-9.50(ポットに対して-31.67%で、マイナスなのでフォールド"}
2025-10-31 19:05:13,999 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:05:13,999 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"fold","amount":0,"reasoning":"期待値が-9.50(ポットに対して-31.67%で、マイナスなのでフォールド"}'
2025-10-31 19:05:13,999 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:05:13,999 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"fold","amount":0,"reasoning":"期待値が-9.50(ポットに対して-31.67%で、マイナスなのでフォールド"}
2025-10-31 19:05:14,000 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が-9.50(ポットに対して-31.67%で、マイナスなのでフォールド'}
2025-10-31 19:05:14,000 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 19:05:14,000 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 19:05:14,000 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:05:14,000 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が-9.50(ポットに対して-31.67%で、マイナスなのでフォールド
2025-10-31 19:05:14,001 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 19:05:14,001 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:14,001 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:14,001 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:05:14,001 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:14,001 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:14,002 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:14,002 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:14,002 - poker_game - INFO - Community cards: []
2025-10-31 19:05:14,002 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:14,002 - poker_game - INFO -   P1(Agent1): chips=2849, bet=10, status=active
2025-10-31 19:05:14,002 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:14,003 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:14,003 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=active
2025-10-31 19:05:14,003 - poker_game - INFO - ==================================================
2025-10-31 19:05:14,003 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 19:05:14,020 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:14,020 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:14,024 - poker_game - INFO - Current player: 4, Dealer: 4
2025-10-31 19:05:14,028 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:14,029 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:14,030 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:14,030 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:14,030 - poker_game - INFO - Community cards: []
2025-10-31 19:05:14,030 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:14,031 - poker_game - INFO -   P1(Agent1): chips=2849, bet=10, status=active
2025-10-31 19:05:14,031 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:14,031 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:14,031 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:14,031 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 19:05:14,031 - poker_game - INFO - ==================================================
2025-10-31 19:05:14,031 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:14,031 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:14,031 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:05:14,032 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:05:14,032 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:14,032 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:14,032 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:05:14,032 - poker_game - DEBUG - Player bets: [10, 20], Current bet: 20, All same: False
2025-10-31 19:05:14,032 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:05:14,032 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:14,032 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:14,032 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:05:14,032 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:14,033 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:14,033 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:14,033 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:14,033 - poker_game - INFO - Community cards: []
2025-10-31 19:05:14,033 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:14,033 - poker_game - INFO -   P1(Agent1): chips=2849, bet=10, status=active
2025-10-31 19:05:14,033 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:14,033 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:14,034 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:14,034 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:05:14,034 - poker_game - INFO - ==================================================
2025-10-31 19:05:14,136 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "9♣",
    "A♣"
  ],
  "community": [],
  "your_chips": 2849,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 4,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 567,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6554,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (2849)"
  ],
  "history": [
    "Player 1 folded",
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded"
  ]
}
2025-10-31 19:05:14,145 - poker_game - DEBUG - Create Session: {'id': '7b15f0fc-0a7f-44bc-945a-ffa8bd613a34', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905114.1436198}
2025-10-31 19:05:16,481 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "A♣9♣ は、フロップ前の状況では非常に強いハンドです（「エース」と「クラブ」のスーツ）。ポットは現在30ですが、プレイヤー3はすでに20をベットしており、コールするには10必要です。このハンドでさらにポジションを有利にするために、レイズして、相手にプレッシャーをかけ、ポットを大きくします。レイズ額は、相手がコールするのに十分なプレッシャーを与えつつ、自分のチップを過剰にリスクにさらさないように、最小レイズ額である40に設定します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 151, 'promptTokenCount': 780, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 780}], 'totalTokenCount': 931}, 'invocationId': 'e-0461f725-8b67-4cdb-bad1-31dedaa58097', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'aa0ygfUY', 'timestamp': 1761905114.156146}]
2025-10-31 19:05:16,482 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:05:16,482 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 40,
  "reasoning": "A♣9♣ は、フロップ前の状況では非常に強いハンドです（「エース」と「クラブ」のスーツ）。ポットは現在30ですが、プレイヤー3はすでに20をベットしており、コールするには10必要です。このハンドでさらにポジションを有利にするために、レイズして、相手にプレッシャーをかけ、ポットを大きくします。レイズ額は、相手がコールするのに十分なプレッシャーを与えつつ、自分のチップを過剰にリスクにさらさないように、最小レイズ額である40に設定します。"
}
```
2025-10-31 19:05:16,482 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:05:16,482 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "A♣9♣ は、フロップ前の状況では非常に強いハンドです（「エース」と「クラブ」のスーツ）。ポットは現在30ですが、プレイヤー3はすでに20をベットしており、コールするには10必要です。このハンドでさらにポジションを有利にするために、レイズして、相手にプレッシャーをかけ、ポットを大きくします。レイズ額は、相手がコールするのに十分なプレッシャーを与えつつ、自分のチップを過剰にリスクにさらさないように、最小レイズ額である40に設定します。"\n}\n```'
2025-10-31 19:05:16,482 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:05:16,482 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 40,\n  "reasoning": "A♣9♣ は、フロップ前の状況では非常に強いハンドです（「エース」と「クラブ」のスーツ）。ポットは現在30ですが、プレイヤー3はすでに20をベットしており、コールするには10必要です。このハンドでさらにポジションを有利にするために、レイズして、相手にプレッシャーをかけ、ポットを大きくします。レイズ額は、相手がコールするのに十分なプレッシャーを与えつつ、自分のチップを過剰にリスクにさらさないように、最小レイズ額である40に設定します。"\n}'
2025-10-31 19:05:16,483 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 40,
  "reasoning": "A♣9♣ は、フロップ前の状況では非常に強いハンドです（「エース」と「クラブ」のスーツ）。ポットは現在30ですが、プレイヤー3はすでに20をベットしており、コールするには10必要です。このハンドでさらにポジションを有利にするために、レイズして、相手にプレッシャーをかけ、ポットを大きくします。レイズ額は、相手がコールするのに十分なプレッシャーを与えつつ、自分のチップを過剰にリスクにさらさないように、最小レイズ額である40に設定します。"
}
2025-10-31 19:05:16,483 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 40, 'reasoning': 'A♣9♣ は、フロップ前の状況では非常に強いハンドです（「エース」と「クラブ」のスーツ）。ポットは現在30ですが、プレイヤー3はすでに20をベットしており、コールするには10必要です。このハンドでさらにポジションを有利にするために、レイズして、相手にプレッシャーをかけ、ポットを大きくします。レイズ額は、相手がコールするのに十分なプレッシャーを与えつつ、自分のチップを過剰にリスクにさらさないように、最小レイズ額である40に設定します。'}
2025-10-31 19:05:16,483 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 40
2025-10-31 19:05:16,483 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (2849)']
2025-10-31 19:05:16,483 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 19:05:16,483 - poker_game - DEBUG - [Agent1] Raise amount 40 is valid (min: 40)
2025-10-31 19:05:16,484 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 40}
2025-10-31 19:05:16,484 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 40, A♣9♣ は、フロップ前の状況では非常に強いハンドです（「エース」と「クラブ」のスーツ）。ポットは現在30ですが、プレイヤー3はすでに20をベットしており、コールするには10必要です。このハンドでさらにポジションを有利にするために、レイズして、相手にプレッシャーをかけ、ポットを大きくします。レイズ額は、相手がコールするのに十分なプレッシャーを与えつつ、自分のチップを過剰にリスクにさらさないように、最小レイズ額である40に設定します。
2025-10-31 19:05:16,484 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 40
2025-10-31 19:05:16,485 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:16,485 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:16,486 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:05:16,486 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:16,487 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:16,488 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:16,488 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:16,489 - poker_game - INFO - Community cards: []
2025-10-31 19:05:16,489 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:16,489 - poker_game - INFO -   P1(Agent1): chips=2849, bet=10, status=active
2025-10-31 19:05:16,489 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:16,490 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:16,490 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:16,490 - poker_game - INFO - ==================================================
2025-10-31 19:05:16,491 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 60
2025-10-31 19:05:16,500 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:16,501 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:16,501 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:05:16,501 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:05:16,501 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:16,502 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:16,502 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:16,502 - poker_game - INFO - Community cards: []
2025-10-31 19:05:16,502 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:16,503 - poker_game - INFO -   P1(Agent1): chips=2799, bet=60, status=active
2025-10-31 19:05:16,503 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:16,503 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:16,503 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:16,504 - poker_game - INFO - Extra: Action: Player 1 raised to 60
2025-10-31 19:05:16,504 - poker_game - INFO - ==================================================
2025-10-31 19:05:16,504 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:16,504 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:16,504 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:05:16,505 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:05:16,505 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:16,505 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:16,505 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:05:16,505 - poker_game - DEBUG - Player bets: [60, 20], Current bet: 60, All same: False
2025-10-31 19:05:16,506 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:05:16,506 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:16,506 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:16,506 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:05:16,506 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:05:16,507 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:16,507 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:16,507 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:16,507 - poker_game - INFO - Community cards: []
2025-10-31 19:05:16,508 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:16,508 - poker_game - INFO -   P1(Agent1): chips=2799, bet=60, status=active
2025-10-31 19:05:16,508 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:16,509 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:16,509 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:16,509 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:05:16,510 - poker_game - INFO - ==================================================
2025-10-31 19:05:16,611 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "4♣",
    "9♥"
  ],
  "community": [],
  "your_chips": 567,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 80,
  "to_call": 40,
  "dealer_button": 4,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2799,
      "bet": 60,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6554,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (40)",
    "raise (min 80)",
    "all-in (567)"
  ],
  "history": [
    "Showdown: Player 3 won 120",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60"
  ]
}
2025-10-31 19:05:16,626 - poker_game - DEBUG - Create Session: {'id': 'e9fecdcd-30a9-457f-9d79-92136efe7dc2', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905116.622679}
2025-10-31 19:05:21,609 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが開かれる前）で、手札の4と9は、あまり強い組み合わせではありません（オフスート、つまり異なるスートで、数字も離れている）。ポットにはすでに80ありますが、コールするには40必要です。相手（プレイヤー1）がすでに60ベットしており、これはプリフロップでは強気なベットです。この状況でコールするのはリスクが高く、勝てる見込みが薄いため、フォールド（降りる）のが最善の判断です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 146, 'promptTokenCount': 783, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 783}], 'totalTokenCount': 929}, 'invocationId': 'e-bef4c4c9-6cb1-4d2d-8d92-9c5fd265739d', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'GiQi7RjI', 'timestamp': 1761905116.636921}]
2025-10-31 19:05:21,610 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:05:21,610 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが開かれる前）で、手札の4と9は、あまり強い組み合わせではありません（オフスート、つまり異なるスートで、数字も離れている）。ポットにはすでに80ありますが、コールするには40必要です。相手（プレイヤー1）がすでに60ベットしており、これはプリフロップでは強気なベットです。この状況でコールするのはリスクが高く、勝てる見込みが薄いため、フォールド（降りる）のが最善の判断です。"
}
```
2025-10-31 19:05:21,610 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:05:21,610 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが開かれる前）で、手札の4と9は、あまり強い組み合わせではありません（オフスート、つまり異なるスートで、数字も離れている）。ポットにはすでに80ありますが、コールするには40必要です。相手（プレイヤー1）がすでに60ベットしており、これはプリフロップでは強気なベットです。この状況でコールするのはリスクが高く、勝てる見込みが薄いため、フォールド（降りる）のが最善の判断です。"\n}\n```'
2025-10-31 19:05:21,610 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:05:21,610 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが開かれる前）で、手札の4と9は、あまり強い組み合わせではありません（オフスート、つまり異なるスートで、数字も離れている）。ポットにはすでに80ありますが、コールするには40必要です。相手（プレイヤー1）がすでに60ベットしており、これはプリフロップでは強気なベットです。この状況でコールするのはリスクが高く、勝てる見込みが薄いため、フォールド（降りる）のが最善の判断です。"\n}'
2025-10-31 19:05:21,610 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "プリフロップ（最初のカードが配られた後、コミュニティカードが開かれる前）で、手札の4と9は、あまり強い組み合わせではありません（オフスート、つまり異なるスートで、数字も離れている）。ポットにはすでに80ありますが、コールするには40必要です。相手（プレイヤー1）がすでに60ベットしており、これはプリフロップでは強気なベットです。この状況でコールするのはリスクが高く、勝てる見込みが薄いため、フォールド（降りる）のが最善の判断です。"
}
2025-10-31 19:05:21,611 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'プリフロップ（最初のカードが配られた後、コミュニティカードが開かれる前）で、手札の4と9は、あまり強い組み合わせではありません（オフスート、つまり異なるスートで、数字も離れている）。ポットにはすでに80ありますが、コールするには40必要です。相手（プレイヤー1）がすでに60ベットしており、これはプリフロップでは強気なベットです。この状況でコールするのはリスクが高く、勝てる見込みが薄いため、フォールド（降りる）のが最善の判断です。'}
2025-10-31 19:05:21,611 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 19:05:21,611 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 19:05:21,611 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:05:21,611 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, プリフロップ（最初のカードが配られた後、コミュニティカードが開かれる前）で、手札の4と9は、あまり強い組み合わせではありません（オフスート、つまり異なるスートで、数字も離れている）。ポットにはすでに80ありますが、コールするには40必要です。相手（プレイヤー1）がすでに60ベットしており、これはプリフロップでは強気なベットです。この状況でコールするのはリスクが高く、勝てる見込みが薄いため、フォールド（降りる）のが最善の判断です。
2025-10-31 19:05:21,612 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 19:05:21,612 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:21,612 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:21,612 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:05:21,612 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:05:21,613 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:21,613 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:21,613 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:21,613 - poker_game - INFO - Community cards: []
2025-10-31 19:05:21,613 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:21,613 - poker_game - INFO -   P1(Agent1): chips=2799, bet=60, status=active
2025-10-31 19:05:21,614 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:21,614 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=active
2025-10-31 19:05:21,614 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:21,614 - poker_game - INFO - ==================================================
2025-10-31 19:05:21,614 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 19:05:21,625 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:21,625 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:21,626 - poker_game - INFO - Current player: 3, Dealer: 4
2025-10-31 19:05:21,627 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:05:21,627 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:21,627 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:21,627 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:21,627 - poker_game - INFO - Community cards: []
2025-10-31 19:05:21,628 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:21,628 - poker_game - INFO -   P1(Agent1): chips=2799, bet=60, status=active
2025-10-31 19:05:21,628 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:21,628 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=folded
2025-10-31 19:05:21,628 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:21,628 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 19:05:21,628 - poker_game - INFO - ==================================================
2025-10-31 19:05:21,629 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:21,629 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:21,629 - poker_game - DEBUG - Active players: [1]
2025-10-31 19:05:21,629 - poker_game - INFO - Advanced from player 3 to player 1 (seat order)
2025-10-31 19:05:21,629 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:21,629 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:21,629 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 19:05:21,630 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 19:05:21,630 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:21,630 - poker_game - INFO - Hand #28, Phase: preflop
2025-10-31 19:05:21,630 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:05:21,630 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:05:21,630 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:21,631 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:21,631 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:21,631 - poker_game - INFO - Community cards: []
2025-10-31 19:05:21,631 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:21,631 - poker_game - INFO -   P1(Agent1): chips=2799, bet=60, status=active
2025-10-31 19:05:21,631 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:21,632 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=folded
2025-10-31 19:05:21,632 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:21,632 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:05:21,632 - poker_game - INFO - ==================================================
2025-10-31 19:05:21,733 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:05:21,734 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:21,734 - poker_game - INFO - Remaining players: 1
2025-10-31 19:05:21,735 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:05:21,735 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 19:05:21,735 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:05:21,735 - poker_game - INFO - Hand #28, Phase: showdown
2025-10-31 19:05:21,736 - poker_game - INFO - Current player: 1, Dealer: 4
2025-10-31 19:05:21,736 - poker_game - INFO - Pot: 80, Current bet: 60
2025-10-31 19:05:21,736 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:21,737 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:21,737 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:21,737 - poker_game - INFO - Community cards: []
2025-10-31 19:05:21,737 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:21,738 - poker_game - INFO -   P1(Agent1): chips=2799, bet=60, status=active
2025-10-31 19:05:21,738 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:21,738 - poker_game - INFO -   P3(Agent3): chips=567, bet=20, status=folded
2025-10-31 19:05:21,738 - poker_game - INFO -   P4(Agent4): chips=6554, bet=0, status=folded
2025-10-31 19:05:21,739 - poker_game - INFO - ==================================================
2025-10-31 19:05:21,739 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:05:21,739 - poker_game - INFO - Pot: 80, Community cards: []
2025-10-31 19:05:21,739 - poker_game - INFO -   Player 1 status=active cards=['9♣', 'A♣']
2025-10-31 19:05:21,740 - poker_game - INFO - Showdown winner by default: Player 1 awarded 80
2025-10-31 19:05:21,740 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:05:21,740 - poker_game - INFO - === STARTING NEW HAND #29 ===
2025-10-31 19:05:21,741 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:05:21,741 - poker_game - INFO - Moving dealer button
2025-10-31 19:05:21,741 - poker_game - INFO - Posting blinds
2025-10-31 19:05:21,766 - poker_game - INFO - Dealing hole cards
2025-10-31 19:05:21,766 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:05:21,776 - poker_game - INFO - Started new hand in database: hand_id=29
2025-10-31 19:05:21,777 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:05:21,777 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:21,778 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:05:21,778 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:21,779 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:21,779 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:21,779 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:21,780 - poker_game - INFO - Community cards: []
2025-10-31 19:05:21,780 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:21,780 - poker_game - INFO -   P1(Agent1): chips=2879, bet=0, status=active
2025-10-31 19:05:21,781 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:21,781 - poker_game - INFO -   P3(Agent3): chips=557, bet=10, status=active
2025-10-31 19:05:21,781 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:21,781 - poker_game - INFO - ==================================================
2025-10-31 19:05:21,782 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "A♥",
    "J♠"
  ],
  "community": [],
  "your_chips": 2879,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 557,
      "bet": 10,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6534,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (2879)"
  ],
  "history": [
    "Player 3 folded",
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20"
  ]
}
2025-10-31 19:05:21,797 - poker_game - DEBUG - Create Session: {'id': '4171e458-f14f-424a-9e56-96c404139807', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905121.795723}
2025-10-31 19:05:18,949 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "A♥J♠は強いハンドですが、プリフロップ（フロップが開く前の段階）では、相手のベット額と自分のチップ量、そしてポットサイズを考慮して慎重にプレイする必要があります。現在の状況では、ポットは30で、コールするには20必要です。これは相手がレイズ（ベット額を上げる行為）をした後のアクションです。A♥J♠は十分に強いハンドなので、ポットを大きくするリスクを負うより、まずはコールしてフロップ（コミュニティカードのうち最初の3枚）を見て、その後の展開で判断するのが賢明です。レイズするには、相手のハンドレンジ（相手が持っている可能性のあるカードの範囲）をさらに絞り込む必要があり、オールインはチップ量が十分ではないため、現時点ではリスクが高すぎます。したがって、コールして状況を見るのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 210, 'promptTokenCount': 782, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 782}], 'totalTokenCount': 992}, 'invocationId': 'e-12befe4f-0831-47d6-83d2-feb8c8352417', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'dbw8TkQr', 'timestamp': 1761905121.811619}]
2025-10-31 19:05:18,950 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:05:18,950 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 20,
  "reasoning": "A♥J♠は強いハンドですが、プリフロップ（フロップが開く前の段階）では、相手のベット額と自分のチップ量、そしてポットサイズを考慮して慎重にプレイする必要があります。現在の状況では、ポットは30で、コールするには20必要です。これは相手がレイズ（ベット額を上げる行為）をした後のアクションです。A♥J♠は十分に強いハンドなので、ポットを大きくするリスクを負うより、まずはコールしてフロップ（コミュニティカードのうち最初の3枚）を見て、その後の展開で判断するのが賢明です。レイズするには、相手のハンドレンジ（相手が持っている可能性のあるカードの範囲）をさらに絞り込む必要があり、オールインはチップ量が十分ではないため、現時点ではリスクが高すぎます。したがって、コールして状況を見るのが最善です。"
}
```
2025-10-31 19:05:18,950 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:05:18,950 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "A♥J♠は強いハンドですが、プリフロップ（フロップが開く前の段階）では、相手のベット額と自分のチップ量、そしてポットサイズを考慮して慎重にプレイする必要があります。現在の状況では、ポットは30で、コールするには20必要です。これは相手がレイズ（ベット額を上げる行為）をした後のアクションです。A♥J♠は十分に強いハンドなので、ポットを大きくするリスクを負うより、まずはコールしてフロップ（コミュニティカードのうち最初の3枚）を見て、その後の展開で判断するのが賢明です。レイズするには、相手のハンドレンジ（相手が持っている可能性のあるカードの範囲）をさらに絞り込む必要があり、オールインはチップ量が十分ではないため、現時点ではリスクが高すぎます。したがって、コールして状況を見るのが最善です。"\n}\n```'
2025-10-31 19:05:18,950 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:05:18,951 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 20,\n  "reasoning": "A♥J♠は強いハンドですが、プリフロップ（フロップが開く前の段階）では、相手のベット額と自分のチップ量、そしてポットサイズを考慮して慎重にプレイする必要があります。現在の状況では、ポットは30で、コールするには20必要です。これは相手がレイズ（ベット額を上げる行為）をした後のアクションです。A♥J♠は十分に強いハンドなので、ポットを大きくするリスクを負うより、まずはコールしてフロップ（コミュニティカードのうち最初の3枚）を見て、その後の展開で判断するのが賢明です。レイズするには、相手のハンドレンジ（相手が持っている可能性のあるカードの範囲）をさらに絞り込む必要があり、オールインはチップ量が十分ではないため、現時点ではリスクが高すぎます。したがって、コールして状況を見るのが最善です。"\n}'
2025-10-31 19:05:18,951 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 20,
  "reasoning": "A♥J♠は強いハンドですが、プリフロップ（フロップが開く前の段階）では、相手のベット額と自分のチップ量、そしてポットサイズを考慮して慎重にプレイする必要があります。現在の状況では、ポットは30で、コールするには20必要です。これは相手がレイズ（ベット額を上げる行為）をした後のアクションです。A♥J♠は十分に強いハンドなので、ポットを大きくするリスクを負うより、まずはコールしてフロップ（コミュニティカードのうち最初の3枚）を見て、その後の展開で判断するのが賢明です。レイズするには、相手のハンドレンジ（相手が持っている可能性のあるカードの範囲）をさらに絞り込む必要があり、オールインはチップ量が十分ではないため、現時点ではリスクが高すぎます。したがって、コールして状況を見るのが最善です。"
}
2025-10-31 19:05:18,951 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 20, 'reasoning': 'A♥J♠は強いハンドですが、プリフロップ（フロップが開く前の段階）では、相手のベット額と自分のチップ量、そしてポットサイズを考慮して慎重にプレイする必要があります。現在の状況では、ポットは30で、コールするには20必要です。これは相手がレイズ（ベット額を上げる行為）をした後のアクションです。A♥J♠は十分に強いハンドなので、ポットを大きくするリスクを負うより、まずはコールしてフロップ（コミュニティカードのうち最初の3枚）を見て、その後の展開で判断するのが賢明です。レイズするには、相手のハンドレンジ（相手が持っている可能性のあるカードの範囲）をさらに絞り込む必要があり、オールインはチップ量が十分ではないため、現時点ではリスクが高すぎます。したがって、コールして状況を見るのが最善です。'}
2025-10-31 19:05:18,951 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 20
2025-10-31 19:05:18,951 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (20)', 'raise (min 40)', 'all-in (2879)']
2025-10-31 19:05:18,951 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (20)': 20
2025-10-31 19:05:18,951 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 20}
2025-10-31 19:05:18,951 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 20, A♥J♠は強いハンドですが、プリフロップ（フロップが開く前の段階）では、相手のベット額と自分のチップ量、そしてポットサイズを考慮して慎重にプレイする必要があります。現在の状況では、ポットは30で、コールするには20必要です。これは相手がレイズ（ベット額を上げる行為）をした後のアクションです。A♥J♠は十分に強いハンドなので、ポットを大きくするリスクを負うより、まずはコールしてフロップ（コミュニティカードのうち最初の3枚）を見て、その後の展開で判断するのが賢明です。レイズするには、相手のハンドレンジ（相手が持っている可能性のあるカードの範囲）をさらに絞り込む必要があり、オールインはチップ量が十分ではないため、現時点ではリスクが高すぎます。したがって、コールして状況を見るのが最善です。
2025-10-31 19:05:18,952 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 20
2025-10-31 19:05:18,952 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:18,952 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:18,953 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:05:18,953 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:18,953 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:18,953 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:18,953 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:18,954 - poker_game - INFO - Community cards: []
2025-10-31 19:05:18,954 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:18,954 - poker_game - INFO -   P1(Agent1): chips=2879, bet=0, status=active
2025-10-31 19:05:18,954 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:18,954 - poker_game - INFO -   P3(Agent3): chips=557, bet=10, status=active
2025-10-31 19:05:18,955 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:18,955 - poker_game - INFO - ==================================================
2025-10-31 19:05:18,955 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 20
2025-10-31 19:05:18,965 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:18,965 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:18,965 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:05:18,966 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 19:05:18,966 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:18,966 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:18,967 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:18,967 - poker_game - INFO - Community cards: []
2025-10-31 19:05:18,967 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:18,968 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:18,968 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:18,968 - poker_game - INFO -   P3(Agent3): chips=557, bet=10, status=active
2025-10-31 19:05:18,969 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:18,969 - poker_game - INFO - Extra: Action: Player 1 called 20
2025-10-31 19:05:18,969 - poker_game - INFO - ==================================================
2025-10-31 19:05:18,969 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:18,970 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:18,970 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:05:18,970 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:05:18,970 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:18,970 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:18,970 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:05:18,971 - poker_game - DEBUG - Player bets: [20, 10, 20], Current bet: 20, All same: False
2025-10-31 19:05:18,971 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:05:18,971 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:18,971 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:18,971 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:05:18,971 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 19:05:18,971 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:18,971 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:18,972 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:18,972 - poker_game - INFO - Community cards: []
2025-10-31 19:05:18,972 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:18,972 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:18,972 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:18,973 - poker_game - INFO -   P3(Agent3): chips=557, bet=10, status=active
2025-10-31 19:05:18,973 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:18,973 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:05:18,973 - poker_game - INFO - ==================================================
2025-10-31 19:05:19,074 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "8♦",
    "Q♦"
  ],
  "community": [],
  "your_chips": 557,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 50,
  "to_call": 10,
  "dealer_button": 1,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2859,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6534,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (557)"
  ],
  "history": [
    "Showdown: Player 4 won 30",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20"
  ]
}
2025-10-31 19:05:19,089 - poker_game - DEBUG - Create Session: {'id': '47919976-becb-4728-9efa-2a30e1a394af', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905119.085434}
2025-10-31 19:05:22,564 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 120,\n  "reasoning": "Q8oはプリフロップでは中程度のハンドです。ポットが大きく、相手がルーズなプレイヤーである可能性もあるため、レイズしてポットを大きくし、相手にプレッシャーをかけます。レイズ額は、相手のベット額（20）と自分のベット額（10）の差額（10）に、さらに自分がコールする額（10）を足した額（20）に、最低レイズ額（40）を足した額、つまり20+40=60に、最低レイズ額の倍額（20）を足した120とします。これは、相手にポットコントロールをさせず、有利なポジションを維持するためです。相手のベット額（20）+自分のベット額（10）+コール額（10）=40。最低レイズ額は40。相手がコールした場合、ポットは120+120=240になる。手札は「Q♦」「8♦」で、フラッシュの可能性も秘めています。相手のベット額は20、こちらは10しかベットしていません。ポットは50です。コールするには10必要です。相手が2人いる状況で、プリフロップでコールするのはリスクが高いと判断します。レイズして、相手にフォールドさせるか、有利なポジションでフロップに進むことを目指します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 338, 'promptTokenCount': 786, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 786}], 'totalTokenCount': 1124}, 'invocationId': 'e-cc946eef-08f1-4999-9357-c38b52ec18c7', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'enYqKCDm', 'timestamp': 1761905119.101192}]
2025-10-31 19:05:22,565 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:05:22,565 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 120,
  "reasoning": "Q8oはプリフロップでは中程度のハンドです。ポットが大きく、相手がルーズなプレイヤーである可能性もあるため、レイズしてポットを大きくし、相手にプレッシャーをかけます。レイズ額は、相手のベット額（20）と自分のベット額（10）の差額（10）に、さらに自分がコールする額（10）を足した額（20）に、最低レイズ額（40）を足した額、つまり20+40=60に、最低レイズ額の倍額（20）を足した120とします。これは、相手にポットコントロールをさせず、有利なポジションを維持するためです。相手のベット額（20）+自分のベット額（10）+コール額（10）=40。最低レイズ額は40。相手がコールした場合、ポットは120+120=240になる。手札は「Q♦」「8♦」で、フラッシュの可能性も秘めています。相手のベット額は20、こちらは10しかベットしていません。ポットは50です。コールするには10必要です。相手が2人いる状況で、プリフロップでコールするのはリスクが高いと判断します。レイズして、相手にフォールドさせるか、有利なポジションでフロップに進むことを目指します。"
}
```
2025-10-31 19:05:22,565 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:05:22,565 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 120,\n  "reasoning": "Q8oはプリフロップでは中程度のハンドです。ポットが大きく、相手がルーズなプレイヤーである可能性もあるため、レイズしてポットを大きくし、相手にプレッシャーをかけます。レイズ額は、相手のベット額（20）と自分のベット額（10）の差額（10）に、さらに自分がコールする額（10）を足した額（20）に、最低レイズ額（40）を足した額、つまり20+40=60に、最低レイズ額の倍額（20）を足した120とします。これは、相手にポットコントロールをさせず、有利なポジションを維持するためです。相手のベット額（20）+自分のベット額（10）+コール額（10）=40。最低レイズ額は40。相手がコールした場合、ポットは120+120=240になる。手札は「Q♦」「8♦」で、フラッシュの可能性も秘めています。相手のベット額は20、こちらは10しかベットしていません。ポットは50です。コールするには10必要です。相手が2人いる状況で、プリフロップでコールするのはリスクが高いと判断します。レイズして、相手にフォールドさせるか、有利なポジションでフロップに進むことを目指します。"\n}\n```'
2025-10-31 19:05:22,565 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:05:22,565 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 120,\n  "reasoning": "Q8oはプリフロップでは中程度のハンドです。ポットが大きく、相手がルーズなプレイヤーである可能性もあるため、レイズしてポットを大きくし、相手にプレッシャーをかけます。レイズ額は、相手のベット額（20）と自分のベット額（10）の差額（10）に、さらに自分がコールする額（10）を足した額（20）に、最低レイズ額（40）を足した額、つまり20+40=60に、最低レイズ額の倍額（20）を足した120とします。これは、相手にポットコントロールをさせず、有利なポジションを維持するためです。相手のベット額（20）+自分のベット額（10）+コール額（10）=40。最低レイズ額は40。相手がコールした場合、ポットは120+120=240になる。手札は「Q♦」「8♦」で、フラッシュの可能性も秘めています。相手のベット額は20、こちらは10しかベットしていません。ポットは50です。コールするには10必要です。相手が2人いる状況で、プリフロップでコールするのはリスクが高いと判断します。レイズして、相手にフォールドさせるか、有利なポジションでフロップに進むことを目指します。"\n}'
2025-10-31 19:05:22,565 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "raise",
  "amount": 120,
  "reasoning": "Q8oはプリフロップでは中程度のハンドです。ポットが大きく、相手がルーズなプレイヤーである可能性もあるため、レイズしてポットを大きくし、相手にプレッシャーをかけます。レイズ額は、相手のベット額（20）と自分のベット額（10）の差額（10）に、さらに自分がコールする額（10）を足した額（20）に、最低レイズ額（40）を足した額、つまり20+40=60に、最低レイズ額の倍額（20）を足した120とします。これは、相手にポットコントロールをさせず、有利なポジションを維持するためです。相手のベット額（20）+自分のベット額（10）+コール額（10）=40。最低レイズ額は40。相手がコールした場合、ポットは120+120=240になる。手札は「Q♦」「8♦」で、フラッシュの可能性も秘めています。相手のベット額は20、こちらは10しかベットしていません。ポットは50です。コールするには10必要です。相手が2人いる状況で、プリフロップでコールするのはリスクが高いと判断します。レイズして、相手にフォールドさせるか、有利なポジションでフロップに進むことを目指します。"
}
2025-10-31 19:05:22,565 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'raise', 'amount': 120, 'reasoning': 'Q8oはプリフロップでは中程度のハンドです。ポットが大きく、相手がルーズなプレイヤーである可能性もあるため、レイズしてポットを大きくし、相手にプレッシャーをかけます。レイズ額は、相手のベット額（20）と自分のベット額（10）の差額（10）に、さらに自分がコールする額（10）を足した額（20）に、最低レイズ額（40）を足した額、つまり20+40=60に、最低レイズ額の倍額（20）を足した120とします。これは、相手にポットコントロールをさせず、有利なポジションを維持するためです。相手のベット額（20）+自分のベット額（10）+コール額（10）=40。最低レイズ額は40。相手がコールした場合、ポットは120+120=240になる。手札は「Q♦」「8♦」で、フラッシュの可能性も秘めています。相手のベット額は20、こちらは10しかベットしていません。ポットは50です。コールするには10必要です。相手が2人いる状況で、プリフロップでコールするのはリスクが高いと判断します。レイズして、相手にフォールドさせるか、有利なポジションでフロップに進むことを目指します。'}
2025-10-31 19:05:22,566 - poker_game - DEBUG - [Agent3] Extracted values - action: 'raise', amount: 120
2025-10-31 19:05:22,566 - poker_game - DEBUG - [Agent3] Processing raise action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (557)']
2025-10-31 19:05:22,566 - poker_game - DEBUG - [Agent3] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 19:05:22,566 - poker_game - DEBUG - [Agent3] Raise amount 120 is valid (min: 40)
2025-10-31 19:05:22,566 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'raise', 'amount': 120}
2025-10-31 19:05:22,566 - poker_game - INFO - [Agent3] Successfully parsed decision: raise, 120, Q8oはプリフロップでは中程度のハンドです。ポットが大きく、相手がルーズなプレイヤーである可能性もあるため、レイズしてポットを大きくし、相手にプレッシャーをかけます。レイズ額は、相手のベット額（20）と自分のベット額（10）の差額（10）に、さらに自分がコールする額（10）を足した額（20）に、最低レイズ額（40）を足した額、つまり20+40=60に、最低レイズ額の倍額（20）を足した120とします。これは、相手にポットコントロールをさせず、有利なポジションを維持するためです。相手のベット額（20）+自分のベット額（10）+コール額（10）=40。最低レイズ額は40。相手がコールした場合、ポットは120+120=240になる。手札は「Q♦」「8♦」で、フラッシュの可能性も秘めています。相手のベット額は20、こちらは10しかベットしていません。ポットは50です。コールするには10必要です。相手が2人いる状況で、プリフロップでコールするのはリスクが高いと判断します。レイズして、相手にフォールドさせるか、有利なポジションでフロップに進むことを目指します。
2025-10-31 19:05:22,567 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'raise' with amount 120
2025-10-31 19:05:22,567 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:22,567 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:22,567 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:05:22,567 - poker_game - INFO - Pot: 50, Current bet: 20
2025-10-31 19:05:22,568 - poker_game - INFO - Last raiser: 4
2025-10-31 19:05:22,568 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:22,568 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:22,568 - poker_game - INFO - Community cards: []
2025-10-31 19:05:22,568 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:22,568 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:22,569 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:22,569 - poker_game - INFO -   P3(Agent3): chips=557, bet=10, status=active
2025-10-31 19:05:22,569 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:22,569 - poker_game - INFO - ==================================================
2025-10-31 19:05:22,570 - poker_game - INFO - ACTION_EXECUTED: Player 3 raised to 140
2025-10-31 19:05:22,583 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:22,583 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:22,583 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:05:22,584 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:22,584 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:22,584 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:22,584 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:22,584 - poker_game - INFO - Community cards: []
2025-10-31 19:05:22,585 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:22,585 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:22,585 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:22,585 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:22,585 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:22,585 - poker_game - INFO - Extra: Action: Player 3 raised to 140
2025-10-31 19:05:22,586 - poker_game - INFO - ==================================================
2025-10-31 19:05:22,586 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:22,586 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:22,586 - poker_game - DEBUG - Active players: [1, 3, 4]
2025-10-31 19:05:22,586 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:05:22,586 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:22,587 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:22,587 - poker_game - DEBUG - Active: 3, All-in: 0
2025-10-31 19:05:22,587 - poker_game - DEBUG - Player bets: [20, 140, 20], Current bet: 140, All same: False
2025-10-31 19:05:22,587 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:05:22,587 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:22,587 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:22,588 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:05:22,588 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:22,592 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:22,595 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:22,595 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:22,595 - poker_game - INFO - Community cards: []
2025-10-31 19:05:22,595 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:22,595 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:22,596 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:22,596 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:22,596 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:22,598 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:05:22,599 - poker_game - INFO - ==================================================
2025-10-31 19:05:22,700 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "4♥",
    "6♦"
  ],
  "community": [],
  "your_chips": 6534,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 180,
  "to_call": 120,
  "dealer_button": 1,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2859,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 427,
      "bet": 140,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (120)",
    "raise (min 160)",
    "all-in (6534)"
  ],
  "history": [
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140"
  ]
}
2025-10-31 19:05:22,713 - poker_game - DEBUG - Create Session: {'id': '2df5a4fc-2ac8-43f8-9f75-b15739e63a3e', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905122.7099988}
2025-10-31 19:05:32,864 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:05:41,413 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_sklOnnheGZ3uIm27wdwZoMa4', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1089, 'totalTokenCount': 1106}, 'invocationId': 'e-db442538-b48d-4b10-86cd-1f49d16cd431', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'IkjQMNBq', 'timestamp': 1761905122.723981}, {'content': {'parts': [{'functionResponse': {'id': 'call_sklOnnheGZ3uIm27wdwZoMa4', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-db442538-b48d-4b10-86cd-1f49d16cd431', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'RqhHWmeS', 'timestamp': 1761905124.012672}, {'content': {'parts': [{'functionCall': {'id': 'call_F9Nuevh4v2X2zIhjlGM2b3ga', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['4♥', '6♦'], 'community': [], 'your_chips': 6534, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 180, 'to_call': 120, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2859, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 427, 'bet': 140, 'status': 'active'}], 'actions': ['fold', 'call (120)', 'raise (min 160)', 'all-in (6534)'], 'history': ['Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 raised to 120', 'Player 4 called 110', 'Player 1 raised to 420', 'Player 3 raised to 860', 'Player 4 raised to 2710', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 3990', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140']}, 'call_amount': 120, 'pot_after_call': 300, 'equity': 0.3}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_xYUgqg0R96zNLi0gld3BP9pD', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['4♥', '6♦'], 'community': [], 'your_chips': 6534, 'your_bet_this_round': 20, 'your_total_bet_this_hand': 20, 'pot': 180, 'to_call': 120, 'dealer_button': 1, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2859, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 427, 'bet': 140, 'status': 'active'}], 'actions': ['fold', 'call (120)', 'raise (min 160)', 'all-in (6534)'], 'history': ['Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 raised to 120', 'Player 4 called 110', 'Player 1 raised to 420', 'Player 3 raised to 860', 'Player 4 raised to 2710', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 3990', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140']}, 'call_amount': 120, 'pot_after_call': 300, 'equity': 0.3}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 658, 'promptTokenCount': 1613, 'totalTokenCount': 2271}, 'invocationId': 'e-db442538-b48d-4b10-86cd-1f49d16cd431', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'p2Kwwu4v', 'timestamp': 1761905124.014602}, {'content': {'parts': [{'functionResponse': {'id': 'call_F9Nuevh4v2X2zIhjlGM2b3ga', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド'}}}, {'functionResponse': {'id': 'call_xYUgqg0R96zNLi0gld3BP9pD', 'name': 'action_decision', 'response': {'action': 'fold', 'amount': 0, 'reasoning': '期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド'}}}], 'role': 'user'}, 'invocationId': 'XPLoYXpi', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'FyLeT7O3', 'timestamp': 1761905139.260208}, {'content': {'parts': [{'text': '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 49, 'promptTokenCount': 2501, 'totalTokenCount': 2550}, 'invocationId': 'e-db442538-b48d-4b10-86cd-1f49d16cd431', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'chNpu5rz', 'timestamp': 1761905139.262624}]
2025-10-31 19:05:41,413 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:05:41,413 - poker_game - DEBUG - {
  "action": "fold",
  "amount": 0,
  "reasoning": "期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド"
}
2025-10-31 19:05:41,414 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:05:41,414 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド"\n}'
2025-10-31 19:05:41,414 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:05:41,414 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド"
}
2025-10-31 19:05:41,414 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': '期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド'}
2025-10-31 19:05:41,414 - poker_game - DEBUG - [Agent4] Extracted values - action: 'fold', amount: 0
2025-10-31 19:05:41,414 - poker_game - DEBUG - [Agent4] Action 'fold' normalized - amount set to 0
2025-10-31 19:05:41,415 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:05:41,415 - poker_game - INFO - [Agent4] Successfully parsed decision: fold, 0, 期待値が6.00(ポットに対して3.33%で、マイナスなのでフォールド
2025-10-31 19:05:41,415 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'fold' with amount 0
2025-10-31 19:05:41,416 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:41,416 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:41,416 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:05:41,416 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:41,416 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:41,417 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:41,417 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:41,417 - poker_game - INFO - Community cards: []
2025-10-31 19:05:41,417 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:41,417 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:41,417 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:41,418 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:41,418 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=active
2025-10-31 19:05:41,418 - poker_game - INFO - ==================================================
2025-10-31 19:05:41,418 - poker_game - INFO - ACTION_EXECUTED: Player 4 folded
2025-10-31 19:05:41,427 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:41,427 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:41,428 - poker_game - INFO - Current player: 4, Dealer: 1
2025-10-31 19:05:41,428 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:41,428 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:41,429 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:41,429 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:41,430 - poker_game - INFO - Community cards: []
2025-10-31 19:05:41,430 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:41,430 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:41,430 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:41,431 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:41,431 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=folded
2025-10-31 19:05:41,431 - poker_game - INFO - Extra: Action: Player 4 folded
2025-10-31 19:05:41,431 - poker_game - INFO - ==================================================
2025-10-31 19:05:41,432 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:41,432 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:41,432 - poker_game - DEBUG - Active players: [1, 3]
2025-10-31 19:05:41,432 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:05:41,432 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:41,432 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:41,432 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:05:41,433 - poker_game - DEBUG - Player bets: [20, 140], Current bet: 140, All same: False
2025-10-31 19:05:41,433 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:05:41,433 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:41,433 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:41,433 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:05:41,434 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:41,434 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:41,434 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:41,435 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:41,435 - poker_game - INFO - Community cards: []
2025-10-31 19:05:41,435 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:41,435 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:41,436 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:41,436 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:41,436 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=folded
2025-10-31 19:05:41,436 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:05:41,437 - poker_game - INFO - ==================================================
2025-10-31 19:05:41,538 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "A♥",
    "J♠"
  ],
  "community": [],
  "your_chips": 2859,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 180,
  "to_call": 120,
  "dealer_button": 1,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 427,
      "bet": 140,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6534,
      "bet": 20,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (120)",
    "raise (min 160)",
    "all-in (2859)"
  ],
  "history": [
    "Player 1 posted big blind 20",
    "Player 3 raised to 120",
    "Player 4 called 110",
    "Player 1 raised to 420",
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded"
  ]
}
2025-10-31 19:05:41,548 - poker_game - DEBUG - Create Session: {'id': '615992fb-9325-498a-b99e-191b5a9e26e3', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905141.5455496}
2025-10-31 19:05:43,368 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "AJオフスート (A♥J♠) は強いハンドですが、プリフロップで既に複数のレイズがあり、コールするにはポットに対して大きすぎるベット（to_call: 120）が必要です。相手のベット額とポットサイズを考慮すると、このハンドでコールするのは有利ではありません。相手が強いハンドを持っている可能性が高いため、フォールドを選択します。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 108, 'promptTokenCount': 786, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 786}], 'totalTokenCount': 894}, 'invocationId': 'e-67152bfe-eb04-4769-9ee3-300e97b2132c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '7VSUwEpV', 'timestamp': 1761905141.557252}]
2025-10-31 19:05:43,368 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:05:43,369 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "AJオフスート (A♥J♠) は強いハンドですが、プリフロップで既に複数のレイズがあり、コールするにはポットに対して大きすぎるベット（to_call: 120）が必要です。相手のベット額とポットサイズを考慮すると、このハンドでコールするのは有利ではありません。相手が強いハンドを持っている可能性が高いため、フォールドを選択します。"
}
```
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "AJオフスート (A♥J♠) は強いハンドですが、プリフロップで既に複数のレイズがあり、コールするにはポットに対して大きすぎるベット（to_call: 120）が必要です。相手のベット額とポットサイズを考慮すると、このハンドでコールするのは有利ではありません。相手が強いハンドを持っている可能性が高いため、フォールドを選択します。"\n}\n```'
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "AJオフスート (A♥J♠) は強いハンドですが、プリフロップで既に複数のレイズがあり、コールするにはポットに対して大きすぎるベット（to_call: 120）が必要です。相手のベット額とポットサイズを考慮すると、このハンドでコールするのは有利ではありません。相手が強いハンドを持っている可能性が高いため、フォールドを選択します。"\n}'
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "AJオフスート (A♥J♠) は強いハンドですが、プリフロップで既に複数のレイズがあり、コールするにはポットに対して大きすぎるベット（to_call: 120）が必要です。相手のベット額とポットサイズを考慮すると、このハンドでコールするのは有利ではありません。相手が強いハンドを持っている可能性が高いため、フォールドを選択します。"
}
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'AJオフスート (A♥J♠) は強いハンドですが、プリフロップで既に複数のレイズがあり、コールするにはポットに対して大きすぎるベット（to_call: 120）が必要です。相手のベット額とポットサイズを考慮すると、このハンドでコールするのは有利ではありません。相手が強いハンドを持っている可能性が高いため、フォールドを選択します。'}
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] Extracted values - action: 'fold', amount: 0
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] Action 'fold' normalized - amount set to 0
2025-10-31 19:05:43,369 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:05:43,370 - poker_game - INFO - [Agent1] Successfully parsed decision: fold, 0, AJオフスート (A♥J♠) は強いハンドですが、プリフロップで既に複数のレイズがあり、コールするにはポットに対して大きすぎるベット（to_call: 120）が必要です。相手のベット額とポットサイズを考慮すると、このハンドでコールするのは有利ではありません。相手が強いハンドを持っている可能性が高いため、フォールドを選択します。
2025-10-31 19:05:43,370 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'fold' with amount 0
2025-10-31 19:05:43,370 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:43,371 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:43,371 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:05:43,371 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:43,371 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:43,371 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:43,371 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:43,372 - poker_game - INFO - Community cards: []
2025-10-31 19:05:43,372 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:43,372 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=active
2025-10-31 19:05:43,372 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:43,372 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:43,373 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=folded
2025-10-31 19:05:43,373 - poker_game - INFO - ==================================================
2025-10-31 19:05:43,373 - poker_game - INFO - ACTION_EXECUTED: Player 1 folded
2025-10-31 19:05:43,381 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:43,382 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:43,382 - poker_game - INFO - Current player: 1, Dealer: 1
2025-10-31 19:05:43,382 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:43,383 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:43,383 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:43,383 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:43,383 - poker_game - INFO - Community cards: []
2025-10-31 19:05:43,383 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:43,384 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=folded
2025-10-31 19:05:43,384 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:43,384 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:43,384 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=folded
2025-10-31 19:05:43,384 - poker_game - INFO - Extra: Action: Player 1 folded
2025-10-31 19:05:43,384 - poker_game - INFO - ==================================================
2025-10-31 19:05:43,384 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:43,385 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:43,385 - poker_game - DEBUG - Active players: [3]
2025-10-31 19:05:43,385 - poker_game - INFO - Advanced from player 1 to player 3 (seat order)
2025-10-31 19:05:43,385 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:43,385 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:43,385 - poker_game - DEBUG - Active: 1, All-in: 0
2025-10-31 19:05:43,385 - poker_game - INFO - Betting complete: Only 1 or fewer players remaining
2025-10-31 19:05:43,385 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:43,385 - poker_game - INFO - Hand #29, Phase: preflop
2025-10-31 19:05:43,386 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:05:43,386 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:43,386 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:43,386 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:43,386 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:43,386 - poker_game - INFO - Community cards: []
2025-10-31 19:05:43,386 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:43,387 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=folded
2025-10-31 19:05:43,387 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:43,387 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:43,387 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=folded
2025-10-31 19:05:43,388 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:05:43,390 - poker_game - INFO - ==================================================
2025-10-31 19:05:43,494 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:05:43,494 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:43,494 - poker_game - INFO - Remaining players: 1
2025-10-31 19:05:43,495 - poker_game - DEBUG -   Remaining P3: Agent3, status: active
2025-10-31 19:05:43,495 - poker_game - INFO - Going to SHOWDOWN - only 1 or fewer players remaining
2025-10-31 19:05:43,496 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:05:43,496 - poker_game - INFO - Hand #29, Phase: showdown
2025-10-31 19:05:43,496 - poker_game - INFO - Current player: 3, Dealer: 1
2025-10-31 19:05:43,497 - poker_game - INFO - Pot: 180, Current bet: 140
2025-10-31 19:05:43,497 - poker_game - INFO - Last raiser: 3
2025-10-31 19:05:43,497 - poker_game - INFO - Betting round complete: True
2025-10-31 19:05:43,498 - poker_game - INFO - Active players: 1, All-in: 0, Folded: 2
2025-10-31 19:05:43,498 - poker_game - INFO - Community cards: []
2025-10-31 19:05:43,498 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:43,499 - poker_game - INFO -   P1(Agent1): chips=2859, bet=20, status=folded
2025-10-31 19:05:43,499 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:43,499 - poker_game - INFO -   P3(Agent3): chips=427, bet=140, status=active
2025-10-31 19:05:43,500 - poker_game - INFO -   P4(Agent4): chips=6534, bet=20, status=folded
2025-10-31 19:05:43,500 - poker_game - INFO - ==================================================
2025-10-31 19:05:43,500 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:05:43,500 - poker_game - INFO - Pot: 180, Community cards: []
2025-10-31 19:05:43,501 - poker_game - INFO -   Player 3 status=active cards=['8♦', 'Q♦']
2025-10-31 19:05:43,501 - poker_game - INFO - Showdown winner by default: Player 3 awarded 180
2025-10-31 19:05:43,501 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
2025-10-31 19:05:43,502 - poker_game - INFO - === STARTING NEW HAND #30 ===
2025-10-31 19:05:43,503 - poker_game - INFO - Active players for new hand: 3
2025-10-31 19:05:43,503 - poker_game - INFO - Moving dealer button
2025-10-31 19:05:43,504 - poker_game - INFO - Posting blinds
2025-10-31 19:05:43,522 - poker_game - INFO - Dealing hole cards
2025-10-31 19:05:43,523 - poker_game - INFO - Setting first actor for preflop
2025-10-31 19:05:43,533 - poker_game - INFO - Started new hand in database: hand_id=30
2025-10-31 19:05:43,533 - poker_game - INFO - === HAND_STARTED ===
2025-10-31 19:05:43,534 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:05:43,534 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:05:43,534 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:43,535 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:43,535 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:43,535 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:43,536 - poker_game - INFO - Community cards: []
2025-10-31 19:05:43,536 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:43,536 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:05:43,537 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:43,537 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=active
2025-10-31 19:05:43,538 - poker_game - INFO -   P4(Agent4): chips=6524, bet=10, status=active
2025-10-31 19:05:43,538 - poker_game - INFO - ==================================================
2025-10-31 19:05:43,539 - poker_game - DEBUG - LLM Prompt for Agent3: {
  "your_id": 3,
  "phase": "preflop",
  "your_cards": [
    "J♣",
    "6♦"
  ],
  "community": [],
  "your_chips": 607,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 0,
  "pot": 30,
  "to_call": 20,
  "dealer_button": 3,
  "current_turn": 3,
  "players": [
    {
      "id": 1,
      "chips": 2839,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 4,
      "chips": 6524,
      "bet": 10,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (20)",
    "raise (min 40)",
    "all-in (607)"
  ],
  "history": [
    "Player 3 raised to 860",
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20"
  ]
}
2025-10-31 19:05:43,550 - poker_game - DEBUG - Create Session: {'id': 'dbebb7b3-0d6d-4b27-a259-4c4fcc371cfb', 'appName': 'beginner_agent', 'userId': 'player_3', 'state': {}, 'events': [], 'lastUpdateTime': 1761905143.5481522}
2025-10-31 19:05:45,233 - poker_game - INFO - LLM raw Response for Agent3: [{'content': {'parts': [{'text': '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "JJ, 6♦はプリフロップではあまり強くないハンドです。ポットに20をコールするには、相手のベット額に対してリスクが高すぎます。相手のベット額はポットサイズ（30）よりも大きく、さらにコール額（20）も考慮すると、より強いハンドを持っている可能性が高いです。そのため、フォールド（降りる）のが最善の選択です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 113, 'promptTokenCount': 776, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 776}], 'totalTokenCount': 889}, 'invocationId': 'e-76d70886-d726-4fb1-bc05-18cda47efcd0', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'vagTvwaw', 'timestamp': 1761905143.561674}]
2025-10-31 19:05:45,234 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent3:
2025-10-31 19:05:45,234 - poker_game - DEBUG - ```json
{
  "action": "fold",
  "amount": 0,
  "reasoning": "JJ, 6♦はプリフロップではあまり強くないハンドです。ポットに20をコールするには、相手のベット額に対してリスクが高すぎます。相手のベット額はポットサイズ（30）よりも大きく、さらにコール額（20）も考慮すると、より強いハンドを持っている可能性が高いです。そのため、フォールド（降りる）のが最善の選択です。"
}
```
2025-10-31 19:05:45,234 - poker_game - DEBUG - [Agent3] Starting LLM API response parsing
2025-10-31 19:05:45,234 - poker_game - DEBUG - [Agent3] Raw response content: '```json\n{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "JJ, 6♦はプリフロップではあまり強くないハンドです。ポットに20をコールするには、相手のベット額に対してリスクが高すぎます。相手のベット額はポットサイズ（30）よりも大きく、さらにコール額（20）も考慮すると、より強いハンドを持っている可能性が高いです。そのため、フォールド（降りる）のが最善の選択です。"\n}\n```'
2025-10-31 19:05:45,234 - poker_game - DEBUG - [Agent3] Markdown code block detected
2025-10-31 19:05:45,234 - poker_game - DEBUG - [Agent3] Extracted content from markdown: '{\n  "action": "fold",\n  "amount": 0,\n  "reasoning": "JJ, 6♦はプリフロップではあまり強くないハンドです。ポットに20をコールするには、相手のベット額に対してリスクが高すぎます。相手のベット額はポットサイズ（30）よりも大きく、さらにコール額（20）も考慮すると、より強いハンドを持っている可能性が高いです。そのため、フォールド（降りる）のが最善の選択です。"\n}'
2025-10-31 19:05:45,235 - poker_game - DEBUG - [Agent3] JSON pattern found: {
  "action": "fold",
  "amount": 0,
  "reasoning": "JJ, 6♦はプリフロップではあまり強くないハンドです。ポットに20をコールするには、相手のベット額に対してリスクが高すぎます。相手のベット額はポットサイズ（30）よりも大きく、さらにコール額（20）も考慮すると、より強いハンドを持っている可能性が高いです。そのため、フォールド（降りる）のが最善の選択です。"
}
2025-10-31 19:05:45,235 - poker_game - DEBUG - [Agent3] JSON parsing successful: {'action': 'fold', 'amount': 0, 'reasoning': 'JJ, 6♦はプリフロップではあまり強くないハンドです。ポットに20をコールするには、相手のベット額に対してリスクが高すぎます。相手のベット額はポットサイズ（30）よりも大きく、さらにコール額（20）も考慮すると、より強いハンドを持っている可能性が高いです。そのため、フォールド（降りる）のが最善の選択です。'}
2025-10-31 19:05:45,235 - poker_game - DEBUG - [Agent3] Extracted values - action: 'fold', amount: 0
2025-10-31 19:05:45,235 - poker_game - DEBUG - [Agent3] Action 'fold' normalized - amount set to 0
2025-10-31 19:05:45,235 - poker_game - DEBUG - [Agent3] Final parsed decision: {'action': 'fold', 'amount': 0}
2025-10-31 19:05:45,235 - poker_game - INFO - [Agent3] Successfully parsed decision: fold, 0, JJ, 6♦はプリフロップではあまり強くないハンドです。ポットに20をコールするには、相手のベット額に対してリスクが高すぎます。相手のベット額はポットサイズ（30）よりも大きく、さらにコール額（20）も考慮すると、より強いハンドを持っている可能性が高いです。そのため、フォールド（降りる）のが最善の選択です。
2025-10-31 19:05:45,236 - poker_game - INFO - >>> PROCESS_ACTION: Player 3 attempts 'fold' with amount 0
2025-10-31 19:05:45,236 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:05:45,236 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:05:45,236 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:05:45,236 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:45,237 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:45,237 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:45,237 - poker_game - INFO - Active players: 3, All-in: 0, Folded: 0
2025-10-31 19:05:45,237 - poker_game - INFO - Community cards: []
2025-10-31 19:05:45,237 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:45,237 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:05:45,237 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:45,237 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=active
2025-10-31 19:05:45,237 - poker_game - INFO -   P4(Agent4): chips=6524, bet=10, status=active
2025-10-31 19:05:45,237 - poker_game - INFO - ==================================================
2025-10-31 19:05:45,237 - poker_game - INFO - ACTION_EXECUTED: Player 3 folded
2025-10-31 19:05:45,246 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:05:45,246 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:05:45,246 - poker_game - INFO - Current player: 3, Dealer: 3
2025-10-31 19:05:45,246 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:45,247 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:45,247 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:45,247 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:45,247 - poker_game - INFO - Community cards: []
2025-10-31 19:05:45,248 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:45,248 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:05:45,248 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:45,248 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:05:45,249 - poker_game - INFO -   P4(Agent4): chips=6524, bet=10, status=active
2025-10-31 19:05:45,249 - poker_game - INFO - Extra: Action: Player 3 folded
2025-10-31 19:05:45,249 - poker_game - INFO - ==================================================
2025-10-31 19:05:45,249 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:05:45,249 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:05:45,250 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:05:45,250 - poker_game - INFO - Advanced from player 3 to player 4 (seat order)
2025-10-31 19:05:45,250 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:05:45,250 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:05:45,250 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:05:45,250 - poker_game - DEBUG - Player bets: [20, 10], Current bet: 20, All same: False
2025-10-31 19:05:45,250 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:05:45,250 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:05:45,251 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:05:45,251 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:05:45,251 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:05:45,251 - poker_game - INFO - Last raiser: 1
2025-10-31 19:05:45,251 - poker_game - INFO - Betting round complete: False
2025-10-31 19:05:45,252 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:05:45,252 - poker_game - INFO - Community cards: []
2025-10-31 19:05:45,252 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:05:45,252 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:05:45,252 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:05:45,253 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:05:45,253 - poker_game - INFO -   P4(Agent4): chips=6524, bet=10, status=active
2025-10-31 19:05:45,253 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:05:45,253 - poker_game - INFO - ==================================================
2025-10-31 19:05:45,354 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "K♣",
    "4♦"
  ],
  "community": [],
  "your_chips": 6524,
  "your_bet_this_round": 10,
  "your_total_bet_this_hand": 10,
  "pot": 30,
  "to_call": 10,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2839,
      "bet": 20,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (10)",
    "raise (min 40)",
    "all-in (6524)"
  ],
  "history": [
    "Player 4 raised to 2710",
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded"
  ]
}
2025-10-31 19:05:45,367 - poker_game - DEBUG - Create Session: {'id': '1bd871f7-9653-4e8a-b622-425218f1812e', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905145.3651183}
2025-10-31 19:05:55,428 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:06:05,415 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:06:06,943 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_y6W7rDCncsyVD1DHVx6ilyKZ', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1085, 'totalTokenCount': 1102}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '50RFEHa0', 'timestamp': 1761905145.377865}, {'content': {'parts': [{'functionResponse': {'id': 'call_y6W7rDCncsyVD1DHVx6ilyKZ', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '572lvHfp', 'timestamp': 1761905146.25494}, {'content': {'parts': [{'functionCall': {'id': 'call_PlkgbjTV0j4eAdlhfCKeWlv2', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1609, 'totalTokenCount': 1629}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'j0oU4b5q', 'timestamp': 1761905146.256536}, {'content': {'parts': [{'functionResponse': {'id': 'call_PlkgbjTV0j4eAdlhfCKeWlv2', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': '3U9g6qTN', 'timestamp': 1761905145.328089}, {'content': {'parts': [{'functionCall': {'id': 'call_cYDR4oEOFIqV54zIe9aA2QdW', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1171, 'totalTokenCount': 1188}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'fBirm71Z', 'timestamp': 1761905145.329597}, {'content': {'parts': [{'functionResponse': {'id': 'call_cYDR4oEOFIqV54zIe9aA2QdW', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'fZJhhVL0', 'timestamp': 1761905146.368759}, {'content': {'parts': [{'functionCall': {'id': 'call_e71WHsJdYT8r4cN1kmOOcgtU', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['K♣', '4♦'], 'community': [], 'your_chips': 6524, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2839, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (6524)'], 'history': ['Player 4 raised to 2710', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 3990', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.4}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_XjKgsEDBZRX2908MXliXnRMT', 'args': {'game_state': {'your_id': 4, 'phase': 'preflop', 'your_cards': ['K♣', '4♦'], 'community': [], 'your_chips': 6524, 'your_bet_this_round': 10, 'your_total_bet_this_hand': 10, 'pot': 30, 'to_call': 10, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2839, 'bet': 20, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'call (10)', 'raise (min 40)', 'all-in (6524)'], 'history': ['Player 4 raised to 2710', 'Player 1 folded', 'Player 3 folded', 'Showdown: Player 4 won 3990', 'Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded']}, 'call_amount': 10, 'pot_after_call': 40, 'equity': 0.4}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 650, 'promptTokenCount': 1701, 'totalTokenCount': 2351}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 't5oQbwsg', 'timestamp': 1761905146.370739}, {'content': {'parts': [{'functionResponse': {'id': 'call_e71WHsJdYT8r4cN1kmOOcgtU', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10'}}}, {'functionResponse': {'id': 'call_XjKgsEDBZRX2908MXliXnRMT', 'name': 'action_decision', 'response': {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており（10.00(ポットに対して33.33%）、コールが妥当と判断。コール額: 10'}}}], 'role': 'user'}, 'invocationId': 'utafLNlf', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'smAEULpS', 'timestamp': 1761905164.332531}, {'content': {'parts': [{'text': '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており(10.00(ポットに対して33.33%))、コールが妥当と判断。コール額: 10"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 55, 'promptTokenCount': 2659, 'totalTokenCount': 2714}, 'invocationId': 'e-97faf568-b26a-45c3-b2ff-a35e30d43511', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '9t1OTlnl', 'timestamp': 1761905164.336749}]
2025-10-31 19:06:06,944 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:06:06,945 - poker_game - DEBUG - {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており(10.00(ポットに対して33.33%))、コールが妥当と判断。コール額: 10"}
2025-10-31 19:06:06,945 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:06:06,946 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"call","amount":10,"reasoning":"ポットオッズを満たしており(10.00(ポットに対して33.33%))、コールが妥当と判断。コール額: 10"}'
2025-10-31 19:06:06,946 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:06:06,946 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"call","amount":10,"reasoning":"ポットオッズを満たしており(10.00(ポットに対して33.33%))、コールが妥当と判断。コール額: 10"}
2025-10-31 19:06:06,947 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 10, 'reasoning': 'ポットオッズを満たしており(10.00(ポットに対して33.33%))、コールが妥当と判断。コール額: 10'}
2025-10-31 19:06:06,947 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 10
2025-10-31 19:06:06,947 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (10)', 'raise (min 40)', 'all-in (6524)']
2025-10-31 19:06:06,947 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (10)': 10
2025-10-31 19:06:06,947 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 10}
2025-10-31 19:06:06,947 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 10, ポットオッズを満たしており(10.00(ポットに対して33.33%))、コールが妥当と判断。コール額: 10
2025-10-31 19:06:06,949 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 10
2025-10-31 19:06:06,950 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:06:06,950 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:06,951 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:06,952 - poker_game - INFO - Pot: 30, Current bet: 20
2025-10-31 19:06:06,953 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:06,954 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:06,955 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:06,955 - poker_game - INFO - Community cards: []
2025-10-31 19:06:06,956 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:06,957 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:06:06,958 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:06,958 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:06,959 - poker_game - INFO -   P4(Agent4): chips=6524, bet=10, status=active
2025-10-31 19:06:06,959 - poker_game - INFO - ==================================================
2025-10-31 19:06:06,960 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 10
2025-10-31 19:06:06,971 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:06:06,972 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:06,972 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:06,973 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:06:06,973 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:06,974 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:06,974 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:06,975 - poker_game - INFO - Community cards: []
2025-10-31 19:06:06,975 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:06,976 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:06:06,976 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:06,976 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:06,976 - poker_game - INFO -   P4(Agent4): chips=6514, bet=20, status=active
2025-10-31 19:06:06,977 - poker_game - INFO - Extra: Action: Player 4 called 10
2025-10-31 19:06:06,977 - poker_game - INFO - ==================================================
2025-10-31 19:06:06,978 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:06:06,978 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:06:06,978 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:06:06,979 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:06:06,979 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:06:06,980 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:06:06,980 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:06:06,980 - poker_game - DEBUG - Player bets: [20, 20], Current bet: 20, All same: True
2025-10-31 19:06:06,980 - poker_game - DEBUG - Active player indices: [1, 4]
2025-10-31 19:06:06,980 - poker_game - DEBUG - Last raiser index: 1
2025-10-31 19:06:06,981 - poker_game - DEBUG - Current player index: 1
2025-10-31 19:06:06,981 - poker_game - DEBUG - Next after last raiser 1: 4
2025-10-31 19:06:06,981 - poker_game - DEBUG - Betting continues: Current player 1 != next after raiser 4
2025-10-31 19:06:06,981 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:06:06,982 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:06,983 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:06,983 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:06:06,984 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:06,985 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:06,985 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:06,987 - poker_game - INFO - Community cards: []
2025-10-31 19:06:06,988 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:06,988 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:06:06,989 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:06,990 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:06,990 - poker_game - INFO -   P4(Agent4): chips=6514, bet=20, status=active
2025-10-31 19:06:06,991 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:06:06,991 - poker_game - INFO - ==================================================
2025-10-31 19:06:07,092 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "preflop",
  "your_cards": [
    "2♥",
    "A♥"
  ],
  "community": [],
  "your_chips": 2839,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 40,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6514,
      "bet": 20,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 40)",
    "all-in (2839)"
  ],
  "history": [
    "Player 1 folded",
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10"
  ]
}
2025-10-31 19:06:07,111 - poker_game - DEBUG - Create Session: {'id': '2a4694f6-35cd-4fd8-967a-072d34aea817', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905167.10824}
2025-10-31 19:06:09,023 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "A♥ K♥は非常に強いハンド（プレフロップで最も強力なハンドの一つ）なので、レイズします。相手がコールする可能性があり、ポットを大きくして有利な状況を作ります。相手のベット額（20）とポットサイズ（40）を考慮し、ミニマムレイズ（40）よりも少し強い60にレイズします。これにより、相手にプレッシャーを与え、ポットコントロールの選択肢を狭めます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 131, 'promptTokenCount': 766, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 766}], 'totalTokenCount': 897}, 'invocationId': 'e-bd195cdd-93b5-4528-a206-09cd06c52349', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'zbYKpYrj', 'timestamp': 1761905167.123561}]
2025-10-31 19:06:09,024 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:06:09,024 - poker_game - DEBUG - ```json
{
  "action": "raise",
  "amount": 60,
  "reasoning": "A♥ K♥は非常に強いハンド（プレフロップで最も強力なハンドの一つ）なので、レイズします。相手がコールする可能性があり、ポットを大きくして有利な状況を作ります。相手のベット額（20）とポットサイズ（40）を考慮し、ミニマムレイズ（40）よりも少し強い60にレイズします。これにより、相手にプレッシャーを与え、ポットコントロールの選択肢を狭めます。"
}
```
2025-10-31 19:06:09,025 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:06:09,025 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "A♥ K♥は非常に強いハンド（プレフロップで最も強力なハンドの一つ）なので、レイズします。相手がコールする可能性があり、ポットを大きくして有利な状況を作ります。相手のベット額（20）とポットサイズ（40）を考慮し、ミニマムレイズ（40）よりも少し強い60にレイズします。これにより、相手にプレッシャーを与え、ポットコントロールの選択肢を狭めます。"\n}\n```'
2025-10-31 19:06:09,025 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:06:09,025 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "raise",\n  "amount": 60,\n  "reasoning": "A♥ K♥は非常に強いハンド（プレフロップで最も強力なハンドの一つ）なので、レイズします。相手がコールする可能性があり、ポットを大きくして有利な状況を作ります。相手のベット額（20）とポットサイズ（40）を考慮し、ミニマムレイズ（40）よりも少し強い60にレイズします。これにより、相手にプレッシャーを与え、ポットコントロールの選択肢を狭めます。"\n}'
2025-10-31 19:06:09,026 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "raise",
  "amount": 60,
  "reasoning": "A♥ K♥は非常に強いハンド（プレフロップで最も強力なハンドの一つ）なので、レイズします。相手がコールする可能性があり、ポットを大きくして有利な状況を作ります。相手のベット額（20）とポットサイズ（40）を考慮し、ミニマムレイズ（40）よりも少し強い60にレイズします。これにより、相手にプレッシャーを与え、ポットコントロールの選択肢を狭めます。"
}
2025-10-31 19:06:09,026 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'raise', 'amount': 60, 'reasoning': 'A♥ K♥は非常に強いハンド（プレフロップで最も強力なハンドの一つ）なので、レイズします。相手がコールする可能性があり、ポットを大きくして有利な状況を作ります。相手のベット額（20）とポットサイズ（40）を考慮し、ミニマムレイズ（40）よりも少し強い60にレイズします。これにより、相手にプレッシャーを与え、ポットコントロールの選択肢を狭めます。'}
2025-10-31 19:06:09,026 - poker_game - DEBUG - [Agent1] Extracted values - action: 'raise', amount: 60
2025-10-31 19:06:09,026 - poker_game - DEBUG - [Agent1] Processing raise action - available actions: ['fold', 'check', 'raise (min 40)', 'all-in (2839)']
2025-10-31 19:06:09,026 - poker_game - DEBUG - [Agent1] Minimum raise amount extracted from 'raise (min 40)': 40
2025-10-31 19:06:09,027 - poker_game - DEBUG - [Agent1] Raise amount 60 is valid (min: 40)
2025-10-31 19:06:09,027 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'raise', 'amount': 60}
2025-10-31 19:06:09,027 - poker_game - INFO - [Agent1] Successfully parsed decision: raise, 60, A♥ K♥は非常に強いハンド（プレフロップで最も強力なハンドの一つ）なので、レイズします。相手がコールする可能性があり、ポットを大きくして有利な状況を作ります。相手のベット額（20）とポットサイズ（40）を考慮し、ミニマムレイズ（40）よりも少し強い60にレイズします。これにより、相手にプレッシャーを与え、ポットコントロールの選択肢を狭めます。
2025-10-31 19:06:09,029 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'raise' with amount 60
2025-10-31 19:06:09,029 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:06:09,030 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:09,030 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:09,031 - poker_game - INFO - Pot: 40, Current bet: 20
2025-10-31 19:06:09,032 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:09,033 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:09,034 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:09,035 - poker_game - INFO - Community cards: []
2025-10-31 19:06:09,035 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:09,036 - poker_game - INFO -   P1(Agent1): chips=2839, bet=20, status=active
2025-10-31 19:06:09,037 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:09,037 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:09,038 - poker_game - INFO -   P4(Agent4): chips=6514, bet=20, status=active
2025-10-31 19:06:09,038 - poker_game - INFO - ==================================================
2025-10-31 19:06:09,039 - poker_game - INFO - ACTION_EXECUTED: Player 1 raised to 80
2025-10-31 19:06:09,053 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:06:09,053 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:09,054 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:09,054 - poker_game - INFO - Pot: 100, Current bet: 80
2025-10-31 19:06:09,055 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:09,055 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:09,055 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:09,056 - poker_game - INFO - Community cards: []
2025-10-31 19:06:09,056 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:09,057 - poker_game - INFO -   P1(Agent1): chips=2779, bet=80, status=active
2025-10-31 19:06:09,057 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:09,058 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:09,058 - poker_game - INFO -   P4(Agent4): chips=6514, bet=20, status=active
2025-10-31 19:06:09,058 - poker_game - INFO - Extra: Action: Player 1 raised to 80
2025-10-31 19:06:09,059 - poker_game - INFO - ==================================================
2025-10-31 19:06:09,059 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:06:09,060 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:06:09,060 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:06:09,060 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 19:06:09,061 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:06:09,061 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:06:09,062 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:06:09,062 - poker_game - DEBUG - Player bets: [80, 20], Current bet: 80, All same: False
2025-10-31 19:06:09,062 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:06:09,062 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:06:09,063 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:09,063 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:09,063 - poker_game - INFO - Pot: 100, Current bet: 80
2025-10-31 19:06:09,064 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:09,065 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:09,065 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:09,066 - poker_game - INFO - Community cards: []
2025-10-31 19:06:09,066 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:09,067 - poker_game - INFO -   P1(Agent1): chips=2779, bet=80, status=active
2025-10-31 19:06:09,067 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:09,068 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:09,068 - poker_game - INFO -   P4(Agent4): chips=6514, bet=20, status=active
2025-10-31 19:06:09,068 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:06:09,068 - poker_game - INFO - ==================================================
2025-10-31 19:06:09,171 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "preflop",
  "your_cards": [
    "K♣",
    "4♦"
  ],
  "community": [],
  "your_chips": 6514,
  "your_bet_this_round": 20,
  "your_total_bet_this_hand": 20,
  "pot": 100,
  "to_call": 60,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2779,
      "bet": 80,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "call (60)",
    "raise (min 100)",
    "all-in (6514)"
  ],
  "history": [
    "Player 3 folded",
    "Showdown: Player 4 won 3990",
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80"
  ]
}
2025-10-31 19:06:09,181 - poker_game - DEBUG - Create Session: {'id': '0f3a1e43-0a2d-489c-8853-6b7163230c14', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905169.1800416}
2025-10-31 19:06:12,481 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_cxaM3rcPYufUzjDjxBSjUoR6', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1086, 'totalTokenCount': 1103}, 'invocationId': 'e-db948f5f-9a75-4d25-a791-824acd7b6863', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '5YHBHLNT', 'timestamp': 1761905169.190739}, {'content': {'parts': [{'functionResponse': {'id': 'call_cxaM3rcPYufUzjDjxBSjUoR6', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-db948f5f-9a75-4d25-a791-824acd7b6863', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': '0j5dsA5F', 'timestamp': 1761905170.305966}, {'content': {'parts': [{'functionCall': {'id': 'call_y0BMGBcchlBIYkz8eikDOqxT', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1610, 'totalTokenCount': 1630}, 'invocationId': 'e-db948f5f-9a75-4d25-a791-824acd7b6863', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'zGGVjLho', 'timestamp': 1761905170.310876}, {'content': {'parts': [{'functionResponse': {'id': 'call_y0BMGBcchlBIYkz8eikDOqxT', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-db948f5f-9a75-4d25-a791-824acd7b6863', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'xggrvWV5', 'timestamp': 1761905171.863597}, {'content': {'parts': [{'text': '{\n  "action": "call",\n  "amount": 60,\n  "reasoning": "K♣4♦はプレフロップでの手札としては弱いですが、相手がベットしている額（60）をコールすることでポットを狙えます。より高いアクションを選ぶには手札の強さが不足しているため、リスクを抑えつつプレイを続けます。"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 104, 'promptTokenCount': 1172, 'totalTokenCount': 1276}, 'invocationId': 'e-db948f5f-9a75-4d25-a791-824acd7b6863', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'MfM3IdiY', 'timestamp': 1761905171.867156}]
2025-10-31 19:06:12,481 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:06:12,481 - poker_game - DEBUG - {
  "action": "call",
  "amount": 60,
  "reasoning": "K♣4♦はプレフロップでの手札としては弱いですが、相手がベットしている額（60）をコールすることでポットを狙えます。より高いアクションを選ぶには手札の強さが不足しているため、リスクを抑えつつプレイを続けます。"
}
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "call",\n  "amount": 60,\n  "reasoning": "K♣4♦はプレフロップでの手札としては弱いですが、相手がベットしている額（60）をコールすることでポットを狙えます。より高いアクションを選ぶには手札の強さが不足しているため、リスクを抑えつつプレイを続けます。"\n}'
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "call",
  "amount": 60,
  "reasoning": "K♣4♦はプレフロップでの手札としては弱いですが、相手がベットしている額（60）をコールすることでポットを狙えます。より高いアクションを選ぶには手札の強さが不足しているため、リスクを抑えつつプレイを続けます。"
}
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'call', 'amount': 60, 'reasoning': 'K♣4♦はプレフロップでの手札としては弱いですが、相手がベットしている額（60）をコールすることでポットを狙えます。より高いアクションを選ぶには手札の強さが不足しているため、リスクを抑えつつプレイを続けます。'}
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] Extracted values - action: 'call', amount: 60
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] Processing call action - available actions: ['fold', 'call (60)', 'raise (min 100)', 'all-in (6514)']
2025-10-31 19:06:12,482 - poker_game - DEBUG - [Agent4] Call amount extracted from 'call (60)': 60
2025-10-31 19:06:12,483 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'call', 'amount': 60}
2025-10-31 19:06:12,483 - poker_game - INFO - [Agent4] Successfully parsed decision: call, 60, K♣4♦はプレフロップでの手札としては弱いですが、相手がベットしている額（60）をコールすることでポットを狙えます。より高いアクションを選ぶには手札の強さが不足しているため、リスクを抑えつつプレイを続けます。
2025-10-31 19:06:12,483 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'call' with amount 60
2025-10-31 19:06:12,484 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:06:12,484 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:12,484 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:12,484 - poker_game - INFO - Pot: 100, Current bet: 80
2025-10-31 19:06:12,484 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:12,485 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:12,485 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:12,485 - poker_game - INFO - Community cards: []
2025-10-31 19:06:12,485 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:12,485 - poker_game - INFO -   P1(Agent1): chips=2779, bet=80, status=active
2025-10-31 19:06:12,486 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:12,486 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:12,486 - poker_game - INFO -   P4(Agent4): chips=6514, bet=20, status=active
2025-10-31 19:06:12,486 - poker_game - INFO - ==================================================
2025-10-31 19:06:12,486 - poker_game - INFO - ACTION_EXECUTED: Player 4 called 60
2025-10-31 19:06:12,495 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:06:12,496 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:12,496 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:12,496 - poker_game - INFO - Pot: 160, Current bet: 80
2025-10-31 19:06:12,496 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:12,496 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:12,497 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:12,497 - poker_game - INFO - Community cards: []
2025-10-31 19:06:12,497 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:12,497 - poker_game - INFO -   P1(Agent1): chips=2779, bet=80, status=active
2025-10-31 19:06:12,498 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:12,498 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:12,498 - poker_game - INFO -   P4(Agent4): chips=6454, bet=80, status=active
2025-10-31 19:06:12,499 - poker_game - INFO - Extra: Action: Player 4 called 60
2025-10-31 19:06:12,499 - poker_game - INFO - ==================================================
2025-10-31 19:06:12,499 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:06:12,500 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:06:12,500 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:06:12,500 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:06:12,500 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:06:12,501 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:06:12,501 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:06:12,501 - poker_game - DEBUG - Player bets: [80, 80], Current bet: 80, All same: True
2025-10-31 19:06:12,501 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:06:12,501 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:06:12,501 - poker_game - INFO - Hand #30, Phase: preflop
2025-10-31 19:06:12,502 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:12,502 - poker_game - INFO - Pot: 160, Current bet: 80
2025-10-31 19:06:12,502 - poker_game - INFO - Last raiser: 1
2025-10-31 19:06:12,502 - poker_game - INFO - Betting round complete: True
2025-10-31 19:06:12,502 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:12,502 - poker_game - INFO - Community cards: []
2025-10-31 19:06:12,503 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:12,503 - poker_game - INFO -   P1(Agent1): chips=2779, bet=80, status=active
2025-10-31 19:06:12,503 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:12,503 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:12,503 - poker_game - INFO -   P4(Agent4): chips=6454, bet=80, status=active
2025-10-31 19:06:12,504 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:06:12,504 - poker_game - INFO - ==================================================
2025-10-31 19:06:12,605 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: preflop
2025-10-31 19:06:12,606 - poker_game - INFO - Betting round complete: True
2025-10-31 19:06:12,606 - poker_game - INFO - Remaining players: 2
2025-10-31 19:06:12,607 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:06:12,607 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:06:12,607 - poker_game - INFO - Phase changed: PREFLOP -> FLOP
2025-10-31 19:06:12,622 - poker_game - INFO - Starting new betting round
2025-10-31 19:06:12,623 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:06:12,623 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:06:12,623 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 19:06:12,623 - poker_game - DEBUG - Dealer button: 3
2025-10-31 19:06:12,624 - poker_game - INFO - First actor: Player 4 (by phase rule), was 1
2025-10-31 19:06:12,624 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:06:12,624 - poker_game - INFO - Hand #30, Phase: flop
2025-10-31 19:06:12,624 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:12,624 - poker_game - INFO - Pot: 160, Current bet: 0
2025-10-31 19:06:12,624 - poker_game - INFO - Last raiser: None
2025-10-31 19:06:12,625 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:12,625 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:12,625 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠']
2025-10-31 19:06:12,626 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:12,626 - poker_game - INFO -   P1(Agent1): chips=2779, bet=0, status=active
2025-10-31 19:06:12,627 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:12,627 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:12,627 - poker_game - INFO -   P4(Agent4): chips=6454, bet=0, status=active
2025-10-31 19:06:12,628 - poker_game - INFO - Extra: Phase: preflop -> flop
2025-10-31 19:06:12,628 - poker_game - INFO - ==================================================
2025-10-31 19:06:12,629 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "flop",
  "your_cards": [
    "K♣",
    "4♦"
  ],
  "community": [
    "Q♦",
    "8♥",
    "K♠"
  ],
  "your_chips": 6454,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 160,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2779,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6454)"
  ],
  "history": [
    "Player 1 posted small blind 10",
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: Q♦, 8♥, K♠"
  ]
}
2025-10-31 19:06:12,640 - poker_game - DEBUG - Create Session: {'id': '7c701478-dd3e-49ea-a8d7-c39d1e93beb8', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905172.6370049}
2025-10-31 19:06:22,686 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:06:32,696 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:06:35,001 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_46ChZEHFxGlwmZUEDP6VL5H5', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1107, 'totalTokenCount': 1124}, 'invocationId': 'e-c71b8fa9-0aa9-4fa8-9045-b3fe28163073', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'FUT4rWsT', 'timestamp': 1761905172.653771}, {'content': {'parts': [{'functionResponse': {'id': 'call_46ChZEHFxGlwmZUEDP6VL5H5', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-c71b8fa9-0aa9-4fa8-9045-b3fe28163073', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'FXKU0dkH', 'timestamp': 1761905174.108842}, {'content': {'parts': [{'functionCall': {'id': 'call_UyvSNq84IOextuLgeP8npWUF', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['K♣', '4♦'], 'community': ['Q♦', '8♥', 'K♠'], 'your_chips': 6454, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 80, 'pot': 160, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2779, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6454)'], 'history': ['Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60', 'Flop dealt: Q♦, 8♥, K♠']}, 'call_amount': 0, 'pot_after_call': 160, 'equity': 0.5}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_z9w0FDPitnhgrXUDTWm1cZ2G', 'args': {'game_state': {'your_id': 4, 'phase': 'flop', 'your_cards': ['K♣', '4♦'], 'community': ['Q♦', '8♥', 'K♠'], 'your_chips': 6454, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 80, 'pot': 160, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2779, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6454)'], 'history': ['Player 1 posted small blind 10', 'Player 3 posted big blind 20', 'Player 4 folded', 'Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60', 'Flop dealt: Q♦, 8♥, K♠']}, 'call_amount': 0, 'pot_after_call': 160, 'equity': 0.5}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 676, 'promptTokenCount': 1631, 'totalTokenCount': 2307}, 'invocationId': 'e-c71b8fa9-0aa9-4fa8-9045-b3fe28163073', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'OrJ7JU6M', 'timestamp': 1761905174.112622}, {'content': {'parts': [{'functionResponse': {'id': 'call_UyvSNq84IOextuLgeP8npWUF', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 80, 'reasoning': '期待値が見込める（80.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 80'}}}, {'functionResponse': {'id': 'call_z9w0FDPitnhgrXUDTWm1cZ2G', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 80, 'reasoning': '期待値が見込める（80.00(ポットに対して50.00%）ため、1/2ポットでセミブラフします。ベット額: 80'}}}], 'role': 'user'}, 'invocationId': '5ZQ83phx', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'lIMWu2O2', 'timestamp': 1761905192.677283}, {'content': {'parts': [{'text': '{\n  "action": "raise",\n  "amount": 80,\n  "reasoning": "期待値が見込める(80.00(ポットに対して50.00%))ため、1/2ポットでセミブラフします。ベット額: 80"\n}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 66, 'promptTokenCount': 2623, 'totalTokenCount': 2689}, 'invocationId': 'e-c71b8fa9-0aa9-4fa8-9045-b3fe28163073', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'mdGv9iTd', 'timestamp': 1761905192.683219}]
2025-10-31 19:06:35,001 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:06:35,001 - poker_game - DEBUG - {
  "action": "raise",
  "amount": 80,
  "reasoning": "期待値が見込める(80.00(ポットに対して50.00%))ため、1/2ポットでセミブラフします。ベット額: 80"
}
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] Raw response content: '{\n  "action": "raise",\n  "amount": 80,\n  "reasoning": "期待値が見込める(80.00(ポットに対して50.00%))ため、1/2ポットでセミブラフします。ベット額: 80"\n}'
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] JSON pattern found: {
  "action": "raise",
  "amount": 80,
  "reasoning": "期待値が見込める(80.00(ポットに対して50.00%))ため、1/2ポットでセミブラフします。ベット額: 80"
}
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 80, 'reasoning': '期待値が見込める(80.00(ポットに対して50.00%))ため、1/2ポットでセミブラフします。ベット額: 80'}
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 80
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (6454)']
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 19:06:35,002 - poker_game - DEBUG - [Agent4] Raise amount 80 is valid (min: 20)
2025-10-31 19:06:35,003 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 80}
2025-10-31 19:06:35,003 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 80, 期待値が見込める(80.00(ポットに対して50.00%))ため、1/2ポットでセミブラフします。ベット額: 80
2025-10-31 19:06:35,003 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 80
2025-10-31 19:06:35,003 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:06:35,004 - poker_game - INFO - Hand #30, Phase: flop
2025-10-31 19:06:35,004 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:35,004 - poker_game - INFO - Pot: 160, Current bet: 0
2025-10-31 19:06:35,004 - poker_game - INFO - Last raiser: None
2025-10-31 19:06:35,004 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:35,005 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:35,005 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠']
2025-10-31 19:06:35,005 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:35,005 - poker_game - INFO -   P1(Agent1): chips=2779, bet=0, status=active
2025-10-31 19:06:35,005 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:35,006 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:35,006 - poker_game - INFO -   P4(Agent4): chips=6454, bet=0, status=active
2025-10-31 19:06:35,006 - poker_game - INFO - ==================================================
2025-10-31 19:06:35,006 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 80
2025-10-31 19:06:35,022 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:06:35,022 - poker_game - INFO - Hand #30, Phase: flop
2025-10-31 19:06:35,022 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:35,022 - poker_game - INFO - Pot: 240, Current bet: 80
2025-10-31 19:06:35,023 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:35,023 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:35,023 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:35,023 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠']
2025-10-31 19:06:35,024 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:35,024 - poker_game - INFO -   P1(Agent1): chips=2779, bet=0, status=active
2025-10-31 19:06:35,024 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:35,024 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:35,024 - poker_game - INFO -   P4(Agent4): chips=6374, bet=80, status=active
2025-10-31 19:06:35,025 - poker_game - INFO - Extra: Action: Player 4 raised to 80
2025-10-31 19:06:35,025 - poker_game - INFO - ==================================================
2025-10-31 19:06:35,025 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:06:35,025 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:06:35,025 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:06:35,025 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:06:35,025 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:06:35,026 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:06:35,026 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:06:35,026 - poker_game - DEBUG - Player bets: [0, 80], Current bet: 80, All same: False
2025-10-31 19:06:35,026 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:06:35,026 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:06:35,026 - poker_game - INFO - Hand #30, Phase: flop
2025-10-31 19:06:35,026 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:35,027 - poker_game - INFO - Pot: 240, Current bet: 80
2025-10-31 19:06:35,027 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:35,027 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:35,027 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:35,027 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠']
2025-10-31 19:06:35,028 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:35,028 - poker_game - INFO -   P1(Agent1): chips=2779, bet=0, status=active
2025-10-31 19:06:35,028 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:35,028 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:35,029 - poker_game - INFO -   P4(Agent4): chips=6374, bet=80, status=active
2025-10-31 19:06:35,029 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:06:35,029 - poker_game - INFO - ==================================================
2025-10-31 19:06:35,130 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "flop",
  "your_cards": [
    "2♥",
    "A♥"
  ],
  "community": [
    "Q♦",
    "8♥",
    "K♠"
  ],
  "your_chips": 2779,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 80,
  "pot": 240,
  "to_call": 80,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6374,
      "bet": 80,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (80)",
    "raise (min 100)",
    "all-in (2779)"
  ],
  "history": [
    "Player 3 posted big blind 20",
    "Player 4 folded",
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: Q♦, 8♥, K♠",
    "Player 4 raised to 80"
  ]
}
2025-10-31 19:06:35,140 - poker_game - DEBUG - Create Session: {'id': '2aa67a44-6785-4007-9df6-11ccc4c57cce', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905195.1375272}
2025-10-31 19:06:37,583 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 80,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）で、あなたの手札はAハイ（エースが最も強いカード）ですが、フラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続するカードが揃うこと）の可能性も秘めています。コミュニティカードにはK（キング）がありますが、あなたの手札にはKはなく、ストレートは完成していません。しかし、A♥があるため、バックドアフラッシュ（まだフラッシュは完成していないが、残りのカードで完成する可能性があること）の可能性があります。相手はベット（チップを賭けること）しており、コール（相手のベット額と同じ額を賭けてゲームを続けること）するには80チップが必要です。ポット（これまでのベット額の合計）は240チップなので、コールはそれほど大きなリスクではありません。相手のベット額とポットサイズを考慮すると、コールして次のカード（ターン）を見るのが最善と判断しました。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 235, 'promptTokenCount': 798, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 798}], 'totalTokenCount': 1033}, 'invocationId': 'e-7fa3629c-8557-432d-831f-b4a7f87ce139', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'KmLsNiAI', 'timestamp': 1761905195.149085}]
2025-10-31 19:06:37,583 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:06:37,584 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 80,
  "reasoning": "フロップ（コミュニティカードが開かれた後）で、あなたの手札はAハイ（エースが最も強いカード）ですが、フラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続するカードが揃うこと）の可能性も秘めています。コミュニティカードにはK（キング）がありますが、あなたの手札にはKはなく、ストレートは完成していません。しかし、A♥があるため、バックドアフラッシュ（まだフラッシュは完成していないが、残りのカードで完成する可能性があること）の可能性があります。相手はベット（チップを賭けること）しており、コール（相手のベット額と同じ額を賭けてゲームを続けること）するには80チップが必要です。ポット（これまでのベット額の合計）は240チップなので、コールはそれほど大きなリスクではありません。相手のベット額とポットサイズを考慮すると、コールして次のカード（ターン）を見るのが最善と判断しました。"
}
```
2025-10-31 19:06:37,584 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:06:37,584 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 80,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）で、あなたの手札はAハイ（エースが最も強いカード）ですが、フラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続するカードが揃うこと）の可能性も秘めています。コミュニティカードにはK（キング）がありますが、あなたの手札にはKはなく、ストレートは完成していません。しかし、A♥があるため、バックドアフラッシュ（まだフラッシュは完成していないが、残りのカードで完成する可能性があること）の可能性があります。相手はベット（チップを賭けること）しており、コール（相手のベット額と同じ額を賭けてゲームを続けること）するには80チップが必要です。ポット（これまでのベット額の合計）は240チップなので、コールはそれほど大きなリスクではありません。相手のベット額とポットサイズを考慮すると、コールして次のカード（ターン）を見るのが最善と判断しました。"\n}\n```'
2025-10-31 19:06:37,584 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:06:37,585 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 80,\n  "reasoning": "フロップ（コミュニティカードが開かれた後）で、あなたの手札はAハイ（エースが最も強いカード）ですが、フラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続するカードが揃うこと）の可能性も秘めています。コミュニティカードにはK（キング）がありますが、あなたの手札にはKはなく、ストレートは完成していません。しかし、A♥があるため、バックドアフラッシュ（まだフラッシュは完成していないが、残りのカードで完成する可能性があること）の可能性があります。相手はベット（チップを賭けること）しており、コール（相手のベット額と同じ額を賭けてゲームを続けること）するには80チップが必要です。ポット（これまでのベット額の合計）は240チップなので、コールはそれほど大きなリスクではありません。相手のベット額とポットサイズを考慮すると、コールして次のカード（ターン）を見るのが最善と判断しました。"\n}'
2025-10-31 19:06:37,585 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 80,
  "reasoning": "フロップ（コミュニティカードが開かれた後）で、あなたの手札はAハイ（エースが最も強いカード）ですが、フラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続するカードが揃うこと）の可能性も秘めています。コミュニティカードにはK（キング）がありますが、あなたの手札にはKはなく、ストレートは完成していません。しかし、A♥があるため、バックドアフラッシュ（まだフラッシュは完成していないが、残りのカードで完成する可能性があること）の可能性があります。相手はベット（チップを賭けること）しており、コール（相手のベット額と同じ額を賭けてゲームを続けること）するには80チップが必要です。ポット（これまでのベット額の合計）は240チップなので、コールはそれほど大きなリスクではありません。相手のベット額とポットサイズを考慮すると、コールして次のカード（ターン）を見るのが最善と判断しました。"
}
2025-10-31 19:06:37,585 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 80, 'reasoning': 'フロップ（コミュニティカードが開かれた後）で、あなたの手札はAハイ（エースが最も強いカード）ですが、フラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続するカードが揃うこと）の可能性も秘めています。コミュニティカードにはK（キング）がありますが、あなたの手札にはKはなく、ストレートは完成していません。しかし、A♥があるため、バックドアフラッシュ（まだフラッシュは完成していないが、残りのカードで完成する可能性があること）の可能性があります。相手はベット（チップを賭けること）しており、コール（相手のベット額と同じ額を賭けてゲームを続けること）するには80チップが必要です。ポット（これまでのベット額の合計）は240チップなので、コールはそれほど大きなリスクではありません。相手のベット額とポットサイズを考慮すると、コールして次のカード（ターン）を見るのが最善と判断しました。'}
2025-10-31 19:06:37,585 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 80
2025-10-31 19:06:37,585 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (80)', 'raise (min 100)', 'all-in (2779)']
2025-10-31 19:06:37,585 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (80)': 80
2025-10-31 19:06:37,586 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 80}
2025-10-31 19:06:37,586 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 80, フロップ（コミュニティカードが開かれた後）で、あなたの手札はAハイ（エースが最も強いカード）ですが、フラッシュ（同じスートのカードが5枚揃うこと）やストレート（数字が連続するカードが揃うこと）の可能性も秘めています。コミュニティカードにはK（キング）がありますが、あなたの手札にはKはなく、ストレートは完成していません。しかし、A♥があるため、バックドアフラッシュ（まだフラッシュは完成していないが、残りのカードで完成する可能性があること）の可能性があります。相手はベット（チップを賭けること）しており、コール（相手のベット額と同じ額を賭けてゲームを続けること）するには80チップが必要です。ポット（これまでのベット額の合計）は240チップなので、コールはそれほど大きなリスクではありません。相手のベット額とポットサイズを考慮すると、コールして次のカード（ターン）を見るのが最善と判断しました。
2025-10-31 19:06:37,586 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 80
2025-10-31 19:06:37,587 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:06:37,587 - poker_game - INFO - Hand #30, Phase: flop
2025-10-31 19:06:37,587 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:37,588 - poker_game - INFO - Pot: 240, Current bet: 80
2025-10-31 19:06:37,588 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:37,588 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:37,588 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:37,589 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠']
2025-10-31 19:06:37,589 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:37,589 - poker_game - INFO -   P1(Agent1): chips=2779, bet=0, status=active
2025-10-31 19:06:37,590 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:37,590 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:37,590 - poker_game - INFO -   P4(Agent4): chips=6374, bet=80, status=active
2025-10-31 19:06:37,591 - poker_game - INFO - ==================================================
2025-10-31 19:06:37,591 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 80
2025-10-31 19:06:37,604 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:06:37,604 - poker_game - INFO - Hand #30, Phase: flop
2025-10-31 19:06:37,605 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:37,605 - poker_game - INFO - Pot: 320, Current bet: 80
2025-10-31 19:06:37,606 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:37,606 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:37,607 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:37,607 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠']
2025-10-31 19:06:37,608 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:37,608 - poker_game - INFO -   P1(Agent1): chips=2699, bet=80, status=active
2025-10-31 19:06:37,609 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:37,609 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:37,610 - poker_game - INFO -   P4(Agent4): chips=6374, bet=80, status=active
2025-10-31 19:06:37,610 - poker_game - INFO - Extra: Action: Player 1 called 80
2025-10-31 19:06:37,610 - poker_game - INFO - ==================================================
2025-10-31 19:06:37,611 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:06:37,611 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:06:37,611 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:06:37,612 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 19:06:37,612 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:06:37,613 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:06:37,613 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:06:37,613 - poker_game - DEBUG - Player bets: [80, 80], Current bet: 80, All same: True
2025-10-31 19:06:37,613 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:06:37,614 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:06:37,614 - poker_game - INFO - Hand #30, Phase: flop
2025-10-31 19:06:37,614 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:37,615 - poker_game - INFO - Pot: 320, Current bet: 80
2025-10-31 19:06:37,615 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:37,616 - poker_game - INFO - Betting round complete: True
2025-10-31 19:06:37,617 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:37,617 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠']
2025-10-31 19:06:37,618 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:37,619 - poker_game - INFO -   P1(Agent1): chips=2699, bet=80, status=active
2025-10-31 19:06:37,619 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:37,620 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:37,621 - poker_game - INFO -   P4(Agent4): chips=6374, bet=80, status=active
2025-10-31 19:06:37,622 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:06:37,622 - poker_game - INFO - ==================================================
2025-10-31 19:06:37,725 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: flop
2025-10-31 19:06:37,726 - poker_game - INFO - Betting round complete: True
2025-10-31 19:06:37,727 - poker_game - INFO - Remaining players: 2
2025-10-31 19:06:37,727 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:06:37,727 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:06:37,727 - poker_game - INFO - Phase changed: FLOP -> TURN
2025-10-31 19:06:37,739 - poker_game - INFO - Starting new betting round
2025-10-31 19:06:37,740 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:06:37,740 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:06:37,741 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 19:06:37,741 - poker_game - DEBUG - Dealer button: 3
2025-10-31 19:06:37,741 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 19:06:37,742 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:06:37,742 - poker_game - INFO - Hand #30, Phase: turn
2025-10-31 19:06:37,742 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:37,743 - poker_game - INFO - Pot: 320, Current bet: 0
2025-10-31 19:06:37,743 - poker_game - INFO - Last raiser: None
2025-10-31 19:06:37,743 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:37,744 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:37,744 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣']
2025-10-31 19:06:37,745 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:37,745 - poker_game - INFO -   P1(Agent1): chips=2699, bet=0, status=active
2025-10-31 19:06:37,746 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:37,747 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:37,748 - poker_game - INFO -   P4(Agent4): chips=6374, bet=0, status=active
2025-10-31 19:06:37,749 - poker_game - INFO - Extra: Phase: flop -> turn
2025-10-31 19:06:37,750 - poker_game - INFO - ==================================================
2025-10-31 19:06:37,751 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "turn",
  "your_cards": [
    "K♣",
    "4♦"
  ],
  "community": [
    "Q♦",
    "8♥",
    "K♠",
    "Q♣"
  ],
  "your_chips": 6374,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 160,
  "pot": 320,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2699,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6374)"
  ],
  "history": [
    "Player 1 raised to 60",
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: Q♦, 8♥, K♠",
    "Player 4 raised to 80",
    "Player 1 called 80",
    "Turn dealt: Q♣"
  ]
}
2025-10-31 19:06:37,804 - poker_game - DEBUG - Create Session: {'id': '270c65d3-fa47-4d5f-89b3-1814a7a61769', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905197.8002126}
2025-10-31 19:06:47,928 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:06:56,566 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_QHqJ9KkktoN9hHQ2XD1SI3Il', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1111, 'totalTokenCount': 1128}, 'invocationId': 'e-ef564759-6cc7-4abd-a379-cdc04693a8bb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'SpWE275l', 'timestamp': 1761905197.818565}, {'content': {'parts': [{'functionResponse': {'id': 'call_QHqJ9KkktoN9hHQ2XD1SI3Il', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-ef564759-6cc7-4abd-a379-cdc04693a8bb', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'ggErWHTw', 'timestamp': 1761905198.826389}, {'content': {'parts': [{'functionCall': {'id': 'call_LSklAECA0hAxLv8FfREs0l2j', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♣', '4♦'], 'community': ['Q♦', '8♥', 'K♠', 'Q♣'], 'your_chips': 6374, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 160, 'pot': 320, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2699, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6374)'], 'history': ['Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60', 'Flop dealt: Q♦, 8♥, K♠', 'Player 4 raised to 80', 'Player 1 called 80', 'Turn dealt: Q♣']}, 'call_amount': 0, 'pot_after_call': 320, 'equity': 0.55}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_yBed0ZxB5RIYXhsHVqoWptJK', 'args': {'game_state': {'your_id': 4, 'phase': 'turn', 'your_cards': ['K♣', '4♦'], 'community': ['Q♦', '8♥', 'K♠', 'Q♣'], 'your_chips': 6374, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 160, 'pot': 320, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2699, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6374)'], 'history': ['Player 1 raised to 60', 'Player 3 folded', 'Showdown: Player 1 won 80', 'Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60', 'Flop dealt: Q♦, 8♥, K♠', 'Player 4 raised to 80', 'Player 1 called 80', 'Turn dealt: Q♣']}, 'call_amount': 0, 'pot_after_call': 320, 'equity': 0.55}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 680, 'promptTokenCount': 1635, 'totalTokenCount': 2315}, 'invocationId': 'e-ef564759-6cc7-4abd-a379-cdc04693a8bb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'qHpS3u4U', 'timestamp': 1761905198.830773}, {'content': {'parts': [{'functionResponse': {'id': 'call_LSklAECA0hAxLv8FfREs0l2j', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 160, 'reasoning': '期待値が見込める（176.00(ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160'}}}, {'functionResponse': {'id': 'call_yBed0ZxB5RIYXhsHVqoWptJK', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 160, 'reasoning': '期待値が見込める（176.00(ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160'}}}], 'role': 'user'}, 'invocationId': 'Pr09OHJu', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'oYQj7n5w', 'timestamp': 1761905214.061419}, {'content': {'parts': [{'text': '{"action":"raise","amount":160,"reasoning":"期待値が見込める（176.00（ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 56, 'promptTokenCount': 2631, 'totalTokenCount': 2687}, 'invocationId': 'e-ef564759-6cc7-4abd-a379-cdc04693a8bb', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '3T6XLe8t', 'timestamp': 1761905214.064802}]
2025-10-31 19:06:56,567 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:06:56,568 - poker_game - DEBUG - {"action":"raise","amount":160,"reasoning":"期待値が見込める（176.00（ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160"}
2025-10-31 19:06:56,569 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:06:56,569 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":160,"reasoning":"期待値が見込める（176.00（ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160"}'
2025-10-31 19:06:56,569 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:06:56,570 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":160,"reasoning":"期待値が見込める（176.00（ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160"}
2025-10-31 19:06:56,570 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 160, 'reasoning': '期待値が見込める（176.00（ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160'}
2025-10-31 19:06:56,570 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 160
2025-10-31 19:06:56,570 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (6374)']
2025-10-31 19:06:56,570 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 19:06:56,571 - poker_game - DEBUG - [Agent4] Raise amount 160 is valid (min: 20)
2025-10-31 19:06:56,571 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 160}
2025-10-31 19:06:56,571 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 160, 期待値が見込める（176.00（ポットに対して55.00%）ため、1/2ポットでセミブラフします。ベット額: 160
2025-10-31 19:06:56,572 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 160
2025-10-31 19:06:56,573 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:06:56,573 - poker_game - INFO - Hand #30, Phase: turn
2025-10-31 19:06:56,574 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:56,574 - poker_game - INFO - Pot: 320, Current bet: 0
2025-10-31 19:06:56,574 - poker_game - INFO - Last raiser: None
2025-10-31 19:06:56,574 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:56,575 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:56,577 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣']
2025-10-31 19:06:56,579 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:56,580 - poker_game - INFO -   P1(Agent1): chips=2699, bet=0, status=active
2025-10-31 19:06:56,581 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:56,581 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:56,582 - poker_game - INFO -   P4(Agent4): chips=6374, bet=0, status=active
2025-10-31 19:06:56,582 - poker_game - INFO - ==================================================
2025-10-31 19:06:56,583 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 160
2025-10-31 19:06:56,596 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:06:56,597 - poker_game - INFO - Hand #30, Phase: turn
2025-10-31 19:06:56,597 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:56,598 - poker_game - INFO - Pot: 480, Current bet: 160
2025-10-31 19:06:56,598 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:56,599 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:56,599 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:56,600 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣']
2025-10-31 19:06:56,600 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:56,600 - poker_game - INFO -   P1(Agent1): chips=2699, bet=0, status=active
2025-10-31 19:06:56,601 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:56,601 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:56,601 - poker_game - INFO -   P4(Agent4): chips=6214, bet=160, status=active
2025-10-31 19:06:56,602 - poker_game - INFO - Extra: Action: Player 4 raised to 160
2025-10-31 19:06:56,602 - poker_game - INFO - ==================================================
2025-10-31 19:06:56,602 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:06:56,602 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:06:56,602 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:06:56,602 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:06:56,603 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:06:56,603 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:06:56,603 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:06:56,604 - poker_game - DEBUG - Player bets: [0, 160], Current bet: 160, All same: False
2025-10-31 19:06:56,604 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:06:56,604 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:06:56,604 - poker_game - INFO - Hand #30, Phase: turn
2025-10-31 19:06:56,605 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:56,605 - poker_game - INFO - Pot: 480, Current bet: 160
2025-10-31 19:06:56,606 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:56,610 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:56,611 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:56,612 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣']
2025-10-31 19:06:56,612 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:56,613 - poker_game - INFO -   P1(Agent1): chips=2699, bet=0, status=active
2025-10-31 19:06:56,613 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:56,614 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:56,614 - poker_game - INFO -   P4(Agent4): chips=6214, bet=160, status=active
2025-10-31 19:06:56,614 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:06:56,615 - poker_game - INFO - ==================================================
2025-10-31 19:06:56,717 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "turn",
  "your_cards": [
    "2♥",
    "A♥"
  ],
  "community": [
    "Q♦",
    "8♥",
    "K♠",
    "Q♣"
  ],
  "your_chips": 2699,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 160,
  "pot": 480,
  "to_call": 160,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 6214,
      "bet": 160,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (160)",
    "raise (min 180)",
    "all-in (2699)"
  ],
  "history": [
    "Player 3 folded",
    "Showdown: Player 1 won 80",
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: Q♦, 8♥, K♠",
    "Player 4 raised to 80",
    "Player 1 called 80",
    "Turn dealt: Q♣",
    "Player 4 raised to 160"
  ]
}
2025-10-31 19:06:56,776 - poker_game - DEBUG - Create Session: {'id': '2cb96c60-32e5-4ef0-a3ae-7f785e1cf79b', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905216.7728689}
2025-10-31 19:06:59,108 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 160,\n  "reasoning": "コミュニティカードにQが2枚あり、私の手札にA♥があるので、ツーペア（AとQ）またはフロップ（A♥ Q♥ K♠）でフラッシュの可能性（A♥でフラッシュを完成させる）があります。相手はアグレッシブですが、ポットオッズ（コールに必要な160に対してポットは480+160=640）は有利です。ここではコールして、リバーカードを見て判断するのが最善です。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 137, 'promptTokenCount': 808, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 808}], 'totalTokenCount': 945}, 'invocationId': 'e-bd0e6c46-fe02-427f-bcf1-4dc863ca8763', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'bvGMt6YL', 'timestamp': 1761905216.793867}]
2025-10-31 19:06:59,109 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:06:59,111 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 160,
  "reasoning": "コミュニティカードにQが2枚あり、私の手札にA♥があるので、ツーペア（AとQ）またはフロップ（A♥ Q♥ K♠）でフラッシュの可能性（A♥でフラッシュを完成させる）があります。相手はアグレッシブですが、ポットオッズ（コールに必要な160に対してポットは480+160=640）は有利です。ここではコールして、リバーカードを見て判断するのが最善です。"
}
```
2025-10-31 19:06:59,112 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:06:59,112 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 160,\n  "reasoning": "コミュニティカードにQが2枚あり、私の手札にA♥があるので、ツーペア（AとQ）またはフロップ（A♥ Q♥ K♠）でフラッシュの可能性（A♥でフラッシュを完成させる）があります。相手はアグレッシブですが、ポットオッズ（コールに必要な160に対してポットは480+160=640）は有利です。ここではコールして、リバーカードを見て判断するのが最善です。"\n}\n```'
2025-10-31 19:06:59,112 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:06:59,113 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 160,\n  "reasoning": "コミュニティカードにQが2枚あり、私の手札にA♥があるので、ツーペア（AとQ）またはフロップ（A♥ Q♥ K♠）でフラッシュの可能性（A♥でフラッシュを完成させる）があります。相手はアグレッシブですが、ポットオッズ（コールに必要な160に対してポットは480+160=640）は有利です。ここではコールして、リバーカードを見て判断するのが最善です。"\n}'
2025-10-31 19:06:59,113 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 160,
  "reasoning": "コミュニティカードにQが2枚あり、私の手札にA♥があるので、ツーペア（AとQ）またはフロップ（A♥ Q♥ K♠）でフラッシュの可能性（A♥でフラッシュを完成させる）があります。相手はアグレッシブですが、ポットオッズ（コールに必要な160に対してポットは480+160=640）は有利です。ここではコールして、リバーカードを見て判断するのが最善です。"
}
2025-10-31 19:06:59,114 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 160, 'reasoning': 'コミュニティカードにQが2枚あり、私の手札にA♥があるので、ツーペア（AとQ）またはフロップ（A♥ Q♥ K♠）でフラッシュの可能性（A♥でフラッシュを完成させる）があります。相手はアグレッシブですが、ポットオッズ（コールに必要な160に対してポットは480+160=640）は有利です。ここではコールして、リバーカードを見て判断するのが最善です。'}
2025-10-31 19:06:59,114 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 160
2025-10-31 19:06:59,114 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (160)', 'raise (min 180)', 'all-in (2699)']
2025-10-31 19:06:59,114 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (160)': 160
2025-10-31 19:06:59,114 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 160}
2025-10-31 19:06:59,114 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 160, コミュニティカードにQが2枚あり、私の手札にA♥があるので、ツーペア（AとQ）またはフロップ（A♥ Q♥ K♠）でフラッシュの可能性（A♥でフラッシュを完成させる）があります。相手はアグレッシブですが、ポットオッズ（コールに必要な160に対してポットは480+160=640）は有利です。ここではコールして、リバーカードを見て判断するのが最善です。
2025-10-31 19:06:59,117 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 160
2025-10-31 19:06:59,117 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:06:59,119 - poker_game - INFO - Hand #30, Phase: turn
2025-10-31 19:06:59,120 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:59,120 - poker_game - INFO - Pot: 480, Current bet: 160
2025-10-31 19:06:59,120 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:59,121 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:59,121 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:59,121 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣']
2025-10-31 19:06:59,122 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:59,122 - poker_game - INFO -   P1(Agent1): chips=2699, bet=0, status=active
2025-10-31 19:06:59,123 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:59,123 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:59,123 - poker_game - INFO -   P4(Agent4): chips=6214, bet=160, status=active
2025-10-31 19:06:59,124 - poker_game - INFO - ==================================================
2025-10-31 19:06:59,124 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 160
2025-10-31 19:06:59,137 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:06:59,137 - poker_game - INFO - Hand #30, Phase: turn
2025-10-31 19:06:59,138 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:06:59,138 - poker_game - INFO - Pot: 640, Current bet: 160
2025-10-31 19:06:59,138 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:59,139 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:59,139 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:59,139 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣']
2025-10-31 19:06:59,140 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:59,140 - poker_game - INFO -   P1(Agent1): chips=2539, bet=160, status=active
2025-10-31 19:06:59,141 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:59,141 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:59,141 - poker_game - INFO -   P4(Agent4): chips=6214, bet=160, status=active
2025-10-31 19:06:59,142 - poker_game - INFO - Extra: Action: Player 1 called 160
2025-10-31 19:06:59,143 - poker_game - INFO - ==================================================
2025-10-31 19:06:59,144 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:06:59,145 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:06:59,145 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:06:59,145 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 19:06:59,145 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:06:59,146 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:06:59,146 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:06:59,146 - poker_game - DEBUG - Player bets: [160, 160], Current bet: 160, All same: True
2025-10-31 19:06:59,147 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:06:59,147 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:06:59,148 - poker_game - INFO - Hand #30, Phase: turn
2025-10-31 19:06:59,148 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:59,148 - poker_game - INFO - Pot: 640, Current bet: 160
2025-10-31 19:06:59,149 - poker_game - INFO - Last raiser: 4
2025-10-31 19:06:59,149 - poker_game - INFO - Betting round complete: True
2025-10-31 19:06:59,149 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:59,149 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣']
2025-10-31 19:06:59,150 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:59,150 - poker_game - INFO -   P1(Agent1): chips=2539, bet=160, status=active
2025-10-31 19:06:59,150 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:59,151 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:59,151 - poker_game - INFO -   P4(Agent4): chips=6214, bet=160, status=active
2025-10-31 19:06:59,151 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:06:59,151 - poker_game - INFO - ==================================================
2025-10-31 19:06:59,252 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: turn
2025-10-31 19:06:59,253 - poker_game - INFO - Betting round complete: True
2025-10-31 19:06:59,253 - poker_game - INFO - Remaining players: 2
2025-10-31 19:06:59,253 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:06:59,254 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:06:59,254 - poker_game - INFO - Phase changed: TURN -> RIVER
2025-10-31 19:06:59,266 - poker_game - INFO - Starting new betting round
2025-10-31 19:06:59,267 - poker_game - DEBUG - _start_new_betting_round called
2025-10-31 19:06:59,267 - poker_game - INFO - Reset: current_bet=0, betting_round_complete=False, last_raiser_index=None
2025-10-31 19:06:59,267 - poker_game - DEBUG - Active players for new betting round: [1, 4]
2025-10-31 19:06:59,268 - poker_game - DEBUG - Dealer button: 3
2025-10-31 19:06:59,268 - poker_game - INFO - First actor: Player 4 (by phase rule), was 4
2025-10-31 19:06:59,269 - poker_game - INFO - === NEW_BETTING_ROUND_STARTED ===
2025-10-31 19:06:59,269 - poker_game - INFO - Hand #30, Phase: river
2025-10-31 19:06:59,270 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:06:59,271 - poker_game - INFO - Pot: 640, Current bet: 0
2025-10-31 19:06:59,271 - poker_game - INFO - Last raiser: None
2025-10-31 19:06:59,272 - poker_game - INFO - Betting round complete: False
2025-10-31 19:06:59,272 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:06:59,273 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:06:59,273 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:06:59,274 - poker_game - INFO -   P1(Agent1): chips=2539, bet=0, status=active
2025-10-31 19:06:59,274 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:06:59,274 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:06:59,275 - poker_game - INFO -   P4(Agent4): chips=6214, bet=0, status=active
2025-10-31 19:06:59,275 - poker_game - INFO - Extra: Phase: turn -> river
2025-10-31 19:06:59,276 - poker_game - INFO - ==================================================
2025-10-31 19:06:59,276 - poker_game - DEBUG - LLM Prompt for Agent4: {
  "your_id": 4,
  "phase": "river",
  "your_cards": [
    "K♣",
    "4♦"
  ],
  "community": [
    "Q♦",
    "8♥",
    "K♠",
    "Q♣",
    "5♦"
  ],
  "your_chips": 6214,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 320,
  "pot": 640,
  "to_call": 0,
  "dealer_button": 3,
  "current_turn": 4,
  "players": [
    {
      "id": 1,
      "chips": 2539,
      "bet": 0,
      "status": "active"
    },
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    }
  ],
  "actions": [
    "fold",
    "check",
    "raise (min 20)",
    "all-in (6214)"
  ],
  "history": [
    "Player 3 posted small blind 10",
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: Q♦, 8♥, K♠",
    "Player 4 raised to 80",
    "Player 1 called 80",
    "Turn dealt: Q♣",
    "Player 4 raised to 160",
    "Player 1 called 160",
    "River dealt: 5♦"
  ]
}
2025-10-31 19:06:59,492 - poker_game - DEBUG - Create Session: {'id': '6adfca65-2227-41c7-81bc-2eaf6fb9cee5', 'appName': 'team3_agent', 'userId': 'player_4', 'state': {}, 'events': [], 'lastUpdateTime': 1761905219.488387}
2025-10-31 19:07:10,833 - poker_game - INFO - Waiting for LLM API response for Agent4... 10 seconds elapsed
2025-10-31 19:07:19,641 - poker_game - INFO - Waiting for LLM API response for Agent4... 20 seconds elapsed
2025-10-31 19:07:22,915 - poker_game - INFO - LLM raw Response for Agent4: [{'content': {'parts': [{'functionCall': {'id': 'call_UuIwqNsm3twCZXRC5W5rpsDj', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1115, 'totalTokenCount': 1132}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': '6yaFjOKX', 'timestamp': 1761905219.738288}, {'content': {'parts': [{'functionResponse': {'id': 'call_UuIwqNsm3twCZXRC5W5rpsDj', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'fWX0Oe1z', 'timestamp': 1761905221.273791}, {'content': {'parts': [{'functionCall': {'id': 'call_lMPddfPiZLAk3mKsae7hyGoL', 'args': {'agent_name': 'beginner_poker_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 20, 'promptTokenCount': 1639, 'totalTokenCount': 1659}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'doqO6g8Y', 'timestamp': 1761905221.278638}, {'content': {'parts': [{'functionResponse': {'id': 'call_lMPddfPiZLAk3mKsae7hyGoL', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'beginner_poker_agent', 'requestedAuthConfigs': {}}, 'id': 'odtqvC6S', 'timestamp': 1761905222.92143}, {'content': {'parts': [{'functionCall': {'id': 'call_5fUueo9XB9n9Pl4QPyEtNAaY', 'args': {'agent_name': 'action_agent'}, 'name': 'transfer_to_agent'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 17, 'promptTokenCount': 1201, 'totalTokenCount': 1218}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'yktSs9N9', 'timestamp': 1761905222.925377}, {'content': {'parts': [{'functionResponse': {'id': 'call_5fUueo9XB9n9Pl4QPyEtNAaY', 'name': 'transfer_to_agent', 'response': {'result': None}}}], 'role': 'user'}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'transferToAgent': 'action_agent', 'requestedAuthConfigs': {}}, 'id': 'iZNSK4cR', 'timestamp': 1761905224.077518}, {'content': {'parts': [{'functionCall': {'id': 'call_WZRdR6n9x7TMrs16fHMUShs4', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['K♣', '4♦'], 'community': ['Q♦', '8♥', 'K♠', 'Q♣', '5♦'], 'your_chips': 6214, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 320, 'pot': 640, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2539, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6214)'], 'history': ['Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60', 'Flop dealt: Q♦, 8♥, K♠', 'Player 4 raised to 80', 'Player 1 called 80', 'Turn dealt: Q♣', 'Player 4 raised to 160', 'Player 1 called 160,']}, 'call_amount': 0, 'pot_after_call': 640, 'equity': 0.75}, 'name': 'action_decision'}}, {'functionCall': {'id': 'call_PCvpNog2SpwHtAWXVOVIRqyS', 'args': {'game_state': {'your_id': 4, 'phase': 'river', 'your_cards': ['K♣', '4♦'], 'community': ['Q♦', '8♥', 'K♠', 'Q♣', '5♦'], 'your_chips': 6214, 'your_bet_this_round': 0, 'your_total_bet_this_hand': 320, 'pot': 640, 'to_call': 0, 'dealer_button': 3, 'current_turn': 4, 'players': [{'id': 1, 'chips': 2539, 'bet': 0, 'status': 'active'}, {'id': 3, 'chips': 607, 'bet': 0, 'status': 'folded'}], 'actions': ['fold', 'check', 'raise (min 20)', 'all-in (6214)'], 'history': ['Player 3 posted small blind 10', 'Player 4 posted big blind 20', 'Player 1 called 20', 'Player 3 raised to 140', 'Player 4 folded', 'Player 1 folded', 'Showdown: Player 3 won 180', 'Player 4 posted small blind 10', 'Player 1 posted big blind 20', 'Player 3 folded', 'Player 4 called 10', 'Player 1 raised to 80', 'Player 4 called 60', 'Flop dealt: Q♦, 8♥, K♠', 'Player 4 raised to 80', 'Player 1 called 80', 'Turn dealt: Q♣', 'Player 4 raised to 160', 'Player 1 called 160,']}, 'call_amount': 0, 'pot_after_call': 640, 'equity': 0.75}, 'name': 'action_decision'}}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 680, 'promptTokenCount': 1731, 'totalTokenCount': 2411}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'longRunningToolIds': [], 'id': 'hbCRwaBq', 'timestamp': 1761905224.080002}, {'content': {'parts': [{'functionResponse': {'id': 'call_WZRdR6n9x7TMrs16fHMUShs4', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 422, 'reasoning': '期待値が高い（480.00(ポットに対して75.00%）ため、2/3ポットでベットします。ベット額: 422'}}}, {'functionResponse': {'id': 'call_PCvpNog2SpwHtAWXVOVIRqyS', 'name': 'action_decision', 'response': {'action': 'raise', 'amount': 422, 'reasoning': '期待値が高い（480.00(ポットに対して75.00%）ため、2/3ポットでベットします。ベット額: 422'}}}], 'role': 'user'}, 'invocationId': '2EgOmd8o', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'lyTOOWme', 'timestamp': 1761905240.316696}, {'content': {'parts': [{'text': '{"action":"raise","amount":422,"reasoning":"期待値が高い(480.00(ポットに対して75.00%))ため、2/3ポットでベットします。ベット額: 422"}'}], 'role': 'model'}, 'partial': False, 'usageMetadata': {'candidatesTokenCount': 52, 'promptTokenCount': 2695, 'totalTokenCount': 2747}, 'invocationId': 'e-a37ca22b-787e-415b-849a-978c87f6732a', 'author': 'action_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': 'MMrdm89B', 'timestamp': 1761905240.32214}]
2025-10-31 19:07:22,915 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent4:
2025-10-31 19:07:22,916 - poker_game - DEBUG - {"action":"raise","amount":422,"reasoning":"期待値が高い(480.00(ポットに対して75.00%))ため、2/3ポットでベットします。ベット額: 422"}
2025-10-31 19:07:22,918 - poker_game - DEBUG - [Agent4] Starting LLM API response parsing
2025-10-31 19:07:22,918 - poker_game - DEBUG - [Agent4] Raw response content: '{"action":"raise","amount":422,"reasoning":"期待値が高い(480.00(ポットに対して75.00%))ため、2/3ポットでベットします。ベット額: 422"}'
2025-10-31 19:07:22,918 - poker_game - DEBUG - [Agent4] No markdown code block detected
2025-10-31 19:07:22,919 - poker_game - DEBUG - [Agent4] JSON pattern found: {"action":"raise","amount":422,"reasoning":"期待値が高い(480.00(ポットに対して75.00%))ため、2/3ポットでベットします。ベット額: 422"}
2025-10-31 19:07:22,921 - poker_game - DEBUG - [Agent4] JSON parsing successful: {'action': 'raise', 'amount': 422, 'reasoning': '期待値が高い(480.00(ポットに対して75.00%))ため、2/3ポットでベットします。ベット額: 422'}
2025-10-31 19:07:22,922 - poker_game - DEBUG - [Agent4] Extracted values - action: 'raise', amount: 422
2025-10-31 19:07:22,922 - poker_game - DEBUG - [Agent4] Processing raise action - available actions: ['fold', 'check', 'raise (min 20)', 'all-in (6214)']
2025-10-31 19:07:22,923 - poker_game - DEBUG - [Agent4] Minimum raise amount extracted from 'raise (min 20)': 20
2025-10-31 19:07:22,923 - poker_game - DEBUG - [Agent4] Raise amount 422 is valid (min: 20)
2025-10-31 19:07:22,923 - poker_game - DEBUG - [Agent4] Final parsed decision: {'action': 'raise', 'amount': 422}
2025-10-31 19:07:22,923 - poker_game - INFO - [Agent4] Successfully parsed decision: raise, 422, 期待値が高い(480.00(ポットに対して75.00%))ため、2/3ポットでベットします。ベット額: 422
2025-10-31 19:07:22,927 - poker_game - INFO - >>> PROCESS_ACTION: Player 4 attempts 'raise' with amount 422
2025-10-31 19:07:22,927 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:07:22,927 - poker_game - INFO - Hand #30, Phase: river
2025-10-31 19:07:22,927 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:07:22,927 - poker_game - INFO - Pot: 640, Current bet: 0
2025-10-31 19:07:22,928 - poker_game - INFO - Last raiser: None
2025-10-31 19:07:22,928 - poker_game - INFO - Betting round complete: False
2025-10-31 19:07:22,928 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:07:22,928 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:22,928 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:07:22,929 - poker_game - INFO -   P1(Agent1): chips=2539, bet=0, status=active
2025-10-31 19:07:22,929 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:07:22,929 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:07:22,929 - poker_game - INFO -   P4(Agent4): chips=6214, bet=0, status=active
2025-10-31 19:07:22,929 - poker_game - INFO - ==================================================
2025-10-31 19:07:22,930 - poker_game - INFO - ACTION_EXECUTED: Player 4 raised to 422
2025-10-31 19:07:22,938 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:07:22,938 - poker_game - INFO - Hand #30, Phase: river
2025-10-31 19:07:22,939 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:07:22,939 - poker_game - INFO - Pot: 1062, Current bet: 422
2025-10-31 19:07:22,939 - poker_game - INFO - Last raiser: 4
2025-10-31 19:07:22,940 - poker_game - INFO - Betting round complete: False
2025-10-31 19:07:22,940 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:07:22,941 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:22,941 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:07:22,941 - poker_game - INFO -   P1(Agent1): chips=2539, bet=0, status=active
2025-10-31 19:07:22,941 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:07:22,942 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:07:22,942 - poker_game - INFO -   P4(Agent4): chips=5792, bet=422, status=active
2025-10-31 19:07:22,942 - poker_game - INFO - Extra: Action: Player 4 raised to 422
2025-10-31 19:07:22,942 - poker_game - INFO - ==================================================
2025-10-31 19:07:22,943 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:07:22,943 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:07:22,943 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:07:22,943 - poker_game - INFO - Advanced from player 4 to player 1 (seat order)
2025-10-31 19:07:22,944 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:07:22,944 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:07:22,945 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:07:22,946 - poker_game - DEBUG - Player bets: [0, 422], Current bet: 422, All same: False
2025-10-31 19:07:22,947 - poker_game - DEBUG - Betting continues: Not all players have same bet
2025-10-31 19:07:22,947 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:07:22,947 - poker_game - INFO - Hand #30, Phase: river
2025-10-31 19:07:22,948 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:07:22,949 - poker_game - INFO - Pot: 1062, Current bet: 422
2025-10-31 19:07:22,950 - poker_game - INFO - Last raiser: 4
2025-10-31 19:07:22,951 - poker_game - INFO - Betting round complete: False
2025-10-31 19:07:22,952 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:07:22,953 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:22,955 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:07:22,956 - poker_game - INFO -   P1(Agent1): chips=2539, bet=0, status=active
2025-10-31 19:07:22,956 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:07:22,957 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:07:22,957 - poker_game - INFO -   P4(Agent4): chips=5792, bet=422, status=active
2025-10-31 19:07:22,957 - poker_game - INFO - Extra: Betting complete: False
2025-10-31 19:07:22,957 - poker_game - INFO - ==================================================
2025-10-31 19:07:23,058 - poker_game - DEBUG - LLM Prompt for Agent1: {
  "your_id": 1,
  "phase": "river",
  "your_cards": [
    "2♥",
    "A♥"
  ],
  "community": [
    "Q♦",
    "8♥",
    "K♠",
    "Q♣",
    "5♦"
  ],
  "your_chips": 2539,
  "your_bet_this_round": 0,
  "your_total_bet_this_hand": 320,
  "pot": 1062,
  "to_call": 422,
  "dealer_button": 3,
  "current_turn": 1,
  "players": [
    {
      "id": 3,
      "chips": 607,
      "bet": 0,
      "status": "folded"
    },
    {
      "id": 4,
      "chips": 5792,
      "bet": 422,
      "status": "active"
    }
  ],
  "actions": [
    "fold",
    "call (422)",
    "raise (min 442)",
    "all-in (2539)"
  ],
  "history": [
    "Player 4 posted big blind 20",
    "Player 1 called 20",
    "Player 3 raised to 140",
    "Player 4 folded",
    "Player 1 folded",
    "Showdown: Player 3 won 180",
    "Player 4 posted small blind 10",
    "Player 1 posted big blind 20",
    "Player 3 folded",
    "Player 4 called 10",
    "Player 1 raised to 80",
    "Player 4 called 60",
    "Flop dealt: Q♦, 8♥, K♠",
    "Player 4 raised to 80",
    "Player 1 called 80",
    "Turn dealt: Q♣",
    "Player 4 raised to 160",
    "Player 1 called 160",
    "River dealt: 5♦",
    "Player 4 raised to 422"
  ]
}
2025-10-31 19:07:23,244 - poker_game - DEBUG - Create Session: {'id': 'e0fcec35-7e7c-4536-a45f-f1a742f2a98c', 'appName': 'beginner_agent', 'userId': 'player_1', 'state': {}, 'events': [], 'lastUpdateTime': 1761905243.2419116}
2025-10-31 19:07:25,273 - poker_game - INFO - LLM raw Response for Agent1: [{'content': {'parts': [{'text': '```json\n{\n  "action": "call",\n  "amount": 422,\n  "reasoning": "リバーで、あなたの手札はAハイ（エースハイ）です。ボードにはQが2枚あり、あなたにフラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。相手は422をベットしてきましたが、あなたのハンドでは勝てる可能性が低いため、コールして相手のハンドを確認するのが最善です。もし相手がブラフ（強いハンドを持っていないのに強く見せること）であれば、勝つことができます。もし相手が強いハンドを持っていれば、負けてしまいますが、それ以上の損失を防ぐことができます。"\n}\n```'}], 'role': 'model'}, 'usageMetadata': {'candidatesTokenCount': 152, 'promptTokenCount': 815, 'promptTokensDetails': [{'modality': 'TEXT', 'tokenCount': 815}], 'totalTokenCount': 967}, 'invocationId': 'e-cc878971-caf4-4d33-9d04-f56a7d9c358c', 'author': 'beginner_poker_agent', 'actions': {'stateDelta': {}, 'artifactDelta': {}, 'requestedAuthConfigs': {}}, 'id': '4B8mpqjh', 'timestamp': 1761905243.25758}]
2025-10-31 19:07:25,274 - poker_game - DEBUG - LLM [-1]['content']['parts'][0]['text'] for Agent1:
2025-10-31 19:07:25,274 - poker_game - DEBUG - ```json
{
  "action": "call",
  "amount": 422,
  "reasoning": "リバーで、あなたの手札はAハイ（エースハイ）です。ボードにはQが2枚あり、あなたにフラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。相手は422をベットしてきましたが、あなたのハンドでは勝てる可能性が低いため、コールして相手のハンドを確認するのが最善です。もし相手がブラフ（強いハンドを持っていないのに強く見せること）であれば、勝つことができます。もし相手が強いハンドを持っていれば、負けてしまいますが、それ以上の損失を防ぐことができます。"
}
```
2025-10-31 19:07:25,275 - poker_game - DEBUG - [Agent1] Starting LLM API response parsing
2025-10-31 19:07:25,275 - poker_game - DEBUG - [Agent1] Raw response content: '```json\n{\n  "action": "call",\n  "amount": 422,\n  "reasoning": "リバーで、あなたの手札はAハイ（エースハイ）です。ボードにはQが2枚あり、あなたにフラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。相手は422をベットしてきましたが、あなたのハンドでは勝てる可能性が低いため、コールして相手のハンドを確認するのが最善です。もし相手がブラフ（強いハンドを持っていないのに強く見せること）であれば、勝つことができます。もし相手が強いハンドを持っていれば、負けてしまいますが、それ以上の損失を防ぐことができます。"\n}\n```'
2025-10-31 19:07:25,275 - poker_game - DEBUG - [Agent1] Markdown code block detected
2025-10-31 19:07:25,276 - poker_game - DEBUG - [Agent1] Extracted content from markdown: '{\n  "action": "call",\n  "amount": 422,\n  "reasoning": "リバーで、あなたの手札はAハイ（エースハイ）です。ボードにはQが2枚あり、あなたにフラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。相手は422をベットしてきましたが、あなたのハンドでは勝てる可能性が低いため、コールして相手のハンドを確認するのが最善です。もし相手がブラフ（強いハンドを持っていないのに強く見せること）であれば、勝つことができます。もし相手が強いハンドを持っていれば、負けてしまいますが、それ以上の損失を防ぐことができます。"\n}'
2025-10-31 19:07:25,276 - poker_game - DEBUG - [Agent1] JSON pattern found: {
  "action": "call",
  "amount": 422,
  "reasoning": "リバーで、あなたの手札はAハイ（エースハイ）です。ボードにはQが2枚あり、あなたにフラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。相手は422をベットしてきましたが、あなたのハンドでは勝てる可能性が低いため、コールして相手のハンドを確認するのが最善です。もし相手がブラフ（強いハンドを持っていないのに強く見せること）であれば、勝つことができます。もし相手が強いハンドを持っていれば、負けてしまいますが、それ以上の損失を防ぐことができます。"
}
2025-10-31 19:07:25,276 - poker_game - DEBUG - [Agent1] JSON parsing successful: {'action': 'call', 'amount': 422, 'reasoning': 'リバーで、あなたの手札はAハイ（エースハイ）です。ボードにはQが2枚あり、あなたにフラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。相手は422をベットしてきましたが、あなたのハンドでは勝てる可能性が低いため、コールして相手のハンドを確認するのが最善です。もし相手がブラフ（強いハンドを持っていないのに強く見せること）であれば、勝つことができます。もし相手が強いハンドを持っていれば、負けてしまいますが、それ以上の損失を防ぐことができます。'}
2025-10-31 19:07:25,277 - poker_game - DEBUG - [Agent1] Extracted values - action: 'call', amount: 422
2025-10-31 19:07:25,277 - poker_game - DEBUG - [Agent1] Processing call action - available actions: ['fold', 'call (422)', 'raise (min 442)', 'all-in (2539)']
2025-10-31 19:07:25,277 - poker_game - DEBUG - [Agent1] Call amount extracted from 'call (422)': 422
2025-10-31 19:07:25,278 - poker_game - DEBUG - [Agent1] Final parsed decision: {'action': 'call', 'amount': 422}
2025-10-31 19:07:25,278 - poker_game - INFO - [Agent1] Successfully parsed decision: call, 422, リバーで、あなたの手札はAハイ（エースハイ）です。ボードにはQが2枚あり、あなたにフラッシュ（同じスートのカードが5枚揃うこと）の可能性はありません。相手は422をベットしてきましたが、あなたのハンドでは勝てる可能性が低いため、コールして相手のハンドを確認するのが最善です。もし相手がブラフ（強いハンドを持っていないのに強く見せること）であれば、勝つことができます。もし相手が強いハンドを持っていれば、負けてしまいますが、それ以上の損失を防ぐことができます。
2025-10-31 19:07:25,279 - poker_game - INFO - >>> PROCESS_ACTION: Player 1 attempts 'call' with amount 422
2025-10-31 19:07:25,280 - poker_game - INFO - === BEFORE_ACTION ===
2025-10-31 19:07:25,280 - poker_game - INFO - Hand #30, Phase: river
2025-10-31 19:07:25,281 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:07:25,281 - poker_game - INFO - Pot: 1062, Current bet: 422
2025-10-31 19:07:25,281 - poker_game - INFO - Last raiser: 4
2025-10-31 19:07:25,282 - poker_game - INFO - Betting round complete: False
2025-10-31 19:07:25,282 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:07:25,282 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:25,283 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:07:25,283 - poker_game - INFO -   P1(Agent1): chips=2539, bet=0, status=active
2025-10-31 19:07:25,284 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:07:25,285 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:07:25,286 - poker_game - INFO -   P4(Agent4): chips=5792, bet=422, status=active
2025-10-31 19:07:25,286 - poker_game - INFO - ==================================================
2025-10-31 19:07:25,287 - poker_game - INFO - ACTION_EXECUTED: Player 1 called 422
2025-10-31 19:07:25,301 - poker_game - INFO - === AFTER_ACTION ===
2025-10-31 19:07:25,301 - poker_game - INFO - Hand #30, Phase: river
2025-10-31 19:07:25,301 - poker_game - INFO - Current player: 1, Dealer: 3
2025-10-31 19:07:25,302 - poker_game - INFO - Pot: 1484, Current bet: 422
2025-10-31 19:07:25,302 - poker_game - INFO - Last raiser: 4
2025-10-31 19:07:25,303 - poker_game - INFO - Betting round complete: False
2025-10-31 19:07:25,303 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:07:25,304 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:25,304 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:07:25,305 - poker_game - INFO -   P1(Agent1): chips=2117, bet=422, status=active
2025-10-31 19:07:25,305 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:07:25,306 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:07:25,306 - poker_game - INFO -   P4(Agent4): chips=5792, bet=422, status=active
2025-10-31 19:07:25,307 - poker_game - INFO - Extra: Action: Player 1 called 422
2025-10-31 19:07:25,307 - poker_game - INFO - ==================================================
2025-10-31 19:07:25,307 - poker_game - INFO - >>> ADVANCING to next player
2025-10-31 19:07:25,308 - poker_game - DEBUG - _advance_to_next_player called
2025-10-31 19:07:25,308 - poker_game - DEBUG - Active players: [1, 4]
2025-10-31 19:07:25,308 - poker_game - INFO - Advanced from player 1 to player 4 (seat order)
2025-10-31 19:07:25,309 - poker_game - INFO - >>> CHECKING betting round completion
2025-10-31 19:07:25,309 - poker_game - DEBUG - _check_betting_round_complete called
2025-10-31 19:07:25,309 - poker_game - DEBUG - Active: 2, All-in: 0
2025-10-31 19:07:25,310 - poker_game - DEBUG - Player bets: [422, 422], Current bet: 422, All same: True
2025-10-31 19:07:25,310 - poker_game - INFO - Betting complete: All players matched after a bet/raise
2025-10-31 19:07:25,310 - poker_game - INFO - === AFTER_BETTING_CHECK ===
2025-10-31 19:07:25,311 - poker_game - INFO - Hand #30, Phase: river
2025-10-31 19:07:25,311 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:07:25,312 - poker_game - INFO - Pot: 1484, Current bet: 422
2025-10-31 19:07:25,312 - poker_game - INFO - Last raiser: 4
2025-10-31 19:07:25,313 - poker_game - INFO - Betting round complete: True
2025-10-31 19:07:25,313 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:07:25,314 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:25,315 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:07:25,315 - poker_game - INFO -   P1(Agent1): chips=2117, bet=422, status=active
2025-10-31 19:07:25,316 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:07:25,316 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:07:25,316 - poker_game - INFO -   P4(Agent4): chips=5792, bet=422, status=active
2025-10-31 19:07:25,317 - poker_game - INFO - Extra: Betting complete: True
2025-10-31 19:07:25,317 - poker_game - INFO - ==================================================
2025-10-31 19:07:25,418 - poker_game - INFO - >>> ADVANCE_TO_NEXT_PHASE called - Current phase: river
2025-10-31 19:07:25,419 - poker_game - INFO - Betting round complete: True
2025-10-31 19:07:25,419 - poker_game - INFO - Remaining players: 2
2025-10-31 19:07:25,420 - poker_game - DEBUG -   Remaining P1: Agent1, status: active
2025-10-31 19:07:25,420 - poker_game - DEBUG -   Remaining P4: Agent4, status: active
2025-10-31 19:07:25,420 - poker_game - INFO - Phase changed: RIVER -> SHOWDOWN
2025-10-31 19:07:25,421 - poker_game - INFO - === PHASE_CHANGED_TO_SHOWDOWN ===
2025-10-31 19:07:25,421 - poker_game - INFO - Hand #30, Phase: showdown
2025-10-31 19:07:25,422 - poker_game - INFO - Current player: 4, Dealer: 3
2025-10-31 19:07:25,422 - poker_game - INFO - Pot: 1484, Current bet: 422
2025-10-31 19:07:25,422 - poker_game - INFO - Last raiser: 4
2025-10-31 19:07:25,423 - poker_game - INFO - Betting round complete: True
2025-10-31 19:07:25,423 - poker_game - INFO - Active players: 2, All-in: 0, Folded: 1
2025-10-31 19:07:25,424 - poker_game - INFO - Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:25,424 - poker_game - INFO -   P0(Agent0): chips=0, bet=0, status=busted
2025-10-31 19:07:25,425 - poker_game - INFO -   P1(Agent1): chips=2117, bet=422, status=active
2025-10-31 19:07:25,425 - poker_game - INFO -   P2(Agent2): chips=0, bet=0, status=busted
2025-10-31 19:07:25,425 - poker_game - INFO -   P3(Agent3): chips=607, bet=0, status=folded
2025-10-31 19:07:25,426 - poker_game - INFO -   P4(Agent4): chips=5792, bet=422, status=active
2025-10-31 19:07:25,426 - poker_game - INFO - ==================================================
2025-10-31 19:07:25,426 - poker_game - INFO - === SHOWDOWN_STARTED ===
2025-10-31 19:07:25,427 - poker_game - INFO - Pot: 1484, Community cards: ['Q♦', '8♥', 'K♠', 'Q♣', '5♦']
2025-10-31 19:07:25,427 - poker_game - INFO -   Player 1 status=active cards=['2♥', 'A♥']
2025-10-31 19:07:25,428 - poker_game - INFO -   Player 4 status=active cards=['K♣', '4♦']
2025-10-31 19:07:25,431 - poker_game - INFO -   Player 1 hand=One Pair: Qs - A♥, K♠, Q♦, Q♣, 8♥ cards=['2♥', 'A♥']
2025-10-31 19:07:25,431 - poker_game - INFO -   Player 4 hand=Two Pair: Ks and Qs - K♣, K♠, Q♦, Q♣, 8♥ cards=['K♣', '4♦']
2025-10-31 19:07:25,432 - poker_game - INFO - Pot layer 0: amount=1484, contributors=[1, 4]
2025-10-31 19:07:25,433 - poker_game - INFO - Showdown total awarded: 1484 (game.pot=1484)
2025-10-31 19:07:25,433 - poker_game - INFO - Showdown winners (aggregated): [4]
2025-10-31 19:07:25,434 - poker_game - INFO -   Awarded 1484 to Player 4 (hand=Two Pair: Ks and Qs - K♣, K♠, Q♦, Q♣, 8♥)
2025-10-31 19:07:25,435 - poker_game - INFO - === SHOWDOWN_RESULTS_RECORDED ===
