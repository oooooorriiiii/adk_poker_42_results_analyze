# ポーカーAIログ分析ツール (Poker AI Log Analyzer)

`analyzer/analyzer.py` は、ポーカーゲームのログファイルを解析し、[Streamlit](https://streamlit.io/) を使用してWebブラウザ上でグラフィカルに表示・分析するためのツールです。

## 概要

指定されたログファイル（`.log`）を読み込み、以下の情報を対話的なダッシュボードに表示します。

  * **ハンドごとの行動詳細**: 各プレイヤーの全アクション、ベット額、思考理由（Reasoning）を一覧表示します。
  * **全体の行動分析**: アクションの頻度（円グラフ）やプレイヤー別のアクション内訳（棒グラフ）、ベット額の分布などを表示します。
  * **入力・出力の関係**: 特定のアクションを選択した際に、AIがどのような入力情報（JSONプロンプト）を受け取っていたかを並べて表示・比較できます。
  * **追加分析**: フェーズごとのアクション傾向や、ゲーム全体を通したチップ量の推移などをグラフで表示します。

## 前提条件

このスクリプトを実行するには、以下のPythonライブラリが必要です。

  * `streamlit`
  * `pandas`
  * `plotly`

## 実行方法

### 1\. ファイルの配置

このツールは、`analyzer.py` と**同じディレクトリ**に `poker_game_20251031_184427_838e.log` という名前のログファイルが配置されていることを前提としています。

ディレクトリ構造の例：

```
(Project Root)/
├── analyzer/
│   ├── analyzer.py  (← このスクリプト)
│   ├── 1031/  (← ログのディレクトリ)
│   │   └── poker_game_20251031_184427_xxxx.log (← ここにログを配置)
│   └── poker_game_20251031_184427_838e.log (← ここにログを配置)
|
├── pyproject.toml
├── uv.lock
└── README.md
```

### 2\. ライブラリのインストール

ターミナル（コマンドプロンプト）を開き、以下のコマンドを実行して必要なライブラリをインストールします。

#### `uv` の場合

```bash
# uv.lock に基づいてパッケージを同期 (インストール)
uv sync
```

#### `pip` の場合

```bash
pip install streamlit pandas plotly
```

### 3\. ツールの実行

`analyzer` フォルダに移動し、`streamlit run` コマンドでスクリプトを実行します。


#### `uv` の場合

```bash
cd analyzer

# プロジェクトルートから analyzer/analyzer.py を実行
uv run streamlit run analyzer.py
```

#### `pip` の場合

```bash
# analyzer フォルダに移動
cd analyzer

# Streamlit を実行
streamlit run analyzer.py
```

実行後、自動的にWebブラウザが起動し、分析ダッシュボードが表示されます。
（表示されない場合は、ターミナルに表示される `Local URL` (例: `http://localhost:8501`) をブラウザにコピーしてください）

同じディレクトリに .log ファイルが1つだけある場合、自動的にそのファイルが読み込まれます。
`.log` ファイルが複数ある場合、ダッシュボードの上部にファイルを選択するドロップダウンメニューが表示されます。

## ダッシュボードの機能

ダッシュボードは、主に以下のセクションで構成されています。

### 1\. サイドバー (表示フィルタ)

画面左側のサイドバーで、表示するデータを絞り込むことができます。

  * **プレイヤーを選択**: 表示対象のプレイヤーを選択します。
  * **ハンドIDを選択**: 特定のハンド（ゲーム）番号のみを表示します（デフォルトは全ハンド）。
  * **フェーズを選択**: `preflop`, `flop`, `turn`, `river` から表示対象のフェーズを選択します。

### 2\. MUST 1: ハンドごとの行動詳細

フィルタで選択された全行動がテーブル形式で表示されます。

### 3\. MUST 2: 選択範囲全体の行動分析

選択範囲内での統計情報がグラフで表示されます。

  * アクション頻度 (円グラフ / プレイヤー別棒グラフ)
  * ベット/レイズ額の分布 (ヒストグラム)
  * 思考理由 (Reasoning) のランダムサンプル

### 4\. MUST 3: 入力情報と出力情報の関係

「ハンドごとの行動詳細」テーブルのインデックス番号を選択すると、その行動が実行された際の詳細な「入力情報（JSON）」と「出力情報（Action, Amount）」を並べて比較できます。

### 5\. ADDITIONAL: 追加分析

  * **フェーズごとのアクション比率**: どのフェーズでどのアクションが多いかといった傾向を分析できます。
  * **チップ量の推移**: 各プレイヤーのハンド開始時点でのチップ量が折れ線グラフで表示されます。
